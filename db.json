{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"node_modules/hexo-theme-butterfly/source/img/404.jpg","path":"img/404.jpg","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-butterfly/source/img/favicon.png","path":"img/favicon.png","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-butterfly/source/img/friend_404.gif","path":"img/friend_404.gif","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-butterfly/source/css/index.styl","path":"css/index.styl","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-butterfly/source/css/var.styl","path":"css/var.styl","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-butterfly/source/js/main.js","path":"js/main.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-butterfly/source/js/tw_cn.js","path":"js/tw_cn.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-butterfly/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-butterfly/source/js/search/algolia.js","path":"js/search/algolia.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-butterfly/source/js/search/local-search.js","path":"js/search/local-search.js","modified":1,"renderable":1},{"_id":"source/images/docker/img.png","path":"images/docker/img.png","modified":1,"renderable":0}],"Cache":[{"_id":"node_modules/hexo-theme-butterfly/LICENSE","hash":"1128f8f91104ba9ef98d37eea6523a888dcfa5de","modified":1723861879330},{"_id":"node_modules/hexo-theme-butterfly/README.md","hash":"4e01b47448d9f3a02afc04eef644e2321253f6f4","modified":1723861879398},{"_id":"node_modules/hexo-theme-butterfly/README_CN.md","hash":"148da187d16033624ceccce8b8561835296f5a5a","modified":1723861879397},{"_id":"node_modules/hexo-theme-butterfly/package.json","hash":"b3b9e581778f66a1e920dc99c5035730033a475f","modified":1723861879397},{"_id":"node_modules/hexo-theme-butterfly/plugins.yml","hash":"d807fbb62163bb6fc5a83a24ebd69ac14cf45f67","modified":1723861879448},{"_id":"node_modules/hexo-theme-butterfly/_config.yml","hash":"39fbabbbf1e89dd82a6ea21517c6c24b49e4dd98","modified":1723861879445},{"_id":"node_modules/hexo-theme-butterfly/.github/FUNDING.yml","hash":"da5e77f5e0cdb7e11b36546fb6796d10e3dfbe5d","modified":1723861879448},{"_id":"node_modules/hexo-theme-butterfly/languages/en.yml","hash":"af5603b1a888f167dc80be6d53a19437b5cf6bef","modified":1723861879446},{"_id":"node_modules/hexo-theme-butterfly/languages/zh-CN.yml","hash":"5004faee365139521f161babd66649a8107e4008","modified":1723861879449},{"_id":"node_modules/hexo-theme-butterfly/languages/default.yml","hash":"90a6dc361de67532437d819a55ec64945ca5404b","modified":1723861879446},{"_id":"node_modules/hexo-theme-butterfly/languages/zh-TW.yml","hash":"03629d1d13a7be09d4933aa5dc0dcbe45e79140c","modified":1723861879449},{"_id":"node_modules/hexo-theme-butterfly/layout/archive.pug","hash":"bb32c9c476372de747dfa563b83f77d7a917a77d","modified":1723861879404},{"_id":"node_modules/hexo-theme-butterfly/layout/category.pug","hash":"710708cfdb436bc875602abf096c919ccdf544db","modified":1723861879408},{"_id":"node_modules/hexo-theme-butterfly/layout/index.pug","hash":"e1c3146834c16e6077406180858add0a8183875a","modified":1723861879421},{"_id":"node_modules/hexo-theme-butterfly/layout/page.pug","hash":"baf469784aef227e4cc840550888554588e87a13","modified":1723861879422},{"_id":"node_modules/hexo-theme-butterfly/layout/tag.pug","hash":"0440f42569df2676273c026a92384fa7729bc4e9","modified":1723861879428},{"_id":"node_modules/hexo-theme-butterfly/.github/ISSUE_TEMPLATE/bug_report.yml","hash":"6e34b565ea013812d5e363b6de5fa1f9078d4e12","modified":1723861879445},{"_id":"node_modules/hexo-theme-butterfly/layout/post.pug","hash":"fc9f45252d78fcd15e4a82bfd144401cba5b169a","modified":1723861879424},{"_id":"node_modules/hexo-theme-butterfly/.github/ISSUE_TEMPLATE/config.yml","hash":"7b4831ae8f8f8c55dd1b856781210c517c63e6dd","modified":1723861879445},{"_id":"node_modules/hexo-theme-butterfly/.github/ISSUE_TEMPLATE/feature_request.yml","hash":"996640605ed1e8e35182f0fd9a60a88783b24b03","modified":1723861879446},{"_id":"node_modules/hexo-theme-butterfly/.github/workflows/publish.yml","hash":"05857c2f265246d8de00e31037f2720709540c09","modified":1723861879448},{"_id":"node_modules/hexo-theme-butterfly/.github/workflows/stale.yml","hash":"ac62b989b5550c756e1986fcc68f243170705383","modified":1723861879449},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/404.pug","hash":"cb49f737aca272ccfeb62880bd651eccee72a129","modified":1723861879400},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/footer.pug","hash":"02390a5b6ae1f57497b22ba2e6be9f13cfb7acac","modified":1723861879414},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/additional-js.pug","hash":"aca0ec7ef69b21d1f242c62fed389468a0f0e1a2","modified":1723861879401},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/head.pug","hash":"ecec62305aaa596bb1dfbb46c13d06fb5a9628cf","modified":1723861879418},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/layout.pug","hash":"7fa9ae4b70b87fc97e992dde5944681f92b59bea","modified":1723861879421},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/pagination.pug","hash":"4c85de4dea4dca4e5088097a79bd6d7009cbf8ef","modified":1723861879423},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/rightside.pug","hash":"db275f7fbe4438b54cd813b695f4834e10aa234f","modified":1723861879427},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/sidebar.pug","hash":"9f0e9e039f304439007460fa0a7c8ac18e0ffd37","modified":1723861879427},{"_id":"node_modules/hexo-theme-butterfly/scripts/events/404.js","hash":"83cd7f73225ccad123afbd526ce1834eb1eb6a6d","modified":1723861879375},{"_id":"node_modules/hexo-theme-butterfly/scripts/events/comment.js","hash":"5351e0bc09e6b5b3f6d30f333a2520626a28ca3a","modified":1723861879377},{"_id":"node_modules/hexo-theme-butterfly/scripts/events/cdn.js","hash":"21fb5aabe043486d095c4c8cce361ed85ba88a26","modified":1723861879377},{"_id":"node_modules/hexo-theme-butterfly/scripts/events/init.js","hash":"428b94c7b9e83f7ea36227dee66bfe3c23aee4a8","modified":1723861879379},{"_id":"node_modules/hexo-theme-butterfly/scripts/events/stylus.js","hash":"e196a99733d7f90899bceed5d12488e8234817d5","modified":1723861879391},{"_id":"node_modules/hexo-theme-butterfly/scripts/events/welcome.js","hash":"8ad9911b755cba13dde2cc055c3f857a6b0dd20e","modified":1723861879397},{"_id":"node_modules/hexo-theme-butterfly/scripts/events/merge_config.js","hash":"2ac43fd4103ba3c6897da7c13015cb05f39fd695","modified":1723861879384},{"_id":"node_modules/hexo-theme-butterfly/scripts/filters/post_lazyload.js","hash":"860f967ecf3c6a6ea785b560a7aae4d0757cd18a","modified":1723861879387},{"_id":"node_modules/hexo-theme-butterfly/scripts/filters/random_cover.js","hash":"a8eef3f37428436554f58a2b6bac7c255fbdf38d","modified":1723861879387},{"_id":"node_modules/hexo-theme-butterfly/scripts/helpers/aside_archives.js","hash":"2ec66513d5322f185d2071acc052978ba9415a8e","modified":1723861879376},{"_id":"node_modules/hexo-theme-butterfly/scripts/helpers/aside_categories.js","hash":"96f861151e3b889ef0ffe78821d489ad2625ee43","modified":1723861879376},{"_id":"node_modules/hexo-theme-butterfly/scripts/helpers/findArchiveLength.js","hash":"7caf549810f971c34196fb9deac2d992545bdff9","modified":1723861879377},{"_id":"node_modules/hexo-theme-butterfly/scripts/helpers/page.js","hash":"e2a8a09bfe47da26eab242a36f516e6c452c799a","modified":1723861879386},{"_id":"node_modules/hexo-theme-butterfly/scripts/helpers/related_post.js","hash":"4677be4175da6800c0b3b8c1614e593f73df8831","modified":1723861879388},{"_id":"node_modules/hexo-theme-butterfly/scripts/helpers/inject_head_js.js","hash":"d5c7e61257b08a9648404f6f48ce4d471cd5fa55","modified":1723861879379},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/button.js","hash":"93229d44b35b9da92e647b89d6d3087085974a29","modified":1723861879377},{"_id":"node_modules/hexo-theme-butterfly/scripts/helpers/series.js","hash":"821e973d41f7b3b64cde91e0e836ea49c43e3c06","modified":1723861879388},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/flink.js","hash":"ab62919fa567b95fbe14889517abda649991b1ee","modified":1723861879378},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/gallery.js","hash":"418684993a3a3a2ac534257a2d9ecbcead6808c1","modified":1723861879378},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/hide.js","hash":"365db87ddfc582bf8c15cb440c48bed95106e4b1","modified":1723861879378},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/inlineImg.js","hash":"512c68a22ae4a58d6a6b24b368a0c00c2ccb4fcb","modified":1723861879379},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/label.js","hash":"19773218877281ccffed921431e87148413a7c20","modified":1723861879379},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/mermaid.js","hash":"5c2a07df5874b5377540884e4da14dd21489378f","modified":1723861879385},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/note.js","hash":"1acefc59ead75ebd8cafee36efc7da4fa426d088","modified":1723861879385},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/score.js","hash":"5cb273e95846874e3a58074074c501df23c5e912","modified":1723861879388},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/series.js","hash":"830b1d592278b9f676df0cf9a91b1eeda2456aec","modified":1723861879389},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/tabs.js","hash":"ffc62222f8d7b4d44c1c0726c8a08824a2201039","modified":1723861879391},{"_id":"node_modules/hexo-theme-butterfly/scripts/tag/timeline.js","hash":"4526c75e5bf84609d67e92b6af3524bcb278e852","modified":1723861879393},{"_id":"node_modules/hexo-theme-butterfly/source/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1723861879400},{"_id":"node_modules/hexo-theme-butterfly/source/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1723861879371},{"_id":"node_modules/hexo-theme-butterfly/source/css/index.styl","hash":"755490867fd8afe47d5cce24faea2ca172b0c4dd","modified":1723861879439},{"_id":"node_modules/hexo-theme-butterfly/source/css/var.styl","hash":"152b6bd4b6285165541a71f5a1c913f8ee6a602b","modified":1723861879443},{"_id":"node_modules/hexo-theme-butterfly/source/js/main.js","hash":"0dac585446445e0c419b86eec5580bc9b0657dc6","modified":1723861879384},{"_id":"node_modules/hexo-theme-butterfly/source/js/tw_cn.js","hash":"f8d2e3f31468991a7f5171cbfdb157dfb86d3372","modified":1723861879395},{"_id":"node_modules/hexo-theme-butterfly/source/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1723861879366},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/head/Open_Graph.pug","hash":"8aa8d799aedbfd811195b84a451bc4b6e2647c12","modified":1723861879422},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/head/analytics.pug","hash":"67e1c3b48e4ca7ee0b2c76d3ca7476b9883cf105","modified":1723861879402},{"_id":"node_modules/hexo-theme-butterfly/source/js/utils.js","hash":"8e6b48d294e7aeaba8ff6348c43b2271cf865547","modified":1723861879395},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/head/config_site.pug","hash":"7df90c8e432e33716517ab918b0a125bc284041b","modified":1723861879410},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/head/config.pug","hash":"63fed4548367a3663cdbaffa1df48167b0a2397b","modified":1723861879410},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/head/google_adsense.pug","hash":"95a37e92b39c44bcbea4be7e29ddb3921c5b8220","modified":1723861879418},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/head/pwa.pug","hash":"3d492cfe645d37c94d30512e0b230b0a09913148","modified":1723861879424},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/head/preconnect.pug","hash":"5208fe1e75d97a05fd9bdd6cc53c59d8b741b94b","modified":1723861879424},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/head/site_verification.pug","hash":"e2e8d681f183f00ce5ee239c42d2e36b3744daad","modified":1723861879427},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/header/index.pug","hash":"944d6e9dd50df3395f3a2c7ad9db667d50dea4ed","modified":1723861879418},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/header/menu_item.pug","hash":"31346a210f4f9912c5b29f51d8f659913492f388","modified":1723861879422},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/header/nav.pug","hash":"f61659aa457d1a2d1baa3a13157996cfac4d6609","modified":1723861879422},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/header/social.pug","hash":"5de9a82032cdad1db3b868b797460921cd775fc2","modified":1723861879428},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/loading/fullpage-loading.pug","hash":"9e8c5788602b29a527ef35fe8a20076a5fa969bd","modified":1723861879415},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/header/post-info.pug","hash":"f50e6a17073677933c5bc78481bf587a4a9e6da0","modified":1723861879423},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/loading/index.pug","hash":"131f344d68b4c241d6e03849b243ee792fcd3cea","modified":1723861879418},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/loading/pace.pug","hash":"6ab4e301c92586505d6cddce1b3ad23b7c79010d","modified":1723861879422},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/mixins/article-sort.pug","hash":"90554c2ca5ba946f4c02e1bc5fe2859cef1b1594","modified":1723861879405},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/page/categories.pug","hash":"5276a8d2835e05bd535fedc9f593a0ce8c3e8437","modified":1723861879408},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/mixins/post-ui.pug","hash":"6f310ca7b392021632b987557607d5b6d18052bb","modified":1723861879424},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/page/default-page.pug","hash":"12c65c174d26a41821df9bad26cdf1087ec5b0ca","modified":1723861879410},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/page/tags.pug","hash":"9621991359e22b14049346f1cf87bdedc94edf5a","modified":1723861879428},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/page/flink.pug","hash":"f9ce83978b217a71a2eb8761dc14b09866faa3f4","modified":1723861879414},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/post/post-copyright.pug","hash":"5574804fdea5edf7fd52aad2caf030614d5e7f2f","modified":1723861879423},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/post/reward.pug","hash":"a096ff8eb6b2a22395be881f827ff2a686ba5596","modified":1723861879426},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/aplayer.pug","hash":"c7cfade2b160380432c47eef4cd62273b6508c58","modified":1723861879403},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/effect.pug","hash":"1d39670ee6225f85f5c53bf5c84f3fd6e19290e8","modified":1723861879413},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/pangu.pug","hash":"0f024e36b8116118233e10118714bde304e01e12","modified":1723861879423},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/prismjs.pug","hash":"ffb9ea15a2b54423cd4cd441e2d061b8233e9b58","modified":1723861879424},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/pjax.pug","hash":"12e57491e94fa00d953bbda9db0b6d6169e2358c","modified":1723861879423},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/subtitle.pug","hash":"8044b9c18b34b019ffe26b7383e7e80356b5e4b5","modified":1723861879427},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_ad.pug","hash":"60dc48a7b5d89c2a49123c3fc5893ab9c57dd225","modified":1723861879406},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_announcement.pug","hash":"ae392459ad401a083ca51ee0b27526b3c1e1faed","modified":1723861879406},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_archives.pug","hash":"86897010fe71503e239887fd8f6a4f5851737be9","modified":1723861879407},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_bottom_self.pug","hash":"13dc8ce922e2e2332fe6ad5856ebb5dbf9ea4444","modified":1723861879407},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_author.pug","hash":"03c6afabbf1ac729c7fb21c7ec06da0190b0fdc7","modified":1723861879407},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_categories.pug","hash":"d1a416d0a8a7916d0b1a41d73adc66f8c811e493","modified":1723861879407},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_post_series.pug","hash":"bd5ad01277f8c6ddf8a3a29af1518e5fe6eed23f","modified":1723861879408},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_post_toc.pug","hash":"a658a274c5f7896ee5122725bee45548693bdd66","modified":1723861879408},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_newest_comment.pug","hash":"7834bf7c711e739fd33cfcd0b53d151013b3d449","modified":1723861879407},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_recent_post.pug","hash":"e5aac7b28ed4123d75797263c64e74ac547945bc","modified":1723861879408},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_tags.pug","hash":"eceb4420a64c720f0d2741e89d6229bbb3d87353","modified":1723861879408},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_top_self.pug","hash":"ae67c6d4130a6c075058a9c1faea1648bcc6f83e","modified":1723861879408},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/index.pug","hash":"66f7a8b0cebc05c575ec3cb70b08d6854029d87a","modified":1723861879420},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/widget/card_webinfo.pug","hash":"35ce167c5a275211bfc1fa3d49adfde5b404d98f","modified":1723861879408},{"_id":"node_modules/hexo-theme-butterfly/source/css/_global/index.styl","hash":"c8ff6ddd5bfe1190b7b8056b68ce41114fd79dcb","modified":1723861879438},{"_id":"node_modules/hexo-theme-butterfly/source/css/_global/function.styl","hash":"f19694a42dbe28eda4b39a1696e8fbcd277bc76c","modified":1723861879435},{"_id":"node_modules/hexo-theme-butterfly/source/css/_highlight/highlight.styl","hash":"4dcd468e4d11a0ac75406162678feffcd89fee00","modified":1723861879438},{"_id":"node_modules/hexo-theme-butterfly/source/css/_highlight/theme.styl","hash":"bcd384c8b2aa0390c9eb69ac1abbfd1240ce1da4","modified":1723861879443},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/chat.styl","hash":"f9a5d3f1fc5ed0ed2ee4c1eaa58ed650d11ddebd","modified":1723861879433},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/comments.styl","hash":"134811b2d696f9ed2c0cd578f3886f1c60770c0a","modified":1723861879433},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/footer.styl","hash":"83a7a70eb0532ea9c4267939fe484af915fca01e","modified":1723861879435},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/aside.styl","hash":"fad650f88778b33a6358e38cf50dfafc0974d28f","modified":1723861879432},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/loading.styl","hash":"ac2aeee9926f75b2a0098efe1c114126987430f2","modified":1723861879439},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/head.styl","hash":"18d08be0cd9b1f8c049d4b922e80f8163a55c947","modified":1723861879436},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/pagination.styl","hash":"fb9f78bfbb79579f1d752cb73fb6d25c8418e0fd","modified":1723861879440},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/relatedposts.styl","hash":"d53de408cb27a2e704aba7f7402b7caebe0410d8","modified":1723861879442},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/post.styl","hash":"a2eb44fa5eaea1325319a2064439cf36d0f35a2f","modified":1723861879440},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/reward.styl","hash":"d6cf26ffb8a0343eda1cde65b6b73b0ddbe8fcfc","modified":1723861879442},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/rightside.styl","hash":"f845b9b4efdee750f70c023aab27432611f83059","modified":1723861879442},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/sidebar.styl","hash":"b7a6a585dbc38d177c9aba75df3a467415d0488a","modified":1723861879442},{"_id":"node_modules/hexo-theme-butterfly/source/css/_layout/third-party.styl","hash":"5556c9bf4f53a90cb9b4945cd76a8849bd67f3f3","modified":1723861879443},{"_id":"node_modules/hexo-theme-butterfly/source/css/_mode/darkmode.styl","hash":"0db591a1f4ed5adcb8668a549bbee5c9d62682cf","modified":1723861879433},{"_id":"node_modules/hexo-theme-butterfly/source/css/_page/404.styl","hash":"50dbb9e6d98c71ffe16741b8c1b0c1b9771efd2b","modified":1723861879431},{"_id":"node_modules/hexo-theme-butterfly/source/css/_page/archives.styl","hash":"c9e98027f2dd730ce389c2047f62ebb748955fcf","modified":1723861879432},{"_id":"node_modules/hexo-theme-butterfly/source/css/_mode/readmode.styl","hash":"e549d24ad81a7d93326a509ff8dcfcc58c80729e","modified":1723861879440},{"_id":"node_modules/hexo-theme-butterfly/source/css/_page/categories.styl","hash":"f01ee74948cedb44e53cd3bb1ef36b7d2778ede7","modified":1723861879433},{"_id":"node_modules/hexo-theme-butterfly/source/css/_page/common.styl","hash":"4e320e16d49bc18085045937681f7331a1e243ca","modified":1723861879433},{"_id":"node_modules/hexo-theme-butterfly/source/css/_page/flink.styl","hash":"98d755b686ee833e9da10afaa40c4ec2bd66c19a","modified":1723861879435},{"_id":"node_modules/hexo-theme-butterfly/source/css/_page/homepage.styl","hash":"d4ebc41b5c855dd75f47de7345d62f85ce7cf073","modified":1723861879438},{"_id":"node_modules/hexo-theme-butterfly/source/css/_page/tags.styl","hash":"580feb7e8b0822a1be48ac380f8c5c53b1523321","modified":1723861879443},{"_id":"node_modules/hexo-theme-butterfly/source/css/_search/algolia.styl","hash":"649a054e73278b6724bd4dd9b94724791ec5c928","modified":1723861879431},{"_id":"node_modules/hexo-theme-butterfly/source/css/_search/index.styl","hash":"20a3134e1302b62bfc881f4ec43f398267111f22","modified":1723861879438},{"_id":"node_modules/hexo-theme-butterfly/source/css/_search/local-search.styl","hash":"961589da3c0a532c4709a4a4ea96bd579257f766","modified":1723861879439},{"_id":"node_modules/hexo-theme-butterfly/source/css/_tags/button.styl","hash":"45f0c32bdea117540f6b14ebac6450d7142bd710","modified":1723861879433},{"_id":"node_modules/hexo-theme-butterfly/source/css/_tags/hexo.styl","hash":"d76c38adf1d9c1279ef4241835667789f5b736e0","modified":1723861879436},{"_id":"node_modules/hexo-theme-butterfly/source/css/_tags/hide.styl","hash":"ce489ca2e249e2a3cf71584e20d84bdb022e3475","modified":1723861879437},{"_id":"node_modules/hexo-theme-butterfly/source/css/_tags/inlineImg.styl","hash":"df9d405c33a9a68946b530410f64096bcb72560c","modified":1723861879439},{"_id":"node_modules/hexo-theme-butterfly/source/css/_tags/gallery.styl","hash":"5cddbb5f4eae695a26685e415d821b523e0f17bf","modified":1723861879435},{"_id":"node_modules/hexo-theme-butterfly/source/css/_tags/label.styl","hash":"66c59e193d794cdb02cca7bd1dc4aea5a19d7e84","modified":1723861879439},{"_id":"node_modules/hexo-theme-butterfly/source/css/_tags/tabs.styl","hash":"2d02e52b360f6e6cae47c293ae57ed78e2554663","modified":1723861879443},{"_id":"node_modules/hexo-theme-butterfly/source/css/_tags/note.styl","hash":"909bb5079b26b6ee68177919f522566503654058","modified":1723861879440},{"_id":"node_modules/hexo-theme-butterfly/source/css/_tags/timeline.styl","hash":"f071156d439556e7463ed4bc61ceee87170d5d08","modified":1723861879443},{"_id":"node_modules/hexo-theme-butterfly/source/css/_third-party/normalize.min.css","hash":"2c18a1c9604af475b4749def8f1959df88d8b276","modified":1723861879331},{"_id":"node_modules/hexo-theme-butterfly/source/js/search/algolia.js","hash":"108988d046da9a4716148df43b3975217c8ceaae","modified":1723861879375},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/abcjs/abcjs.pug","hash":"f7299f9fef5bf94bb58c8cd3be8ee660ad2f9cd4","modified":1723861879400},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/abcjs/index.pug","hash":"f58f1648d2d71311bafca4833f20b605bb5f18c8","modified":1723861879418},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/card-post-count/artalk.pug","hash":"71af0b679e00290b0854384368b3c7e9b3e5f26a","modified":1723861879404},{"_id":"node_modules/hexo-theme-butterfly/source/js/search/local-search.js","hash":"e1f60ebac53a3f596fd0a4769b4f9275c48c6542","modified":1723861879382},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/card-post-count/disqus.pug","hash":"c5f7081ca29db8cc80f808dfc29e36d5fa22fd7e","modified":1723861879411},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/card-post-count/fb.pug","hash":"0344477a2cf38698318ead2681c63ac12f01586e","modified":1723861879414},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/card-post-count/index.pug","hash":"b2d274db84ef22fbd6d5ea8f4404821898934209","modified":1723861879419},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/card-post-count/remark42.pug","hash":"001e8be47854b891efe04013c240c38fed4185eb","modified":1723861879425},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/card-post-count/twikoo.pug","hash":"56c028ba0ea8fac19f0125114d765dfc56ce2b48","modified":1723861879428},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/card-post-count/valine.pug","hash":"39427e107230a10790972349c9dd4c4f31d55eb7","modified":1723861879429},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/card-post-count/waline.pug","hash":"3a5ccfc69bd8ccb4b8f3ce3502023f7914f2a022","modified":1723861879430},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/chat/chatra.pug","hash":"ddce8352b371a1fb426bdb6c33f587eb37a69647","modified":1723861879410},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/chat/crisp.pug","hash":"2fb098a7aa45010a8cd212dc0bd5308c6e7c63e3","modified":1723861879410},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/chat/daovoice.pug","hash":"9b57a8e13de8fc51a5f550854e47164fd8ac1be8","modified":1723861879410},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/chat/index.pug","hash":"618e1b7f9204049b07beb9e1363c844a78a9ace3","modified":1723861879419},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/chat/messenger.pug","hash":"e39a9c37adf4cb15a2ba3b2cc65542ffea88650d","modified":1723861879422},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/artalk.pug","hash":"f77f0fdeac2bc8a72f71a58f9b75aa39f0a108c8","modified":1723861879405},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/disqus.pug","hash":"62f16a602e57e5f7f7c5249dd37b42d436dc032a","modified":1723861879411},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/chat/tidio.pug","hash":"dd61eca6e9a45f63e09bdefba89fe285a81ba096","modified":1723861879428},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/disqusjs.pug","hash":"3bc4c1b91568561f0491bdac65b75aa0bfd01f27","modified":1723861879411},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/facebook_comments.pug","hash":"46aec6466959baec1c3d71a5dbc510fbeb00c91d","modified":1723861879414},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/giscus.pug","hash":"2d7b0b09678adba09481e3152e0b32962677f650","modified":1723861879416},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/gitalk.pug","hash":"0d378ee8a671982a46213a4bfb223b4f3409aea9","modified":1723861879416},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/index.pug","hash":"a9709905593d960954e2dd572f09f48a6c2b1ef7","modified":1723861879419},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/js.pug","hash":"00ed91c52939b9675b316137f854d13684c895a6","modified":1723861879421},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/livere.pug","hash":"63cea2b5c8f7b59f5919379d61a2bb2ce8ed7623","modified":1723861879421},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/remark42.pug","hash":"f15699abb8c7a255aabad0222ae53eee387c66a3","modified":1723861879425},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/twikoo.pug","hash":"5c29b5887e2e6cd81e1f13b32da53d9c139b788b","modified":1723861879429},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/utterances.pug","hash":"1995a654ba7ad62775a0a6e2922209cd1a85f2e3","modified":1723861879429},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/valine.pug","hash":"46865e3f52096acb07d0212174b4e8751b123aea","modified":1723861879429},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/comments/waline.pug","hash":"7aa443b4881448979b810864e206e58c9ed787e3","modified":1723861879430},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/math/index.pug","hash":"b8ae5fd7d74e1edcef21f5004fc96147e064d219","modified":1723861879420},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/math/katex.pug","hash":"dfcbd9881be569ea420eff1a6b00e4f4dbe2138e","modified":1723861879421},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/math/mathjax.pug","hash":"fc072ac839401174b5d3cf9acd3b694246c23a55","modified":1723861879421},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/math/mermaid.pug","hash":"6b67982bb7a3713b5bffd6a23ba2810425c504d0","modified":1723861879422},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/newest-comments/artalk.pug","hash":"17080aba1754478197ab089f7948ed900f116d2b","modified":1723861879405},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/newest-comments/disqus-comment.pug","hash":"2609bc2656aaaa9b59e8d575e711776512a62192","modified":1723861879411},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/newest-comments/index.pug","hash":"4ec0642f2d5444acfab570a6f8c7868e7ff43fde","modified":1723861879420},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/newest-comments/github-issues.pug","hash":"0f0b46d637a9a1b6ae35148923abecc80b866276","modified":1723861879417},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/newest-comments/remark42.pug","hash":"de2c4d02b520dd49a0a59fc0f33295e5bbb2c624","modified":1723861879426},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/newest-comments/twikoo-comment.pug","hash":"4104f96faa6040f111ebfb9a90eeb470857c3b86","modified":1723861879428},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/newest-comments/valine.pug","hash":"1f9f51023e9e33081c2add2ca73643c0edc5e9d5","modified":1723861879429},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/newest-comments/waline.pug","hash":"24804ab6da9727ed793655c1262fa3f1a9746f70","modified":1723861879430},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/search/algolia.pug","hash":"9c3c109a12d2b6916e8b4965cca12f521510ead9","modified":1723861879402},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/search/docsearch.pug","hash":"b928be14d1b47a9fadb1bcc5f5072a7328752d4b","modified":1723861879411},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/search/index.pug","hash":"a99a41334387ee9a46c6f8e8212331a29a10d159","modified":1723861879420},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/search/local-search.pug","hash":"3335024ba91f55ccf3858571b7898f46881c455c","modified":1723861879421},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/share/addtoany.pug","hash":"85c92f8a7e44d7cd1c86f089a05be438535e5362","modified":1723861879401},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/share/index.pug","hash":"3ba49cfe186e9ca05faf9f0d0113611ec47e9b38","modified":1723861879420},{"_id":"node_modules/hexo-theme-butterfly/layout/includes/third-party/share/share-js.pug","hash":"c7dd2b2ae9b23aa0a60fffd7df9e9f76ef52033e","modified":1723861879427},{"_id":"node_modules/hexo-theme-butterfly/source/css/_highlight/highlight/diff.styl","hash":"cf1fae641c927621a4df1be5ca4a853b9b526e23","modified":1723861879434},{"_id":"node_modules/hexo-theme-butterfly/source/css/_highlight/highlight/index.styl","hash":"18804c58239d95798fa86d0597f32d7f7dd30051","modified":1723861879438},{"_id":"node_modules/hexo-theme-butterfly/source/css/_highlight/prismjs/diff.styl","hash":"5972c61f5125068cbe0af279a0c93a54847fdc3b","modified":1723861879435},{"_id":"node_modules/hexo-theme-butterfly/source/css/_highlight/prismjs/index.styl","hash":"5dc2e0bcae9a54bfb9bdcc82d02ae5a3cf1ca97d","modified":1723861879438},{"_id":"node_modules/hexo-theme-butterfly/source/css/_highlight/prismjs/line-number.styl","hash":"25914321762e30aacc610bc4dfb9de3e1cb556a3","modified":1723861879439},{"_id":"source/about/index.md","hash":"657772a187f652e5b37c2cda6b695927e7d16634","modified":1722856044398},{"_id":"source/ceph/index.md","hash":"282a172afe12bc4d1b25918d7ca71c75ec62b7d2","modified":1723858999731},{"_id":"source/links/index.md","hash":"d79aa67b02c5f1d976f110a14880d3f6064c7f69","modified":1722856044398},{"_id":"source/message-board/index.md","hash":"58e34b3d298804e0d2ea8d55ae74d00d388c7633","modified":1722856044398},{"_id":"source/_posts/2023/Hadoop.md","hash":"62ea2073e8b89de4e3314553e94d5728068b4b79","modified":1722856044314},{"_id":"source/_posts/2023/docker-springboot-config.md","hash":"49fb99ddee14cb3133eeaf24082b7c692bc53a31","modified":1722856044333},{"_id":"source/_posts/2023/docker-springboot.md","hash":"798b0dee8d3c79ae5da6e27285b69c1084545d2c","modified":1722856044333},{"_id":"source/_posts/2023/dockerfile.md","hash":"46a3902fb639d5dc960e99736f30eb3fc51a767b","modified":1722856044333},{"_id":"source/_posts/2023/gitlab-ci-springboot.md","hash":"d1c340d8a8fb0325d089964a03bdce19dfafd18a","modified":1722856044333},{"_id":"source/_posts/2023/gitlab.md","hash":"1da7c2da4eff1a7caa98d047f0b6c28e8c54138b","modified":1722856044336},{"_id":"source/_posts/2023/docker.md","hash":"914ae68e7db304981cb60f4060a3585dd7af6fe1","modified":1722856044333},{"_id":"source/_posts/2023/jvm.md","hash":"3720e5fb8be4dcfbb4bfb8e97576260207a7476a","modified":1722856044339},{"_id":"source/_posts/2023/kotlin-springboot.md","hash":"da8089c3b71a21d76c5cbca30103e16f9978eeb2","modified":1722860875738},{"_id":"source/_posts/2023/localdate-springboot.md","hash":"017c4b6952170bef2a8539cd72e9c25a5f7ab9d3","modified":1722860875731},{"_id":"source/_posts/2023/thread-pool.md","hash":"8d1fc199ed4c8d77d9cab206231e0dcb46552a51","modified":1722856044366},{"_id":"source/images/docker/img.png","hash":"b143488994153ef0d6f7e54496b1032224d384a4","modified":1722856044398},{"_id":"source/_posts/2024/jsch/jsch.md","hash":"920023bc35cd7ef1d18169d9502c6015dfb7bb87","modified":1722861261624},{"_id":"source/_posts/2023/Hadoop/image-20200822090658863.png","hash":"d7fc3ffd118a9de3fd8ef2b5b6d558dc867902d5","modified":1722856044319},{"_id":"source/_posts/2023/Hadoop/image-20200822090905199.png","hash":"25e8cd21aa5779e9f47fa546c247e867a84015e0","modified":1722856044319},{"_id":"source/_posts/2023/https.md","hash":"f95e963e31870a6d51e32315a611ff1ebfe8d023","modified":1722856044339},{"_id":"source/_posts/2023/Hadoop/image-20200822091216510.png","hash":"b8785e417cf113d5a83e4d71dc3226639d3f5431","modified":1722856044319},{"_id":"source/_posts/2023/Hadoop/image-20200822091809558.png","hash":"7432d46f5c12e36dbd633f4b47c82c20f36c35e6","modified":1722856044320},{"_id":"source/_posts/2023/Hadoop/image-20200822092048172.png","hash":"a67e04af7dbe1dc1778501f3220965b6f43b3eba","modified":1722856044320},{"_id":"source/_posts/2023/Hadoop/image-20200822093255847.png","hash":"eacb1a96d01d3ae079893859cde70b1f2989a978","modified":1722856044320},{"_id":"source/_posts/2023/Hadoop/image-20200822100056038.png","hash":"141d5c19c489fea0a62003641aefca5d74eb5e31","modified":1722856044322},{"_id":"source/_posts/2023/Hadoop/image-20200822102024933.png","hash":"d7124e486338ff4331137f38b1b4c1c6979f0a56","modified":1722856044322},{"_id":"source/_posts/2023/Hadoop/image-20200822102108817.png","hash":"03b11682abdcc18022e0fcb120d428f1f0f7148b","modified":1722856044322},{"_id":"source/_posts/2023/Hadoop/image-20200827081213048.png","hash":"1cbc3780302c1f4d525e55c446e7221db10221c6","modified":1722856044330},{"_id":"source/_posts/2023/Hadoop/image-20200827081247672.png","hash":"aa0635adbf8548c108d58ef07adefaa21f929f7b","modified":1722856044330},{"_id":"source/_posts/2023/docker/img.png","hash":"b143488994153ef0d6f7e54496b1032224d384a4","modified":1722856044333},{"_id":"source/_posts/2023/Hadoop/image-20200830083752748.png","hash":"4d48d443e2fbf67f237bc3e91dd03d448101b5b1","modified":1722856044333},{"_id":"source/_posts/2023/gitlab/img_0.png","hash":"d7f77d4af50b9c1ea9899716abf7d0c63617e28e","modified":1722856044336},{"_id":"source/_posts/2023/gitlab/img_1.png","hash":"96c624fe29a8788e745da8fa598815e09158a992","modified":1722856044337},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_10.png","hash":"995ab2fb28aeb05e4760c4e141dc10729c842961","modified":1722856044334},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_11.png","hash":"f41f8ea13677c8c36bf2e497ef6d1f98de9287f7","modified":1722856044334},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_7.png","hash":"ffafc6509bc1a548005e8668d090bed46cee458d","modified":1722856044336},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_9.png","hash":"32571f27b92a774d43d33cd6a32859ec58cac8ab","modified":1722856044336},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_8.png","hash":"a1a30dcd7dd81059add8dcb1c1b3c7583892cbb3","modified":1722856044336},{"_id":"source/_posts/2023/kotlin-springboot/kotlin.png","hash":"fe1dbb0685411cb1e07231201162d28f18a6f03c","modified":1722861427000},{"_id":"source/_posts/2023/jvm/3bfa032a-2a4e-4f01-b03d-90c4c39df0aa.png","hash":"8e776b0b7ee3c45619f140503c9c27bdf20037ee","modified":1722856044340},{"_id":"source/_posts/2023/jvm/4f6873cb-c0f9-4955-8600-bf37e24f4fbf.png","hash":"dfffd7906b9a69d21cb644b15b5ddb3932ee65f4","modified":1722856044343},{"_id":"source/_posts/2023/jvm/5f12c1e3-2e47-4997-a887-b395b511490b.png","hash":"da1effd9381c2231ae7fc51fda2210f532aecae8","modified":1722856044344},{"_id":"source/_posts/2023/jvm/626353d2-1f73-46e9-858d-732ed7bee94a.png","hash":"856df1b182f85194738502a882aece1f48dfdaed","modified":1722856044345},{"_id":"source/_posts/2023/thread/0e59c147-a499-4226-bf3b-d6f0a4cabd5a.png","hash":"663ac36db166b7f0f0be74799bf9f9e2badcc1f5","modified":1722856044369},{"_id":"source/_posts/2023/thread/210feb5c-150a-43c3-8b3d-440f53e343d1.png","hash":"316de16f4669bb9cd7933ac9052afec6640f33ef","modified":1722856044369},{"_id":"source/_posts/2023/thread/2feee3db-6b39-4e1a-9098-1a5f966742f7.png","hash":"5bd0d306e3fa5201b97dbea2754c913cb02d16f8","modified":1722856044370},{"_id":"source/_posts/2023/thread/3a071edf-6ded-487b-abbb-d016a9fe6864.png","hash":"07e81d464bfbed0cce4b25d8f75264b4365f455b","modified":1722856044370},{"_id":"source/_posts/2023/thread/3ce55a24-aeb0-4055-9925-c69a63ec9053.png","hash":"6fee86ac4ba8fb76dac7b65467ba6282f69e781c","modified":1722856044370},{"_id":"source/_posts/2023/thread/4b22adcb-879c-493e-a6dc-7a50426a6db7.png","hash":"0ee5d65ef5f85aeca6ce4e45e96d8731d4f4cfb1","modified":1722856044372},{"_id":"source/_posts/2023/thread/4f22eeff-a017-46f6-bf49-5359e570fe22.png","hash":"f58a2c6ca682fc86a56d4e5c11d14c0092d7fbd5","modified":1722856044372},{"_id":"source/_posts/2023/thread/52ebada9-ad0c-45fc-9482-40b961c20bbf.png","hash":"c70ea807c2b5bc2c7c3e1ec5e7b2a5247ce05e59","modified":1722856044373},{"_id":"source/_posts/2023/thread/51e456b2-69ca-4039-8ec3-137a74a3e57d.png","hash":"ee61890765721cbd674687298584e6094d6203b5","modified":1722856044373},{"_id":"source/_posts/2023/thread/5cce206b-f24c-4489-afda-57b5a3102172.png","hash":"b767fe80aa4b611bacf1bcd3f9fd43d3a30c9f5d","modified":1722856044373},{"_id":"source/_posts/2023/thread/683dd209-d862-46f9-878f-b9e8f4c2db3b.png","hash":"b6e8d9ad8d6023695c28d85cc9984a8e3a311cd1","modified":1722856044373},{"_id":"source/_posts/2023/thread/75442144-d101-4e7a-97ca-c833a2b827fe.png","hash":"7424b987b22a83d9b74a04cfeac3107ccd268592","modified":1722856044374},{"_id":"source/_posts/2023/thread/70691192-ef7e-43b6-b365-d139f036e188.png","hash":"f2a08244782535b2da540ced9432a97469feeb0b","modified":1722856044374},{"_id":"source/_posts/2023/thread/7bf73e18-7259-45da-93c5-a4183062572e.png","hash":"71b171d00227e1db64ee9cc852edd95a4f42f8ac","modified":1722856044375},{"_id":"source/_posts/2023/thread/6d0f8427-4068-4a15-a933-cd3f74e28dbf.png","hash":"2f093ea67352ffa5206724c6a0a74973bea851b8","modified":1722856044374},{"_id":"source/_posts/2023/thread/7d8e2e3b-8f62-4e97-86d1-d8ab88b83ca1.png","hash":"588d6599688192f7cd1bbc9a3b7660e3bb4fabb0","modified":1722856044375},{"_id":"source/_posts/2023/thread/815e324a-777f-4b34-b590-acbb4c624cb0.png","hash":"b2cafbf904b30d436cff0f586b8cf7509a53fbe8","modified":1722856044375},{"_id":"source/_posts/2023/thread/86d6badd-f76b-4152-8044-bef85f333017.png","hash":"9738c63f3b469c594cda5cfc94c1647890a05940","modified":1722856044376},{"_id":"source/_posts/2023/thread/a6cd39b0-e6e9-4b6f-88ea-3cfb0d899b83.png","hash":"9ad36c024752065b597cc3dad8b05be6a023e531","modified":1722856044377},{"_id":"source/_posts/2023/thread/bc0f03b1-c84a-45af-879e-4bdc0f0ff35e.png","hash":"3cec796993b6ee3fadb1c4aac935527701226d0e","modified":1722856044378},{"_id":"source/_posts/2023/thread/c2203c1e-3091-4832-8061-8ba8bc3b24d1.png","hash":"9f26f95685b8c6c38bb857cb27756a6f12e2edc6","modified":1722856044379},{"_id":"source/_posts/2023/thread/ca324ec8-b1a0-419a-a962-640dae424e10.png","hash":"c42c3d3dcc1c8ca4d9ff81253d88b1b73dfd6360","modified":1722856044379},{"_id":"source/_posts/2023/thread/cb65fed7-57dd-404b-b4f1-e365dbe83379.png","hash":"290852347a4d3d810007dc01b9db3bec494d1d9c","modified":1722856044379},{"_id":"source/_posts/2023/thread/d05f71ef-bbbb-4b19-a804-6444a74de835.png","hash":"f7feac9d118a9ceeae453270fbe57f346405a776","modified":1722856044379},{"_id":"source/_posts/2023/thread/d37e0c1b-1e69-4360-937a-edf5296f47ce.png","hash":"2b111d57e4382379c3da9dfcc65b7fdb2737edaa","modified":1722856044381},{"_id":"source/_posts/2023/thread/ea4c56c3-75b1-48fa-a40e-dcb6dd63823f.png","hash":"551d3b922458221f252abe7f88ba3f5aed400408","modified":1722856044383},{"_id":"source/_posts/2023/thread/f5e5190c-2ca0-4467-8618-c9084b18b26f.png","hash":"1a84944ce5afcf74a3a1bcc5afa2b4042167df6f","modified":1722856044384},{"_id":"source/_posts/2023/thread/f78c9ec4-6379-48de-b2e6-f529bb063540.png","hash":"028bb29d17c1c8eed636a0756db0690fa03ff83b","modified":1722856044384},{"_id":"source/_posts/2023/thread/feed6992-8dff-450c-9010-e2f46caf6243.png","hash":"f6e1257845d5914ac68f56dc052dc39afbc82115","modified":1722856044384},{"_id":"source/_posts/2023/thread/image-20200806070304756.png","hash":"f9dfca825356fc1e2c30432b35d0648b9d549b50","modified":1722856044385},{"_id":"source/_posts/2023/thread/image-20200806070323056.png","hash":"6796a4feb0fc360f4c82e6290c77af0d33780b47","modified":1722856044385},{"_id":"source/_posts/2023/thread/image-20200806080136510.png","hash":"9103f2678ec0cefb33cb191e5009341d9d698eda","modified":1722856044386},{"_id":"source/_posts/2023/thread/image-20200806081215362.png","hash":"492631ff5318a7e8b9349f632d6529a868d93061","modified":1722856044388},{"_id":"source/_posts/2023/thread/image-20200806081339039.png","hash":"cffbdb84a9a9e35e010bfd44e2e34858af7d5637","modified":1722856044388},{"_id":"source/_posts/2023/thread/image-20200806081409317.png","hash":"ba278464bf35d6052fa89ae01d9974c4ddaf1884","modified":1722856044389},{"_id":"source/_posts/2023/thread/image-20200806093605366.png","hash":"694cfbe498d562957601afae761fd13dd40be691","modified":1722856044389},{"_id":"source/_posts/2023/thread/image-20200806112353892.png","hash":"b7dcaaad87ecfb99fc562e9ec042695b2d51a797","modified":1722856044390},{"_id":"source/_posts/2023/thread/image-20200818213438504.png","hash":"f1c421e1781dcfba8098b39151285e6ab320cd64","modified":1722856044393},{"_id":"source/_posts/2023/thread/image-20200819065515918.png","hash":"582e986b0b79cbc6ed7365ca61e336eb595e0998","modified":1722856044393},{"_id":"source/_posts/2023/thread/image-20200819064936628.png","hash":"a49e6013c091b78f269d1301ce98ef221282af35","modified":1722856044393},{"_id":"source/_posts/2023/thread/image-20200819065601188.png","hash":"0640011d4ca03ca90746874dee5f40e4e32dd905","modified":1722856044394},{"_id":"source/_posts/2023/thread/image-20200819065708766.png","hash":"72b90495ef9382ebd6c505e6a5d6f36ad1e318ca","modified":1722856044394},{"_id":"source/_posts/2023/thread/image-20200819065931928.png","hash":"15aa55530c3c335c250ab871610b8df489c9d860","modified":1722856044396},{"_id":"source/_posts/2023/thread/image-20200819071006301.png","hash":"1f153e2698d1babc2be26e7fa9782c55cc4ef072","modified":1722856044396},{"_id":"source/_posts/2023/thread/image-20200819071139042.png","hash":"2a6dcba9c5f8e427624744e43b9ad722bbc49739","modified":1722856044396},{"_id":"source/_posts/2023/thread/image-20200819072504262.png","hash":"bbaee27959b4ef444eff941b385c266ab43b3699","modified":1722856044397},{"_id":"source/_posts/2023/thread/image-20200822234416578.png","hash":"9ec2f0afd72eae56ce6d748bfa689ddc78e9d70e","modified":1722856044398},{"_id":"source/_posts/2023/thread-pool/e0733727-92bd-4438-a628-3b3989d8e838.png","hash":"c2291fdef94fd0aa6a714767358a290ea33eccc2","modified":1722856044367},{"_id":"source/_posts/2024/jsch/jsch/ssh.webp","hash":"e25c4c12bc0f742703bc4853b041af5141cfc8a6","modified":1722862095000},{"_id":"source/_posts/2024/jsch/jsch/ssh.jpg","hash":"3d3014147b2baceec1a624a2db4ea693124ffaa4","modified":1722861946000},{"_id":"source/_posts/2023/Hadoop/image-20200822091335115.png","hash":"e08813cdce7071540bff67fbb0cbd07af5bd85a7","modified":1722856044320},{"_id":"source/_posts/2023/gitlab/img_2.png","hash":"7b0a07bc04b004d74d47754411a5825e0ab03062","modified":1722856044337},{"_id":"source/_posts/2023/gitlab/img_4.png","hash":"6091a762b81a9854e08360e39d39b2de42b378e4","modified":1722856044338},{"_id":"source/_posts/2023/gitlab/img_3.png","hash":"3a260c5afd1cebacc9cbb42b49dcc3a52399edf5","modified":1722856044338},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_12.png","hash":"6b2f4e69a0850b3bebbb59e9ad5b0a68cd76d4d0","modified":1722856044334},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_6.png","hash":"b968b33971b7dcbb31679803d1cd7c729eeb02e4","modified":1722856044335},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_5.png","hash":"aa538d95ed2d8361ab43f6b5d677264350503542","modified":1722856044335},{"_id":"source/_posts/2023/https/https.png","hash":"62ee9c6405db5bc8c20553be16706d684b2800ab","modified":1722856044339},{"_id":"source/_posts/2023/jvm/0c1c2fd0-acb6-4197-801f-a9ff12f5ced4.png","hash":"5d4398baa866a6b1bbfb9f1d9026d57bf52e87f7","modified":1722856044340},{"_id":"source/_posts/2023/jvm/3d67796c-0dc7-4f12-9af0-39b20fab7cbf.png","hash":"57e32b13dc4acddd9f89aa60af0df1d5c6a22684","modified":1722856044342},{"_id":"source/_posts/2023/jvm/787d871b-0d4c-403a-ae3f-cbc6ea587dc1.png","hash":"513ad7700fa9783cde27d59842375cb3530c41aa","modified":1722856044348},{"_id":"source/_posts/2023/jvm/9111c342-79fb-4def-aef6-d266daea6078.png","hash":"0197a97dc0443916f3c5878684be02142dc662be","modified":1722856044354},{"_id":"source/_posts/2023/jvm/a670f078-2260-4276-8db9-79112eb9e979.png","hash":"a366309db43e3f406c0b0c19a0878927f6393d14","modified":1722856044355},{"_id":"source/_posts/2023/jvm/d215e636-ea46-4b84-a861-4aff3dbdbf0e.png","hash":"222caaea6f4182e6f2cf625341d57c4ef50757fd","modified":1722856044360},{"_id":"source/_posts/2023/jvm/f0d5cf63-e51f-4309-b8ff-448f90ca78fb.png","hash":"467301f9b42b8054230b7a53a9c5c2386a2d3ab1","modified":1722856044366},{"_id":"source/_posts/2023/thread/44fc6f61-2e64-414e-be76-0486d270b52b.png","hash":"73031b5bab90a9f861e5c2048a06896e1c068d24","modified":1722856044371},{"_id":"source/_posts/2023/thread/81a4db1a-c8d1-47f7-a955-39db726f5173.png","hash":"385a28b5e0f34702a41dd2041a5369c7f4771ba1","modified":1722856044376},{"_id":"source/_posts/2023/thread/9372a527-1cf5-4699-9271-f9724c815f24.png","hash":"c36cde5b2b7444dec832d2d89216de12b18f337f","modified":1722856044377},{"_id":"source/_posts/2023/thread/b94de8b0-5933-49dc-b0ff-a29a03280074.png","hash":"3eb0f33baa51a9d471413bfa13e0be3273f5fd11","modified":1722856044378},{"_id":"source/_posts/2023/thread/d1df5ae9-03d4-4960-a460-86c4eb4f13d9.png","hash":"6e393cf40a3127c3b264b5c3b9f43bd57df1bc76","modified":1722856044380},{"_id":"source/_posts/2023/thread/d1f13ce8-f7cb-4cf1-b2aa-6e8d7204a459.png","hash":"074cbb6b221f5649703ccb248fa39eba78a01800","modified":1722856044380},{"_id":"source/_posts/2023/thread/d3f13fb8-e2e2-4692-8b27-2ca13a87ec1a.png","hash":"a0b67dcf2acae58a56fa219df0693d17b8c03e4c","modified":1722856044381},{"_id":"source/_posts/2023/thread/d9550ede-fad3-4675-8791-3a1237fab0de.png","hash":"a392ef2a1ec3f75da751cb47d742f8f6527c448e","modified":1722856044382},{"_id":"source/_posts/2023/thread/e1c2fc78-6f75-4049-8631-1e2bf400e92b.png","hash":"df1459dc58074f9d28da5b520628f0bcb0a36742","modified":1722856044382},{"_id":"source/_posts/2023/thread/image-20200806072602725.png","hash":"3f5236edb47f8fc9c8ad7fc10a04fa7e327d6468","modified":1722856044385},{"_id":"source/_posts/2023/thread/image-20200806080218070.png","hash":"a74b746c12ca67031ce2b19da9a1407a85425fb5","modified":1722856044386},{"_id":"source/_posts/2023/thread/image-20200806080338819.png","hash":"6300a2c7f65c40beeb2bbc3084401fbf87e4ddc1","modified":1722856044387},{"_id":"source/_posts/2023/thread/image-20200806080425078.png","hash":"9d4080b53d58141084834173b5b9c02be9e47a4e","modified":1722856044387},{"_id":"source/_posts/2023/thread/image-20200806081309415.png","hash":"29bd021c0d14e30a0d4133a9f73ad0b03d0dc048","modified":1722856044388},{"_id":"source/_posts/2023/thread/image-20200806093649652.png","hash":"de3e5ea75f2909cb9e9bb6d5628cadc22f82512c","modified":1722856044390},{"_id":"source/_posts/2023/thread/image-20200806113212737.png","hash":"c4d5e47497e3d4cefc40a6f4f14350d5a7e8456e","modified":1722856044391},{"_id":"source/_posts/2023/thread/image-20200806113017975.png","hash":"81c550995075bf03c29518f6f31e64ac5e6c3773","modified":1722856044391},{"_id":"source/_posts/2023/thread/image-20200806113622053.png","hash":"83e346987a6ccba16456e8d84c60b43f9b238390","modified":1722856044392},{"_id":"source/_posts/2023/thread/image-20200806115634318.png","hash":"c7d9fbd613fe6f3738a3a75011fa2e93a48477a4","modified":1722856044393},{"_id":"source/_posts/2023/thread/image-20200819065820151.png","hash":"5b7a2c8899ed1fabcc811e64067ca27776dc2034","modified":1722856044395},{"_id":"source/_posts/2023/thread/image-20200819065835524.png","hash":"5b7a2c8899ed1fabcc811e64067ca27776dc2034","modified":1722856044395},{"_id":"source/_posts/2023/thread/image-20200819072452480.png","hash":"1b4721d50279ed36c46bc90adbce4868de21b27d","modified":1722856044397},{"_id":"source/_posts/2023/thread.md","hash":"0dd5209d6b3d9f97a27bdd53c16d4a489ec0fcd7","modified":1722856044367},{"_id":"source/_posts/2023/Hadoop/image-20200820213620752.png","hash":"6ff3914cb67d22fb3ee7c65b88bb912172a084a1","modified":1722856044315},{"_id":"source/_posts/2023/Hadoop/image-20200822140954237.png","hash":"562b657e326eda688f3cf149f31f5e255382d2a3","modified":1722856044326},{"_id":"source/_posts/2023/Hadoop/image-20200822141013068.png","hash":"7f550e064b8f379cdcd3c2b5d6c873922eef06e5","modified":1722856044327},{"_id":"source/_posts/2023/Hadoop/image-20200822141028970.png","hash":"462eda7f4bd379fd6302f7eea768a0c60de16e0d","modified":1722856044328},{"_id":"source/_posts/2023/jvm/3cd7e3a5-2b1d-4eb6-83c9-fedc27a2bfc1.png","hash":"19510a86dea995a003b196e007d9702c2564bf3f","modified":1722856044341},{"_id":"source/_posts/2023/jvm/6bcb9fd5-1105-4a75-b6c5-55dc08af5c50.png","hash":"a8c602dd69cc9de4cb07a635675414a758f0fabf","modified":1722856044346},{"_id":"source/_posts/2023/jvm/5066a220-0f28-4b94-8934-f54c722697a9.png","hash":"758887c04eb0024e99e93a74a496f69c65eeb878","modified":1722856044344},{"_id":"source/_posts/2023/jvm/bece6bf1-f9a8-475d-9911-6293e225d84e.png","hash":"7046744e505c65a8229917fde6669c77182ab9e0","modified":1722856044356},{"_id":"source/_posts/2023/jvm/d5649d47-ed1b-4797-8a8f-73634873cd9d.png","hash":"7bfd7ed3686995e7069a29538ce44bc00c1a4ded","modified":1722856044362},{"_id":"source/_posts/2023/jvm/db1f5266-c920-4379-a82d-f0dadbe1a1c3.png","hash":"8b64187079fbcd3c1faf9c0e032d0ac7521b824b","modified":1722856044364},{"_id":"source/_posts/2023/thread/0827c261-3195-4bdc-9b78-e0c664037749.png","hash":"13bb80c66b9f0e57e295ec8f93fe53b503846052","modified":1722856044368},{"_id":"source/_posts/2023/thread/e5b813b7-361c-42ec-9326-53b01a2872da.png","hash":"bac3d9f8a5a6afddde782b86053a069206eb4829","modified":1722856044383},{"_id":"source/_posts/2023/Hadoop/image-20200822111645219.png","hash":"79c46499ae6ee259da2b962e462770b008deaae3","modified":1722856044323},{"_id":"source/_posts/2023/Hadoop/image-20200822140728454.png","hash":"0dafa732c02dd1164da799d79fd8ed4f10214708","modified":1722856044325},{"_id":"source/_posts/2023/Hadoop/image-20200823180537869.png","hash":"4cdaedbdaafd3733e2918c8eff9aa03e051ae3f1","modified":1722856044329},{"_id":"source/_posts/2023/localdate-springboot/kotlin.jpg","hash":"82ab99e263d90ddcfc6ba2163268633b41a7335f","modified":1722861455000},{"_id":"source/_posts/2023/jvm/8b2d9ee5-a0da-460c-9296-71cd9bae71cb.png","hash":"f40d032d1cf2d1df63c498d630fbbb9515a1963c","modified":1722856044349},{"_id":"source/_posts/2023/jvm/5fb46273-081b-4271-b94c-e2ba6eea5f69.png","hash":"595d174b456d02addd4fd3912f1ed87889873558","modified":1722856044345},{"_id":"source/_posts/2023/jvm/95c89389-d9e7-42e1-9d80-4886d458a48b.png","hash":"be467b0262b096ab0709740edc8da3620e26a6aa","modified":1722856044355},{"_id":"source/_posts/2023/jvm/ecac62a6-7c65-4df3-ba5e-19c0630fb78f.png","hash":"81df4f3d9d06cadc1cbd1910aa81d378af1adecb","modified":1722856044366},{"_id":"source/_posts/2023/thread/2ed065be-3fb7-4e67-b04e-b8e08980405d.png","hash":"28b7ee69c494328e2f47fd16cf1acedf73dcfcce","modified":1722856044370},{"_id":"source/_posts/2023/thread/453affe8-17db-40b3-940f-162e7597336e.png","hash":"426fcd121eebccfbf2a84af93e2bb87d9cc9a987","modified":1722856044372},{"_id":"source/_posts/2023/Hadoop/image-20200822094801817.png","hash":"ac576617320853778bd3f6e0686bb6277ab2cc1f","modified":1722856044322},{"_id":"source/_posts/2023/jvm/745b992d-fcff-46df-8a33-150b65bf47ca.png","hash":"aa447e7b6dbad59928fcd1ffeb81fabf850103d3","modified":1722856044348},{"_id":"source/_posts/2023/jvm/d404438c-1def-4366-90a5-3f304dd1ddf2.png","hash":"e286e478e23e9e0cf9f15b08020eb24b43f993e3","modified":1722856044361},{"_id":"source/_posts/2023/Hadoop/image-20200829223326519.png","hash":"77bbdcca8b8e37e8659554c328b95cda2b971dd5","modified":1722856044332},{"_id":"source/_posts/2023/jvm/3e60331e-2742-4047-8383-e107945f85c4.png","hash":"8633fd7a38783439a2ea55a9028e85e1bc3161c6","modified":1722856044343},{"_id":"source/_posts/2023/jvm/bedb0d3f-90d8-4867-84c2-cea52a58412f.png","hash":"d6bf5d0b19c2e9f663bb89cd35a85fc7b729b8be","modified":1722856044357},{"_id":"source/_posts/2023/jvm/d9b58c91-421c-4afe-b359-2cde68c12eca.png","hash":"1d8c8d048b3f884c3a06196a8e3e81274a05ee38","modified":1722856044363},{"_id":"source/_posts/2023/Hadoop/image-20200820224123902.png","hash":"953caf8c2c1e8ae0899417fb41646e92b9e0b9ff","modified":1722856044318},{"_id":"source/_posts/2023/jvm/90434413-5431-408e-878f-3b76d5118d64.png","hash":"7633ac5e2e68639b7df78eee4f000feb2db62131","modified":1722856044353},{"_id":"source/_posts/2023/jvm/befee5fe-233e-4ca1-8a63-1b8908311845.png","hash":"6b76efc79c2d99fd57e08657e2b7015ae85bcb83","modified":1722856044359},{"_id":"public/about/index.html","hash":"aca0270ffcec1836663c306bdb61e5d61bad1909","modified":1723862611275},{"_id":"public/ceph/index.html","hash":"ad33791aeb18fe6a6e3cb8ba024c4f074904d312","modified":1723862611275},{"_id":"public/message-board/index.html","hash":"dd5a08568ed819c2fe3865ac93c396e25962b61d","modified":1723862611275},{"_id":"public/post/2024/jsch/jsch.html","hash":"cd86d0cda954297b4e169220f9642bbb7a7b9a30","modified":1723862611275},{"_id":"public/links/index.html","hash":"06b86dd6d76cb62d285252aa837f691e14201f04","modified":1723862611275},{"_id":"public/post/2023/kotlin-springboot.html","hash":"e784b9c21592b05866ae7d6fd8be20ca715ae1dd","modified":1723862611275},{"_id":"public/post/2023/localdate-springboot.html","hash":"3d3e7124ce6a55b12c6d4e416cd55765fef298ae","modified":1723862611275},{"_id":"public/post/2023/https.html","hash":"f9c98eeac69b6e17f7dea4857cc6cefa8912199c","modified":1723862611275},{"_id":"public/post/2023/jvm.html","hash":"a76dab2bc5278799168264ab692aff6d1eedd72c","modified":1723862611275},{"_id":"public/post/2023/thread-pool.html","hash":"c2c652ace4a8278a32b5f80671b14880f08413df","modified":1723862611275},{"_id":"public/post/2023/thread.html","hash":"09724c21cfc0c942fe5e277656a2fbeb1be29919","modified":1723862611275},{"_id":"public/post/2023/Hadoop.html","hash":"b942e2567c446dec91b8bc1da4148dffe8845d58","modified":1723862611275},{"_id":"public/post/2023/docker-springboot-config.html","hash":"5f80695b45446ed17997a26af23cc423d1a1e939","modified":1723862611275},{"_id":"public/post/2023/docker.html","hash":"b8bd50fa80006877048cf79611e3802ad117a520","modified":1723862611275},{"_id":"public/post/2023/dockerfile.html","hash":"dc986c42c3c0d6de0c5c583d1660634308675c5b","modified":1723862611275},{"_id":"public/post/2023/gitlab-ci-springboot.html","hash":"e8b563e20334822d7391c2feb6adbd0a1913add6","modified":1723862611275},{"_id":"public/post/2023/gitlab.html","hash":"fef75ca7d448222bf862e3a889831e44bcfb982f","modified":1723862611275},{"_id":"public/post/2023/docker-springboot.html","hash":"6f3256d52f8f9b0227d62dd5a984e98dc404ffbe","modified":1723862611275},{"_id":"public/archives/index.html","hash":"fc2dc69e590ccb6d7a3279e403fb6135e9f461cb","modified":1723862611275},{"_id":"public/archives/page/2/index.html","hash":"c0cdaa94f134bb5fa9af83fcde6d074bfe26f279","modified":1723862611275},{"_id":"public/archives/2021/index.html","hash":"fa255eff933d1804f782642d8a8ab240ce990b5e","modified":1723862611275},{"_id":"public/archives/2021/12/index.html","hash":"90587bb3d5bab19627e9982fd8560d983bc2db1e","modified":1723862611275},{"_id":"public/archives/2023/index.html","hash":"1c7c9b2ce6a93219d61de4b67ed01b0ff7cb2d41","modified":1723862611275},{"_id":"public/archives/2023/02/index.html","hash":"e2ace72b8b0964e498bfcca6887988af970f39d7","modified":1723862611275},{"_id":"public/archives/2023/03/index.html","hash":"7fce00d7443d43dd8afbb381b44ab7fae801182d","modified":1723862611275},{"_id":"public/archives/2023/05/index.html","hash":"ef53be4c95f5e81785ede018d379a2ef69dfe130","modified":1723862611275},{"_id":"public/archives/2023/06/index.html","hash":"d08a2efce7121811d08dce7303ba16c72a3170e8","modified":1723862611275},{"_id":"public/archives/2024/index.html","hash":"bccef822cd8690702cf8c80627e3a7e2ec8e1d08","modified":1723862611275},{"_id":"public/archives/2024/08/index.html","hash":"00ade06d1ace0824d461a20d8acb8c66439008ab","modified":1723862611275},{"_id":"public/categories/Hadoop/index.html","hash":"c694d10d3a7184c34485cdc8e0216042dc519f11","modified":1723862611275},{"_id":"public/categories/JAVA/index.html","hash":"066023cb95876f28b4031127729ec299a3fa1cb8","modified":1723862611275},{"_id":"public/categories/Docker/index.html","hash":"8d5de6ded15e5bce0a1b0e802f30f0e4b6fe5d1a","modified":1723862611275},{"_id":"public/categories/JAVA/Docker/index.html","hash":"2a1c83ed9085bac7a997ec156780762d411e6936","modified":1723862611275},{"_id":"public/categories/SpringBoot/index.html","hash":"2eebaf6310112782ee601e3f781f681bba1e9e65","modified":1723862611275},{"_id":"public/index.html","hash":"c726bee101322e0c88f3d8abd785622030ec594b","modified":1723862611275},{"_id":"public/page/2/index.html","hash":"ae01065c7bf19c6b7528d2db759ff4ead2200dc2","modified":1723862611275},{"_id":"public/tags/Hadoop/index.html","hash":"0984b4bc6fd8525c61fcdc13262b500fe5c2489b","modified":1723862611275},{"_id":"public/tags/springboot/index.html","hash":"78994350e2924d23c339dcc54f873a62eef839fb","modified":1723862611275},{"_id":"public/tags/docker/index.html","hash":"7972f8807f6ddcb90bc2a0d35da3724d0bbeec52","modified":1723862611275},{"_id":"public/tags/jvm/index.html","hash":"06caa25071bb3e53a8e95c78f892d3318e8039d7","modified":1723862611275},{"_id":"public/tags/ssh/index.html","hash":"e8b06be89ba444226c25b4469e305016ce35aa4b","modified":1723862611275},{"_id":"public/tags/java/index.html","hash":"6317c7094bb61bcdcb383296b8f96e80f3d37b24","modified":1723862611275},{"_id":"public/tags/thread/index.html","hash":"f20d3e4abb248ddc23992659b4cc57966b2d5f97","modified":1723862611275},{"_id":"public/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1723862611275},{"_id":"public/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1723862611275},{"_id":"public/images/docker/img.png","hash":"b143488994153ef0d6f7e54496b1032224d384a4","modified":1723862611275},{"_id":"public/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822090658863.png","hash":"d7fc3ffd118a9de3fd8ef2b5b6d558dc867902d5","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822091216510.png","hash":"b8785e417cf113d5a83e4d71dc3226639d3f5431","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822091809558.png","hash":"7432d46f5c12e36dbd633f4b47c82c20f36c35e6","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822090905199.png","hash":"25e8cd21aa5779e9f47fa546c247e867a84015e0","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822092048172.png","hash":"a67e04af7dbe1dc1778501f3220965b6f43b3eba","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822093255847.png","hash":"eacb1a96d01d3ae079893859cde70b1f2989a978","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822102024933.png","hash":"d7124e486338ff4331137f38b1b4c1c6979f0a56","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822100056038.png","hash":"141d5c19c489fea0a62003641aefca5d74eb5e31","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822102108817.png","hash":"03b11682abdcc18022e0fcb120d428f1f0f7148b","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200827081213048.png","hash":"1cbc3780302c1f4d525e55c446e7221db10221c6","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200827081247672.png","hash":"aa0635adbf8548c108d58ef07adefaa21f929f7b","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200830083752748.png","hash":"4d48d443e2fbf67f237bc3e91dd03d448101b5b1","modified":1723862611275},{"_id":"public/post/2023/docker/img.png","hash":"b143488994153ef0d6f7e54496b1032224d384a4","modified":1723862611275},{"_id":"public/post/2023/gitlab-ci-springboot/img_10.png","hash":"995ab2fb28aeb05e4760c4e141dc10729c842961","modified":1723862611275},{"_id":"public/post/2023/gitlab-ci-springboot/img_11.png","hash":"f41f8ea13677c8c36bf2e497ef6d1f98de9287f7","modified":1723862611275},{"_id":"public/post/2023/gitlab-ci-springboot/img_8.png","hash":"a1a30dcd7dd81059add8dcb1c1b3c7583892cbb3","modified":1723862611275},{"_id":"public/post/2023/gitlab-ci-springboot/img_7.png","hash":"ffafc6509bc1a548005e8668d090bed46cee458d","modified":1723862611275},{"_id":"public/post/2023/gitlab-ci-springboot/img_9.png","hash":"32571f27b92a774d43d33cd6a32859ec58cac8ab","modified":1723862611275},{"_id":"public/post/2023/gitlab/img_0.png","hash":"d7f77d4af50b9c1ea9899716abf7d0c63617e28e","modified":1723862611275},{"_id":"public/post/2023/gitlab/img_1.png","hash":"96c624fe29a8788e745da8fa598815e09158a992","modified":1723862611275},{"_id":"public/post/2023/jvm/3bfa032a-2a4e-4f01-b03d-90c4c39df0aa.png","hash":"8e776b0b7ee3c45619f140503c9c27bdf20037ee","modified":1723862611275},{"_id":"public/post/2023/jvm/4f6873cb-c0f9-4955-8600-bf37e24f4fbf.png","hash":"dfffd7906b9a69d21cb644b15b5ddb3932ee65f4","modified":1723862611275},{"_id":"public/post/2023/jvm/5f12c1e3-2e47-4997-a887-b395b511490b.png","hash":"da1effd9381c2231ae7fc51fda2210f532aecae8","modified":1723862611275},{"_id":"public/post/2023/jvm/626353d2-1f73-46e9-858d-732ed7bee94a.png","hash":"856df1b182f85194738502a882aece1f48dfdaed","modified":1723862611275},{"_id":"public/post/2023/kotlin-springboot/kotlin.png","hash":"fe1dbb0685411cb1e07231201162d28f18a6f03c","modified":1723862611275},{"_id":"public/post/2024/jsch/jsch/ssh.jpg","hash":"3d3014147b2baceec1a624a2db4ea693124ffaa4","modified":1723862611275},{"_id":"public/post/2024/jsch/jsch/ssh.webp","hash":"e25c4c12bc0f742703bc4853b041af5141cfc8a6","modified":1723862611275},{"_id":"public/post/2023/thread-pool/e0733727-92bd-4438-a628-3b3989d8e838.png","hash":"c2291fdef94fd0aa6a714767358a290ea33eccc2","modified":1723862611275},{"_id":"public/post/2023/thread/210feb5c-150a-43c3-8b3d-440f53e343d1.png","hash":"316de16f4669bb9cd7933ac9052afec6640f33ef","modified":1723862611275},{"_id":"public/post/2023/thread/0e59c147-a499-4226-bf3b-d6f0a4cabd5a.png","hash":"663ac36db166b7f0f0be74799bf9f9e2badcc1f5","modified":1723862611275},{"_id":"public/post/2023/thread/3a071edf-6ded-487b-abbb-d016a9fe6864.png","hash":"07e81d464bfbed0cce4b25d8f75264b4365f455b","modified":1723862611275},{"_id":"public/post/2023/thread/2feee3db-6b39-4e1a-9098-1a5f966742f7.png","hash":"5bd0d306e3fa5201b97dbea2754c913cb02d16f8","modified":1723862611275},{"_id":"public/post/2023/thread/3ce55a24-aeb0-4055-9925-c69a63ec9053.png","hash":"6fee86ac4ba8fb76dac7b65467ba6282f69e781c","modified":1723862611275},{"_id":"public/post/2023/thread/4b22adcb-879c-493e-a6dc-7a50426a6db7.png","hash":"0ee5d65ef5f85aeca6ce4e45e96d8731d4f4cfb1","modified":1723862611275},{"_id":"public/post/2023/thread/51e456b2-69ca-4039-8ec3-137a74a3e57d.png","hash":"ee61890765721cbd674687298584e6094d6203b5","modified":1723862611275},{"_id":"public/post/2023/thread/4f22eeff-a017-46f6-bf49-5359e570fe22.png","hash":"f58a2c6ca682fc86a56d4e5c11d14c0092d7fbd5","modified":1723862611275},{"_id":"public/post/2023/thread/52ebada9-ad0c-45fc-9482-40b961c20bbf.png","hash":"c70ea807c2b5bc2c7c3e1ec5e7b2a5247ce05e59","modified":1723862611275},{"_id":"public/post/2023/thread/683dd209-d862-46f9-878f-b9e8f4c2db3b.png","hash":"b6e8d9ad8d6023695c28d85cc9984a8e3a311cd1","modified":1723862611275},{"_id":"public/post/2023/thread/5cce206b-f24c-4489-afda-57b5a3102172.png","hash":"b767fe80aa4b611bacf1bcd3f9fd43d3a30c9f5d","modified":1723862611275},{"_id":"public/post/2023/thread/6d0f8427-4068-4a15-a933-cd3f74e28dbf.png","hash":"2f093ea67352ffa5206724c6a0a74973bea851b8","modified":1723862611275},{"_id":"public/post/2023/thread/75442144-d101-4e7a-97ca-c833a2b827fe.png","hash":"7424b987b22a83d9b74a04cfeac3107ccd268592","modified":1723862611275},{"_id":"public/post/2023/thread/70691192-ef7e-43b6-b365-d139f036e188.png","hash":"f2a08244782535b2da540ced9432a97469feeb0b","modified":1723862611275},{"_id":"public/post/2023/thread/7d8e2e3b-8f62-4e97-86d1-d8ab88b83ca1.png","hash":"588d6599688192f7cd1bbc9a3b7660e3bb4fabb0","modified":1723862611275},{"_id":"public/post/2023/thread/7bf73e18-7259-45da-93c5-a4183062572e.png","hash":"71b171d00227e1db64ee9cc852edd95a4f42f8ac","modified":1723862611275},{"_id":"public/post/2023/thread/815e324a-777f-4b34-b590-acbb4c624cb0.png","hash":"b2cafbf904b30d436cff0f586b8cf7509a53fbe8","modified":1723862611275},{"_id":"public/post/2023/thread/86d6badd-f76b-4152-8044-bef85f333017.png","hash":"9738c63f3b469c594cda5cfc94c1647890a05940","modified":1723862611275},{"_id":"public/post/2023/thread/c2203c1e-3091-4832-8061-8ba8bc3b24d1.png","hash":"9f26f95685b8c6c38bb857cb27756a6f12e2edc6","modified":1723862611275},{"_id":"public/post/2023/thread/bc0f03b1-c84a-45af-879e-4bdc0f0ff35e.png","hash":"3cec796993b6ee3fadb1c4aac935527701226d0e","modified":1723862611275},{"_id":"public/post/2023/thread/cb65fed7-57dd-404b-b4f1-e365dbe83379.png","hash":"290852347a4d3d810007dc01b9db3bec494d1d9c","modified":1723862611275},{"_id":"public/post/2023/thread/ca324ec8-b1a0-419a-a962-640dae424e10.png","hash":"c42c3d3dcc1c8ca4d9ff81253d88b1b73dfd6360","modified":1723862611275},{"_id":"public/post/2023/thread/d05f71ef-bbbb-4b19-a804-6444a74de835.png","hash":"f7feac9d118a9ceeae453270fbe57f346405a776","modified":1723862611275},{"_id":"public/post/2023/thread/a6cd39b0-e6e9-4b6f-88ea-3cfb0d899b83.png","hash":"9ad36c024752065b597cc3dad8b05be6a023e531","modified":1723862611275},{"_id":"public/post/2023/thread/d37e0c1b-1e69-4360-937a-edf5296f47ce.png","hash":"2b111d57e4382379c3da9dfcc65b7fdb2737edaa","modified":1723862611275},{"_id":"public/post/2023/thread/f5e5190c-2ca0-4467-8618-c9084b18b26f.png","hash":"1a84944ce5afcf74a3a1bcc5afa2b4042167df6f","modified":1723862611275},{"_id":"public/post/2023/thread/f78c9ec4-6379-48de-b2e6-f529bb063540.png","hash":"028bb29d17c1c8eed636a0756db0690fa03ff83b","modified":1723862611275},{"_id":"public/post/2023/thread/ea4c56c3-75b1-48fa-a40e-dcb6dd63823f.png","hash":"551d3b922458221f252abe7f88ba3f5aed400408","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806070323056.png","hash":"6796a4feb0fc360f4c82e6290c77af0d33780b47","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806070304756.png","hash":"f9dfca825356fc1e2c30432b35d0648b9d549b50","modified":1723862611275},{"_id":"public/post/2023/thread/feed6992-8dff-450c-9010-e2f46caf6243.png","hash":"f6e1257845d5914ac68f56dc052dc39afbc82115","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806080136510.png","hash":"9103f2678ec0cefb33cb191e5009341d9d698eda","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806081215362.png","hash":"492631ff5318a7e8b9349f632d6529a868d93061","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806081339039.png","hash":"cffbdb84a9a9e35e010bfd44e2e34858af7d5637","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806093605366.png","hash":"694cfbe498d562957601afae761fd13dd40be691","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806081409317.png","hash":"ba278464bf35d6052fa89ae01d9974c4ddaf1884","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806112353892.png","hash":"b7dcaaad87ecfb99fc562e9ec042695b2d51a797","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200818213438504.png","hash":"f1c421e1781dcfba8098b39151285e6ab320cd64","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819064936628.png","hash":"a49e6013c091b78f269d1301ce98ef221282af35","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819065515918.png","hash":"582e986b0b79cbc6ed7365ca61e336eb595e0998","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819065601188.png","hash":"0640011d4ca03ca90746874dee5f40e4e32dd905","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819065708766.png","hash":"72b90495ef9382ebd6c505e6a5d6f36ad1e318ca","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819065931928.png","hash":"15aa55530c3c335c250ab871610b8df489c9d860","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819071006301.png","hash":"1f153e2698d1babc2be26e7fa9782c55cc4ef072","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819071139042.png","hash":"2a6dcba9c5f8e427624744e43b9ad722bbc49739","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819072504262.png","hash":"bbaee27959b4ef444eff941b385c266ab43b3699","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200822234416578.png","hash":"9ec2f0afd72eae56ce6d748bfa689ddc78e9d70e","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822091335115.png","hash":"e08813cdce7071540bff67fbb0cbd07af5bd85a7","modified":1723862611275},{"_id":"public/post/2023/gitlab-ci-springboot/img_12.png","hash":"6b2f4e69a0850b3bebbb59e9ad5b0a68cd76d4d0","modified":1723862611275},{"_id":"public/post/2023/gitlab-ci-springboot/img_5.png","hash":"aa538d95ed2d8361ab43f6b5d677264350503542","modified":1723862611275},{"_id":"public/post/2023/gitlab-ci-springboot/img_6.png","hash":"b968b33971b7dcbb31679803d1cd7c729eeb02e4","modified":1723862611275},{"_id":"public/post/2023/https/https.png","hash":"62ee9c6405db5bc8c20553be16706d684b2800ab","modified":1723862611275},{"_id":"public/post/2023/gitlab/img_2.png","hash":"7b0a07bc04b004d74d47754411a5825e0ab03062","modified":1723862611275},{"_id":"public/post/2023/gitlab/img_3.png","hash":"3a260c5afd1cebacc9cbb42b49dcc3a52399edf5","modified":1723862611275},{"_id":"public/post/2023/gitlab/img_4.png","hash":"6091a762b81a9854e08360e39d39b2de42b378e4","modified":1723862611275},{"_id":"public/post/2023/jvm/0c1c2fd0-acb6-4197-801f-a9ff12f5ced4.png","hash":"5d4398baa866a6b1bbfb9f1d9026d57bf52e87f7","modified":1723862611275},{"_id":"public/post/2023/jvm/3d67796c-0dc7-4f12-9af0-39b20fab7cbf.png","hash":"57e32b13dc4acddd9f89aa60af0df1d5c6a22684","modified":1723862611275},{"_id":"public/post/2023/jvm/787d871b-0d4c-403a-ae3f-cbc6ea587dc1.png","hash":"513ad7700fa9783cde27d59842375cb3530c41aa","modified":1723862611275},{"_id":"public/post/2023/jvm/9111c342-79fb-4def-aef6-d266daea6078.png","hash":"0197a97dc0443916f3c5878684be02142dc662be","modified":1723862611275},{"_id":"public/post/2023/jvm/a670f078-2260-4276-8db9-79112eb9e979.png","hash":"a366309db43e3f406c0b0c19a0878927f6393d14","modified":1723862611275},{"_id":"public/post/2023/jvm/d215e636-ea46-4b84-a861-4aff3dbdbf0e.png","hash":"222caaea6f4182e6f2cf625341d57c4ef50757fd","modified":1723862611275},{"_id":"public/post/2023/jvm/f0d5cf63-e51f-4309-b8ff-448f90ca78fb.png","hash":"467301f9b42b8054230b7a53a9c5c2386a2d3ab1","modified":1723862611275},{"_id":"public/post/2023/thread/44fc6f61-2e64-414e-be76-0486d270b52b.png","hash":"73031b5bab90a9f861e5c2048a06896e1c068d24","modified":1723862611275},{"_id":"public/post/2023/thread/81a4db1a-c8d1-47f7-a955-39db726f5173.png","hash":"385a28b5e0f34702a41dd2041a5369c7f4771ba1","modified":1723862611275},{"_id":"public/post/2023/thread/9372a527-1cf5-4699-9271-f9724c815f24.png","hash":"c36cde5b2b7444dec832d2d89216de12b18f337f","modified":1723862611275},{"_id":"public/post/2023/thread/b94de8b0-5933-49dc-b0ff-a29a03280074.png","hash":"3eb0f33baa51a9d471413bfa13e0be3273f5fd11","modified":1723862611275},{"_id":"public/post/2023/thread/d1df5ae9-03d4-4960-a460-86c4eb4f13d9.png","hash":"6e393cf40a3127c3b264b5c3b9f43bd57df1bc76","modified":1723862611275},{"_id":"public/post/2023/thread/d3f13fb8-e2e2-4692-8b27-2ca13a87ec1a.png","hash":"a0b67dcf2acae58a56fa219df0693d17b8c03e4c","modified":1723862611275},{"_id":"public/post/2023/thread/d9550ede-fad3-4675-8791-3a1237fab0de.png","hash":"a392ef2a1ec3f75da751cb47d742f8f6527c448e","modified":1723862611275},{"_id":"public/post/2023/thread/d1f13ce8-f7cb-4cf1-b2aa-6e8d7204a459.png","hash":"074cbb6b221f5649703ccb248fa39eba78a01800","modified":1723862611275},{"_id":"public/post/2023/thread/e1c2fc78-6f75-4049-8631-1e2bf400e92b.png","hash":"df1459dc58074f9d28da5b520628f0bcb0a36742","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806072602725.png","hash":"3f5236edb47f8fc9c8ad7fc10a04fa7e327d6468","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806080218070.png","hash":"a74b746c12ca67031ce2b19da9a1407a85425fb5","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806080338819.png","hash":"6300a2c7f65c40beeb2bbc3084401fbf87e4ddc1","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806080425078.png","hash":"9d4080b53d58141084834173b5b9c02be9e47a4e","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806113017975.png","hash":"81c550995075bf03c29518f6f31e64ac5e6c3773","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806081309415.png","hash":"29bd021c0d14e30a0d4133a9f73ad0b03d0dc048","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806113212737.png","hash":"c4d5e47497e3d4cefc40a6f4f14350d5a7e8456e","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806113622053.png","hash":"83e346987a6ccba16456e8d84c60b43f9b238390","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806115634318.png","hash":"c7d9fbd613fe6f3738a3a75011fa2e93a48477a4","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200806093649652.png","hash":"de3e5ea75f2909cb9e9bb6d5628cadc22f82512c","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819065835524.png","hash":"5b7a2c8899ed1fabcc811e64067ca27776dc2034","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819065820151.png","hash":"5b7a2c8899ed1fabcc811e64067ca27776dc2034","modified":1723862611275},{"_id":"public/post/2023/thread/image-20200819072452480.png","hash":"1b4721d50279ed36c46bc90adbce4868de21b27d","modified":1723862611275},{"_id":"public/css/index.css","hash":"aec51d3ddd5cf94e4fe4771750edf500be15d523","modified":1723862611275},{"_id":"public/css/var.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1723862611275},{"_id":"public/js/main.js","hash":"0dac585446445e0c419b86eec5580bc9b0657dc6","modified":1723862611275},{"_id":"public/js/tw_cn.js","hash":"f8d2e3f31468991a7f5171cbfdb157dfb86d3372","modified":1723862611275},{"_id":"public/js/utils.js","hash":"8e6b48d294e7aeaba8ff6348c43b2271cf865547","modified":1723862611275},{"_id":"public/js/search/local-search.js","hash":"e1f60ebac53a3f596fd0a4769b4f9275c48c6542","modified":1723862611275},{"_id":"public/js/search/algolia.js","hash":"108988d046da9a4716148df43b3975217c8ceaae","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200820213620752.png","hash":"6ff3914cb67d22fb3ee7c65b88bb912172a084a1","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822140728454.png","hash":"0dafa732c02dd1164da799d79fd8ed4f10214708","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822111645219.png","hash":"79c46499ae6ee259da2b962e462770b008deaae3","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822140954237.png","hash":"562b657e326eda688f3cf149f31f5e255382d2a3","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822141013068.png","hash":"7f550e064b8f379cdcd3c2b5d6c873922eef06e5","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822141028970.png","hash":"462eda7f4bd379fd6302f7eea768a0c60de16e0d","modified":1723862611275},{"_id":"public/post/2023/jvm/3cd7e3a5-2b1d-4eb6-83c9-fedc27a2bfc1.png","hash":"19510a86dea995a003b196e007d9702c2564bf3f","modified":1723862611275},{"_id":"public/post/2023/jvm/5066a220-0f28-4b94-8934-f54c722697a9.png","hash":"758887c04eb0024e99e93a74a496f69c65eeb878","modified":1723862611275},{"_id":"public/post/2023/jvm/6bcb9fd5-1105-4a75-b6c5-55dc08af5c50.png","hash":"a8c602dd69cc9de4cb07a635675414a758f0fabf","modified":1723862611275},{"_id":"public/post/2023/jvm/bece6bf1-f9a8-475d-9911-6293e225d84e.png","hash":"7046744e505c65a8229917fde6669c77182ab9e0","modified":1723862611275},{"_id":"public/post/2023/jvm/d5649d47-ed1b-4797-8a8f-73634873cd9d.png","hash":"7bfd7ed3686995e7069a29538ce44bc00c1a4ded","modified":1723862611275},{"_id":"public/post/2023/jvm/db1f5266-c920-4379-a82d-f0dadbe1a1c3.png","hash":"8b64187079fbcd3c1faf9c0e032d0ac7521b824b","modified":1723862611275},{"_id":"public/post/2023/thread/0827c261-3195-4bdc-9b78-e0c664037749.png","hash":"13bb80c66b9f0e57e295ec8f93fe53b503846052","modified":1723862611275},{"_id":"public/post/2023/thread/e5b813b7-361c-42ec-9326-53b01a2872da.png","hash":"bac3d9f8a5a6afddde782b86053a069206eb4829","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200823180537869.png","hash":"4cdaedbdaafd3733e2918c8eff9aa03e051ae3f1","modified":1723862611275},{"_id":"public/post/2023/jvm/5fb46273-081b-4271-b94c-e2ba6eea5f69.png","hash":"595d174b456d02addd4fd3912f1ed87889873558","modified":1723862611275},{"_id":"public/post/2023/jvm/8b2d9ee5-a0da-460c-9296-71cd9bae71cb.png","hash":"f40d032d1cf2d1df63c498d630fbbb9515a1963c","modified":1723862611275},{"_id":"public/post/2023/localdate-springboot/kotlin.jpg","hash":"82ab99e263d90ddcfc6ba2163268633b41a7335f","modified":1723862611275},{"_id":"public/post/2023/jvm/95c89389-d9e7-42e1-9d80-4886d458a48b.png","hash":"be467b0262b096ab0709740edc8da3620e26a6aa","modified":1723862611275},{"_id":"public/post/2023/jvm/ecac62a6-7c65-4df3-ba5e-19c0630fb78f.png","hash":"81df4f3d9d06cadc1cbd1910aa81d378af1adecb","modified":1723862611275},{"_id":"public/post/2023/thread/2ed065be-3fb7-4e67-b04e-b8e08980405d.png","hash":"28b7ee69c494328e2f47fd16cf1acedf73dcfcce","modified":1723862611275},{"_id":"public/post/2023/thread/453affe8-17db-40b3-940f-162e7597336e.png","hash":"426fcd121eebccfbf2a84af93e2bb87d9cc9a987","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200822094801817.png","hash":"ac576617320853778bd3f6e0686bb6277ab2cc1f","modified":1723862611275},{"_id":"public/post/2023/jvm/745b992d-fcff-46df-8a33-150b65bf47ca.png","hash":"aa447e7b6dbad59928fcd1ffeb81fabf850103d3","modified":1723862611275},{"_id":"public/post/2023/jvm/d404438c-1def-4366-90a5-3f304dd1ddf2.png","hash":"e286e478e23e9e0cf9f15b08020eb24b43f993e3","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200829223326519.png","hash":"77bbdcca8b8e37e8659554c328b95cda2b971dd5","modified":1723862611275},{"_id":"public/post/2023/jvm/3e60331e-2742-4047-8383-e107945f85c4.png","hash":"8633fd7a38783439a2ea55a9028e85e1bc3161c6","modified":1723862611275},{"_id":"public/post/2023/jvm/bedb0d3f-90d8-4867-84c2-cea52a58412f.png","hash":"d6bf5d0b19c2e9f663bb89cd35a85fc7b729b8be","modified":1723862611275},{"_id":"public/post/2023/jvm/d9b58c91-421c-4afe-b359-2cde68c12eca.png","hash":"1d8c8d048b3f884c3a06196a8e3e81274a05ee38","modified":1723862611275},{"_id":"public/post/2023/Hadoop/image-20200820224123902.png","hash":"953caf8c2c1e8ae0899417fb41646e92b9e0b9ff","modified":1723862611275},{"_id":"public/post/2023/jvm/90434413-5431-408e-878f-3b76d5118d64.png","hash":"7633ac5e2e68639b7df78eee4f000feb2db62131","modified":1723862611275},{"_id":"public/post/2023/jvm/befee5fe-233e-4ca1-8a63-1b8908311845.png","hash":"6b76efc79c2d99fd57e08657e2b7015ae85bcb83","modified":1723862611275}],"Category":[{"name":"Hadoop","_id":"clzxjaiuv0004vaiba5fx83ik"},{"name":"JAVA","_id":"clzxjaiv1000bvaibahp9hizc"},{"name":"Docker","_id":"clzxjaiv3000hvaiber0g1zfc"},{"name":"Docker","parent":"clzxjaiv1000bvaibahp9hizc","_id":"clzxjaivb000xvaib2xjh13b3"},{"name":"SpringBoot","_id":"clzxjaivc0014vaib8e5adj6d"}],"Data":[],"Page":[{"title":"about","date":"2024-05-28T11:18:09.000Z","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2024-05-28 19:18:09\n---\n","updated":"2024-08-05T11:07:24.398Z","path":"about/index.html","comments":1,"layout":"page","_id":"clzxjaium0000vaib9jltbw57","content":"","cover":false,"excerpt":"","more":""},{"title":"ceph","date":"2024-08-17T01:11:22.000Z","_content":"\n# Ceph","source":"ceph/index.md","raw":"---\ntitle: ceph\ndate: 2024-08-17 09:11:22\n---\n\n# Ceph","updated":"2024-08-17T01:43:19.731Z","path":"ceph/index.html","comments":1,"layout":"page","_id":"clzxjaiut0002vaib064t3ncy","content":"<h1 id=\"Ceph\"><a href=\"#Ceph\" class=\"headerlink\" title=\"Ceph\"></a>Ceph</h1>","cover":false,"excerpt":"","more":"<h1 id=\"Ceph\"><a href=\"#Ceph\" class=\"headerlink\" title=\"Ceph\"></a>Ceph</h1>"},{"title":"message-board","date":"2024-05-28T12:24:44.000Z","_content":"\n# ","source":"message-board/index.md","raw":"---\ntitle: message-board\ndate: 2024-05-28 20:24:44\n---\n\n# ","updated":"2024-08-05T11:07:24.398Z","path":"message-board/index.html","comments":1,"layout":"page","_id":"clzxjaiux0006vaib9jb79nhn","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>","cover":false,"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>"},{"title":"friends","date":"2023-08-06T09:19:32.000Z","type":"friends","categoryMode":true,"data":[{"nick":"","avatar":"https://res.cloudinary.com/tridiamond/image/upload/v1625037705/ObsidianestLogo-hex_hecqbw.png","description":"Think like an artist, develop like an artisan.","link":"https://tridiamond.tech/","label":"links-badge-vip"}],"_content":"","source":"links/index.md","raw":"---\ntitle: friends\ndate: 2023-08-06 17:19:32\ntype: friends\ncategoryMode: true\ndata:\n  - nick: \n    avatar: https://res.cloudinary.com/tridiamond/image/upload/v1625037705/ObsidianestLogo-hex_hecqbw.png\n    description: Think like an artist, develop like an artisan.\n    link: https://tridiamond.tech/\n    label: links-badge-vip\n---","updated":"2024-08-05T11:07:24.398Z","path":"links/index.html","comments":1,"layout":"page","_id":"clzxjaiuz0008vaibejzof3lz","content":"","cover":false,"excerpt":"","more":""}],"Post":[{"title":"Hadoop","date":"2023-02-20T16:00:00.000Z","_content":"\n## Hadoop\n\n1. hadoopAoache \n2. \n3. HadoopHadoop\n\n## Hadoop\n\n### Lucene\n\n### \n\n#### GFS-->HDFS\n\n#### Map-Reduce-->MR\n\n#### BigTable-->HBase\n\n\n\n## Hadoop\n\n### Apache\n\n\n\n### Cloudera\n\n\n\n### Hortonworks\n\n\n\n## Hadoop4\n\n1. HadoopHadoop\n2. \n3. Mao-Reduce Hadoop\n4. \n\n## Hadoop\n\n###  1.x 2.x\n\n![image-20200820213620752](image-20200820213620752.png)\n\n\n\n### HDFS\n\n#### 1.NameNode (nn)\n\nDataNode \n\n#### 2.DataNode (dn)\n\n\n\n#### 3.Secondary NameNode (2nn)\n\nHDFSHDFS\n\n\n\n### YARN \n\n#### ResourceManage(RM)\n\n- \n- NodeManage\n- ApplicationMaster\n- \n\n#### NodeManage(NM)\n\n- \n- ResourceManage\n- ApplicationMaster \n\n#### ApplicationMaster(AM)\n\n- \n- \n- \n\n#### Container\n\n- ContainerYARNCPU,\n\n### MapReduce\n\nMapReduce map  Reduce\n\n1. Map \n2. ReduceMap\n\n \n\n## \n\n![image-20200820224123902](image-20200820224123902.png)\n\n\n\n## \n\n### 1.\n\n### 2.JDK\n\n### 3.Hadoop\n\n- \n\n- \n\n   `/etc/profile`\n\n  ``` bash\n  export HADOOP_HOME=/usr/local/hadoop-3.2.1\n  export PATH=$PATH:$HADOOP_HOME/bin\n  export PATH=$PATH:$HADOOP_HOME/sbin\n  ``` \n\n  \n\n  ``` bash\n  $ source /ect/profile\n  ``` \n\n### 4.Hadoop\n\n- **bin**\n\n  HadoopHDFS,YARN\n\n- **etc** \n\n  Hadoop\n\n- **lib**\n\n  Hadoop\n\n- **sbin**\n\n  Hadoop\n\n- **share**\n\n  Hadoopjar\n\n### 5.Hadoop\n\nHadoophttps://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html\n\n## Hadoop\n\nHadoop\n\n\n\n\n\n### \n\n#### Grep\n\n1.hadoop-3.2.1input\n\n``` bash\n$ mkdir input\n``` \n\n2.Hadoopxmlinput\n\n``` bash\n$ cp  etc/hadoop/*.xml  input\n``` \n\n3.shareMapReduce\n\n``` bash\n$ bin/hadoop\tjar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar grep input  output  'dfs[a-z.]+'\n``` \n\n4.\n\n``` bash\ncat  output/*\n``` \n\n#### WordCount\n\n1.hadoop-3.2.1wcinput\n\n``` bash\nmkdir wcinput\n``` \n\n2.wcinputwc.input\n\n``` bash\n$ cd wcinput\n\n$ touchwc.input\n``` \n\n3.wc.input\n\n``` bash\n$ vim  wc.input\n``` \n\n\n\n``` \nhadoopyarn\nhadoopmapreduce\natguigu\natguigu\n``` \n\nwq\n\n4.Hadoop\n\n5.\n\n``` bash\n$ hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount wcinput wcoutput\n``` \n\n6.\n\n``` bash\n$ cat wcoutput /part-r-00000\n``` \n\n``` \natguigu2\nhadoop2\nmapreduce1\nyarn1\n``` \n\n\n\n### \n\n#### HDFSMapReduce\n\n##### 1.\n\n1\n2\n3WordCount\n\n##### 2.\n\n###### 1\n\nHadoopetc\n\n``` bash\n$ cd ./etc\n``` \n\n- hadoop-env.sh\n\n  LinuxJDK\n\n  ``` bash\n  $ echo $JAVA_HOME\n  ``` \n\n  ``` bash\n  /usr/local/jdk1.8.0_121\n  ``` \n\n  JAVA_HOME\n\n  ``` bash\n  export JAVA_HOME=/usr/local/jdk1.8.0_121\n  ``` \n\n- core-site.xml\n\n  ``` xml\n  <!--HDFSNameNode-->\n  <property>\n  \t<name>fs.defaultFS</name>\n  \t<value>hdfs://localhost:9000</value>\n  </property>\n  <!--Hadoop-->\n  <property>\n  \t<name>hadoop.tmp.dir</name>\n  \t<value>/usr/local/hadoop-3.2.1/data/tmp</value>\n  </property>\n  ``` \n\n- hdfs-site.xml\n\n  ``` xml\n  <!--HDFS-->\n  <property>\n  \t<name>dfs.replication</name>\n  \t<value>1</value>\n  </property>\n  ``` \n\n###### 2SSH\n\n- SSH\n\n  ``` bash\n   $ ssh  localhost\n  ``` \n\n  SSH\n\n- \n\n  ``` bash\n  $ ssh-keygen -t rsa -P''-f/ .ssh / id_rsa \n  $ cat/ .ssh / id_rsa.pub >>/ .ssh / authorized_keys \n  $ chmod 0600/ .ssh / authorized_keys\n  ``` \n\n###### 3\n\n- \n\n  ``` bash\n  $ bin/hdfs namenode -format\n  ``` \n\n- NameNodeDataNode\n\n  ``` bash\n  $ ./sbin/start-dfs.sh\n  ``` \n\n- \n\n  ``` bash\n  [root@iZ2zednzb8iugz3kgudq9bZ hadoop-3.2.1]# ./sbin/stop-dfs.sh\n  Stopping namenodes on [localhost]\n  ERROR: Attempting to operate on hdfs namenode as root\n  ERROR: but there is no HDFS_NAMENODE_USER defined. Aborting operation.\n  Stopping datanodes\n  ERROR: Attempting to operate on hdfs datanode as root\n  ERROR: but there is no HDFS_DATANODE_USER defined. Aborting operation.\n  Stopping secondary namenodes [iZ2zednzb8iugz3kgudq9bZ]\n  ERROR: Attempting to operate on hdfs secondarynamenode as root\n  ERROR: but there is no HDFS_SECONDARYNAMENODE_USER defined. Aborting operation.\n  ``` \n\n   `hadoop-env.sh`\n\n  ``` bash\n  HDFS_DATANODE_USER=root  \n  HDFS_NAMENODE_USER=root  \n  HDFS_SECONDARYNAMENODE_USER=root \n  ``` \n\n- WebNameNode\n\n  ``` http\n  http://localhost:9870/\n  ``` \n\n- MapReduceHDFS\n\n  ``` bash\n  $ bin/hdfs dfs -mkdir /user/root\n  $ bin/hdfs dfs -mkdir /user/<>\n  ``` \n\n  - \n\n  ``` bash\n  $ bin/hdfs dfs -mkdir -p  /user/wry\n  ``` \n\n  ![image-20200822090658863](image-20200822090658863.png)\n\n  - \n\n  ``` bash\n  $ bin/hdfs dfs -ls -R /\n\t``` \n\n  ![image-20200822090905199](image-20200822090905199.png)\n  \n- \n\n  ``` bash\n  $ bin/hdfs dfs -mkdir -p /user/wry/input\n  $ bin/hdfs dfs -put etc/hadoop/*.xml /user/wry/input\n  ``` \n\n  ![image-20200822091216510](image-20200822091216510.png)\n\n  ![image-20200822091335115](image-20200822091335115.png)\n\n- \n\n  ``` bash\n  $ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar grep /user/wry/input /user/wry/output 'dfs[a-z.]+'\n  ``` \n\n  ![image-20200822091809558](image-20200822091809558.png)\n\n  - \n\n    ``` bash\n    $ bin/hdfs dfs -ls -r /user/wry/output\n    ``` \n\n  - \n\n    ``` bash\n    $ bin/hdfs dfs -cat /user/wry/output/<>\n    ``` \n\n    ![image-20200822092048172](image-20200822092048172.png)\n\n    or\n\n  - \n\n    ``` bash\n    $ bin/hdfs dfs -get /user/wry/output /usr/local/wryoutput \n    $ cat /usr/local/wryoutput/*\n    ``` \n\n    ![image-20200822093255847](image-20200822093255847.png)\n\n- \n\n  ``` bash\n  $ sbin/stop-dfs.sh\n  ``` \n\n>**NameNode **\n>\n>1.\n>\n>2.data log\n>\n>3.\n\n>** NameNode**\n>\n>NameNodeId,NameNodeDataNodeIdNameNodedatalogNameNode\n\n![image-20200822094801817](image-20200822094801817.png)\n\n\n\n#### YARNMapReduce\n\n##### 1.\n\n1YARNMR\n2\n3YARNWordCount\n\n##### 2.\n\n###### 1\n\n`etc/hadoop/mapred-site.xml`:\n\n``` xml\n<configuration>\n    <!--MapReducelocalclassic yarn -->\n    <property>\n  \t<name>mapreduce.framework.name</name>\n        <value>yarn</value>\n    </property>\n    \n    <!-- MR -->\n    <property>\n        <name>mapreduce.application.classpath</name>\n        <value>$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*</value>\n    </property>\n</configuration>\n``` \n\n\n\n`etc/hadoop/yarn-site.xml`:\n\n``` xml\n<configuration>\n    <!--Reduce -->\n    <property>\n        <name>yarn.nodemanager.aux-services</name>\n        <value>mapreduce_shuffle</value>\n    </property>\n    \n    <!--yarn-->\n    <property>\n        <name>yarn.nodemanager.env-whitelist</name> \t\t<value>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME</value>\n    </property>\n    \n    <!--YARNResourceManager-->\n<property>\n\t<name>yarn.resourcemanager.hostname</name>\n\t<value>0.0.0.0</value>\n</property>\n</configuration>\n``` \n\n\n\n``` bash\n$ sbin/start-yarn.sh\n``` \n\n\n\n![image-20200822100056038](image-20200822100056038.png)\n\n`etc/hadoop/hadoop-env.sh`\n\n``` bash\nexport YARN_RESOURCEMANAGER_USER=root\nexport YARN_NODEMANAGER_USER=root\n``` \n\n![image-20200822102024933](image-20200822102024933.png)\n\n![image-20200822102108817](image-20200822102108817.png)\n\nResourceManagerweb\n\nResourceManager - `http://localhost:8088/`\n\n![image-20200822111645219](image-20200822111645219.png)\n\njob\n\n- hadoop \n\n``` bash\n$ bin/hdfs dfs -put wcinput/wc.input  /user/wry/wcinput\n``` \n\n- \n\n``` bash\n$ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount /user/wry/wcinput /user/wry/wcoutput\n``` \n\n- \n\n``` bash\n$ bin/hadoop dfs -ls -r /user/wry/wcoutput\n``` \n\n\n\n\n\n#### \n\n\n\n- `etc/hadoop/mapred-site.xml`\n\n``` xml\n<!---->\n<property>\n\t<name>mapreduce.jobhistory.address</name>\n\t<value>0.0.0.0:10020</value>\n</property>\n<!--web-->\n<property>\n\t<name>mapreduce.jobhistory.webapp.address</name>\n\t<value>0.0.0.0:19888</value>\n</property>\n``` \n\n- \n\n  ``` bash\n  $ sbin/mr-jobhistory-daemon.sh starthistoryserver\n  ``` \n\n- \n\n  ``` bash\n  $ jps\n  ``` \n\n- JobHistory\n\n  JobHistory -   http://hadoop101:19888/jobhistory\n\n#### \n\nHDFS\n\n\nNodeManagerResourceManager\nHistoryManager\n\n\n\n-  `etc/hadoop/yarn-site.xml`\n\n  ``` xml\n  <!---->\n  <property>\n  \t<name>yarn.log-aggregation-enable</name>\n  \t<value>true</value>\n  </property>\n  <!--7-->\n  <property>\n  \t<name>yarn.log-aggregation.retain-seconds</name>\n  \t<value>604800</value>\n  </property>\n  ``` \n\n- NodeManagerResourceManagerHistoryManager\n\n  -   NodeManagerResourceManagerName NodeDataNode\n\n  ``` bash\n   $ sbin/stop-all.sh\n  ``` \n\n  -   NodeManagerResourceManager\n\n  ``` bash\n  $ sbin/stop-yarn.sh\n  ``` \n\n  -   Name NodeDataNode\n\n  ``` bash\n  $ sbin/stop-dfs.sh\n  ``` \n\n  -   HistoryManager\n\n  ``` bash\n  $ sbin/mr-jobhistory-daemon.sh stop historyserver \n  ``` \n\n- NodeManagerResourceManagerHistoryManager\n\n- HDFS\n\n  ``` bash\n  $ bin/hadoop dfs -rm -f -r /user/wry/wcoutput\n  ``` \n\n- WordCount\n\n  ``` bash\n  $ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount /user/wry/wcinput /user/wry/wcoutput\n  ``` \n\n- \n\n  ![image-20200822140954237](image-20200822140954237.png)\n\n  ![image-20200822141013068](image-20200822141013068.png)\n\n  ![image-20200822141028970](image-20200822141028970.png)\n\n#### \n\nHadoop\n\n\n##### 1\n\nHadoopjar\n\n|        |                                     |\n| :----------------- | --------------------------------------------------------- |\n| core-default.xml   | hadoop-common-2.7.2.jar/core-default.xml                  |\n| hdfs-default.xml   | hadoop-hdfs-2.7.2.jar/hdfs-default.xml                    |\n| yarn-default.xml   | hadoop-yarn-common-2.7.2.jar/yarn-default.xml             |\n| mapred-default.xml | hadoop-mapreduce-client-core-2.7.2.jar/mapred-default.xml |\n\n##### 2\n\ncore-site.xmlhdfs-site.xmlyarn-site.xmlmapred-site.xml\n$HADOOP_HOME/etc/hadoop\n\n\n\n### \n\n#### \n\n13ip\n2JDK\n3\n4Hadoop\n5\n6\n7\n8ssh\n9\n\n#### \n\n##### 1IP\n\n``` bash\n$ vim /etc/sysconfig/network-scripts/ifcfg-ens33 \n``` \n\n``` bash\nTYPE=Ethernet\nPROXY_METHOD=none\nBROWSER_ONLY=no\nBOOTPROTO=static\t\t#static\nDEFROUTE=yes\nIPV4_FAILURE_FATAL=no\nIPV6INIT=yes\nIPV6_AUTOCONF=yes\nIPV6_DEFROUTE=yes\nIPV6_FAILURE_FATAL=no\nIPV6_ADDR_GEN_MODE=stable-privacy\nNAME=ens33\nUUID=67b4d72d-1ff5-4e3e-a089-e1579700eba8\nDEVICE=ens33\nONBOOT=yes\t\t\t\t#yes\n\nIPADDR=192.168.100.102  # ip\nNETMASK=255.255.255.0   #\nGATEWAY=192.168.100.1\t#\nDNS1=8.8.8.8\t\t\t#DNS\nDNS2=223.6.6.6\n\nPREFIX=24\n\n``` \n\n##### 2\n\n\n\n``` bash\n$ vim /etc/hotos\n``` \n\n``` bash\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n192.168.100.102 hadoop102\n192.168.100.103 hadoop103\n192.168.100.104 hadoop104\n``` \n\n\n\n#### xsync\n\n##### 1.scpsecurecopy\n\n###### 1scp\n\n`scp`fromserver1toserver2\n\n###### 2\n\n``` bash\nscp\t\t-r  \t$pdir/$fname\t\t$user@hadoop$host:$pdir/$fname\n\t  \t \t   @:/\n``` \n\n###### 3\n\na`192.168.100.101``192.168.100.101``/usr/local/software``192.168.100.102`\n\n``` bash\n$ scp -r /usr/local/software/*  root@192.168.100.102:/usr/local/software\n``` \n\nb`192.168.100.103``192.168.100.101``/usr/local/software`\n`192.168.100.103`\n\n``` bash\n$ scp -r root@192.168.100.101:/usr/local/software/*  /usr/local/software/\n``` \n\nc`192.168.100.103``192.168.100.101``/usr/local/software`\n`192.168.100.104`\n\n``` bash\n$ scp -r root@192.168.100.101:/usr/local/software/*  root@192.168.100.104:/usr/local/software/\n``` \n\n##### 2.rsync\n\n`rsync`\n\n**`rsync``scp`**\n\n`rsync``scp``rsync``scp`\n\n###### 1\n\n``` bash\nrsync\t-rvl\t\t$pdir/$fname\t\t\t$user@hadoop$host:$pdir/$fname\n\t  \t\t/\t\t@:/\n``` \n\n\n\n|  |          |\n| ---- | ------------ |\n| -r   |          |\n| -v   |  |\n| -l   |  |\n\n###### 2\n\na`192.168.100.101``/usr/local/software``192.168.100.102`root\n`/usr/local/software`\n\n``` bash\n$ rsync  -rvl /usr/local/software/*  root@192.168.100.102:/usr/local/software/\n``` \n\n##### 3.xsync\n\n###### 1\n\n\n\n###### 2\n\narsync\n\n``` bash\nrsync -rvl  /usr/local/program/*  root@192.168.100.103:/usr/local/program/\n``` \n\nb\nxsync\nc`/home/<>/bin`root\n\n###### 3\n\na`/home/<>/bin`binbinxsync\n\n``` bash\n$ cd /home/<>\n$ mkdir bin\n$ cd bin\n$ vim xsync\n``` \n\n\n\n``` bash\n#!/bin/bash\n#1\npcount=$#\nif((pcount==0));then\necho noargs;\nexit;\nfi\n#2\np1=$1\nfname=`basename $p1`\necho  fname=$fname\n#3\npdir=`cd -P $(dirname $p1);pwd`\necho pdir=$pdir\n#4\nuser=`whoami`\n#5\nfor((host=103;host<105;host++));do\necho -------------------192.168.100.$host--------------\nrsync -rvl $pdir/$fname  $user@192.168.100.$host:$pdir\ndone\n``` \n\nbxsync\n\n``` bash\n$ chmod 777 xsync\n``` \n\ncxsync\n\n``` bash\n$ xsync  /home/<>/bin\n``` \n\n\n\n\n>****\n>\n>`xsync``/home/<>/bin`\n>\n>`xsync``/usr/local/bin`\n\n#### \n\n##### 1.\n\n|      | 192.168.100.102 -hadoop102 | 192.168.100.103-hadoop103        | 192.168.100.104-hadoop104        |\n| ---- | :------------------------- | -------------------------------- | -------------------------------- |\n| HDFS | NameNode <br /> DataNode   | <br />DataNode                   | SecondaryNameNode <br />DataNode |\n| YARN | <br />NodeManage           | ResourceManage  <br />NodeManage | <br />NodeManage                 |\n\nIP \n\n##### 2.\n\n###### 1\n\n`192.168.100.102` \n\n`etc/hadoop/core-site.xml`\n\n``` bash\n$ cd /usr/local/program/hadoop3.2.1\n$ vim etc/hadoop/core-site.xml\n``` \n\n\n\n``` xml\n<!--HDFSNameNode-->\n<property>\n\t<name>fs.defaultFS</name>\n\t<value>hdfs://192.168.100.102:9000</value>\n</property>\n<!--Hadoop-->\n<property>\n\t<name>hadoop.tmp.dir</name>\n\t<value>/usr/local/program/hadoop-3.2.1/data/tmp/hadoop-${user.name}</value>\n</property>\n``` \n\n###### 2HDFS\n\n`etc/hadoop/hadoop-env.sh`\n\n``` bash\nexport JAVA_HOME=/usr/local/program/jdk1.8 \n\nexport HDFS_DATANODE_USER=root  \nexport HDFS_NAMENODE_USER=root  \nexport HDFS_SECONDARYNAMENODE_USER=root \n``` \n\n`etc/hadoop/hdfs-site.xml`\n\n```  xml\n<property>\n\t<name>dfs.replication</name>\n    <value>3</value>\n</property>\n<!--Hadoop-->\n<property>\n\t<name>dfs.namenode.secondary.http-address</name>\n    <value>192.168.100.104:50090</value>\n</property>\n<!--HadoopNameNode-->\n<property>\n  <name>dfs.http.address</name>\n  <value>192.168.100.102:9870</value>\n</property>\n\n\n``` \n\n###### 3YARN\n\n shell\n\n``` bash\n$ hadoop  classpath\n``` \n\n    yarn  yarn-site.xml <name>yarn.application.classpath</name>\n\n`etc/hadoop/hadoop-env.sh`\n\n``` bash\nexport YARN_RESOURCEMANAGER_USER=root\nexport YARN_NODEMANAGER_USER=root\n``` \n\n`etc/hadoop/yarn-site.xml`\n\n``` xml\n<!--MapReducelocalclassic yarn -->\n<property>\n\t<name>mapreduce.framework.name</name>\n    <value>yarn</value>\n</property>\n    \n<!-- MR -->\n<property>\n\t<name>mapreduce.application.classpath</name>\n    <value>/usr/local/program/hadoop-3.2.1/etc/hadoop:/usr/local/program/hadoop-3.2.1/share/hadoop/common/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/common/*:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs/*:/usr/local/program/hadoop-3.2.1/share/hadoop/mapreduce/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/mapreduce/*:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn/*</value>\n</property>\n<!--YARNResourceManager-->\n<property>\n\t<name>yarn.resourcemanager.hostname</name>\n\t<value>192.168.100.103</value>\n</property>\n\n<property>\n    <name>yarn.nodemanager.aux-services</name>\n    <value>mapreduce_shuffle</value>\n</property>\n<property>\n    <name>yarn.nodemanager.aux-services.mapreduce.shuffle.class</name>\n    <value>org.apache.hadoop.mapred.ShuffleHandler</value>\n</property>\n\n``` \n\n###### 4MapReduce\n\n`etc/hadoop/mapred-site.xml`\n\n``` xml\n<!--MRYarn-->\n<property>\n\t<name>mapreduce.framework.name</name>\n\t<value>yarn</value>\n</property>\n<!-- MR -->\n<property>\n\t<name>mapreduce.application.classpath</name>     <value>$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*</value>\n</property>\n``` \n\n##### 3.Hadoop\n\n``` bash\n$ xsync ./etc/hadoop/\n``` \n\n##### 4.\n\n#### \n\n1`NameNode`\n\n``` bash\n$  bin/hdfs namenode -formart\n``` \n\n2`192.168.100.102``NameNode`\n\n``` bash\n$ sbin/hadoop-daemon.sh  start namenode\n``` \n\n3`192.168.100.102`,`192.168.100.103``192.168.100.104``DataNode`\n\n``` bash\n$ sbin/hadoop-daemon.sh  start datanode\n``` \n\n41000\n\t\t\t\n\n#### SSH\n\n##### 1.ssh\n\n1\n\t\t\tsship\n2sshHostkeyverificationfailed\n\n``` bash\n$ ssh  192.168.1.103\nTheauthenticityofhost'192.168.1.103(192.168.1.103)'can't\nbeestablished.\nRSAkeyfingerprintis\ncf:1e:de:d7:d0:4c:2d:98:60:b4:fd:ae:b1:2d:ad:06.\nAreyousureyouwanttocontinueconnecting(yes/no)?\nHostkeyverificationfailed.\n``` \n\n3yes\n\n##### 2.\n\n1\n\n![image-20200823180537869](image-20200823180537869.png)\n\n2`192.168.100.102`\n\n``` bash\n$ cd /root/.ssh\n$ ssh-keygen -t rsa\n``` \n\nid_rsaid_rsa.pub\n\n3\n\n``` bash\n$ ssh-copy-id 192.168.100.102\n$ ssh-copy-id 192.168.100.103\n$ ssh-copy-id 192.168.100.104\n``` \n\n4`192.168.100.103`,\n\n\n\n##### 3.`.ssh`~/.ssh\n\n| known_hosts     | ssh(publickey) |\n| --------------- | ------------------------------------ |\n| id_rsa          |                            |\n| id_rsa.pub      |                            |\n| authorized_keys |        |\n\n#### \n\n##### 1.`etc/hadoop/workers`\n\n``` bash\n$ vim etc/hadoop/workers \n``` \n\n\n\n``` bash\n192.168.100.102\n192.168.100.103\n192.168.100.104\n``` \n\n>#### \n>\n>\n\n##### 2.\n\n###### 1\n\nNameNodenamenodedatanodedatalog\n\n``` bash\n$ bin/hdfs namenode -format\n``` \n\n###### 2HDFS\n\n``` bash\n$ sbin/start-dfs.sh\n``` \n\n`jps`\n\n###### 3`YARN`\n\n``` bash\n$ sbin/start-yarn.sh\n``` \n\n###### 3Web`SecondaryNameNode`\n\n``` http\nhttp://192.168.100.102:9870/\n``` \n\n###### 4\n\n ``` bash\n$ bin/hdfs dfsadmin -report\n ``` \n\n\n\n> \n>\n> NameNodeResourceMangerNameNodeYARNResouceManagerYARN\n\n##### 3.\n\n###### 1\n\n``` bash\n$ bin/hdfs dfs -put  ./wcinput/wc.input  /user/wry/input\n``` \n\n###### 2\n\n``` bash\n$ pwd\n``` \n\n``` bash\n/usr/local/program/hadoop-3.2.1/data/tmp/hadoop-root/dfs/data/current/BP-719430212-127.0.0.1-1598525636602/current/finalized/subdir0/subdir0\n``` \n\n\n\n#### /\n\n##### 1./\n\n###### 1/HDFS\n\n``` bash\n$ sbin/hadoop-daemon.sh start/stop  namenode/datanode/secondarynamenode\n``` \n\n###### 2/YARN\n\n``` bash\n$ sbin/yarn-daemon.sh  start/stop  resourcemanager/nodemanager\n``` \n\n##### 2./ssh\n\n###### 1/HDFS\n\n``` bash\n$ sbin/start-dfs.sh/stop-dfs.sh\n``` \n\n###### 2/YARN\n\n``` bash\n$ sbin/start-yarn.sh/stop-yarn.sh\n``` \n\n### crontab\n\n#### \n\ncrontab []\n\n#### \n\n|  |                            |\n| ---- | ------------------------------ |\n| -e   | crontab            |\n| -l   | crontab                |\n| -r   | crontab  |\n\n#### \n\n``` bash\n$ crontab -e\n``` \n\n##### 1crontabvim \n\n``` \n* * * * *  \n``` \n\n|       |                  |                     |\n| --------- | -------------------- | ----------------------- |\n| * |  | 0-59                    |\n| * |    | 0-23                    |\n| * |      | 1-31                    |\n| * |      | 1-12                    |\n| * |      | 0-707 |\n\n##### 2\n\n|  |                                                          |\n| -------- | ------------------------------------------------------------ |\n| *        | * |\n|        | \"0 8,12,16 * * *\" 80120160 |\n| -        | \"0 5 * * 1-6\" ,50 |\n| */n      | \"*/10 * * * *\",10 |\n\n##### 3\n\n|          |                                                          |\n| ------------ | ------------------------------------------------------------ |\n| 45 22 * * *  | 2245                                           |\n| 0 17 * * 1   | 170                                      |\n| 0 5 1,15 * * | 11550                            |\n| 40 4 * * 1-5 | 440                            |\n| */10 4 * * * | 410                        |\n| 0 0 1,15 * 1 | 11500 |\n\n##### 4\n\n- 1`/root/bailongma.txt`11 \n\n  ``` bash\n  */1 * * * * /bin/echo \"11\" >>/root/bailongma.txt\n  ``` \n\n\n\n### \n\n\n\n![image-20200829223326519](image-20200829223326519.png)\n\n\n\n## Linux\n\n### IP\n\n#### VMnet\n\nVMware - NAT VMnet2\n\n![](https://img.jbzj.com/file_images/article/202001/2020011513342421.png)\n\nip,,\n\nA255.0.0.0\nB255.255.0.0\nC255.255.255.0\n\nIP: DHCPIP ()\n\nNAT\n\nip,ip\n\n![Alt](https://img.jbzj.com/file_images/article/202001/2020011513342422.png)\n\n#### \n\n rootcentos8vi /etc/sysconfig/network-scripts/ifcfg-ens33\n\n``` bash\nTYPE=Ethernet\nPROXY_METHOD=none\nBROWSER_ONLY=no\nBOOTPROTO=static #static\nDEFROUTE=yes\nIPV4_FAILURE_FATAL=no\nIPV6INIT=yes\nIPV6_AUTOCONF=yes\nIPV6_DEFROUTE=yes\nIPV6_FAILURE_FATAL=no\nIPV6_ADDR_GEN_MODE=stable-privacy\nNAME=ens33\nUUID=aa18fb34-fea8-4fff-83a4-1ebed631beff\nDEVICE=ens33\nONBOOT=yes #noyes\nGATEWAY=192.168.0.2 #\nIPADDR=192.168.0.150 #\nNETMASK=255.255.255.0 #\nDNS1=8.8.8.8 #DNS1,\nDNS2=223.6.6.6 #DNS2\n``` \n\n :wq\n\n#### : \n\nCentOS 8  : nmcli c reload\n\nCentOS7  /etc/init.d/network restart\n\n`reboot` \n\n\n\n### \n\ncentos8\n\n#### \n\n``` bash\n$ systemctl disable firewalld\n``` \n\n#### \n\n``` bash\n$ systemctl status firewalld.service\n``` \n\n#### \n\n``` bash\n$ systemctl stop firewalld.service\n``` \n\n#### \n\n``` bash\n$ systemctl start firewalld.service\n``` \n\n### JDK\n\n#### \n\n``` bash\n$ tar -zxvf /usr/local/software/jdk1.8.231 -C /usr/local/program/\n``` \n\n#### \n\n``` bash\n$ vim /etc/profile\n``` \n\njava \n\n``` bash\nexport JAVA_HOME=/usr/local/program/jdk1.8.231\nexport CLASS_PATH=.:$JAVA_HOME/lib.tools.jar\nexport PATH=$PATH:$JAVA_HOME/bin\n``` \n\n#### \n\n``` bash\n$ source /etc/profile\n``` \n\n### SSH\n\n#### \n\n``` bash\n$ vim /etc/ssh/sshd_config\n``` \n\n \n\nClientAliveInterval 60\n\n, , \n\nClientAliveCountMax 3 \n\nClientAliveCountMax, \n\n#### \n\n``` bash\n$ service sshd restart\n``` \n\n\n\n``` bash\ntar -zxvf /usr/local/software/hadoop-3.2.1.tar.gz  -C /usr/local/program/\n\nvim /etc/profile\n\n#hadoop \nexport HADOOP_HOME=/usr/local/program/hadoop-3.2.1\nexport PATH=$PATH:$HADOOP_HOME/bin\nexport PATH=$PATH:$HADOOP_HOME/sbin\n\nsource /etc/profile\n\nhadoop version\n``` \n\n","source":"_posts/2023/Hadoop.md","raw":"---\ntitle: Hadoop\ndate: 2023-02-21\ntags:\n- Hadoop\ncategories:\n- Hadoop\n---\n\n## Hadoop\n\n1. hadoopAoache \n2. \n3. HadoopHadoop\n\n## Hadoop\n\n### Lucene\n\n### \n\n#### GFS-->HDFS\n\n#### Map-Reduce-->MR\n\n#### BigTable-->HBase\n\n\n\n## Hadoop\n\n### Apache\n\n\n\n### Cloudera\n\n\n\n### Hortonworks\n\n\n\n## Hadoop4\n\n1. HadoopHadoop\n2. \n3. Mao-Reduce Hadoop\n4. \n\n## Hadoop\n\n###  1.x 2.x\n\n![image-20200820213620752](image-20200820213620752.png)\n\n\n\n### HDFS\n\n#### 1.NameNode (nn)\n\nDataNode \n\n#### 2.DataNode (dn)\n\n\n\n#### 3.Secondary NameNode (2nn)\n\nHDFSHDFS\n\n\n\n### YARN \n\n#### ResourceManage(RM)\n\n- \n- NodeManage\n- ApplicationMaster\n- \n\n#### NodeManage(NM)\n\n- \n- ResourceManage\n- ApplicationMaster \n\n#### ApplicationMaster(AM)\n\n- \n- \n- \n\n#### Container\n\n- ContainerYARNCPU,\n\n### MapReduce\n\nMapReduce map  Reduce\n\n1. Map \n2. ReduceMap\n\n \n\n## \n\n![image-20200820224123902](image-20200820224123902.png)\n\n\n\n## \n\n### 1.\n\n### 2.JDK\n\n### 3.Hadoop\n\n- \n\n- \n\n   `/etc/profile`\n\n  ``` bash\n  export HADOOP_HOME=/usr/local/hadoop-3.2.1\n  export PATH=$PATH:$HADOOP_HOME/bin\n  export PATH=$PATH:$HADOOP_HOME/sbin\n  ``` \n\n  \n\n  ``` bash\n  $ source /ect/profile\n  ``` \n\n### 4.Hadoop\n\n- **bin**\n\n  HadoopHDFS,YARN\n\n- **etc** \n\n  Hadoop\n\n- **lib**\n\n  Hadoop\n\n- **sbin**\n\n  Hadoop\n\n- **share**\n\n  Hadoopjar\n\n### 5.Hadoop\n\nHadoophttps://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html\n\n## Hadoop\n\nHadoop\n\n\n\n\n\n### \n\n#### Grep\n\n1.hadoop-3.2.1input\n\n``` bash\n$ mkdir input\n``` \n\n2.Hadoopxmlinput\n\n``` bash\n$ cp  etc/hadoop/*.xml  input\n``` \n\n3.shareMapReduce\n\n``` bash\n$ bin/hadoop\tjar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar grep input  output  'dfs[a-z.]+'\n``` \n\n4.\n\n``` bash\ncat  output/*\n``` \n\n#### WordCount\n\n1.hadoop-3.2.1wcinput\n\n``` bash\nmkdir wcinput\n``` \n\n2.wcinputwc.input\n\n``` bash\n$ cd wcinput\n\n$ touchwc.input\n``` \n\n3.wc.input\n\n``` bash\n$ vim  wc.input\n``` \n\n\n\n``` \nhadoopyarn\nhadoopmapreduce\natguigu\natguigu\n``` \n\nwq\n\n4.Hadoop\n\n5.\n\n``` bash\n$ hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount wcinput wcoutput\n``` \n\n6.\n\n``` bash\n$ cat wcoutput /part-r-00000\n``` \n\n``` \natguigu2\nhadoop2\nmapreduce1\nyarn1\n``` \n\n\n\n### \n\n#### HDFSMapReduce\n\n##### 1.\n\n1\n2\n3WordCount\n\n##### 2.\n\n###### 1\n\nHadoopetc\n\n``` bash\n$ cd ./etc\n``` \n\n- hadoop-env.sh\n\n  LinuxJDK\n\n  ``` bash\n  $ echo $JAVA_HOME\n  ``` \n\n  ``` bash\n  /usr/local/jdk1.8.0_121\n  ``` \n\n  JAVA_HOME\n\n  ``` bash\n  export JAVA_HOME=/usr/local/jdk1.8.0_121\n  ``` \n\n- core-site.xml\n\n  ``` xml\n  <!--HDFSNameNode-->\n  <property>\n  \t<name>fs.defaultFS</name>\n  \t<value>hdfs://localhost:9000</value>\n  </property>\n  <!--Hadoop-->\n  <property>\n  \t<name>hadoop.tmp.dir</name>\n  \t<value>/usr/local/hadoop-3.2.1/data/tmp</value>\n  </property>\n  ``` \n\n- hdfs-site.xml\n\n  ``` xml\n  <!--HDFS-->\n  <property>\n  \t<name>dfs.replication</name>\n  \t<value>1</value>\n  </property>\n  ``` \n\n###### 2SSH\n\n- SSH\n\n  ``` bash\n   $ ssh  localhost\n  ``` \n\n  SSH\n\n- \n\n  ``` bash\n  $ ssh-keygen -t rsa -P''-f/ .ssh / id_rsa \n  $ cat/ .ssh / id_rsa.pub >>/ .ssh / authorized_keys \n  $ chmod 0600/ .ssh / authorized_keys\n  ``` \n\n###### 3\n\n- \n\n  ``` bash\n  $ bin/hdfs namenode -format\n  ``` \n\n- NameNodeDataNode\n\n  ``` bash\n  $ ./sbin/start-dfs.sh\n  ``` \n\n- \n\n  ``` bash\n  [root@iZ2zednzb8iugz3kgudq9bZ hadoop-3.2.1]# ./sbin/stop-dfs.sh\n  Stopping namenodes on [localhost]\n  ERROR: Attempting to operate on hdfs namenode as root\n  ERROR: but there is no HDFS_NAMENODE_USER defined. Aborting operation.\n  Stopping datanodes\n  ERROR: Attempting to operate on hdfs datanode as root\n  ERROR: but there is no HDFS_DATANODE_USER defined. Aborting operation.\n  Stopping secondary namenodes [iZ2zednzb8iugz3kgudq9bZ]\n  ERROR: Attempting to operate on hdfs secondarynamenode as root\n  ERROR: but there is no HDFS_SECONDARYNAMENODE_USER defined. Aborting operation.\n  ``` \n\n   `hadoop-env.sh`\n\n  ``` bash\n  HDFS_DATANODE_USER=root  \n  HDFS_NAMENODE_USER=root  \n  HDFS_SECONDARYNAMENODE_USER=root \n  ``` \n\n- WebNameNode\n\n  ``` http\n  http://localhost:9870/\n  ``` \n\n- MapReduceHDFS\n\n  ``` bash\n  $ bin/hdfs dfs -mkdir /user/root\n  $ bin/hdfs dfs -mkdir /user/<>\n  ``` \n\n  - \n\n  ``` bash\n  $ bin/hdfs dfs -mkdir -p  /user/wry\n  ``` \n\n  ![image-20200822090658863](image-20200822090658863.png)\n\n  - \n\n  ``` bash\n  $ bin/hdfs dfs -ls -R /\n\t``` \n\n  ![image-20200822090905199](image-20200822090905199.png)\n  \n- \n\n  ``` bash\n  $ bin/hdfs dfs -mkdir -p /user/wry/input\n  $ bin/hdfs dfs -put etc/hadoop/*.xml /user/wry/input\n  ``` \n\n  ![image-20200822091216510](image-20200822091216510.png)\n\n  ![image-20200822091335115](image-20200822091335115.png)\n\n- \n\n  ``` bash\n  $ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar grep /user/wry/input /user/wry/output 'dfs[a-z.]+'\n  ``` \n\n  ![image-20200822091809558](image-20200822091809558.png)\n\n  - \n\n    ``` bash\n    $ bin/hdfs dfs -ls -r /user/wry/output\n    ``` \n\n  - \n\n    ``` bash\n    $ bin/hdfs dfs -cat /user/wry/output/<>\n    ``` \n\n    ![image-20200822092048172](image-20200822092048172.png)\n\n    or\n\n  - \n\n    ``` bash\n    $ bin/hdfs dfs -get /user/wry/output /usr/local/wryoutput \n    $ cat /usr/local/wryoutput/*\n    ``` \n\n    ![image-20200822093255847](image-20200822093255847.png)\n\n- \n\n  ``` bash\n  $ sbin/stop-dfs.sh\n  ``` \n\n>**NameNode **\n>\n>1.\n>\n>2.data log\n>\n>3.\n\n>** NameNode**\n>\n>NameNodeId,NameNodeDataNodeIdNameNodedatalogNameNode\n\n![image-20200822094801817](image-20200822094801817.png)\n\n\n\n#### YARNMapReduce\n\n##### 1.\n\n1YARNMR\n2\n3YARNWordCount\n\n##### 2.\n\n###### 1\n\n`etc/hadoop/mapred-site.xml`:\n\n``` xml\n<configuration>\n    <!--MapReducelocalclassic yarn -->\n    <property>\n  \t<name>mapreduce.framework.name</name>\n        <value>yarn</value>\n    </property>\n    \n    <!-- MR -->\n    <property>\n        <name>mapreduce.application.classpath</name>\n        <value>$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*</value>\n    </property>\n</configuration>\n``` \n\n\n\n`etc/hadoop/yarn-site.xml`:\n\n``` xml\n<configuration>\n    <!--Reduce -->\n    <property>\n        <name>yarn.nodemanager.aux-services</name>\n        <value>mapreduce_shuffle</value>\n    </property>\n    \n    <!--yarn-->\n    <property>\n        <name>yarn.nodemanager.env-whitelist</name> \t\t<value>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME</value>\n    </property>\n    \n    <!--YARNResourceManager-->\n<property>\n\t<name>yarn.resourcemanager.hostname</name>\n\t<value>0.0.0.0</value>\n</property>\n</configuration>\n``` \n\n\n\n``` bash\n$ sbin/start-yarn.sh\n``` \n\n\n\n![image-20200822100056038](image-20200822100056038.png)\n\n`etc/hadoop/hadoop-env.sh`\n\n``` bash\nexport YARN_RESOURCEMANAGER_USER=root\nexport YARN_NODEMANAGER_USER=root\n``` \n\n![image-20200822102024933](image-20200822102024933.png)\n\n![image-20200822102108817](image-20200822102108817.png)\n\nResourceManagerweb\n\nResourceManager - `http://localhost:8088/`\n\n![image-20200822111645219](image-20200822111645219.png)\n\njob\n\n- hadoop \n\n``` bash\n$ bin/hdfs dfs -put wcinput/wc.input  /user/wry/wcinput\n``` \n\n- \n\n``` bash\n$ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount /user/wry/wcinput /user/wry/wcoutput\n``` \n\n- \n\n``` bash\n$ bin/hadoop dfs -ls -r /user/wry/wcoutput\n``` \n\n\n\n\n\n#### \n\n\n\n- `etc/hadoop/mapred-site.xml`\n\n``` xml\n<!---->\n<property>\n\t<name>mapreduce.jobhistory.address</name>\n\t<value>0.0.0.0:10020</value>\n</property>\n<!--web-->\n<property>\n\t<name>mapreduce.jobhistory.webapp.address</name>\n\t<value>0.0.0.0:19888</value>\n</property>\n``` \n\n- \n\n  ``` bash\n  $ sbin/mr-jobhistory-daemon.sh starthistoryserver\n  ``` \n\n- \n\n  ``` bash\n  $ jps\n  ``` \n\n- JobHistory\n\n  JobHistory -   http://hadoop101:19888/jobhistory\n\n#### \n\nHDFS\n\n\nNodeManagerResourceManager\nHistoryManager\n\n\n\n-  `etc/hadoop/yarn-site.xml`\n\n  ``` xml\n  <!---->\n  <property>\n  \t<name>yarn.log-aggregation-enable</name>\n  \t<value>true</value>\n  </property>\n  <!--7-->\n  <property>\n  \t<name>yarn.log-aggregation.retain-seconds</name>\n  \t<value>604800</value>\n  </property>\n  ``` \n\n- NodeManagerResourceManagerHistoryManager\n\n  -   NodeManagerResourceManagerName NodeDataNode\n\n  ``` bash\n   $ sbin/stop-all.sh\n  ``` \n\n  -   NodeManagerResourceManager\n\n  ``` bash\n  $ sbin/stop-yarn.sh\n  ``` \n\n  -   Name NodeDataNode\n\n  ``` bash\n  $ sbin/stop-dfs.sh\n  ``` \n\n  -   HistoryManager\n\n  ``` bash\n  $ sbin/mr-jobhistory-daemon.sh stop historyserver \n  ``` \n\n- NodeManagerResourceManagerHistoryManager\n\n- HDFS\n\n  ``` bash\n  $ bin/hadoop dfs -rm -f -r /user/wry/wcoutput\n  ``` \n\n- WordCount\n\n  ``` bash\n  $ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount /user/wry/wcinput /user/wry/wcoutput\n  ``` \n\n- \n\n  ![image-20200822140954237](image-20200822140954237.png)\n\n  ![image-20200822141013068](image-20200822141013068.png)\n\n  ![image-20200822141028970](image-20200822141028970.png)\n\n#### \n\nHadoop\n\n\n##### 1\n\nHadoopjar\n\n|        |                                     |\n| :----------------- | --------------------------------------------------------- |\n| core-default.xml   | hadoop-common-2.7.2.jar/core-default.xml                  |\n| hdfs-default.xml   | hadoop-hdfs-2.7.2.jar/hdfs-default.xml                    |\n| yarn-default.xml   | hadoop-yarn-common-2.7.2.jar/yarn-default.xml             |\n| mapred-default.xml | hadoop-mapreduce-client-core-2.7.2.jar/mapred-default.xml |\n\n##### 2\n\ncore-site.xmlhdfs-site.xmlyarn-site.xmlmapred-site.xml\n$HADOOP_HOME/etc/hadoop\n\n\n\n### \n\n#### \n\n13ip\n2JDK\n3\n4Hadoop\n5\n6\n7\n8ssh\n9\n\n#### \n\n##### 1IP\n\n``` bash\n$ vim /etc/sysconfig/network-scripts/ifcfg-ens33 \n``` \n\n``` bash\nTYPE=Ethernet\nPROXY_METHOD=none\nBROWSER_ONLY=no\nBOOTPROTO=static\t\t#static\nDEFROUTE=yes\nIPV4_FAILURE_FATAL=no\nIPV6INIT=yes\nIPV6_AUTOCONF=yes\nIPV6_DEFROUTE=yes\nIPV6_FAILURE_FATAL=no\nIPV6_ADDR_GEN_MODE=stable-privacy\nNAME=ens33\nUUID=67b4d72d-1ff5-4e3e-a089-e1579700eba8\nDEVICE=ens33\nONBOOT=yes\t\t\t\t#yes\n\nIPADDR=192.168.100.102  # ip\nNETMASK=255.255.255.0   #\nGATEWAY=192.168.100.1\t#\nDNS1=8.8.8.8\t\t\t#DNS\nDNS2=223.6.6.6\n\nPREFIX=24\n\n``` \n\n##### 2\n\n\n\n``` bash\n$ vim /etc/hotos\n``` \n\n``` bash\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n192.168.100.102 hadoop102\n192.168.100.103 hadoop103\n192.168.100.104 hadoop104\n``` \n\n\n\n#### xsync\n\n##### 1.scpsecurecopy\n\n###### 1scp\n\n`scp`fromserver1toserver2\n\n###### 2\n\n``` bash\nscp\t\t-r  \t$pdir/$fname\t\t$user@hadoop$host:$pdir/$fname\n\t  \t \t   @:/\n``` \n\n###### 3\n\na`192.168.100.101``192.168.100.101``/usr/local/software``192.168.100.102`\n\n``` bash\n$ scp -r /usr/local/software/*  root@192.168.100.102:/usr/local/software\n``` \n\nb`192.168.100.103``192.168.100.101``/usr/local/software`\n`192.168.100.103`\n\n``` bash\n$ scp -r root@192.168.100.101:/usr/local/software/*  /usr/local/software/\n``` \n\nc`192.168.100.103``192.168.100.101``/usr/local/software`\n`192.168.100.104`\n\n``` bash\n$ scp -r root@192.168.100.101:/usr/local/software/*  root@192.168.100.104:/usr/local/software/\n``` \n\n##### 2.rsync\n\n`rsync`\n\n**`rsync``scp`**\n\n`rsync``scp``rsync``scp`\n\n###### 1\n\n``` bash\nrsync\t-rvl\t\t$pdir/$fname\t\t\t$user@hadoop$host:$pdir/$fname\n\t  \t\t/\t\t@:/\n``` \n\n\n\n|  |          |\n| ---- | ------------ |\n| -r   |          |\n| -v   |  |\n| -l   |  |\n\n###### 2\n\na`192.168.100.101``/usr/local/software``192.168.100.102`root\n`/usr/local/software`\n\n``` bash\n$ rsync  -rvl /usr/local/software/*  root@192.168.100.102:/usr/local/software/\n``` \n\n##### 3.xsync\n\n###### 1\n\n\n\n###### 2\n\narsync\n\n``` bash\nrsync -rvl  /usr/local/program/*  root@192.168.100.103:/usr/local/program/\n``` \n\nb\nxsync\nc`/home/<>/bin`root\n\n###### 3\n\na`/home/<>/bin`binbinxsync\n\n``` bash\n$ cd /home/<>\n$ mkdir bin\n$ cd bin\n$ vim xsync\n``` \n\n\n\n``` bash\n#!/bin/bash\n#1\npcount=$#\nif((pcount==0));then\necho noargs;\nexit;\nfi\n#2\np1=$1\nfname=`basename $p1`\necho  fname=$fname\n#3\npdir=`cd -P $(dirname $p1);pwd`\necho pdir=$pdir\n#4\nuser=`whoami`\n#5\nfor((host=103;host<105;host++));do\necho -------------------192.168.100.$host--------------\nrsync -rvl $pdir/$fname  $user@192.168.100.$host:$pdir\ndone\n``` \n\nbxsync\n\n``` bash\n$ chmod 777 xsync\n``` \n\ncxsync\n\n``` bash\n$ xsync  /home/<>/bin\n``` \n\n\n\n\n>****\n>\n>`xsync``/home/<>/bin`\n>\n>`xsync``/usr/local/bin`\n\n#### \n\n##### 1.\n\n|      | 192.168.100.102 -hadoop102 | 192.168.100.103-hadoop103        | 192.168.100.104-hadoop104        |\n| ---- | :------------------------- | -------------------------------- | -------------------------------- |\n| HDFS | NameNode <br /> DataNode   | <br />DataNode                   | SecondaryNameNode <br />DataNode |\n| YARN | <br />NodeManage           | ResourceManage  <br />NodeManage | <br />NodeManage                 |\n\nIP \n\n##### 2.\n\n###### 1\n\n`192.168.100.102` \n\n`etc/hadoop/core-site.xml`\n\n``` bash\n$ cd /usr/local/program/hadoop3.2.1\n$ vim etc/hadoop/core-site.xml\n``` \n\n\n\n``` xml\n<!--HDFSNameNode-->\n<property>\n\t<name>fs.defaultFS</name>\n\t<value>hdfs://192.168.100.102:9000</value>\n</property>\n<!--Hadoop-->\n<property>\n\t<name>hadoop.tmp.dir</name>\n\t<value>/usr/local/program/hadoop-3.2.1/data/tmp/hadoop-${user.name}</value>\n</property>\n``` \n\n###### 2HDFS\n\n`etc/hadoop/hadoop-env.sh`\n\n``` bash\nexport JAVA_HOME=/usr/local/program/jdk1.8 \n\nexport HDFS_DATANODE_USER=root  \nexport HDFS_NAMENODE_USER=root  \nexport HDFS_SECONDARYNAMENODE_USER=root \n``` \n\n`etc/hadoop/hdfs-site.xml`\n\n```  xml\n<property>\n\t<name>dfs.replication</name>\n    <value>3</value>\n</property>\n<!--Hadoop-->\n<property>\n\t<name>dfs.namenode.secondary.http-address</name>\n    <value>192.168.100.104:50090</value>\n</property>\n<!--HadoopNameNode-->\n<property>\n  <name>dfs.http.address</name>\n  <value>192.168.100.102:9870</value>\n</property>\n\n\n``` \n\n###### 3YARN\n\n shell\n\n``` bash\n$ hadoop  classpath\n``` \n\n    yarn  yarn-site.xml <name>yarn.application.classpath</name>\n\n`etc/hadoop/hadoop-env.sh`\n\n``` bash\nexport YARN_RESOURCEMANAGER_USER=root\nexport YARN_NODEMANAGER_USER=root\n``` \n\n`etc/hadoop/yarn-site.xml`\n\n``` xml\n<!--MapReducelocalclassic yarn -->\n<property>\n\t<name>mapreduce.framework.name</name>\n    <value>yarn</value>\n</property>\n    \n<!-- MR -->\n<property>\n\t<name>mapreduce.application.classpath</name>\n    <value>/usr/local/program/hadoop-3.2.1/etc/hadoop:/usr/local/program/hadoop-3.2.1/share/hadoop/common/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/common/*:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs/*:/usr/local/program/hadoop-3.2.1/share/hadoop/mapreduce/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/mapreduce/*:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn/*</value>\n</property>\n<!--YARNResourceManager-->\n<property>\n\t<name>yarn.resourcemanager.hostname</name>\n\t<value>192.168.100.103</value>\n</property>\n\n<property>\n    <name>yarn.nodemanager.aux-services</name>\n    <value>mapreduce_shuffle</value>\n</property>\n<property>\n    <name>yarn.nodemanager.aux-services.mapreduce.shuffle.class</name>\n    <value>org.apache.hadoop.mapred.ShuffleHandler</value>\n</property>\n\n``` \n\n###### 4MapReduce\n\n`etc/hadoop/mapred-site.xml`\n\n``` xml\n<!--MRYarn-->\n<property>\n\t<name>mapreduce.framework.name</name>\n\t<value>yarn</value>\n</property>\n<!-- MR -->\n<property>\n\t<name>mapreduce.application.classpath</name>     <value>$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*</value>\n</property>\n``` \n\n##### 3.Hadoop\n\n``` bash\n$ xsync ./etc/hadoop/\n``` \n\n##### 4.\n\n#### \n\n1`NameNode`\n\n``` bash\n$  bin/hdfs namenode -formart\n``` \n\n2`192.168.100.102``NameNode`\n\n``` bash\n$ sbin/hadoop-daemon.sh  start namenode\n``` \n\n3`192.168.100.102`,`192.168.100.103``192.168.100.104``DataNode`\n\n``` bash\n$ sbin/hadoop-daemon.sh  start datanode\n``` \n\n41000\n\t\t\t\n\n#### SSH\n\n##### 1.ssh\n\n1\n\t\t\tsship\n2sshHostkeyverificationfailed\n\n``` bash\n$ ssh  192.168.1.103\nTheauthenticityofhost'192.168.1.103(192.168.1.103)'can't\nbeestablished.\nRSAkeyfingerprintis\ncf:1e:de:d7:d0:4c:2d:98:60:b4:fd:ae:b1:2d:ad:06.\nAreyousureyouwanttocontinueconnecting(yes/no)?\nHostkeyverificationfailed.\n``` \n\n3yes\n\n##### 2.\n\n1\n\n![image-20200823180537869](image-20200823180537869.png)\n\n2`192.168.100.102`\n\n``` bash\n$ cd /root/.ssh\n$ ssh-keygen -t rsa\n``` \n\nid_rsaid_rsa.pub\n\n3\n\n``` bash\n$ ssh-copy-id 192.168.100.102\n$ ssh-copy-id 192.168.100.103\n$ ssh-copy-id 192.168.100.104\n``` \n\n4`192.168.100.103`,\n\n\n\n##### 3.`.ssh`~/.ssh\n\n| known_hosts     | ssh(publickey) |\n| --------------- | ------------------------------------ |\n| id_rsa          |                            |\n| id_rsa.pub      |                            |\n| authorized_keys |        |\n\n#### \n\n##### 1.`etc/hadoop/workers`\n\n``` bash\n$ vim etc/hadoop/workers \n``` \n\n\n\n``` bash\n192.168.100.102\n192.168.100.103\n192.168.100.104\n``` \n\n>#### \n>\n>\n\n##### 2.\n\n###### 1\n\nNameNodenamenodedatanodedatalog\n\n``` bash\n$ bin/hdfs namenode -format\n``` \n\n###### 2HDFS\n\n``` bash\n$ sbin/start-dfs.sh\n``` \n\n`jps`\n\n###### 3`YARN`\n\n``` bash\n$ sbin/start-yarn.sh\n``` \n\n###### 3Web`SecondaryNameNode`\n\n``` http\nhttp://192.168.100.102:9870/\n``` \n\n###### 4\n\n ``` bash\n$ bin/hdfs dfsadmin -report\n ``` \n\n\n\n> \n>\n> NameNodeResourceMangerNameNodeYARNResouceManagerYARN\n\n##### 3.\n\n###### 1\n\n``` bash\n$ bin/hdfs dfs -put  ./wcinput/wc.input  /user/wry/input\n``` \n\n###### 2\n\n``` bash\n$ pwd\n``` \n\n``` bash\n/usr/local/program/hadoop-3.2.1/data/tmp/hadoop-root/dfs/data/current/BP-719430212-127.0.0.1-1598525636602/current/finalized/subdir0/subdir0\n``` \n\n\n\n#### /\n\n##### 1./\n\n###### 1/HDFS\n\n``` bash\n$ sbin/hadoop-daemon.sh start/stop  namenode/datanode/secondarynamenode\n``` \n\n###### 2/YARN\n\n``` bash\n$ sbin/yarn-daemon.sh  start/stop  resourcemanager/nodemanager\n``` \n\n##### 2./ssh\n\n###### 1/HDFS\n\n``` bash\n$ sbin/start-dfs.sh/stop-dfs.sh\n``` \n\n###### 2/YARN\n\n``` bash\n$ sbin/start-yarn.sh/stop-yarn.sh\n``` \n\n### crontab\n\n#### \n\ncrontab []\n\n#### \n\n|  |                            |\n| ---- | ------------------------------ |\n| -e   | crontab            |\n| -l   | crontab                |\n| -r   | crontab  |\n\n#### \n\n``` bash\n$ crontab -e\n``` \n\n##### 1crontabvim \n\n``` \n* * * * *  \n``` \n\n|       |                  |                     |\n| --------- | -------------------- | ----------------------- |\n| * |  | 0-59                    |\n| * |    | 0-23                    |\n| * |      | 1-31                    |\n| * |      | 1-12                    |\n| * |      | 0-707 |\n\n##### 2\n\n|  |                                                          |\n| -------- | ------------------------------------------------------------ |\n| *        | * |\n|        | \"0 8,12,16 * * *\" 80120160 |\n| -        | \"0 5 * * 1-6\" ,50 |\n| */n      | \"*/10 * * * *\",10 |\n\n##### 3\n\n|          |                                                          |\n| ------------ | ------------------------------------------------------------ |\n| 45 22 * * *  | 2245                                           |\n| 0 17 * * 1   | 170                                      |\n| 0 5 1,15 * * | 11550                            |\n| 40 4 * * 1-5 | 440                            |\n| */10 4 * * * | 410                        |\n| 0 0 1,15 * 1 | 11500 |\n\n##### 4\n\n- 1`/root/bailongma.txt`11 \n\n  ``` bash\n  */1 * * * * /bin/echo \"11\" >>/root/bailongma.txt\n  ``` \n\n\n\n### \n\n\n\n![image-20200829223326519](image-20200829223326519.png)\n\n\n\n## Linux\n\n### IP\n\n#### VMnet\n\nVMware - NAT VMnet2\n\n![](https://img.jbzj.com/file_images/article/202001/2020011513342421.png)\n\nip,,\n\nA255.0.0.0\nB255.255.0.0\nC255.255.255.0\n\nIP: DHCPIP ()\n\nNAT\n\nip,ip\n\n![Alt](https://img.jbzj.com/file_images/article/202001/2020011513342422.png)\n\n#### \n\n rootcentos8vi /etc/sysconfig/network-scripts/ifcfg-ens33\n\n``` bash\nTYPE=Ethernet\nPROXY_METHOD=none\nBROWSER_ONLY=no\nBOOTPROTO=static #static\nDEFROUTE=yes\nIPV4_FAILURE_FATAL=no\nIPV6INIT=yes\nIPV6_AUTOCONF=yes\nIPV6_DEFROUTE=yes\nIPV6_FAILURE_FATAL=no\nIPV6_ADDR_GEN_MODE=stable-privacy\nNAME=ens33\nUUID=aa18fb34-fea8-4fff-83a4-1ebed631beff\nDEVICE=ens33\nONBOOT=yes #noyes\nGATEWAY=192.168.0.2 #\nIPADDR=192.168.0.150 #\nNETMASK=255.255.255.0 #\nDNS1=8.8.8.8 #DNS1,\nDNS2=223.6.6.6 #DNS2\n``` \n\n :wq\n\n#### : \n\nCentOS 8  : nmcli c reload\n\nCentOS7  /etc/init.d/network restart\n\n`reboot` \n\n\n\n### \n\ncentos8\n\n#### \n\n``` bash\n$ systemctl disable firewalld\n``` \n\n#### \n\n``` bash\n$ systemctl status firewalld.service\n``` \n\n#### \n\n``` bash\n$ systemctl stop firewalld.service\n``` \n\n#### \n\n``` bash\n$ systemctl start firewalld.service\n``` \n\n### JDK\n\n#### \n\n``` bash\n$ tar -zxvf /usr/local/software/jdk1.8.231 -C /usr/local/program/\n``` \n\n#### \n\n``` bash\n$ vim /etc/profile\n``` \n\njava \n\n``` bash\nexport JAVA_HOME=/usr/local/program/jdk1.8.231\nexport CLASS_PATH=.:$JAVA_HOME/lib.tools.jar\nexport PATH=$PATH:$JAVA_HOME/bin\n``` \n\n#### \n\n``` bash\n$ source /etc/profile\n``` \n\n### SSH\n\n#### \n\n``` bash\n$ vim /etc/ssh/sshd_config\n``` \n\n \n\nClientAliveInterval 60\n\n, , \n\nClientAliveCountMax 3 \n\nClientAliveCountMax, \n\n#### \n\n``` bash\n$ service sshd restart\n``` \n\n\n\n``` bash\ntar -zxvf /usr/local/software/hadoop-3.2.1.tar.gz  -C /usr/local/program/\n\nvim /etc/profile\n\n#hadoop \nexport HADOOP_HOME=/usr/local/program/hadoop-3.2.1\nexport PATH=$PATH:$HADOOP_HOME/bin\nexport PATH=$PATH:$HADOOP_HOME/sbin\n\nsource /etc/profile\n\nhadoop version\n``` \n\n","slug":"2023/Hadoop","published":1,"updated":"2024-08-05T11:07:24.314Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiup0001vaib053qfkvr","content":"<h2 id=\"Hadoop\"><a href=\"#Hadoop\" class=\"headerlink\" title=\"Hadoop\"></a>Hadoop</h2><ol>\n<li>hadoopAoache </li>\n<li></li>\n<li>HadoopHadoop</li>\n</ol>\n<h2 id=\"Hadoop\"><a href=\"#Hadoop\" class=\"headerlink\" title=\"Hadoop\"></a>Hadoop</h2><h3 id=\"Lucene\"><a href=\"#Lucene\" class=\"headerlink\" title=\"Lucene\"></a>Lucene</h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"GFS-HDFS\"><a href=\"#GFS-HDFS\" class=\"headerlink\" title=\"GFS&gt;HDFS\"></a>GFS&gt;HDFS</h4><h4 id=\"Map-Reduce-MR\"><a href=\"#Map-Reduce-MR\" class=\"headerlink\" title=\"Map-Reduce&gt;MR\"></a>Map-Reduce&gt;MR</h4><h4 id=\"BigTable-HBase\"><a href=\"#BigTable-HBase\" class=\"headerlink\" title=\"BigTable&gt;HBase\"></a>BigTable&gt;HBase</h4><h2 id=\"Hadoop\"><a href=\"#Hadoop\" class=\"headerlink\" title=\"Hadoop\"></a>Hadoop</h2><h3 id=\"Apache\"><a href=\"#Apache\" class=\"headerlink\" title=\"Apache\"></a>Apache</h3><p></p>\n<h3 id=\"Cloudera\"><a href=\"#Cloudera\" class=\"headerlink\" title=\"Cloudera\"></a>Cloudera</h3><p></p>\n<h3 id=\"Hortonworks\"><a href=\"#Hortonworks\" class=\"headerlink\" title=\"Hortonworks\"></a>Hortonworks</h3><p></p>\n<h2 id=\"Hadoop4\"><a href=\"#Hadoop4\" class=\"headerlink\" title=\"Hadoop4\"></a>Hadoop4</h2><ol>\n<li>HadoopHadoop</li>\n<li></li>\n<li>Mao-Reduce Hadoop</li>\n<li></li>\n</ol>\n<h2 id=\"Hadoop\"><a href=\"#Hadoop\" class=\"headerlink\" title=\"Hadoop\"></a>Hadoop</h2><h3 id=\"1-x-2-x\"><a href=\"#1-x-2-x\" class=\"headerlink\" title=\"1.x 2.x\"></a>1.x 2.x</h3><p><img src=\"/post/2023/Hadoop/image-20200820213620752.png\" alt=\"image-20200820213620752\"></p>\n<h3 id=\"HDFS\"><a href=\"#HDFS\" class=\"headerlink\" title=\"HDFS\"></a>HDFS</h3><h4 id=\"1-NameNode-nn\"><a href=\"#1-NameNode-nn\" class=\"headerlink\" title=\"1.NameNode (nn)\"></a>1.NameNode (nn)</h4><p>DataNode </p>\n<h4 id=\"2-DataNode-dn\"><a href=\"#2-DataNode-dn\" class=\"headerlink\" title=\"2.DataNode (dn)\"></a>2.DataNode (dn)</h4><p></p>\n<h4 id=\"3-Secondary-NameNode-2nn\"><a href=\"#3-Secondary-NameNode-2nn\" class=\"headerlink\" title=\"3.Secondary NameNode (2nn)\"></a>3.Secondary NameNode (2nn)</h4><p>HDFSHDFS</p>\n<h3 id=\"YARN-\"><a href=\"#YARN-\" class=\"headerlink\" title=\"YARN \"></a>YARN </h3><h4 id=\"ResourceManage-RM-\"><a href=\"#ResourceManage-RM-\" class=\"headerlink\" title=\"ResourceManage(RM)\"></a>ResourceManage(RM)</h4><ul>\n<li></li>\n<li>NodeManage</li>\n<li>ApplicationMaster</li>\n<li></li>\n</ul>\n<h4 id=\"NodeManage-NM-\"><a href=\"#NodeManage-NM-\" class=\"headerlink\" title=\"NodeManage(NM)\"></a>NodeManage(NM)</h4><ul>\n<li></li>\n<li>ResourceManage</li>\n<li>ApplicationMaster</li>\n</ul>\n<h4 id=\"ApplicationMaster-AM-\"><a href=\"#ApplicationMaster-AM-\" class=\"headerlink\" title=\"ApplicationMaster(AM)\"></a>ApplicationMaster(AM)</h4><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h4 id=\"Container\"><a href=\"#Container\" class=\"headerlink\" title=\"Container\"></a>Container</h4><ul>\n<li>ContainerYARNCPU,</li>\n</ul>\n<h3 id=\"MapReduce\"><a href=\"#MapReduce\" class=\"headerlink\" title=\"MapReduce\"></a>MapReduce</h3><p>MapReduce map  Reduce</p>\n<ol>\n<li>Map </li>\n<li>ReduceMap</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/post/2023/Hadoop/image-20200820224123902.png\" alt=\"image-20200820224123902\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><h3 id=\"2-JDK\"><a href=\"#2-JDK\" class=\"headerlink\" title=\"2.JDK\"></a>2.JDK</h3><h3 id=\"3-Hadoop\"><a href=\"#3-Hadoop\" class=\"headerlink\" title=\"3.Hadoop\"></a>3.Hadoop</h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n<p> <code>/etc/profile</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> HADOOP_HOME=/usr/local/hadoop-3.2.1</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HADOOP_HOME</span>/bin</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HADOOP_HOME</span>/sbin</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">source</span> /ect/profile</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"4-Hadoop\"><a href=\"#4-Hadoop\" class=\"headerlink\" title=\"4.Hadoop\"></a>4.Hadoop</h3><ul>\n<li><p><strong>bin</strong></p>\n<p>HadoopHDFS,YARN</p>\n</li>\n<li><p><strong>etc</strong> </p>\n<p>Hadoop</p>\n</li>\n<li><p><strong>lib</strong></p>\n<p>Hadoop</p>\n</li>\n<li><p><strong>sbin</strong></p>\n<p>Hadoop</p>\n</li>\n<li><p><strong>share</strong></p>\n<p>Hadoopjar</p>\n</li>\n</ul>\n<h3 id=\"5-Hadoop\"><a href=\"#5-Hadoop\" class=\"headerlink\" title=\"5.Hadoop\"></a>5.Hadoop</h3><p>Hadoop<a href=\"https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html\">https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html</a></p>\n<h2 id=\"Hadoop\"><a href=\"#Hadoop\" class=\"headerlink\" title=\"Hadoop\"></a>Hadoop</h2><p>Hadoop</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"Grep\"><a href=\"#Grep\" class=\"headerlink\" title=\"Grep\"></a>Grep</h4><p>1.hadoop-3.2.1input</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">mkdir</span> input</span><br></pre></td></tr></table></figure>\n\n<p>2.Hadoopxmlinput</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cp</span>  etc/hadoop/*.xml  input</span><br></pre></td></tr></table></figure>\n\n<p>3.shareMapReduce</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop\tjar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar grep input  output  <span class=\"string\">&#x27;dfs[a-z.]+&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p>4.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span>  output/*</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"WordCount\"><a href=\"#WordCount\" class=\"headerlink\" title=\"WordCount\"></a>WordCount</h4><p>1.hadoop-3.2.1wcinput</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">mkdir</span> wcinput</span><br></pre></td></tr></table></figure>\n\n<p>2.wcinputwc.input</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> wcinput</span><br><span class=\"line\"></span><br><span class=\"line\">$ touchwc.input</span><br></pre></td></tr></table></figure>\n\n<p>3.wc.input</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim  wc.input</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hadoopyarn</span><br><span class=\"line\">hadoopmapreduce</span><br><span class=\"line\">atguigu</span><br><span class=\"line\">atguigu</span><br></pre></td></tr></table></figure>\n\n<p>wq</p>\n<p>4.Hadoop</p>\n<p>5.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount wcinput wcoutput</span><br></pre></td></tr></table></figure>\n\n<p>6.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cat</span> wcoutput /part-r-00000</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">atguigu2</span><br><span class=\"line\">hadoop2</span><br><span class=\"line\">mapreduce1</span><br><span class=\"line\">yarn1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"HDFSMapReduce\"><a href=\"#HDFSMapReduce\" class=\"headerlink\" title=\"HDFSMapReduce\"></a>HDFSMapReduce</h4><h5 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h5><p>1<br>2<br>3WordCount</p>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h5><h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><p>Hadoopetc</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> ./etc</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>hadoop-env.sh</p>\n<p>LinuxJDK</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">echo</span> <span class=\"variable\">$JAVA_HOME</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/local/jdk1.8.0_121</span><br></pre></td></tr></table></figure>\n\n<p>JAVA_HOME</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> JAVA_HOME=/usr/local/jdk1.8.0_121</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>core-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--HDFSNameNode--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>fs.defaultFS<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://localhost:9000<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--Hadoop--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hadoop.tmp.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>/usr/local/hadoop-3.2.1/data/tmp<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>hdfs-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--HDFS--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.replication<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h6 id=\"2SSH\"><a href=\"#2SSH\" class=\"headerlink\" title=\"2SSH\"></a>2SSH</h6><ul>\n<li><p>SSH</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ssh  localhost</span><br></pre></td></tr></table></figure>\n\n<p>SSH</p>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ssh-keygen -t rsa -P<span class=\"string\">&#x27;&#x27;</span>-f/ .ssh / id_rsa </span><br><span class=\"line\">$ <span class=\"built_in\">cat</span>/ .ssh / id_rsa.pub &gt;&gt;/ .ssh / authorized_keys </span><br><span class=\"line\">$ <span class=\"built_in\">chmod</span> 0600/ .ssh / authorized_keys</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h6 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h6><ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs namenode -format</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>NameNodeDataNode</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ./sbin/start-dfs.sh</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@iZ2zednzb8iugz3kgudq9bZ hadoop-3.2.1]<span class=\"comment\"># ./sbin/stop-dfs.sh</span></span><br><span class=\"line\">Stopping namenodes on [localhost]</span><br><span class=\"line\">ERROR: Attempting to operate on hdfs namenode as root</span><br><span class=\"line\">ERROR: but there is no HDFS_NAMENODE_USER defined. Aborting operation.</span><br><span class=\"line\">Stopping datanodes</span><br><span class=\"line\">ERROR: Attempting to operate on hdfs datanode as root</span><br><span class=\"line\">ERROR: but there is no HDFS_DATANODE_USER defined. Aborting operation.</span><br><span class=\"line\">Stopping secondary namenodes [iZ2zednzb8iugz3kgudq9bZ]</span><br><span class=\"line\">ERROR: Attempting to operate on hdfs secondarynamenode as root</span><br><span class=\"line\">ERROR: but there is no HDFS_SECONDARYNAMENODE_USER defined. Aborting operation.</span><br></pre></td></tr></table></figure>\n\n<p> <code>hadoop-env.sh</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HDFS_DATANODE_USER=root  </span><br><span class=\"line\">HDFS_NAMENODE_USER=root  </span><br><span class=\"line\">HDFS_SECONDARYNAMENODE_USER=root </span><br></pre></td></tr></table></figure>\n</li>\n<li><p>WebNameNode</p>\n<figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://localhost:9870/</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>MapReduceHDFS</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">mkdir</span> /user/root</span><br><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">mkdir</span> /user/&lt;&gt;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">mkdir</span> -p  /user/wry</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822090658863.png\" alt=\"image-20200822090658863\"></p>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">ls</span> -R /</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822090905199.png\" alt=\"image-20200822090905199\"></p>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">mkdir</span> -p /user/wry/input</span><br><span class=\"line\">$ bin/hdfs dfs -put etc/hadoop/*.xml /user/wry/input</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822091216510.png\" alt=\"image-20200822091216510\"></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822091335115.png\" alt=\"image-20200822091335115\"></p>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar grep /user/wry/input /user/wry/output <span class=\"string\">&#x27;dfs[a-z.]+&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822091809558.png\" alt=\"image-20200822091809558\"></p>\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">ls</span> -r /user/wry/output</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">cat</span> /user/wry/output/&lt;&gt;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822092048172.png\" alt=\"image-20200822092048172\"></p>\n<p>or</p>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -get /user/wry/output /usr/local/wryoutput </span><br><span class=\"line\">$ <span class=\"built_in\">cat</span> /usr/local/wryoutput/*</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822093255847.png\" alt=\"image-20200822093255847\"></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/stop-dfs.sh</span><br></pre></td></tr></table></figure></li>\n</ul>\n<blockquote>\n<p><strong>NameNode </strong></p>\n<p>1.</p>\n<p>2.data log</p>\n<p>3.</p>\n</blockquote>\n<blockquote>\n<p><strong> NameNode</strong></p>\n<p>NameNodeId,NameNodeDataNodeIdNameNodedatalogNameNode</p>\n</blockquote>\n<p><img src=\"/post/2023/Hadoop/image-20200822094801817.png\" alt=\"image-20200822094801817\"></p>\n<h4 id=\"YARNMapReduce\"><a href=\"#YARNMapReduce\" class=\"headerlink\" title=\"YARNMapReduce\"></a>YARNMapReduce</h4><h5 id=\"1--1\"><a href=\"#1--1\" class=\"headerlink\" title=\"1.\"></a>1.</h5><p>1YARNMR<br>2<br>3YARNWordCount</p>\n<h5 id=\"2--1\"><a href=\"#2--1\" class=\"headerlink\" title=\"2.\"></a>2.</h5><h6 id=\"1-1\"><a href=\"#1-1\" class=\"headerlink\" title=\"1\"></a>1</h6><p><code>etc/hadoop/mapred-site.xml</code>:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--MapReducelocalclassic yarn --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  \t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.framework.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>yarn<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- MR --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.application.classpath<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p><code>etc/hadoop/yarn-site.xml</code>:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Reduce --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.aux-services<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mapreduce_shuffle<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">&lt;!--yarn--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span> \t\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">&lt;!--YARNResourceManager--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.resourcemanager.hostname<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>0.0.0.0<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/start-yarn.sh</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822100056038.png\" alt=\"image-20200822100056038\"></p>\n<p><code>etc/hadoop/hadoop-env.sh</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> YARN_RESOURCEMANAGER_USER=root</span><br><span class=\"line\"><span class=\"built_in\">export</span> YARN_NODEMANAGER_USER=root</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822102024933.png\" alt=\"image-20200822102024933\"></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822102108817.png\" alt=\"image-20200822102108817\"></p>\n<p>ResourceManagerweb</p>\n<p>ResourceManager - <code>http://localhost:8088/</code></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822111645219.png\" alt=\"image-20200822111645219\"></p>\n<p>job</p>\n<ul>\n<li>hadoop </li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -put wcinput/wc.input  /user/wry/wcinput</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount /user/wry/wcinput /user/wry/wcoutput</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop dfs -<span class=\"built_in\">ls</span> -r /user/wry/wcoutput</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<ul>\n<li><code>etc/hadoop/mapred-site.xml</code></li>\n</ul>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.jobhistory.address<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>0.0.0.0:10020<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--web--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>0.0.0.0:19888<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/mr-jobhistory-daemon.sh starthistoryserver</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ jps</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>JobHistory</p>\n<p>JobHistory -   <a href=\"http://hadoop101:19888/jobhistory\">http://hadoop101:19888/jobhistory</a></p>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>HDFS<br></p>\n<p>NodeManagerResourceManager<br>HistoryManager</p>\n<p></p>\n<ul>\n<li><p> <code>etc/hadoop/yarn-site.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.log-aggregation-enable<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--7--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>604800<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>NodeManagerResourceManagerHistoryManager</p>\n<ul>\n<li>  NodeManagerResourceManagerName NodeDataNode</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/stop-all.sh</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>  NodeManagerResourceManager</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/stop-yarn.sh</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>  Name NodeDataNode</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/stop-dfs.sh</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>  HistoryManager</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/mr-jobhistory-daemon.sh stop historyserver </span><br></pre></td></tr></table></figure>\n</li>\n<li><p>NodeManagerResourceManagerHistoryManager</p>\n</li>\n<li><p>HDFS</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop dfs -<span class=\"built_in\">rm</span> -f -r /user/wry/wcoutput</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>WordCount</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount /user/wry/wcinput /user/wry/wcoutput</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822140954237.png\" alt=\"image-20200822140954237\"></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822141013068.png\" alt=\"image-20200822141013068\"></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822141028970.png\" alt=\"image-20200822141028970\"></p>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Hadoop<br></p>\n<h5 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h5><p>Hadoopjar</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\"></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">core-default.xml</td>\n<td>hadoop-common-2.7.2.jar&#x2F;core-default.xml</td>\n</tr>\n<tr>\n<td align=\"left\">hdfs-default.xml</td>\n<td>hadoop-hdfs-2.7.2.jar&#x2F;hdfs-default.xml</td>\n</tr>\n<tr>\n<td align=\"left\">yarn-default.xml</td>\n<td>hadoop-yarn-common-2.7.2.jar&#x2F;yarn-default.xml</td>\n</tr>\n<tr>\n<td align=\"left\">mapred-default.xml</td>\n<td>hadoop-mapreduce-client-core-2.7.2.jar&#x2F;mapred-default.xml</td>\n</tr>\n</tbody></table>\n<h5 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h5><p>core-site.xmlhdfs-site.xmlyarn-site.xmlmapred-site.xml<br>$HADOOP_HOME&#x2F;etc&#x2F;hadoop</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>13ip<br>2JDK<br>3<br>4Hadoop<br>5<br>6<br>7<br>8ssh<br>9</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"1IP\"><a href=\"#1IP\" class=\"headerlink\" title=\"1IP\"></a>1IP</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim /etc/sysconfig/network-scripts/ifcfg-ens33 </span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TYPE=Ethernet</span><br><span class=\"line\">PROXY_METHOD=none</span><br><span class=\"line\">BROWSER_ONLY=no</span><br><span class=\"line\">BOOTPROTO=static\t\t<span class=\"comment\">#static</span></span><br><span class=\"line\">DEFROUTE=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV4_FAILURE_FATAL=no</span><br><span class=\"line\">IPV6INIT=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_AUTOCONF=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_DEFROUTE=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_FAILURE_FATAL=no</span><br><span class=\"line\">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class=\"line\">NAME=ens33</span><br><span class=\"line\">UUID=67b4d72d-1ff5-4e3e-a089-e1579700eba8</span><br><span class=\"line\">DEVICE=ens33</span><br><span class=\"line\">ONBOOT=<span class=\"built_in\">yes</span>\t\t\t\t<span class=\"comment\">#yes</span></span><br><span class=\"line\"></span><br><span class=\"line\">IPADDR=192.168.100.102  <span class=\"comment\"># ip</span></span><br><span class=\"line\">NETMASK=255.255.255.0   <span class=\"comment\">#</span></span><br><span class=\"line\">GATEWAY=192.168.100.1\t<span class=\"comment\">#</span></span><br><span class=\"line\">DNS1=8.8.8.8\t\t\t<span class=\"comment\">#DNS</span></span><br><span class=\"line\">DNS2=223.6.6.6</span><br><span class=\"line\"></span><br><span class=\"line\">PREFIX=24</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h5><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim /etc/hotos</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class=\"line\">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class=\"line\">192.168.100.102 hadoop102</span><br><span class=\"line\">192.168.100.103 hadoop103</span><br><span class=\"line\">192.168.100.104 hadoop104</span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"xsync\"><a href=\"#xsync\" class=\"headerlink\" title=\"xsync\"></a>xsync</h4><h5 id=\"1-scpsecurecopy\"><a href=\"#1-scpsecurecopy\" class=\"headerlink\" title=\"1.scpsecurecopy\"></a>1.scpsecurecopy</h5><h6 id=\"1scp\"><a href=\"#1scp\" class=\"headerlink\" title=\"1scp\"></a>1scp</h6><p><code>scp</code>fromserver1toserver2</p>\n<h6 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp\t\t-r  \t<span class=\"variable\">$pdir</span>/<span class=\"variable\">$fname</span>\t\t<span class=\"variable\">$user</span>@hadoop<span class=\"variable\">$host</span>:<span class=\"variable\">$pdir</span>/<span class=\"variable\">$fname</span></span><br><span class=\"line\">\t  \t \t   @:/</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h6><p>a<code>192.168.100.101</code><code>192.168.100.101</code><code>/usr/local/software</code><code>192.168.100.102</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ scp -r /usr/local/software/*  root@192.168.100.102:/usr/local/software</span><br></pre></td></tr></table></figure>\n\n<p>b<code>192.168.100.103</code><code>192.168.100.101</code><code>/usr/local/software</code><br><code>192.168.100.103</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ scp -r root@192.168.100.101:/usr/local/software/*  /usr/local/software/</span><br></pre></td></tr></table></figure>\n\n<p>c<code>192.168.100.103</code><code>192.168.100.101</code><code>/usr/local/software</code><br><code>192.168.100.104</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ scp -r root@192.168.100.101:/usr/local/software/*  root@192.168.100.104:/usr/local/software/</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2-rsync\"><a href=\"#2-rsync\" class=\"headerlink\" title=\"2.rsync\"></a>2.rsync</h5><p><code>rsync</code></p>\n<p><strong><code>rsync</code><code>scp</code></strong></p>\n<p><code>rsync</code><code>scp</code><code>rsync</code><code>scp</code></p>\n<h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rsync\t-rvl\t\t<span class=\"variable\">$pdir</span>/<span class=\"variable\">$fname</span>\t\t\t<span class=\"variable\">$user</span>@hadoop<span class=\"variable\">$host</span>:<span class=\"variable\">$pdir</span>/<span class=\"variable\">$fname</span></span><br><span class=\"line\">\t  \t\t/\t\t@:/</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-r</td>\n<td></td>\n</tr>\n<tr>\n<td>-v</td>\n<td></td>\n</tr>\n<tr>\n<td>-l</td>\n<td></td>\n</tr>\n</tbody></table>\n<h6 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h6><p>a<code>192.168.100.101</code><code>/usr/local/software</code><code>192.168.100.102</code>root<br><code>/usr/local/software</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ rsync  -rvl /usr/local/software/*  root@192.168.100.102:/usr/local/software/</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"3-xsync\"><a href=\"#3-xsync\" class=\"headerlink\" title=\"3.xsync\"></a>3.xsync</h5><h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><p></p>\n<h6 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h6><p>arsync</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rsync -rvl  /usr/local/program/*  root@192.168.100.103:/usr/local/program/</span><br></pre></td></tr></table></figure>\n\n<p>b<br>xsync<br>c<code>/home/&lt;&gt;/bin</code>root</p>\n<h6 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h6><p>a<code>/home/&lt;&gt;/bin</code>binbinxsync</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /home/&lt;&gt;</span><br><span class=\"line\">$ <span class=\"built_in\">mkdir</span> bin</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> bin</span><br><span class=\"line\">$ vim xsync</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"comment\">#1</span></span><br><span class=\"line\">pcount=<span class=\"variable\">$#</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>((pcount==<span class=\"number\">0</span>));<span class=\"keyword\">then</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> noargs;</span><br><span class=\"line\"><span class=\"built_in\">exit</span>;</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"comment\">#2</span></span><br><span class=\"line\">p1=<span class=\"variable\">$1</span></span><br><span class=\"line\">fname=`<span class=\"built_in\">basename</span> <span class=\"variable\">$p1</span>`</span><br><span class=\"line\"><span class=\"built_in\">echo</span>  fname=<span class=\"variable\">$fname</span></span><br><span class=\"line\"><span class=\"comment\">#3</span></span><br><span class=\"line\">pdir=`<span class=\"built_in\">cd</span> -P $(<span class=\"built_in\">dirname</span> <span class=\"variable\">$p1</span>);<span class=\"built_in\">pwd</span>`</span><br><span class=\"line\"><span class=\"built_in\">echo</span> pdir=<span class=\"variable\">$pdir</span></span><br><span class=\"line\"><span class=\"comment\">#4</span></span><br><span class=\"line\">user=`<span class=\"built_in\">whoami</span>`</span><br><span class=\"line\"><span class=\"comment\">#5</span></span><br><span class=\"line\"><span class=\"keyword\">for</span>((host=<span class=\"number\">103</span>;host&lt;<span class=\"number\">105</span>;host++));<span class=\"keyword\">do</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -------------------192.168.100.<span class=\"variable\">$host</span>--------------</span><br><span class=\"line\">rsync -rvl <span class=\"variable\">$pdir</span>/<span class=\"variable\">$fname</span>  <span class=\"variable\">$user</span>@192.168.100.<span class=\"variable\">$host</span>:<span class=\"variable\">$pdir</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<p>bxsync</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">chmod</span> 777 xsync</span><br></pre></td></tr></table></figure>\n\n<p>cxsync</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ xsync  /home/&lt;&gt;/bin</span><br></pre></td></tr></table></figure>\n\n\n\n\n<blockquote>\n<p><strong></strong></p>\n<p><code>xsync</code><code>/home/&lt;&gt;/bin</code></p>\n<p><code>xsync</code><code>/usr/local/bin</code></p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h5><table>\n<thead>\n<tr>\n<th></th>\n<th align=\"left\">192.168.100.102 -hadoop102</th>\n<th>192.168.100.103-hadoop103</th>\n<th>192.168.100.104-hadoop104</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>HDFS</td>\n<td align=\"left\">NameNode <br /> DataNode</td>\n<td><br />DataNode</td>\n<td>SecondaryNameNode <br />DataNode</td>\n</tr>\n<tr>\n<td>YARN</td>\n<td align=\"left\"><br />NodeManage</td>\n<td>ResourceManage  <br />NodeManage</td>\n<td><br />NodeManage</td>\n</tr>\n</tbody></table>\n<p>IP </p>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h5><h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><p><code>192.168.100.102</code> </p>\n<p><code>etc/hadoop/core-site.xml</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /usr/local/program/hadoop3.2.1</span><br><span class=\"line\">$ vim etc/hadoop/core-site.xml</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--HDFSNameNode--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>fs.defaultFS<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://192.168.100.102:9000<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--Hadoop--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hadoop.tmp.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>/usr/local/program/hadoop-3.2.1/data/tmp/hadoop-$&#123;user.name&#125;<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h6 id=\"2HDFS\"><a href=\"#2HDFS\" class=\"headerlink\" title=\"2HDFS\"></a>2HDFS</h6><p><code>etc/hadoop/hadoop-env.sh</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> JAVA_HOME=/usr/local/program/jdk1.8 </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">export</span> HDFS_DATANODE_USER=root  </span><br><span class=\"line\"><span class=\"built_in\">export</span> HDFS_NAMENODE_USER=root  </span><br><span class=\"line\"><span class=\"built_in\">export</span> HDFS_SECONDARYNAMENODE_USER=root </span><br></pre></td></tr></table></figure>\n\n<p><code>etc/hadoop/hdfs-site.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.replication<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>3<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--Hadoop--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>192.168.100.104:50090<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--HadoopNameNode--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.http.address<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>192.168.100.102:9870<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h6 id=\"3YARN\"><a href=\"#3YARN\" class=\"headerlink\" title=\"3YARN\"></a>3YARN</h6><p> shell</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hadoop  classpath</span><br></pre></td></tr></table></figure>\n\n<p>    yarn  yarn-site.xml <name>yarn.application.classpath</name></p>\n<p><code>etc/hadoop/hadoop-env.sh</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> YARN_RESOURCEMANAGER_USER=root</span><br><span class=\"line\"><span class=\"built_in\">export</span> YARN_NODEMANAGER_USER=root</span><br></pre></td></tr></table></figure>\n\n<p><code>etc/hadoop/yarn-site.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--MapReducelocalclassic yarn --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.framework.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>yarn<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">&lt;!-- MR --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.application.classpath<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>/usr/local/program/hadoop-3.2.1/etc/hadoop:/usr/local/program/hadoop-3.2.1/share/hadoop/common/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/common/*:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs/*:/usr/local/program/hadoop-3.2.1/share/hadoop/mapreduce/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/mapreduce/*:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn/*<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--YARNResourceManager--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.resourcemanager.hostname<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>192.168.100.103<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.aux-services<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mapreduce_shuffle<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.aux-services.mapreduce.shuffle.class<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>org.apache.hadoop.mapred.ShuffleHandler<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h6 id=\"4MapReduce\"><a href=\"#4MapReduce\" class=\"headerlink\" title=\"4MapReduce\"></a>4MapReduce</h6><p><code>etc/hadoop/mapred-site.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--MRYarn--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.framework.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>yarn<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- MR --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.application.classpath<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>     <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"3-Hadoop\"><a href=\"#3-Hadoop\" class=\"headerlink\" title=\"3.Hadoop\"></a>3.Hadoop</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ xsync ./etc/hadoop/</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h5><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1<code>NameNode</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$  bin/hdfs namenode -formart</span><br></pre></td></tr></table></figure>\n\n<p>2<code>192.168.100.102</code><code>NameNode</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/hadoop-daemon.sh  start namenode</span><br></pre></td></tr></table></figure>\n\n<p>3<code>192.168.100.102</code>,<code>192.168.100.103</code><code>192.168.100.104</code><code>DataNode</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/hadoop-daemon.sh  start datanode</span><br></pre></td></tr></table></figure>\n\n<p>41000<br>            </p>\n<h4 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h4><h5 id=\"1-ssh\"><a href=\"#1-ssh\" class=\"headerlink\" title=\"1.ssh\"></a>1.ssh</h5><p>1<br>            sship<br>2sshHostkeyverificationfailed</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ssh  192.168.1.103</span><br><span class=\"line\">Theauthenticityofhost<span class=\"string\">&#x27;192.168.1.103(192.168.1.103)&#x27;</span>can<span class=\"string\">&#x27;t</span></span><br><span class=\"line\"><span class=\"string\">beestablished.</span></span><br><span class=\"line\"><span class=\"string\">RSAkeyfingerprintis</span></span><br><span class=\"line\"><span class=\"string\">cf:1e:de:d7:d0:4c:2d:98:60:b4:fd:ae:b1:2d:ad:06.</span></span><br><span class=\"line\"><span class=\"string\">Areyousureyouwanttocontinueconnecting(yes/no)?</span></span><br><span class=\"line\"><span class=\"string\">Hostkeyverificationfailed.</span></span><br></pre></td></tr></table></figure>\n\n<p>3yes</p>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h5><p>1</p>\n<p><img src=\"/post/2023/Hadoop/image-20200823180537869.png\" alt=\"image-20200823180537869\"></p>\n<p>2<code>192.168.100.102</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /root/.ssh</span><br><span class=\"line\">$ ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>\n\n<p>id_rsaid_rsa.pub</p>\n<p>3</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ssh-copy-id 192.168.100.102</span><br><span class=\"line\">$ ssh-copy-id 192.168.100.103</span><br><span class=\"line\">$ ssh-copy-id 192.168.100.104</span><br></pre></td></tr></table></figure>\n\n<p>4<code>192.168.100.103</code>,</p>\n<h5 id=\"3-ssh-ssh\"><a href=\"#3-ssh-ssh\" class=\"headerlink\" title=\"3..ssh~&#x2F;.ssh\"></a>3.<code>.ssh</code>~&#x2F;.ssh</h5><table>\n<thead>\n<tr>\n<th>known_hosts</th>\n<th>ssh(publickey)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>id_rsa</td>\n<td></td>\n</tr>\n<tr>\n<td>id_rsa.pub</td>\n<td></td>\n</tr>\n<tr>\n<td>authorized_keys</td>\n<td></td>\n</tr>\n</tbody></table>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"1-etc-hadoop-workers\"><a href=\"#1-etc-hadoop-workers\" class=\"headerlink\" title=\"1.etc/hadoop/workers\"></a>1.<code>etc/hadoop/workers</code></h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim etc/hadoop/workers </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">192.168.100.102</span><br><span class=\"line\">192.168.100.103</span><br><span class=\"line\">192.168.100.104</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n</blockquote>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h5><h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><p>NameNodenamenodedatanodedatalog</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs namenode -format</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"2HDFS\"><a href=\"#2HDFS\" class=\"headerlink\" title=\"2HDFS\"></a>2HDFS</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/start-dfs.sh</span><br></pre></td></tr></table></figure>\n\n<p><code>jps</code></p>\n<h6 id=\"3YARN\"><a href=\"#3YARN\" class=\"headerlink\" title=\"3YARN\"></a>3<code>YARN</code></h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/start-yarn.sh</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"3WebSecondaryNameNode\"><a href=\"#3WebSecondaryNameNode\" class=\"headerlink\" title=\"3WebSecondaryNameNode\"></a>3Web<code>SecondaryNameNode</code></h6><figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://192.168.100.102:9870/</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"4\"><a href=\"#4\" class=\"headerlink\" title=\"4\"></a>4</h6> <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfsadmin -report</span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p></p>\n<p>NameNodeResourceMangerNameNodeYARNResouceManagerYARN</p>\n</blockquote>\n<h5 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h5><h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -put  ./wcinput/wc.input  /user/wry/input</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">pwd</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/local/program/hadoop-3.2.1/data/tmp/hadoop-root/dfs/data/current/BP-719430212-127.0.0.1-1598525636602/current/finalized/subdir0/subdir0</span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"&#x2F;\"></a>&#x2F;</h4><h5 id=\"1--\"><a href=\"#1--\" class=\"headerlink\" title=\"1.&#x2F;\"></a>1.&#x2F;</h5><h6 id=\"1-HDFS\"><a href=\"#1-HDFS\" class=\"headerlink\" title=\"1&#x2F;HDFS\"></a>1&#x2F;HDFS</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/hadoop-daemon.sh start/stop  namenode/datanode/secondarynamenode</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"2-YARN\"><a href=\"#2-YARN\" class=\"headerlink\" title=\"2&#x2F;YARN\"></a>2&#x2F;YARN</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/yarn-daemon.sh  start/stop  resourcemanager/nodemanager</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2--ssh\"><a href=\"#2--ssh\" class=\"headerlink\" title=\"2.&#x2F;ssh\"></a>2.&#x2F;ssh</h5><h6 id=\"1-HDFS\"><a href=\"#1-HDFS\" class=\"headerlink\" title=\"1&#x2F;HDFS\"></a>1&#x2F;HDFS</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/start-dfs.sh/stop-dfs.sh</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"2-YARN\"><a href=\"#2-YARN\" class=\"headerlink\" title=\"2&#x2F;YARN\"></a>2&#x2F;YARN</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/start-yarn.sh/stop-yarn.sh</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"crontab\"><a href=\"#crontab\" class=\"headerlink\" title=\"crontab\"></a>crontab</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>crontab []</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-e</td>\n<td>crontab </td>\n</tr>\n<tr>\n<td>-l</td>\n<td>crontab</td>\n</tr>\n<tr>\n<td>-r</td>\n<td>crontab </td>\n</tr>\n</tbody></table>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ crontab -e</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"1crontabvim-\"><a href=\"#1crontabvim-\" class=\"headerlink\" title=\"1crontabvim \"></a>1crontabvim </h5><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">* * * * *  </span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>*</td>\n<td></td>\n<td>0-59</td>\n</tr>\n<tr>\n<td>*</td>\n<td></td>\n<td>0-23</td>\n</tr>\n<tr>\n<td>*</td>\n<td></td>\n<td>1-31</td>\n</tr>\n<tr>\n<td>*</td>\n<td></td>\n<td>1-12</td>\n</tr>\n<tr>\n<td>*</td>\n<td></td>\n<td>0-707</td>\n</tr>\n</tbody></table>\n<h5 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h5><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>*</td>\n<td>*</td>\n</tr>\n<tr>\n<td></td>\n<td>0 8,12,16 * * * 80120160</td>\n</tr>\n<tr>\n<td>-</td>\n<td>0 5 * * 1-6 ,50</td>\n</tr>\n<tr>\n<td>*&#x2F;n</td>\n<td>*&#x2F;10 * * * *,10</td>\n</tr>\n</tbody></table>\n<h5 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h5><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>45 22 * * *</td>\n<td>2245 </td>\n</tr>\n<tr>\n<td>0 17 * * 1</td>\n<td>170</td>\n</tr>\n<tr>\n<td>0 5 1,15 * *</td>\n<td>11550</td>\n</tr>\n<tr>\n<td>40 4 * * 1-5</td>\n<td>440 </td>\n</tr>\n<tr>\n<td>*&#x2F;10 4 * * *</td>\n<td>410</td>\n</tr>\n<tr>\n<td>0 0 1,15 * 1</td>\n<td>11500</td>\n</tr>\n</tbody></table>\n<h5 id=\"4\"><a href=\"#4\" class=\"headerlink\" title=\"4\"></a>4</h5><ul>\n<li><p>1<code>/root/bailongma.txt</code>11 </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">*/1 * * * * /bin/echo <span class=\"string\">&quot;11&quot;</span> &gt;&gt;/root/bailongma.txt</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><img src=\"/post/2023/Hadoop/image-20200829223326519.png\" alt=\"image-20200829223326519\"></p>\n<h2 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h2><h3 id=\"IP\"><a href=\"#IP\" class=\"headerlink\" title=\"IP\"></a>IP</h3><h4 id=\"VMnet\"><a href=\"#VMnet\" class=\"headerlink\" title=\"VMnet\"></a>VMnet</h4><p>VMware - NAT VMnet2</p>\n<p><img src=\"https://img.jbzj.com/file_images/article/202001/2020011513342421.png\" alt=\"\"></p>\n<p>ip,,</p>\n<p>A255.0.0.0<br>B255.255.0.0<br>C255.255.255.0</p>\n<p>IP: DHCPIP ()</p>\n<p>NAT</p>\n<p>ip,ip</p>\n<p><img src=\"https://img.jbzj.com/file_images/article/202001/2020011513342422.png\" alt=\"Alt\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> rootcentos8vi &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TYPE=Ethernet</span><br><span class=\"line\">PROXY_METHOD=none</span><br><span class=\"line\">BROWSER_ONLY=no</span><br><span class=\"line\">BOOTPROTO=static <span class=\"comment\">#static</span></span><br><span class=\"line\">DEFROUTE=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV4_FAILURE_FATAL=no</span><br><span class=\"line\">IPV6INIT=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_AUTOCONF=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_DEFROUTE=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_FAILURE_FATAL=no</span><br><span class=\"line\">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class=\"line\">NAME=ens33</span><br><span class=\"line\">UUID=aa18fb34-fea8-4fff-83a4-1ebed631beff</span><br><span class=\"line\">DEVICE=ens33</span><br><span class=\"line\">ONBOOT=<span class=\"built_in\">yes</span> <span class=\"comment\">#noyes</span></span><br><span class=\"line\">GATEWAY=192.168.0.2 <span class=\"comment\">#</span></span><br><span class=\"line\">IPADDR=192.168.0.150 <span class=\"comment\">#</span></span><br><span class=\"line\">NETMASK=255.255.255.0 <span class=\"comment\">#</span></span><br><span class=\"line\">DNS1=8.8.8.8 <span class=\"comment\">#DNS1,</span></span><br><span class=\"line\">DNS2=223.6.6.6 <span class=\"comment\">#DNS2</span></span><br></pre></td></tr></table></figure>\n\n<p> :wq</p>\n<h4 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\": \"></a>: </h4><p>CentOS 8  : nmcli c reload</p>\n<p>CentOS7  &#x2F;etc&#x2F;init.d&#x2F;network restart</p>\n<p><code>reboot</code> </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>centos8</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ systemctl <span class=\"built_in\">disable</span> firewalld</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ systemctl status firewalld.service</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ systemctl stop firewalld.service</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ systemctl start firewalld.service</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"JDK\"><a href=\"#JDK\" class=\"headerlink\" title=\"JDK\"></a>JDK</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ tar -zxvf /usr/local/software/jdk1.8.231 -C /usr/local/program/</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim /etc/profile</span><br></pre></td></tr></table></figure>\n\n<p>java </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> JAVA_HOME=/usr/local/program/jdk1.8.231</span><br><span class=\"line\"><span class=\"built_in\">export</span> CLASS_PATH=.:<span class=\"variable\">$JAVA_HOME</span>/lib.tools.jar</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$JAVA_HOME</span>/bin</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">source</span> /etc/profile</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n<p>ClientAliveInterval 60</p>\n<p>, , </p>\n<p>ClientAliveCountMax 3 </p>\n<p>ClientAliveCountMax, </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ service sshd restart</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf /usr/local/software/hadoop-3.2.1.tar.gz  -C /usr/local/program/</span><br><span class=\"line\"></span><br><span class=\"line\">vim /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#hadoop </span></span><br><span class=\"line\"><span class=\"built_in\">export</span> HADOOP_HOME=/usr/local/program/hadoop-3.2.1</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HADOOP_HOME</span>/bin</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HADOOP_HOME</span>/sbin</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">source</span> /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\">hadoop version</span><br></pre></td></tr></table></figure>\n\n","cover":false,"excerpt":"","more":"<h2 id=\"Hadoop\"><a href=\"#Hadoop\" class=\"headerlink\" title=\"Hadoop\"></a>Hadoop</h2><ol>\n<li>hadoopAoache </li>\n<li></li>\n<li>HadoopHadoop</li>\n</ol>\n<h2 id=\"Hadoop\"><a href=\"#Hadoop\" class=\"headerlink\" title=\"Hadoop\"></a>Hadoop</h2><h3 id=\"Lucene\"><a href=\"#Lucene\" class=\"headerlink\" title=\"Lucene\"></a>Lucene</h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"GFS-HDFS\"><a href=\"#GFS-HDFS\" class=\"headerlink\" title=\"GFS&gt;HDFS\"></a>GFS&gt;HDFS</h4><h4 id=\"Map-Reduce-MR\"><a href=\"#Map-Reduce-MR\" class=\"headerlink\" title=\"Map-Reduce&gt;MR\"></a>Map-Reduce&gt;MR</h4><h4 id=\"BigTable-HBase\"><a href=\"#BigTable-HBase\" class=\"headerlink\" title=\"BigTable&gt;HBase\"></a>BigTable&gt;HBase</h4><h2 id=\"Hadoop\"><a href=\"#Hadoop\" class=\"headerlink\" title=\"Hadoop\"></a>Hadoop</h2><h3 id=\"Apache\"><a href=\"#Apache\" class=\"headerlink\" title=\"Apache\"></a>Apache</h3><p></p>\n<h3 id=\"Cloudera\"><a href=\"#Cloudera\" class=\"headerlink\" title=\"Cloudera\"></a>Cloudera</h3><p></p>\n<h3 id=\"Hortonworks\"><a href=\"#Hortonworks\" class=\"headerlink\" title=\"Hortonworks\"></a>Hortonworks</h3><p></p>\n<h2 id=\"Hadoop4\"><a href=\"#Hadoop4\" class=\"headerlink\" title=\"Hadoop4\"></a>Hadoop4</h2><ol>\n<li>HadoopHadoop</li>\n<li></li>\n<li>Mao-Reduce Hadoop</li>\n<li></li>\n</ol>\n<h2 id=\"Hadoop\"><a href=\"#Hadoop\" class=\"headerlink\" title=\"Hadoop\"></a>Hadoop</h2><h3 id=\"1-x-2-x\"><a href=\"#1-x-2-x\" class=\"headerlink\" title=\"1.x 2.x\"></a>1.x 2.x</h3><p><img src=\"/post/2023/Hadoop/image-20200820213620752.png\" alt=\"image-20200820213620752\"></p>\n<h3 id=\"HDFS\"><a href=\"#HDFS\" class=\"headerlink\" title=\"HDFS\"></a>HDFS</h3><h4 id=\"1-NameNode-nn\"><a href=\"#1-NameNode-nn\" class=\"headerlink\" title=\"1.NameNode (nn)\"></a>1.NameNode (nn)</h4><p>DataNode </p>\n<h4 id=\"2-DataNode-dn\"><a href=\"#2-DataNode-dn\" class=\"headerlink\" title=\"2.DataNode (dn)\"></a>2.DataNode (dn)</h4><p></p>\n<h4 id=\"3-Secondary-NameNode-2nn\"><a href=\"#3-Secondary-NameNode-2nn\" class=\"headerlink\" title=\"3.Secondary NameNode (2nn)\"></a>3.Secondary NameNode (2nn)</h4><p>HDFSHDFS</p>\n<h3 id=\"YARN-\"><a href=\"#YARN-\" class=\"headerlink\" title=\"YARN \"></a>YARN </h3><h4 id=\"ResourceManage-RM-\"><a href=\"#ResourceManage-RM-\" class=\"headerlink\" title=\"ResourceManage(RM)\"></a>ResourceManage(RM)</h4><ul>\n<li></li>\n<li>NodeManage</li>\n<li>ApplicationMaster</li>\n<li></li>\n</ul>\n<h4 id=\"NodeManage-NM-\"><a href=\"#NodeManage-NM-\" class=\"headerlink\" title=\"NodeManage(NM)\"></a>NodeManage(NM)</h4><ul>\n<li></li>\n<li>ResourceManage</li>\n<li>ApplicationMaster</li>\n</ul>\n<h4 id=\"ApplicationMaster-AM-\"><a href=\"#ApplicationMaster-AM-\" class=\"headerlink\" title=\"ApplicationMaster(AM)\"></a>ApplicationMaster(AM)</h4><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h4 id=\"Container\"><a href=\"#Container\" class=\"headerlink\" title=\"Container\"></a>Container</h4><ul>\n<li>ContainerYARNCPU,</li>\n</ul>\n<h3 id=\"MapReduce\"><a href=\"#MapReduce\" class=\"headerlink\" title=\"MapReduce\"></a>MapReduce</h3><p>MapReduce map  Reduce</p>\n<ol>\n<li>Map </li>\n<li>ReduceMap</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/post/2023/Hadoop/image-20200820224123902.png\" alt=\"image-20200820224123902\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><h3 id=\"2-JDK\"><a href=\"#2-JDK\" class=\"headerlink\" title=\"2.JDK\"></a>2.JDK</h3><h3 id=\"3-Hadoop\"><a href=\"#3-Hadoop\" class=\"headerlink\" title=\"3.Hadoop\"></a>3.Hadoop</h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n<p> <code>/etc/profile</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> HADOOP_HOME=/usr/local/hadoop-3.2.1</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HADOOP_HOME</span>/bin</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HADOOP_HOME</span>/sbin</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">source</span> /ect/profile</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"4-Hadoop\"><a href=\"#4-Hadoop\" class=\"headerlink\" title=\"4.Hadoop\"></a>4.Hadoop</h3><ul>\n<li><p><strong>bin</strong></p>\n<p>HadoopHDFS,YARN</p>\n</li>\n<li><p><strong>etc</strong> </p>\n<p>Hadoop</p>\n</li>\n<li><p><strong>lib</strong></p>\n<p>Hadoop</p>\n</li>\n<li><p><strong>sbin</strong></p>\n<p>Hadoop</p>\n</li>\n<li><p><strong>share</strong></p>\n<p>Hadoopjar</p>\n</li>\n</ul>\n<h3 id=\"5-Hadoop\"><a href=\"#5-Hadoop\" class=\"headerlink\" title=\"5.Hadoop\"></a>5.Hadoop</h3><p>Hadoop<a href=\"https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html\">https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html</a></p>\n<h2 id=\"Hadoop\"><a href=\"#Hadoop\" class=\"headerlink\" title=\"Hadoop\"></a>Hadoop</h2><p>Hadoop</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"Grep\"><a href=\"#Grep\" class=\"headerlink\" title=\"Grep\"></a>Grep</h4><p>1.hadoop-3.2.1input</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">mkdir</span> input</span><br></pre></td></tr></table></figure>\n\n<p>2.Hadoopxmlinput</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cp</span>  etc/hadoop/*.xml  input</span><br></pre></td></tr></table></figure>\n\n<p>3.shareMapReduce</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop\tjar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar grep input  output  <span class=\"string\">&#x27;dfs[a-z.]+&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p>4.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span>  output/*</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"WordCount\"><a href=\"#WordCount\" class=\"headerlink\" title=\"WordCount\"></a>WordCount</h4><p>1.hadoop-3.2.1wcinput</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">mkdir</span> wcinput</span><br></pre></td></tr></table></figure>\n\n<p>2.wcinputwc.input</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> wcinput</span><br><span class=\"line\"></span><br><span class=\"line\">$ touchwc.input</span><br></pre></td></tr></table></figure>\n\n<p>3.wc.input</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim  wc.input</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hadoopyarn</span><br><span class=\"line\">hadoopmapreduce</span><br><span class=\"line\">atguigu</span><br><span class=\"line\">atguigu</span><br></pre></td></tr></table></figure>\n\n<p>wq</p>\n<p>4.Hadoop</p>\n<p>5.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount wcinput wcoutput</span><br></pre></td></tr></table></figure>\n\n<p>6.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cat</span> wcoutput /part-r-00000</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">atguigu2</span><br><span class=\"line\">hadoop2</span><br><span class=\"line\">mapreduce1</span><br><span class=\"line\">yarn1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"HDFSMapReduce\"><a href=\"#HDFSMapReduce\" class=\"headerlink\" title=\"HDFSMapReduce\"></a>HDFSMapReduce</h4><h5 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h5><p>1<br>2<br>3WordCount</p>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h5><h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><p>Hadoopetc</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> ./etc</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>hadoop-env.sh</p>\n<p>LinuxJDK</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">echo</span> <span class=\"variable\">$JAVA_HOME</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/local/jdk1.8.0_121</span><br></pre></td></tr></table></figure>\n\n<p>JAVA_HOME</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> JAVA_HOME=/usr/local/jdk1.8.0_121</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>core-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--HDFSNameNode--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>fs.defaultFS<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://localhost:9000<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--Hadoop--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hadoop.tmp.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>/usr/local/hadoop-3.2.1/data/tmp<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>hdfs-site.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--HDFS--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.replication<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h6 id=\"2SSH\"><a href=\"#2SSH\" class=\"headerlink\" title=\"2SSH\"></a>2SSH</h6><ul>\n<li><p>SSH</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ssh  localhost</span><br></pre></td></tr></table></figure>\n\n<p>SSH</p>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ssh-keygen -t rsa -P<span class=\"string\">&#x27;&#x27;</span>-f/ .ssh / id_rsa </span><br><span class=\"line\">$ <span class=\"built_in\">cat</span>/ .ssh / id_rsa.pub &gt;&gt;/ .ssh / authorized_keys </span><br><span class=\"line\">$ <span class=\"built_in\">chmod</span> 0600/ .ssh / authorized_keys</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h6 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h6><ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs namenode -format</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>NameNodeDataNode</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ./sbin/start-dfs.sh</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@iZ2zednzb8iugz3kgudq9bZ hadoop-3.2.1]<span class=\"comment\"># ./sbin/stop-dfs.sh</span></span><br><span class=\"line\">Stopping namenodes on [localhost]</span><br><span class=\"line\">ERROR: Attempting to operate on hdfs namenode as root</span><br><span class=\"line\">ERROR: but there is no HDFS_NAMENODE_USER defined. Aborting operation.</span><br><span class=\"line\">Stopping datanodes</span><br><span class=\"line\">ERROR: Attempting to operate on hdfs datanode as root</span><br><span class=\"line\">ERROR: but there is no HDFS_DATANODE_USER defined. Aborting operation.</span><br><span class=\"line\">Stopping secondary namenodes [iZ2zednzb8iugz3kgudq9bZ]</span><br><span class=\"line\">ERROR: Attempting to operate on hdfs secondarynamenode as root</span><br><span class=\"line\">ERROR: but there is no HDFS_SECONDARYNAMENODE_USER defined. Aborting operation.</span><br></pre></td></tr></table></figure>\n\n<p> <code>hadoop-env.sh</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HDFS_DATANODE_USER=root  </span><br><span class=\"line\">HDFS_NAMENODE_USER=root  </span><br><span class=\"line\">HDFS_SECONDARYNAMENODE_USER=root </span><br></pre></td></tr></table></figure>\n</li>\n<li><p>WebNameNode</p>\n<figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://localhost:9870/</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>MapReduceHDFS</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">mkdir</span> /user/root</span><br><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">mkdir</span> /user/&lt;&gt;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">mkdir</span> -p  /user/wry</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822090658863.png\" alt=\"image-20200822090658863\"></p>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">ls</span> -R /</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822090905199.png\" alt=\"image-20200822090905199\"></p>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">mkdir</span> -p /user/wry/input</span><br><span class=\"line\">$ bin/hdfs dfs -put etc/hadoop/*.xml /user/wry/input</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822091216510.png\" alt=\"image-20200822091216510\"></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822091335115.png\" alt=\"image-20200822091335115\"></p>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar grep /user/wry/input /user/wry/output <span class=\"string\">&#x27;dfs[a-z.]+&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822091809558.png\" alt=\"image-20200822091809558\"></p>\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">ls</span> -r /user/wry/output</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -<span class=\"built_in\">cat</span> /user/wry/output/&lt;&gt;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822092048172.png\" alt=\"image-20200822092048172\"></p>\n<p>or</p>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -get /user/wry/output /usr/local/wryoutput </span><br><span class=\"line\">$ <span class=\"built_in\">cat</span> /usr/local/wryoutput/*</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822093255847.png\" alt=\"image-20200822093255847\"></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/stop-dfs.sh</span><br></pre></td></tr></table></figure></li>\n</ul>\n<blockquote>\n<p><strong>NameNode </strong></p>\n<p>1.</p>\n<p>2.data log</p>\n<p>3.</p>\n</blockquote>\n<blockquote>\n<p><strong> NameNode</strong></p>\n<p>NameNodeId,NameNodeDataNodeIdNameNodedatalogNameNode</p>\n</blockquote>\n<p><img src=\"/post/2023/Hadoop/image-20200822094801817.png\" alt=\"image-20200822094801817\"></p>\n<h4 id=\"YARNMapReduce\"><a href=\"#YARNMapReduce\" class=\"headerlink\" title=\"YARNMapReduce\"></a>YARNMapReduce</h4><h5 id=\"1--1\"><a href=\"#1--1\" class=\"headerlink\" title=\"1.\"></a>1.</h5><p>1YARNMR<br>2<br>3YARNWordCount</p>\n<h5 id=\"2--1\"><a href=\"#2--1\" class=\"headerlink\" title=\"2.\"></a>2.</h5><h6 id=\"1-1\"><a href=\"#1-1\" class=\"headerlink\" title=\"1\"></a>1</h6><p><code>etc/hadoop/mapred-site.xml</code>:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--MapReducelocalclassic yarn --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  \t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.framework.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>yarn<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- MR --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.application.classpath<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p><code>etc/hadoop/yarn-site.xml</code>:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Reduce --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.aux-services<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mapreduce_shuffle<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">&lt;!--yarn--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span> \t\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">&lt;!--YARNResourceManager--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.resourcemanager.hostname<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>0.0.0.0<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/start-yarn.sh</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822100056038.png\" alt=\"image-20200822100056038\"></p>\n<p><code>etc/hadoop/hadoop-env.sh</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> YARN_RESOURCEMANAGER_USER=root</span><br><span class=\"line\"><span class=\"built_in\">export</span> YARN_NODEMANAGER_USER=root</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/2023/Hadoop/image-20200822102024933.png\" alt=\"image-20200822102024933\"></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822102108817.png\" alt=\"image-20200822102108817\"></p>\n<p>ResourceManagerweb</p>\n<p>ResourceManager - <code>http://localhost:8088/</code></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822111645219.png\" alt=\"image-20200822111645219\"></p>\n<p>job</p>\n<ul>\n<li>hadoop </li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -put wcinput/wc.input  /user/wry/wcinput</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount /user/wry/wcinput /user/wry/wcoutput</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop dfs -<span class=\"built_in\">ls</span> -r /user/wry/wcoutput</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<ul>\n<li><code>etc/hadoop/mapred-site.xml</code></li>\n</ul>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.jobhistory.address<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>0.0.0.0:10020<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--web--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>0.0.0.0:19888<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/mr-jobhistory-daemon.sh starthistoryserver</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ jps</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>JobHistory</p>\n<p>JobHistory -   <a href=\"http://hadoop101:19888/jobhistory\">http://hadoop101:19888/jobhistory</a></p>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>HDFS<br></p>\n<p>NodeManagerResourceManager<br>HistoryManager</p>\n<p></p>\n<ul>\n<li><p> <code>etc/hadoop/yarn-site.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.log-aggregation-enable<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--7--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>604800<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>NodeManagerResourceManagerHistoryManager</p>\n<ul>\n<li>  NodeManagerResourceManagerName NodeDataNode</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/stop-all.sh</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>  NodeManagerResourceManager</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/stop-yarn.sh</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>  Name NodeDataNode</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/stop-dfs.sh</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>  HistoryManager</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/mr-jobhistory-daemon.sh stop historyserver </span><br></pre></td></tr></table></figure>\n</li>\n<li><p>NodeManagerResourceManagerHistoryManager</p>\n</li>\n<li><p>HDFS</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop dfs -<span class=\"built_in\">rm</span> -f -r /user/wry/wcoutput</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>WordCount</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar wordcount /user/wry/wcinput /user/wry/wcoutput</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822140954237.png\" alt=\"image-20200822140954237\"></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822141013068.png\" alt=\"image-20200822141013068\"></p>\n<p><img src=\"/post/2023/Hadoop/image-20200822141028970.png\" alt=\"image-20200822141028970\"></p>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Hadoop<br></p>\n<h5 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h5><p>Hadoopjar</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\"></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">core-default.xml</td>\n<td>hadoop-common-2.7.2.jar&#x2F;core-default.xml</td>\n</tr>\n<tr>\n<td align=\"left\">hdfs-default.xml</td>\n<td>hadoop-hdfs-2.7.2.jar&#x2F;hdfs-default.xml</td>\n</tr>\n<tr>\n<td align=\"left\">yarn-default.xml</td>\n<td>hadoop-yarn-common-2.7.2.jar&#x2F;yarn-default.xml</td>\n</tr>\n<tr>\n<td align=\"left\">mapred-default.xml</td>\n<td>hadoop-mapreduce-client-core-2.7.2.jar&#x2F;mapred-default.xml</td>\n</tr>\n</tbody></table>\n<h5 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h5><p>core-site.xmlhdfs-site.xmlyarn-site.xmlmapred-site.xml<br>$HADOOP_HOME&#x2F;etc&#x2F;hadoop</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>13ip<br>2JDK<br>3<br>4Hadoop<br>5<br>6<br>7<br>8ssh<br>9</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"1IP\"><a href=\"#1IP\" class=\"headerlink\" title=\"1IP\"></a>1IP</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim /etc/sysconfig/network-scripts/ifcfg-ens33 </span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TYPE=Ethernet</span><br><span class=\"line\">PROXY_METHOD=none</span><br><span class=\"line\">BROWSER_ONLY=no</span><br><span class=\"line\">BOOTPROTO=static\t\t<span class=\"comment\">#static</span></span><br><span class=\"line\">DEFROUTE=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV4_FAILURE_FATAL=no</span><br><span class=\"line\">IPV6INIT=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_AUTOCONF=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_DEFROUTE=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_FAILURE_FATAL=no</span><br><span class=\"line\">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class=\"line\">NAME=ens33</span><br><span class=\"line\">UUID=67b4d72d-1ff5-4e3e-a089-e1579700eba8</span><br><span class=\"line\">DEVICE=ens33</span><br><span class=\"line\">ONBOOT=<span class=\"built_in\">yes</span>\t\t\t\t<span class=\"comment\">#yes</span></span><br><span class=\"line\"></span><br><span class=\"line\">IPADDR=192.168.100.102  <span class=\"comment\"># ip</span></span><br><span class=\"line\">NETMASK=255.255.255.0   <span class=\"comment\">#</span></span><br><span class=\"line\">GATEWAY=192.168.100.1\t<span class=\"comment\">#</span></span><br><span class=\"line\">DNS1=8.8.8.8\t\t\t<span class=\"comment\">#DNS</span></span><br><span class=\"line\">DNS2=223.6.6.6</span><br><span class=\"line\"></span><br><span class=\"line\">PREFIX=24</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h5><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim /etc/hotos</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class=\"line\">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class=\"line\">192.168.100.102 hadoop102</span><br><span class=\"line\">192.168.100.103 hadoop103</span><br><span class=\"line\">192.168.100.104 hadoop104</span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"xsync\"><a href=\"#xsync\" class=\"headerlink\" title=\"xsync\"></a>xsync</h4><h5 id=\"1-scpsecurecopy\"><a href=\"#1-scpsecurecopy\" class=\"headerlink\" title=\"1.scpsecurecopy\"></a>1.scpsecurecopy</h5><h6 id=\"1scp\"><a href=\"#1scp\" class=\"headerlink\" title=\"1scp\"></a>1scp</h6><p><code>scp</code>fromserver1toserver2</p>\n<h6 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp\t\t-r  \t<span class=\"variable\">$pdir</span>/<span class=\"variable\">$fname</span>\t\t<span class=\"variable\">$user</span>@hadoop<span class=\"variable\">$host</span>:<span class=\"variable\">$pdir</span>/<span class=\"variable\">$fname</span></span><br><span class=\"line\">\t  \t \t   @:/</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h6><p>a<code>192.168.100.101</code><code>192.168.100.101</code><code>/usr/local/software</code><code>192.168.100.102</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ scp -r /usr/local/software/*  root@192.168.100.102:/usr/local/software</span><br></pre></td></tr></table></figure>\n\n<p>b<code>192.168.100.103</code><code>192.168.100.101</code><code>/usr/local/software</code><br><code>192.168.100.103</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ scp -r root@192.168.100.101:/usr/local/software/*  /usr/local/software/</span><br></pre></td></tr></table></figure>\n\n<p>c<code>192.168.100.103</code><code>192.168.100.101</code><code>/usr/local/software</code><br><code>192.168.100.104</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ scp -r root@192.168.100.101:/usr/local/software/*  root@192.168.100.104:/usr/local/software/</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2-rsync\"><a href=\"#2-rsync\" class=\"headerlink\" title=\"2.rsync\"></a>2.rsync</h5><p><code>rsync</code></p>\n<p><strong><code>rsync</code><code>scp</code></strong></p>\n<p><code>rsync</code><code>scp</code><code>rsync</code><code>scp</code></p>\n<h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rsync\t-rvl\t\t<span class=\"variable\">$pdir</span>/<span class=\"variable\">$fname</span>\t\t\t<span class=\"variable\">$user</span>@hadoop<span class=\"variable\">$host</span>:<span class=\"variable\">$pdir</span>/<span class=\"variable\">$fname</span></span><br><span class=\"line\">\t  \t\t/\t\t@:/</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-r</td>\n<td></td>\n</tr>\n<tr>\n<td>-v</td>\n<td></td>\n</tr>\n<tr>\n<td>-l</td>\n<td></td>\n</tr>\n</tbody></table>\n<h6 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h6><p>a<code>192.168.100.101</code><code>/usr/local/software</code><code>192.168.100.102</code>root<br><code>/usr/local/software</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ rsync  -rvl /usr/local/software/*  root@192.168.100.102:/usr/local/software/</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"3-xsync\"><a href=\"#3-xsync\" class=\"headerlink\" title=\"3.xsync\"></a>3.xsync</h5><h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><p></p>\n<h6 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h6><p>arsync</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rsync -rvl  /usr/local/program/*  root@192.168.100.103:/usr/local/program/</span><br></pre></td></tr></table></figure>\n\n<p>b<br>xsync<br>c<code>/home/&lt;&gt;/bin</code>root</p>\n<h6 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h6><p>a<code>/home/&lt;&gt;/bin</code>binbinxsync</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /home/&lt;&gt;</span><br><span class=\"line\">$ <span class=\"built_in\">mkdir</span> bin</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> bin</span><br><span class=\"line\">$ vim xsync</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"comment\">#1</span></span><br><span class=\"line\">pcount=<span class=\"variable\">$#</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>((pcount==<span class=\"number\">0</span>));<span class=\"keyword\">then</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> noargs;</span><br><span class=\"line\"><span class=\"built_in\">exit</span>;</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"comment\">#2</span></span><br><span class=\"line\">p1=<span class=\"variable\">$1</span></span><br><span class=\"line\">fname=`<span class=\"built_in\">basename</span> <span class=\"variable\">$p1</span>`</span><br><span class=\"line\"><span class=\"built_in\">echo</span>  fname=<span class=\"variable\">$fname</span></span><br><span class=\"line\"><span class=\"comment\">#3</span></span><br><span class=\"line\">pdir=`<span class=\"built_in\">cd</span> -P $(<span class=\"built_in\">dirname</span> <span class=\"variable\">$p1</span>);<span class=\"built_in\">pwd</span>`</span><br><span class=\"line\"><span class=\"built_in\">echo</span> pdir=<span class=\"variable\">$pdir</span></span><br><span class=\"line\"><span class=\"comment\">#4</span></span><br><span class=\"line\">user=`<span class=\"built_in\">whoami</span>`</span><br><span class=\"line\"><span class=\"comment\">#5</span></span><br><span class=\"line\"><span class=\"keyword\">for</span>((host=<span class=\"number\">103</span>;host&lt;<span class=\"number\">105</span>;host++));<span class=\"keyword\">do</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> -------------------192.168.100.<span class=\"variable\">$host</span>--------------</span><br><span class=\"line\">rsync -rvl <span class=\"variable\">$pdir</span>/<span class=\"variable\">$fname</span>  <span class=\"variable\">$user</span>@192.168.100.<span class=\"variable\">$host</span>:<span class=\"variable\">$pdir</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n\n<p>bxsync</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">chmod</span> 777 xsync</span><br></pre></td></tr></table></figure>\n\n<p>cxsync</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ xsync  /home/&lt;&gt;/bin</span><br></pre></td></tr></table></figure>\n\n\n\n\n<blockquote>\n<p><strong></strong></p>\n<p><code>xsync</code><code>/home/&lt;&gt;/bin</code></p>\n<p><code>xsync</code><code>/usr/local/bin</code></p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h5><table>\n<thead>\n<tr>\n<th></th>\n<th align=\"left\">192.168.100.102 -hadoop102</th>\n<th>192.168.100.103-hadoop103</th>\n<th>192.168.100.104-hadoop104</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>HDFS</td>\n<td align=\"left\">NameNode <br /> DataNode</td>\n<td><br />DataNode</td>\n<td>SecondaryNameNode <br />DataNode</td>\n</tr>\n<tr>\n<td>YARN</td>\n<td align=\"left\"><br />NodeManage</td>\n<td>ResourceManage  <br />NodeManage</td>\n<td><br />NodeManage</td>\n</tr>\n</tbody></table>\n<p>IP </p>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h5><h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><p><code>192.168.100.102</code> </p>\n<p><code>etc/hadoop/core-site.xml</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /usr/local/program/hadoop3.2.1</span><br><span class=\"line\">$ vim etc/hadoop/core-site.xml</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--HDFSNameNode--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>fs.defaultFS<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>hdfs://192.168.100.102:9000<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--Hadoop--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>hadoop.tmp.dir<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>/usr/local/program/hadoop-3.2.1/data/tmp/hadoop-$&#123;user.name&#125;<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h6 id=\"2HDFS\"><a href=\"#2HDFS\" class=\"headerlink\" title=\"2HDFS\"></a>2HDFS</h6><p><code>etc/hadoop/hadoop-env.sh</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> JAVA_HOME=/usr/local/program/jdk1.8 </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">export</span> HDFS_DATANODE_USER=root  </span><br><span class=\"line\"><span class=\"built_in\">export</span> HDFS_NAMENODE_USER=root  </span><br><span class=\"line\"><span class=\"built_in\">export</span> HDFS_SECONDARYNAMENODE_USER=root </span><br></pre></td></tr></table></figure>\n\n<p><code>etc/hadoop/hdfs-site.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.replication<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>3<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--Hadoop--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>192.168.100.104:50090<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--HadoopNameNode--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>dfs.http.address<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>192.168.100.102:9870<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h6 id=\"3YARN\"><a href=\"#3YARN\" class=\"headerlink\" title=\"3YARN\"></a>3YARN</h6><p> shell</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hadoop  classpath</span><br></pre></td></tr></table></figure>\n\n<p>    yarn  yarn-site.xml <name>yarn.application.classpath</name></p>\n<p><code>etc/hadoop/hadoop-env.sh</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> YARN_RESOURCEMANAGER_USER=root</span><br><span class=\"line\"><span class=\"built_in\">export</span> YARN_NODEMANAGER_USER=root</span><br></pre></td></tr></table></figure>\n\n<p><code>etc/hadoop/yarn-site.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--MapReducelocalclassic yarn --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.framework.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>yarn<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">&lt;!-- MR --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.application.classpath<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>/usr/local/program/hadoop-3.2.1/etc/hadoop:/usr/local/program/hadoop-3.2.1/share/hadoop/common/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/common/*:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/hdfs/*:/usr/local/program/hadoop-3.2.1/share/hadoop/mapreduce/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/mapreduce/*:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn/lib/*:/usr/local/program/hadoop-3.2.1/share/hadoop/yarn/*<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--YARNResourceManager--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.resourcemanager.hostname<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>192.168.100.103<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.aux-services<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mapreduce_shuffle<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>yarn.nodemanager.aux-services.mapreduce.shuffle.class<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>org.apache.hadoop.mapred.ShuffleHandler<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h6 id=\"4MapReduce\"><a href=\"#4MapReduce\" class=\"headerlink\" title=\"4MapReduce\"></a>4MapReduce</h6><p><code>etc/hadoop/mapred-site.xml</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--MRYarn--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.framework.name<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>yarn<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- MR --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>mapreduce.application.classpath<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span>     <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"3-Hadoop\"><a href=\"#3-Hadoop\" class=\"headerlink\" title=\"3.Hadoop\"></a>3.Hadoop</h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ xsync ./etc/hadoop/</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h5><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1<code>NameNode</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$  bin/hdfs namenode -formart</span><br></pre></td></tr></table></figure>\n\n<p>2<code>192.168.100.102</code><code>NameNode</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/hadoop-daemon.sh  start namenode</span><br></pre></td></tr></table></figure>\n\n<p>3<code>192.168.100.102</code>,<code>192.168.100.103</code><code>192.168.100.104</code><code>DataNode</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/hadoop-daemon.sh  start datanode</span><br></pre></td></tr></table></figure>\n\n<p>41000<br>            </p>\n<h4 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h4><h5 id=\"1-ssh\"><a href=\"#1-ssh\" class=\"headerlink\" title=\"1.ssh\"></a>1.ssh</h5><p>1<br>            sship<br>2sshHostkeyverificationfailed</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ssh  192.168.1.103</span><br><span class=\"line\">Theauthenticityofhost<span class=\"string\">&#x27;192.168.1.103(192.168.1.103)&#x27;</span>can<span class=\"string\">&#x27;t</span></span><br><span class=\"line\"><span class=\"string\">beestablished.</span></span><br><span class=\"line\"><span class=\"string\">RSAkeyfingerprintis</span></span><br><span class=\"line\"><span class=\"string\">cf:1e:de:d7:d0:4c:2d:98:60:b4:fd:ae:b1:2d:ad:06.</span></span><br><span class=\"line\"><span class=\"string\">Areyousureyouwanttocontinueconnecting(yes/no)?</span></span><br><span class=\"line\"><span class=\"string\">Hostkeyverificationfailed.</span></span><br></pre></td></tr></table></figure>\n\n<p>3yes</p>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h5><p>1</p>\n<p><img src=\"/post/2023/Hadoop/image-20200823180537869.png\" alt=\"image-20200823180537869\"></p>\n<p>2<code>192.168.100.102</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> /root/.ssh</span><br><span class=\"line\">$ ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>\n\n<p>id_rsaid_rsa.pub</p>\n<p>3</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ ssh-copy-id 192.168.100.102</span><br><span class=\"line\">$ ssh-copy-id 192.168.100.103</span><br><span class=\"line\">$ ssh-copy-id 192.168.100.104</span><br></pre></td></tr></table></figure>\n\n<p>4<code>192.168.100.103</code>,</p>\n<h5 id=\"3-ssh-ssh\"><a href=\"#3-ssh-ssh\" class=\"headerlink\" title=\"3..ssh~&#x2F;.ssh\"></a>3.<code>.ssh</code>~&#x2F;.ssh</h5><table>\n<thead>\n<tr>\n<th>known_hosts</th>\n<th>ssh(publickey)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>id_rsa</td>\n<td></td>\n</tr>\n<tr>\n<td>id_rsa.pub</td>\n<td></td>\n</tr>\n<tr>\n<td>authorized_keys</td>\n<td></td>\n</tr>\n</tbody></table>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"1-etc-hadoop-workers\"><a href=\"#1-etc-hadoop-workers\" class=\"headerlink\" title=\"1.etc/hadoop/workers\"></a>1.<code>etc/hadoop/workers</code></h5><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim etc/hadoop/workers </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">192.168.100.102</span><br><span class=\"line\">192.168.100.103</span><br><span class=\"line\">192.168.100.104</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n</blockquote>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h5><h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><p>NameNodenamenodedatanodedatalog</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs namenode -format</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"2HDFS\"><a href=\"#2HDFS\" class=\"headerlink\" title=\"2HDFS\"></a>2HDFS</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/start-dfs.sh</span><br></pre></td></tr></table></figure>\n\n<p><code>jps</code></p>\n<h6 id=\"3YARN\"><a href=\"#3YARN\" class=\"headerlink\" title=\"3YARN\"></a>3<code>YARN</code></h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/start-yarn.sh</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"3WebSecondaryNameNode\"><a href=\"#3WebSecondaryNameNode\" class=\"headerlink\" title=\"3WebSecondaryNameNode\"></a>3Web<code>SecondaryNameNode</code></h6><figure class=\"highlight http\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://192.168.100.102:9870/</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"4\"><a href=\"#4\" class=\"headerlink\" title=\"4\"></a>4</h6> <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfsadmin -report</span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p></p>\n<p>NameNodeResourceMangerNameNodeYARNResouceManagerYARN</p>\n</blockquote>\n<h5 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h5><h6 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ bin/hdfs dfs -put  ./wcinput/wc.input  /user/wry/input</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">pwd</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/local/program/hadoop-3.2.1/data/tmp/hadoop-root/dfs/data/current/BP-719430212-127.0.0.1-1598525636602/current/finalized/subdir0/subdir0</span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"&#x2F;\"></a>&#x2F;</h4><h5 id=\"1--\"><a href=\"#1--\" class=\"headerlink\" title=\"1.&#x2F;\"></a>1.&#x2F;</h5><h6 id=\"1-HDFS\"><a href=\"#1-HDFS\" class=\"headerlink\" title=\"1&#x2F;HDFS\"></a>1&#x2F;HDFS</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/hadoop-daemon.sh start/stop  namenode/datanode/secondarynamenode</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"2-YARN\"><a href=\"#2-YARN\" class=\"headerlink\" title=\"2&#x2F;YARN\"></a>2&#x2F;YARN</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/yarn-daemon.sh  start/stop  resourcemanager/nodemanager</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2--ssh\"><a href=\"#2--ssh\" class=\"headerlink\" title=\"2.&#x2F;ssh\"></a>2.&#x2F;ssh</h5><h6 id=\"1-HDFS\"><a href=\"#1-HDFS\" class=\"headerlink\" title=\"1&#x2F;HDFS\"></a>1&#x2F;HDFS</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/start-dfs.sh/stop-dfs.sh</span><br></pre></td></tr></table></figure>\n\n<h6 id=\"2-YARN\"><a href=\"#2-YARN\" class=\"headerlink\" title=\"2&#x2F;YARN\"></a>2&#x2F;YARN</h6><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sbin/start-yarn.sh/stop-yarn.sh</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"crontab\"><a href=\"#crontab\" class=\"headerlink\" title=\"crontab\"></a>crontab</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>crontab []</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-e</td>\n<td>crontab </td>\n</tr>\n<tr>\n<td>-l</td>\n<td>crontab</td>\n</tr>\n<tr>\n<td>-r</td>\n<td>crontab </td>\n</tr>\n</tbody></table>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ crontab -e</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"1crontabvim-\"><a href=\"#1crontabvim-\" class=\"headerlink\" title=\"1crontabvim \"></a>1crontabvim </h5><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">* * * * *  </span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>*</td>\n<td></td>\n<td>0-59</td>\n</tr>\n<tr>\n<td>*</td>\n<td></td>\n<td>0-23</td>\n</tr>\n<tr>\n<td>*</td>\n<td></td>\n<td>1-31</td>\n</tr>\n<tr>\n<td>*</td>\n<td></td>\n<td>1-12</td>\n</tr>\n<tr>\n<td>*</td>\n<td></td>\n<td>0-707</td>\n</tr>\n</tbody></table>\n<h5 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h5><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>*</td>\n<td>*</td>\n</tr>\n<tr>\n<td></td>\n<td>0 8,12,16 * * * 80120160</td>\n</tr>\n<tr>\n<td>-</td>\n<td>0 5 * * 1-6 ,50</td>\n</tr>\n<tr>\n<td>*&#x2F;n</td>\n<td>*&#x2F;10 * * * *,10</td>\n</tr>\n</tbody></table>\n<h5 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h5><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>45 22 * * *</td>\n<td>2245 </td>\n</tr>\n<tr>\n<td>0 17 * * 1</td>\n<td>170</td>\n</tr>\n<tr>\n<td>0 5 1,15 * *</td>\n<td>11550</td>\n</tr>\n<tr>\n<td>40 4 * * 1-5</td>\n<td>440 </td>\n</tr>\n<tr>\n<td>*&#x2F;10 4 * * *</td>\n<td>410</td>\n</tr>\n<tr>\n<td>0 0 1,15 * 1</td>\n<td>11500</td>\n</tr>\n</tbody></table>\n<h5 id=\"4\"><a href=\"#4\" class=\"headerlink\" title=\"4\"></a>4</h5><ul>\n<li><p>1<code>/root/bailongma.txt</code>11 </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">*/1 * * * * /bin/echo <span class=\"string\">&quot;11&quot;</span> &gt;&gt;/root/bailongma.txt</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><img src=\"/post/2023/Hadoop/image-20200829223326519.png\" alt=\"image-20200829223326519\"></p>\n<h2 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h2><h3 id=\"IP\"><a href=\"#IP\" class=\"headerlink\" title=\"IP\"></a>IP</h3><h4 id=\"VMnet\"><a href=\"#VMnet\" class=\"headerlink\" title=\"VMnet\"></a>VMnet</h4><p>VMware - NAT VMnet2</p>\n<p><img src=\"https://img.jbzj.com/file_images/article/202001/2020011513342421.png\" alt=\"\"></p>\n<p>ip,,</p>\n<p>A255.0.0.0<br>B255.255.0.0<br>C255.255.255.0</p>\n<p>IP: DHCPIP ()</p>\n<p>NAT</p>\n<p>ip,ip</p>\n<p><img src=\"https://img.jbzj.com/file_images/article/202001/2020011513342422.png\" alt=\"Alt\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> rootcentos8vi &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TYPE=Ethernet</span><br><span class=\"line\">PROXY_METHOD=none</span><br><span class=\"line\">BROWSER_ONLY=no</span><br><span class=\"line\">BOOTPROTO=static <span class=\"comment\">#static</span></span><br><span class=\"line\">DEFROUTE=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV4_FAILURE_FATAL=no</span><br><span class=\"line\">IPV6INIT=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_AUTOCONF=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_DEFROUTE=<span class=\"built_in\">yes</span></span><br><span class=\"line\">IPV6_FAILURE_FATAL=no</span><br><span class=\"line\">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class=\"line\">NAME=ens33</span><br><span class=\"line\">UUID=aa18fb34-fea8-4fff-83a4-1ebed631beff</span><br><span class=\"line\">DEVICE=ens33</span><br><span class=\"line\">ONBOOT=<span class=\"built_in\">yes</span> <span class=\"comment\">#noyes</span></span><br><span class=\"line\">GATEWAY=192.168.0.2 <span class=\"comment\">#</span></span><br><span class=\"line\">IPADDR=192.168.0.150 <span class=\"comment\">#</span></span><br><span class=\"line\">NETMASK=255.255.255.0 <span class=\"comment\">#</span></span><br><span class=\"line\">DNS1=8.8.8.8 <span class=\"comment\">#DNS1,</span></span><br><span class=\"line\">DNS2=223.6.6.6 <span class=\"comment\">#DNS2</span></span><br></pre></td></tr></table></figure>\n\n<p> :wq</p>\n<h4 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\": \"></a>: </h4><p>CentOS 8  : nmcli c reload</p>\n<p>CentOS7  &#x2F;etc&#x2F;init.d&#x2F;network restart</p>\n<p><code>reboot</code> </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>centos8</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ systemctl <span class=\"built_in\">disable</span> firewalld</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ systemctl status firewalld.service</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ systemctl stop firewalld.service</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ systemctl start firewalld.service</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"JDK\"><a href=\"#JDK\" class=\"headerlink\" title=\"JDK\"></a>JDK</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ tar -zxvf /usr/local/software/jdk1.8.231 -C /usr/local/program/</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim /etc/profile</span><br></pre></td></tr></table></figure>\n\n<p>java </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> JAVA_HOME=/usr/local/program/jdk1.8.231</span><br><span class=\"line\"><span class=\"built_in\">export</span> CLASS_PATH=.:<span class=\"variable\">$JAVA_HOME</span>/lib.tools.jar</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$JAVA_HOME</span>/bin</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">source</span> /etc/profile</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n<p>ClientAliveInterval 60</p>\n<p>, , </p>\n<p>ClientAliveCountMax 3 </p>\n<p>ClientAliveCountMax, </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ service sshd restart</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf /usr/local/software/hadoop-3.2.1.tar.gz  -C /usr/local/program/</span><br><span class=\"line\"></span><br><span class=\"line\">vim /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#hadoop </span></span><br><span class=\"line\"><span class=\"built_in\">export</span> HADOOP_HOME=/usr/local/program/hadoop-3.2.1</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HADOOP_HOME</span>/bin</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:<span class=\"variable\">$HADOOP_HOME</span>/sbin</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">source</span> /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\">hadoop version</span><br></pre></td></tr></table></figure>\n\n"},{"title":"SpringBootdocker","date":"2021-12-01T10:00:00.000Z","_content":"\n# SpringBootdocker\n\n## maven\n\n### pom.xmlbuild\n```xml\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>com.spotify</groupId>\n            <artifactId>docker-maven-plugin</artifactId>\n            <version>1.1.0</version>\n            <executions>\n                <execution>\n                    <id>build-image</id>\n                    <phase>package</phase>\n                    <goals>\n                        <goal>build</goal>\n                    </goals>\n                </execution>\n            </executions>\n            <configuration>\n                <!--docker-->\n                <dockerHost>http://192.168.1.20:2375</dockerHost>\n                <!--docker-->\n                <imageName>${project.artifactId}:${project.version}</imageName>\n                <!---->\n                <baseImage>java:8</baseImage>\n                <!---->\n                <entryPoint>[\"java\",\"-jar\",\"-Dfile.encoding=UTF-8\",\"-Dsun.jnu.encoding=UTF-8\",\"/${project.build.finalName}.jar\"]\n                </entryPoint>\n                <!--jar-->\n                <resources>\n                    <resource>\n                        <targetPath>/</targetPath>\n                        <directory>${project.build.directory}</directory>\n                        <include>${project.build.finalName}.jar</include>\n                    </resource>\n                </resources>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n```\n\n## maven+dockerfile\n\n### src->main->dockerdockerfile\n\n```yml\n# \nFROM java:8\n  # jardocker/\nADD ebbms-admin-1.0.0-SNAPSHOT.jar /app.jar\n  # app.jar\nRUN bash -c 'touch /app.jar'\n  # 8080\nEXPOSE 8084\n  # dockerjar\nENTRYPOINT [\"java\", \"-jar\",\"-Dfile.encoding=UTF-8\",\"-Dsun.jnu.encoding=UTF-8\",\"/app.jar\"]\n  # \nENV LANG en_US.UTF-8\nENV LANGUAGE en_US:en\nENV LC_ALL en_US.UTF-8\n  # \nMAINTAINER wangruiyu\n```\n\n### pom.xmlbuild\n\n```xml\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>com.spotify</groupId>\n            <artifactId>docker-maven-plugin</artifactId>\n            <version>1.1.0</version>\n            <executions>\n                <execution>\n                    <id>build-image</id>\n                    <phase>package</phase>\n                    <goals>\n                        <goal>build</goal>\n                    </goals>\n                </execution>\n            </executions>\n            <configuration>\n                <!--docker-->\n                <dockerHost>http://192.168.1.20:2375</dockerHost>\n                <!--docker-->\n                <imageName>${project.artifactId}:${project.version}</imageName>\n                <!--dockerfile-->\n                <dockerDirectory>src/main/docker</dockerDirectory>\n                <!--jar-->\n                <resources>\n                    <resource>\n                        <targetPath>/</targetPath>\n                        <directory>${project.build.directory}</directory>\n                        <include>${project.build.finalName}.jar</include>\n                    </resource>\n                </resources>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n```\n\n","source":"_posts/2023/docker-springboot.md","raw":"---\ntitle: SpringBootdocker\ndate: 2021-12-01 18:00:00\ntags:\n - springboot\n - docker\ncategories:\n - JAVA\n - Docker\n---\n\n# SpringBootdocker\n\n## maven\n\n### pom.xmlbuild\n```xml\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>com.spotify</groupId>\n            <artifactId>docker-maven-plugin</artifactId>\n            <version>1.1.0</version>\n            <executions>\n                <execution>\n                    <id>build-image</id>\n                    <phase>package</phase>\n                    <goals>\n                        <goal>build</goal>\n                    </goals>\n                </execution>\n            </executions>\n            <configuration>\n                <!--docker-->\n                <dockerHost>http://192.168.1.20:2375</dockerHost>\n                <!--docker-->\n                <imageName>${project.artifactId}:${project.version}</imageName>\n                <!---->\n                <baseImage>java:8</baseImage>\n                <!---->\n                <entryPoint>[\"java\",\"-jar\",\"-Dfile.encoding=UTF-8\",\"-Dsun.jnu.encoding=UTF-8\",\"/${project.build.finalName}.jar\"]\n                </entryPoint>\n                <!--jar-->\n                <resources>\n                    <resource>\n                        <targetPath>/</targetPath>\n                        <directory>${project.build.directory}</directory>\n                        <include>${project.build.finalName}.jar</include>\n                    </resource>\n                </resources>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n```\n\n## maven+dockerfile\n\n### src->main->dockerdockerfile\n\n```yml\n# \nFROM java:8\n  # jardocker/\nADD ebbms-admin-1.0.0-SNAPSHOT.jar /app.jar\n  # app.jar\nRUN bash -c 'touch /app.jar'\n  # 8080\nEXPOSE 8084\n  # dockerjar\nENTRYPOINT [\"java\", \"-jar\",\"-Dfile.encoding=UTF-8\",\"-Dsun.jnu.encoding=UTF-8\",\"/app.jar\"]\n  # \nENV LANG en_US.UTF-8\nENV LANGUAGE en_US:en\nENV LC_ALL en_US.UTF-8\n  # \nMAINTAINER wangruiyu\n```\n\n### pom.xmlbuild\n\n```xml\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>com.spotify</groupId>\n            <artifactId>docker-maven-plugin</artifactId>\n            <version>1.1.0</version>\n            <executions>\n                <execution>\n                    <id>build-image</id>\n                    <phase>package</phase>\n                    <goals>\n                        <goal>build</goal>\n                    </goals>\n                </execution>\n            </executions>\n            <configuration>\n                <!--docker-->\n                <dockerHost>http://192.168.1.20:2375</dockerHost>\n                <!--docker-->\n                <imageName>${project.artifactId}:${project.version}</imageName>\n                <!--dockerfile-->\n                <dockerDirectory>src/main/docker</dockerDirectory>\n                <!--jar-->\n                <resources>\n                    <resource>\n                        <targetPath>/</targetPath>\n                        <directory>${project.build.directory}</directory>\n                        <include>${project.build.finalName}.jar</include>\n                    </resource>\n                </resources>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n```\n\n","slug":"2023/docker-springboot","published":1,"updated":"2024-08-05T11:07:24.333Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiut0003vaibhf84gyom","content":"<h1 id=\"SpringBootdocker\"><a href=\"#SpringBootdocker\" class=\"headerlink\" title=\"SpringBootdocker\"></a>SpringBootdocker</h1><h2 id=\"maven\"><a href=\"#maven\" class=\"headerlink\" title=\"maven\"></a>maven</h2><h3 id=\"pom-xmlbuild\"><a href=\"#pom-xmlbuild\" class=\"headerlink\" title=\"pom.xmlbuild\"></a>pom.xmlbuild</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.spotify<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>docker-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.1.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>build-image<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>package<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>build<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--docker--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">dockerHost</span>&gt;</span>http://192.168.1.20:2375<span class=\"tag\">&lt;/<span class=\"name\">dockerHost</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--docker--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">imageName</span>&gt;</span>$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">imageName</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">baseImage</span>&gt;</span>java:8<span class=\"tag\">&lt;/<span class=\"name\">baseImage</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">entryPoint</span>&gt;</span>[&quot;java&quot;,&quot;-jar&quot;,&quot;-Dfile.encoding=UTF-8&quot;,&quot;-Dsun.jnu.encoding=UTF-8&quot;,&quot;/$&#123;project.build.finalName&#125;.jar&quot;]</span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">entryPoint</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--jar--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>$&#123;project.build.finalName&#125;.jar<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"maven-dockerfile\"><a href=\"#maven-dockerfile\" class=\"headerlink\" title=\"maven+dockerfile\"></a>maven+dockerfile</h2><h3 id=\"src-main-dockerdockerfile\"><a href=\"#src-main-dockerdockerfile\" class=\"headerlink\" title=\"src-&gt;main-&gt;dockerdockerfile\"></a>src-&gt;main-&gt;dockerdockerfile</h3><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">FROM</span> <span class=\"string\">java:8</span></span><br><span class=\"line\">  <span class=\"comment\"># jardocker/</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">ebbms-admin-1.0.0-SNAPSHOT.jar</span> <span class=\"string\">/app.jar</span></span><br><span class=\"line\">  <span class=\"comment\"># app.jar</span></span><br><span class=\"line\"><span class=\"string\">RUN</span> <span class=\"string\">bash</span> <span class=\"string\">-c</span> <span class=\"string\">&#x27;touch /app.jar&#x27;</span></span><br><span class=\"line\">  <span class=\"comment\"># 8080</span></span><br><span class=\"line\"><span class=\"string\">EXPOSE</span> <span class=\"number\">8084</span></span><br><span class=\"line\">  <span class=\"comment\"># dockerjar</span></span><br><span class=\"line\"><span class=\"string\">ENTRYPOINT</span> [<span class=\"string\">&quot;java&quot;</span>, <span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;-Dfile.encoding=UTF-8&quot;</span>,<span class=\"string\">&quot;-Dsun.jnu.encoding=UTF-8&quot;</span>,<span class=\"string\">&quot;/app.jar&quot;</span>]</span><br><span class=\"line\">  <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LANG</span> <span class=\"string\">en_US.UTF-8</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LANGUAGE</span> <span class=\"string\">en_US:en</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_ALL</span> <span class=\"string\">en_US.UTF-8</span></span><br><span class=\"line\">  <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">MAINTAINER</span> <span class=\"string\">wangruiyu</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"pom-xmlbuild-1\"><a href=\"#pom-xmlbuild-1\" class=\"headerlink\" title=\"pom.xmlbuild\"></a>pom.xmlbuild</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.spotify<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>docker-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.1.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>build-image<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>package<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>build<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--docker--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">dockerHost</span>&gt;</span>http://192.168.1.20:2375<span class=\"tag\">&lt;/<span class=\"name\">dockerHost</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--docker--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">imageName</span>&gt;</span>$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">imageName</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--dockerfile--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">dockerDirectory</span>&gt;</span>src/main/docker<span class=\"tag\">&lt;/<span class=\"name\">dockerDirectory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--jar--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>$&#123;project.build.finalName&#125;.jar<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n","cover":false,"excerpt":"","more":"<h1 id=\"SpringBootdocker\"><a href=\"#SpringBootdocker\" class=\"headerlink\" title=\"SpringBootdocker\"></a>SpringBootdocker</h1><h2 id=\"maven\"><a href=\"#maven\" class=\"headerlink\" title=\"maven\"></a>maven</h2><h3 id=\"pom-xmlbuild\"><a href=\"#pom-xmlbuild\" class=\"headerlink\" title=\"pom.xmlbuild\"></a>pom.xmlbuild</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.spotify<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>docker-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.1.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>build-image<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>package<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>build<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--docker--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">dockerHost</span>&gt;</span>http://192.168.1.20:2375<span class=\"tag\">&lt;/<span class=\"name\">dockerHost</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--docker--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">imageName</span>&gt;</span>$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">imageName</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">baseImage</span>&gt;</span>java:8<span class=\"tag\">&lt;/<span class=\"name\">baseImage</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!----&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">entryPoint</span>&gt;</span>[&quot;java&quot;,&quot;-jar&quot;,&quot;-Dfile.encoding=UTF-8&quot;,&quot;-Dsun.jnu.encoding=UTF-8&quot;,&quot;/$&#123;project.build.finalName&#125;.jar&quot;]</span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">entryPoint</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--jar--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>$&#123;project.build.finalName&#125;.jar<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"maven-dockerfile\"><a href=\"#maven-dockerfile\" class=\"headerlink\" title=\"maven+dockerfile\"></a>maven+dockerfile</h2><h3 id=\"src-main-dockerdockerfile\"><a href=\"#src-main-dockerdockerfile\" class=\"headerlink\" title=\"src-&gt;main-&gt;dockerdockerfile\"></a>src-&gt;main-&gt;dockerdockerfile</h3><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">FROM</span> <span class=\"string\">java:8</span></span><br><span class=\"line\">  <span class=\"comment\"># jardocker/</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">ebbms-admin-1.0.0-SNAPSHOT.jar</span> <span class=\"string\">/app.jar</span></span><br><span class=\"line\">  <span class=\"comment\"># app.jar</span></span><br><span class=\"line\"><span class=\"string\">RUN</span> <span class=\"string\">bash</span> <span class=\"string\">-c</span> <span class=\"string\">&#x27;touch /app.jar&#x27;</span></span><br><span class=\"line\">  <span class=\"comment\"># 8080</span></span><br><span class=\"line\"><span class=\"string\">EXPOSE</span> <span class=\"number\">8084</span></span><br><span class=\"line\">  <span class=\"comment\"># dockerjar</span></span><br><span class=\"line\"><span class=\"string\">ENTRYPOINT</span> [<span class=\"string\">&quot;java&quot;</span>, <span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;-Dfile.encoding=UTF-8&quot;</span>,<span class=\"string\">&quot;-Dsun.jnu.encoding=UTF-8&quot;</span>,<span class=\"string\">&quot;/app.jar&quot;</span>]</span><br><span class=\"line\">  <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LANG</span> <span class=\"string\">en_US.UTF-8</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LANGUAGE</span> <span class=\"string\">en_US:en</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_ALL</span> <span class=\"string\">en_US.UTF-8</span></span><br><span class=\"line\">  <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">MAINTAINER</span> <span class=\"string\">wangruiyu</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"pom-xmlbuild-1\"><a href=\"#pom-xmlbuild-1\" class=\"headerlink\" title=\"pom.xmlbuild\"></a>pom.xmlbuild</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.spotify<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>docker-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.1.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>build-image<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>package<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>build<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--docker--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">dockerHost</span>&gt;</span>http://192.168.1.20:2375<span class=\"tag\">&lt;/<span class=\"name\">dockerHost</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--docker--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">imageName</span>&gt;</span>$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">imageName</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--dockerfile--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">dockerDirectory</span>&gt;</span>src/main/docker<span class=\"tag\">&lt;/<span class=\"name\">dockerDirectory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--jar--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>$&#123;project.build.finalName&#125;.jar<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n"},{"title":"SpringBootdocker","date":"2021-12-20T04:30:00.000Z","_content":"\n# SpringBootdocker\n\n## pom.xmlcopy\n```xml\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-maven-plugin</artifactId>\n        </plugin>\n        <plugin>\n            <groupId>com.spotify</groupId>\n            <artifactId>docker-maven-plugin</artifactId>\n            <version>1.1.0</version>\n            <executions>\n                <execution>\n                    <id>build-image</id>\n                    <phase>package</phase>\n                    <goals>\n                        <goal>build</goal>\n                    </goals>\n                </execution>\n            </executions>\n            <configuration>\n                <dockerHost>http://192.168.1.230:2375</dockerHost>\n                <imageName>${project.artifactId}:${project.version}</imageName>\n                <dockerDirectory>src/main/docker</dockerDirectory>\n                <resources>\n                    <resource>\n                        <targetPath>/</targetPath>\n                        <directory>${project.build.directory}</directory>\n                        <include>${project.build.finalName}.jar</include>\n                    </resource>\n                    <!-- config-->\n                    <resource>\n                        <targetPath>/config</targetPath>\n                        <directory>${project.build.outputDirectory}</directory>\n                        <includes>\n                            <include>*.*</include>\n                        </includes>\n                    </resource>\n                </resources>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n```\n\n## 1.jar\n\n### dockerfile\n\n```yaml\n# \nFROM anapsix/alpine-java:8_server-jre_unlimited\n# jardocker/\nADD /ebbms-admin-1.0.0-SNAPSHOT.jar  /app.jar\n# jarconfigspringboot\nADD /config       /config\n# app.jar\nRUN bash -c 'touch /app.jar'\n# 8084\nEXPOSE 8084\n# \nENV LANG='UTF-8'\nENV LC_ALL='zh_CN.UTF-8'\nENV LC_CTYPE='zh_CN.UTF-8'\n# dockerjar\nENTRYPOINT [\"java\",\"-jar\",\"app.jar\",\"-Dfile.encoding=UTF-8\",\"-Dsun.jnu.encoding=UTF-8\"]\n# \nMAINTAINER wangruiyu\n```\n\n\n\n## 2.jar\n**/usr/local/ebbms**\n\ndockerWORKDIR\n\n****\n### dockerfile\n\n```yml\n# \nFROM anapsix/alpine-java:8_server-jre_unlimited\n# jardocker/\nADD /ebbms-admin-1.0.0-SNAPSHOT.jar  /usr/local/ebbms/app.jar\nADD /config       /usr/local/ebbms/config\n# app.jar\nRUN bash -c 'touch /usr/local/ebbms/app.jar'\n# 8084\nEXPOSE 8084\n# \nENV LANG='UTF-8'\nENV LC_ALL='zh_CN.UTF-8'\nENV LC_CTYPE='zh_CN.UTF-8'\n# jar\nWORKDIR /usr/local/ebbms\n# dockerjar\nENTRYPOINT [\"java\",\"-jar\",\"app.jar\",\"-Dfile.encoding=UTF-8\",\"-Dsun.jnu.encoding=UTF-8\"]\n# \nMAINTAINER wangruiyu\n\n```\n\n\n\n## 3.jar\n**/usr/local/ebbms**\n\ndockerjarspring.config.location \n### dockerfile\n\n```yml\n# \nFROM anapsix/alpine-java:8_server-jre_unlimited\n# jardocker/\nADD /ebbms-admin-1.0.0-SNAPSHOT.jar  /usr/local/ebbms/app.jar\nADD /config       /usr/local/ebbms/config\n# app.jar\nRUN bash -c 'touch /usr/local/ebbms/app.jar'\n# 8084\nEXPOSE 8084\n# \nENV LANG='UTF-8'\nENV LC_ALL='zh_CN.UTF-8'\nENV LC_CTYPE='zh_CN.UTF-8'\n# dockerjar,spring.config.location \nENTRYPOINT [\"java\",\"-jar\",\"app.jar\",\"--spring.config.location=/usr/local/ebbms/config/application.yaml\",\"-Dfile.encoding=UTF-8\",\"-Dsun.jnu.encoding=UTF-8\"]\n# \nMAINTAINER wangruiyu\n\n```\n\n","source":"_posts/2023/docker-springboot-config.md","raw":"---\ntitle: SpringBootdocker\ndate: 2021-12-20 12:30:00\ntags:\n - springboot\n - docker\n---\n\n# SpringBootdocker\n\n## pom.xmlcopy\n```xml\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-maven-plugin</artifactId>\n        </plugin>\n        <plugin>\n            <groupId>com.spotify</groupId>\n            <artifactId>docker-maven-plugin</artifactId>\n            <version>1.1.0</version>\n            <executions>\n                <execution>\n                    <id>build-image</id>\n                    <phase>package</phase>\n                    <goals>\n                        <goal>build</goal>\n                    </goals>\n                </execution>\n            </executions>\n            <configuration>\n                <dockerHost>http://192.168.1.230:2375</dockerHost>\n                <imageName>${project.artifactId}:${project.version}</imageName>\n                <dockerDirectory>src/main/docker</dockerDirectory>\n                <resources>\n                    <resource>\n                        <targetPath>/</targetPath>\n                        <directory>${project.build.directory}</directory>\n                        <include>${project.build.finalName}.jar</include>\n                    </resource>\n                    <!-- config-->\n                    <resource>\n                        <targetPath>/config</targetPath>\n                        <directory>${project.build.outputDirectory}</directory>\n                        <includes>\n                            <include>*.*</include>\n                        </includes>\n                    </resource>\n                </resources>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n```\n\n## 1.jar\n\n### dockerfile\n\n```yaml\n# \nFROM anapsix/alpine-java:8_server-jre_unlimited\n# jardocker/\nADD /ebbms-admin-1.0.0-SNAPSHOT.jar  /app.jar\n# jarconfigspringboot\nADD /config       /config\n# app.jar\nRUN bash -c 'touch /app.jar'\n# 8084\nEXPOSE 8084\n# \nENV LANG='UTF-8'\nENV LC_ALL='zh_CN.UTF-8'\nENV LC_CTYPE='zh_CN.UTF-8'\n# dockerjar\nENTRYPOINT [\"java\",\"-jar\",\"app.jar\",\"-Dfile.encoding=UTF-8\",\"-Dsun.jnu.encoding=UTF-8\"]\n# \nMAINTAINER wangruiyu\n```\n\n\n\n## 2.jar\n**/usr/local/ebbms**\n\ndockerWORKDIR\n\n****\n### dockerfile\n\n```yml\n# \nFROM anapsix/alpine-java:8_server-jre_unlimited\n# jardocker/\nADD /ebbms-admin-1.0.0-SNAPSHOT.jar  /usr/local/ebbms/app.jar\nADD /config       /usr/local/ebbms/config\n# app.jar\nRUN bash -c 'touch /usr/local/ebbms/app.jar'\n# 8084\nEXPOSE 8084\n# \nENV LANG='UTF-8'\nENV LC_ALL='zh_CN.UTF-8'\nENV LC_CTYPE='zh_CN.UTF-8'\n# jar\nWORKDIR /usr/local/ebbms\n# dockerjar\nENTRYPOINT [\"java\",\"-jar\",\"app.jar\",\"-Dfile.encoding=UTF-8\",\"-Dsun.jnu.encoding=UTF-8\"]\n# \nMAINTAINER wangruiyu\n\n```\n\n\n\n## 3.jar\n**/usr/local/ebbms**\n\ndockerjarspring.config.location \n### dockerfile\n\n```yml\n# \nFROM anapsix/alpine-java:8_server-jre_unlimited\n# jardocker/\nADD /ebbms-admin-1.0.0-SNAPSHOT.jar  /usr/local/ebbms/app.jar\nADD /config       /usr/local/ebbms/config\n# app.jar\nRUN bash -c 'touch /usr/local/ebbms/app.jar'\n# 8084\nEXPOSE 8084\n# \nENV LANG='UTF-8'\nENV LC_ALL='zh_CN.UTF-8'\nENV LC_CTYPE='zh_CN.UTF-8'\n# dockerjar,spring.config.location \nENTRYPOINT [\"java\",\"-jar\",\"app.jar\",\"--spring.config.location=/usr/local/ebbms/config/application.yaml\",\"-Dfile.encoding=UTF-8\",\"-Dsun.jnu.encoding=UTF-8\"]\n# \nMAINTAINER wangruiyu\n\n```\n\n","slug":"2023/docker-springboot-config","published":1,"updated":"2024-08-05T11:07:24.333Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiuy0007vaibdvf40roq","content":"<h1 id=\"SpringBootdocker\"><a href=\"#SpringBootdocker\" class=\"headerlink\" title=\"SpringBootdocker\"></a>SpringBootdocker</h1><h2 id=\"pom-xmlcopy\"><a href=\"#pom-xmlcopy\" class=\"headerlink\" title=\"pom.xmlcopy\"></a>pom.xmlcopy</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.spotify<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>docker-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.1.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>build-image<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>package<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>build<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">dockerHost</span>&gt;</span>http://192.168.1.230:2375<span class=\"tag\">&lt;/<span class=\"name\">dockerHost</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">imageName</span>&gt;</span>$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">imageName</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">dockerDirectory</span>&gt;</span>src/main/docker<span class=\"tag\">&lt;/<span class=\"name\">dockerDirectory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>$&#123;project.build.finalName&#125;.jar<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"comment\">&lt;!-- config--&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>/config<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>$&#123;project.build.outputDirectory&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>*.*<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;/<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"1-jar\"><a href=\"#1-jar\" class=\"headerlink\" title=\"1.jar\"></a>1.jar</h2><h3 id=\"dockerfile\"><a href=\"#dockerfile\" class=\"headerlink\" title=\"dockerfile\"></a>dockerfile</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">FROM</span> <span class=\"string\">anapsix/alpine-java:8_server-jre_unlimited</span></span><br><span class=\"line\"><span class=\"comment\"># jardocker/</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/ebbms-admin-1.0.0-SNAPSHOT.jar</span>  <span class=\"string\">/app.jar</span></span><br><span class=\"line\"><span class=\"comment\"># jarconfigspringboot</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/config</span>       <span class=\"string\">/config</span></span><br><span class=\"line\"><span class=\"comment\"># app.jar</span></span><br><span class=\"line\"><span class=\"string\">RUN</span> <span class=\"string\">bash</span> <span class=\"string\">-c</span> <span class=\"string\">&#x27;touch /app.jar&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># 8084</span></span><br><span class=\"line\"><span class=\"string\">EXPOSE</span> <span class=\"number\">8084</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LANG=&#x27;UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_ALL=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_CTYPE=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># dockerjar</span></span><br><span class=\"line\"><span class=\"string\">ENTRYPOINT</span> [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;app.jar&quot;</span>,<span class=\"string\">&quot;-Dfile.encoding=UTF-8&quot;</span>,<span class=\"string\">&quot;-Dsun.jnu.encoding=UTF-8&quot;</span>]</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">MAINTAINER</span> <span class=\"string\">wangruiyu</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"2-jar\"><a href=\"#2-jar\" class=\"headerlink\" title=\"2.jar\"></a>2.jar</h2><p><strong>&#x2F;usr&#x2F;local&#x2F;ebbms</strong></p>\n<p>dockerWORKDIR</p>\n<p><strong></strong></p>\n<h3 id=\"dockerfile\"><a href=\"#dockerfile\" class=\"headerlink\" title=\"dockerfile\"></a>dockerfile</h3><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">FROM</span> <span class=\"string\">anapsix/alpine-java:8_server-jre_unlimited</span></span><br><span class=\"line\"><span class=\"comment\"># jardocker/</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/ebbms-admin-1.0.0-SNAPSHOT.jar</span>  <span class=\"string\">/usr/local/ebbms/app.jar</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/config</span>       <span class=\"string\">/usr/local/ebbms/config</span></span><br><span class=\"line\"><span class=\"comment\"># app.jar</span></span><br><span class=\"line\"><span class=\"string\">RUN</span> <span class=\"string\">bash</span> <span class=\"string\">-c</span> <span class=\"string\">&#x27;touch /usr/local/ebbms/app.jar&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># 8084</span></span><br><span class=\"line\"><span class=\"string\">EXPOSE</span> <span class=\"number\">8084</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LANG=&#x27;UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_ALL=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_CTYPE=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># jar</span></span><br><span class=\"line\"><span class=\"string\">WORKDIR</span> <span class=\"string\">/usr/local/ebbms</span></span><br><span class=\"line\"><span class=\"comment\"># dockerjar</span></span><br><span class=\"line\"><span class=\"string\">ENTRYPOINT</span> [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;app.jar&quot;</span>,<span class=\"string\">&quot;-Dfile.encoding=UTF-8&quot;</span>,<span class=\"string\">&quot;-Dsun.jnu.encoding=UTF-8&quot;</span>]</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">MAINTAINER</span> <span class=\"string\">wangruiyu</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"3-jar\"><a href=\"#3-jar\" class=\"headerlink\" title=\"3.jar\"></a>3.jar</h2><p><strong>&#x2F;usr&#x2F;local&#x2F;ebbms</strong></p>\n<p>dockerjarspring.config.location </p>\n<h3 id=\"dockerfile-1\"><a href=\"#dockerfile-1\" class=\"headerlink\" title=\"dockerfile\"></a>dockerfile</h3><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">FROM</span> <span class=\"string\">anapsix/alpine-java:8_server-jre_unlimited</span></span><br><span class=\"line\"><span class=\"comment\"># jardocker/</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/ebbms-admin-1.0.0-SNAPSHOT.jar</span>  <span class=\"string\">/usr/local/ebbms/app.jar</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/config</span>       <span class=\"string\">/usr/local/ebbms/config</span></span><br><span class=\"line\"><span class=\"comment\"># app.jar</span></span><br><span class=\"line\"><span class=\"string\">RUN</span> <span class=\"string\">bash</span> <span class=\"string\">-c</span> <span class=\"string\">&#x27;touch /usr/local/ebbms/app.jar&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># 8084</span></span><br><span class=\"line\"><span class=\"string\">EXPOSE</span> <span class=\"number\">8084</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LANG=&#x27;UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_ALL=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_CTYPE=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># dockerjar,spring.config.location </span></span><br><span class=\"line\"><span class=\"string\">ENTRYPOINT</span> [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;app.jar&quot;</span>,<span class=\"string\">&quot;--spring.config.location=/usr/local/ebbms/config/application.yaml&quot;</span>,<span class=\"string\">&quot;-Dfile.encoding=UTF-8&quot;</span>,<span class=\"string\">&quot;-Dsun.jnu.encoding=UTF-8&quot;</span>]</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">MAINTAINER</span> <span class=\"string\">wangruiyu</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n","cover":false,"excerpt":"","more":"<h1 id=\"SpringBootdocker\"><a href=\"#SpringBootdocker\" class=\"headerlink\" title=\"SpringBootdocker\"></a>SpringBootdocker</h1><h2 id=\"pom-xmlcopy\"><a href=\"#pom-xmlcopy\" class=\"headerlink\" title=\"pom.xmlcopy\"></a>pom.xmlcopy</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.spotify<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>docker-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.1.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>build-image<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>package<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>build<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">dockerHost</span>&gt;</span>http://192.168.1.230:2375<span class=\"tag\">&lt;/<span class=\"name\">dockerHost</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">imageName</span>&gt;</span>$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">imageName</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">dockerDirectory</span>&gt;</span>src/main/docker<span class=\"tag\">&lt;/<span class=\"name\">dockerDirectory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>$&#123;project.build.finalName&#125;.jar<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"comment\">&lt;!-- config--&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>/config<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>$&#123;project.build.outputDirectory&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>*.*<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;/<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"1-jar\"><a href=\"#1-jar\" class=\"headerlink\" title=\"1.jar\"></a>1.jar</h2><h3 id=\"dockerfile\"><a href=\"#dockerfile\" class=\"headerlink\" title=\"dockerfile\"></a>dockerfile</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">FROM</span> <span class=\"string\">anapsix/alpine-java:8_server-jre_unlimited</span></span><br><span class=\"line\"><span class=\"comment\"># jardocker/</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/ebbms-admin-1.0.0-SNAPSHOT.jar</span>  <span class=\"string\">/app.jar</span></span><br><span class=\"line\"><span class=\"comment\"># jarconfigspringboot</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/config</span>       <span class=\"string\">/config</span></span><br><span class=\"line\"><span class=\"comment\"># app.jar</span></span><br><span class=\"line\"><span class=\"string\">RUN</span> <span class=\"string\">bash</span> <span class=\"string\">-c</span> <span class=\"string\">&#x27;touch /app.jar&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># 8084</span></span><br><span class=\"line\"><span class=\"string\">EXPOSE</span> <span class=\"number\">8084</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LANG=&#x27;UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_ALL=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_CTYPE=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># dockerjar</span></span><br><span class=\"line\"><span class=\"string\">ENTRYPOINT</span> [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;app.jar&quot;</span>,<span class=\"string\">&quot;-Dfile.encoding=UTF-8&quot;</span>,<span class=\"string\">&quot;-Dsun.jnu.encoding=UTF-8&quot;</span>]</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">MAINTAINER</span> <span class=\"string\">wangruiyu</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"2-jar\"><a href=\"#2-jar\" class=\"headerlink\" title=\"2.jar\"></a>2.jar</h2><p><strong>&#x2F;usr&#x2F;local&#x2F;ebbms</strong></p>\n<p>dockerWORKDIR</p>\n<p><strong></strong></p>\n<h3 id=\"dockerfile\"><a href=\"#dockerfile\" class=\"headerlink\" title=\"dockerfile\"></a>dockerfile</h3><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">FROM</span> <span class=\"string\">anapsix/alpine-java:8_server-jre_unlimited</span></span><br><span class=\"line\"><span class=\"comment\"># jardocker/</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/ebbms-admin-1.0.0-SNAPSHOT.jar</span>  <span class=\"string\">/usr/local/ebbms/app.jar</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/config</span>       <span class=\"string\">/usr/local/ebbms/config</span></span><br><span class=\"line\"><span class=\"comment\"># app.jar</span></span><br><span class=\"line\"><span class=\"string\">RUN</span> <span class=\"string\">bash</span> <span class=\"string\">-c</span> <span class=\"string\">&#x27;touch /usr/local/ebbms/app.jar&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># 8084</span></span><br><span class=\"line\"><span class=\"string\">EXPOSE</span> <span class=\"number\">8084</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LANG=&#x27;UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_ALL=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_CTYPE=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># jar</span></span><br><span class=\"line\"><span class=\"string\">WORKDIR</span> <span class=\"string\">/usr/local/ebbms</span></span><br><span class=\"line\"><span class=\"comment\"># dockerjar</span></span><br><span class=\"line\"><span class=\"string\">ENTRYPOINT</span> [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;app.jar&quot;</span>,<span class=\"string\">&quot;-Dfile.encoding=UTF-8&quot;</span>,<span class=\"string\">&quot;-Dsun.jnu.encoding=UTF-8&quot;</span>]</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">MAINTAINER</span> <span class=\"string\">wangruiyu</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"3-jar\"><a href=\"#3-jar\" class=\"headerlink\" title=\"3.jar\"></a>3.jar</h2><p><strong>&#x2F;usr&#x2F;local&#x2F;ebbms</strong></p>\n<p>dockerjarspring.config.location </p>\n<h3 id=\"dockerfile-1\"><a href=\"#dockerfile-1\" class=\"headerlink\" title=\"dockerfile\"></a>dockerfile</h3><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">FROM</span> <span class=\"string\">anapsix/alpine-java:8_server-jre_unlimited</span></span><br><span class=\"line\"><span class=\"comment\"># jardocker/</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/ebbms-admin-1.0.0-SNAPSHOT.jar</span>  <span class=\"string\">/usr/local/ebbms/app.jar</span></span><br><span class=\"line\"><span class=\"string\">ADD</span> <span class=\"string\">/config</span>       <span class=\"string\">/usr/local/ebbms/config</span></span><br><span class=\"line\"><span class=\"comment\"># app.jar</span></span><br><span class=\"line\"><span class=\"string\">RUN</span> <span class=\"string\">bash</span> <span class=\"string\">-c</span> <span class=\"string\">&#x27;touch /usr/local/ebbms/app.jar&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># 8084</span></span><br><span class=\"line\"><span class=\"string\">EXPOSE</span> <span class=\"number\">8084</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LANG=&#x27;UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_ALL=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ENV</span> <span class=\"string\">LC_CTYPE=&#x27;zh_CN.UTF-8&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># dockerjar,spring.config.location </span></span><br><span class=\"line\"><span class=\"string\">ENTRYPOINT</span> [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;app.jar&quot;</span>,<span class=\"string\">&quot;--spring.config.location=/usr/local/ebbms/config/application.yaml&quot;</span>,<span class=\"string\">&quot;-Dfile.encoding=UTF-8&quot;</span>,<span class=\"string\">&quot;-Dsun.jnu.encoding=UTF-8&quot;</span>]</span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">MAINTAINER</span> <span class=\"string\">wangruiyu</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n"},{"title":"Docker","date":"2021-12-20T04:30:00.000Z","_content":"\n![img.png](img.png)\n\n- [](https://dockerdocs.cn/index.html)\n- [](https://docs.docker.com/)\n- [DockerHub](https://hub.docker.com/)\n- [](https://gist.github.com/y0ngb1n/7e8f16af3242c7815e7ca2f0833d3ea6)\n\n\n## \n### 1.\nCentOS7 643.10\nCentOS6 6.5642.6.32-431\n\n```shell\nuname -r #\n\ncat /etc/os-release #.\n```\ncentos-extras\nCentos 7centos-extras\n### 2.\n\n```shell\nsudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n```\nDocker\n```shell\nsudo rm /var/lib/docker/ -rf\n```\n### 3.\n#### yum\n\n```shell\nsudo yum install -y yum-utils \\\n  device-mapper-persistent-data \\\n  lvm2\n```\n\n```shell\nsudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n```\n\n```shell\n#\nsudo rm -f /etc/yum.repos.d/docker-ce.repo\n\n#\nsudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n```\n#### yum\n```shell\nsudo yum makecache fast\n```\n### 4.Docker-CE\n\n#### \n```shell\nsudo yum install -y docker-ce docker-ce-cli containerd.io\n```\n#### \n\n```shell\nyum list docker-ce --showduplicates | sort -r\n\n# \n# docker-ce.x86_64  3:18.09.1-3.el7                     docker-ce-stable\n# docker-ce.x86_64  3:18.09.0-3.el7                     docker-ce-stable\n# docker-ce.x86_64  18.06.1.ce-3.el7                    docker-ce-stable\n# docker-ce.x86_64  18.06.0.ce-3.el7                    docker-ce-stable\n```\n\n18.06.0.ce-3.el7\n```shell\nsudo yum install docker-ce-<VERSION_STRING> docker-ce-cli-<VERSION_STRING> containerd.io\n```\n### ****\n**Docker**\n[https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors](https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors)\n## \n### Docker\n```shell\nsystemctl start docker\n```\n### \n```shell\ndocker run  hello-world\n```\n### \n```shell\ndocker images\n```\n![](https://cdn.nlark.com/yuque/0/2022/png/21973095/1672381927401-6e68e3d2-847d-42e8-aeba-d5aec4ca9a9c.png#averageHue=%23262a2c&id=xsf1S&originHeight=77&originWidth=821&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)\n\n- REPOSITORY: \n- TAG:  :\n- IMAGE ID :ID\n- CREATED :\n- SIZE: \n### \n```shell\ndocker images -a\n```\n### ID\n```shell\ndocker images -q\n```\n### ID\n```shell\ndocker images -qa\n```\n### \n```shell\ndocker images --digests\n```\n### \n```shell\ndocker images --digests --no-trunc\n```\n### \n```shell\ndocker search \n```\n### Start30tomca\n```shell\ndocker search -s 30 tomcat\n```\n### \n```shell\ndocker pull :latest   \n```\n### \n```shell\ndocker rmi \n```\n### \n```shell\ndocker rmi -f \n```\n### \n```shell\ndocker rmi   :TAG  2:TAG\n```\n### \n```shell\ndocker rmi -f $(docker images -q)\n\n```\n### \n#### \n```shell\ndocker run [OPTIONS] IMAGE [COMMAND] [ARG...]\n```\n#### OPTIONS\n\n- **-a stdin:** STDIN/STDOUT/STDERR \n- **-d:**ID\n- **-i:** -t \n- **-t:** -i \n- **-P:******\n- **-p:****():**\n- **--name=\"nginx-lb\":**\n- **--dns 8.8.8.8:**DNS\n- **--dns-search example.com:**DNS\n- **-h \"mars\":**hostname\n- **-e username=\"ritchie\":**\n- **--env-file=[]:**\n- **--cpuset=\"0-2\" or --cpuset=\"0,1,2\":**CPU\n- **-m :**\n- **--net=\"bridge\":** bridge/host/none/container:\n- **--link=[]:**\n- **--expose=[]:**\n- **--volume , -v:**\n#### \ndockernginx:latest,mynginx\n`docker run --name mynginx -d nginx:latest`\nnginx:latest,80\n`docker run -P -d nginx:latest`\n nginx:latest, 80  80 , /data  /data\n`docker run -p 80:80 -v /data:/data -d nginx:latest`\n 8080  127.0.0.1  80 \n`$docker run -p 127.0.0.1:80:8080/tcp ubuntu bash`\nnginx:latest**-n:**N,/bin/bash\n`docker run -it nginx:latest /bin/bash`\n### \n#### \n```shell\ndocker ps  [OPTIONS] \n```\n#### OPTIONS\n\n- **-a :**+\n- **-l:**ID\n- **-n:**N\n- **-q:**Id\n- -**-no -trunc**\n#### \n`exit` \n`ctrl+P+Q `\n#### \n```shell\ndocker start ID\n```\n#### \n```shell\ndocker restart ID\n```\n#### \n```shell\ndocker stop ID   \n\ndocker kill ID   \n```\n#### \n```shell\ndocker rm ID\n```\n#### \n```shell\ndocker rm  -f $(docker ps -a -q)\n# \ndocker ps -a -q|xagrgs docker rm\n```\n\n```shell\ndocker inspect ID\n```\n#### IP\n```shell\ndocker inspect ID |grep \"IPAddress\"\n```\n#### \n```shell\ndocker exec -it ID bashShell(shell)\n```\n#### \n```shell\ndocker attach ID\n```\n**exec attach**\n\n- attach :\n- exec\n\n","source":"_posts/2023/docker.md","raw":"---\ntitle: Docker\ndate: 2021-12-20 12:30:00\ntags:\n - docker\ncategories:\n - Docker\n---\n\n![img.png](img.png)\n\n- [](https://dockerdocs.cn/index.html)\n- [](https://docs.docker.com/)\n- [DockerHub](https://hub.docker.com/)\n- [](https://gist.github.com/y0ngb1n/7e8f16af3242c7815e7ca2f0833d3ea6)\n\n\n## \n### 1.\nCentOS7 643.10\nCentOS6 6.5642.6.32-431\n\n```shell\nuname -r #\n\ncat /etc/os-release #.\n```\ncentos-extras\nCentos 7centos-extras\n### 2.\n\n```shell\nsudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n```\nDocker\n```shell\nsudo rm /var/lib/docker/ -rf\n```\n### 3.\n#### yum\n\n```shell\nsudo yum install -y yum-utils \\\n  device-mapper-persistent-data \\\n  lvm2\n```\n\n```shell\nsudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n```\n\n```shell\n#\nsudo rm -f /etc/yum.repos.d/docker-ce.repo\n\n#\nsudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n```\n#### yum\n```shell\nsudo yum makecache fast\n```\n### 4.Docker-CE\n\n#### \n```shell\nsudo yum install -y docker-ce docker-ce-cli containerd.io\n```\n#### \n\n```shell\nyum list docker-ce --showduplicates | sort -r\n\n# \n# docker-ce.x86_64  3:18.09.1-3.el7                     docker-ce-stable\n# docker-ce.x86_64  3:18.09.0-3.el7                     docker-ce-stable\n# docker-ce.x86_64  18.06.1.ce-3.el7                    docker-ce-stable\n# docker-ce.x86_64  18.06.0.ce-3.el7                    docker-ce-stable\n```\n\n18.06.0.ce-3.el7\n```shell\nsudo yum install docker-ce-<VERSION_STRING> docker-ce-cli-<VERSION_STRING> containerd.io\n```\n### ****\n**Docker**\n[https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors](https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors)\n## \n### Docker\n```shell\nsystemctl start docker\n```\n### \n```shell\ndocker run  hello-world\n```\n### \n```shell\ndocker images\n```\n![](https://cdn.nlark.com/yuque/0/2022/png/21973095/1672381927401-6e68e3d2-847d-42e8-aeba-d5aec4ca9a9c.png#averageHue=%23262a2c&id=xsf1S&originHeight=77&originWidth=821&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)\n\n- REPOSITORY: \n- TAG:  :\n- IMAGE ID :ID\n- CREATED :\n- SIZE: \n### \n```shell\ndocker images -a\n```\n### ID\n```shell\ndocker images -q\n```\n### ID\n```shell\ndocker images -qa\n```\n### \n```shell\ndocker images --digests\n```\n### \n```shell\ndocker images --digests --no-trunc\n```\n### \n```shell\ndocker search \n```\n### Start30tomca\n```shell\ndocker search -s 30 tomcat\n```\n### \n```shell\ndocker pull :latest   \n```\n### \n```shell\ndocker rmi \n```\n### \n```shell\ndocker rmi -f \n```\n### \n```shell\ndocker rmi   :TAG  2:TAG\n```\n### \n```shell\ndocker rmi -f $(docker images -q)\n\n```\n### \n#### \n```shell\ndocker run [OPTIONS] IMAGE [COMMAND] [ARG...]\n```\n#### OPTIONS\n\n- **-a stdin:** STDIN/STDOUT/STDERR \n- **-d:**ID\n- **-i:** -t \n- **-t:** -i \n- **-P:******\n- **-p:****():**\n- **--name=\"nginx-lb\":**\n- **--dns 8.8.8.8:**DNS\n- **--dns-search example.com:**DNS\n- **-h \"mars\":**hostname\n- **-e username=\"ritchie\":**\n- **--env-file=[]:**\n- **--cpuset=\"0-2\" or --cpuset=\"0,1,2\":**CPU\n- **-m :**\n- **--net=\"bridge\":** bridge/host/none/container:\n- **--link=[]:**\n- **--expose=[]:**\n- **--volume , -v:**\n#### \ndockernginx:latest,mynginx\n`docker run --name mynginx -d nginx:latest`\nnginx:latest,80\n`docker run -P -d nginx:latest`\n nginx:latest, 80  80 , /data  /data\n`docker run -p 80:80 -v /data:/data -d nginx:latest`\n 8080  127.0.0.1  80 \n`$docker run -p 127.0.0.1:80:8080/tcp ubuntu bash`\nnginx:latest**-n:**N,/bin/bash\n`docker run -it nginx:latest /bin/bash`\n### \n#### \n```shell\ndocker ps  [OPTIONS] \n```\n#### OPTIONS\n\n- **-a :**+\n- **-l:**ID\n- **-n:**N\n- **-q:**Id\n- -**-no -trunc**\n#### \n`exit` \n`ctrl+P+Q `\n#### \n```shell\ndocker start ID\n```\n#### \n```shell\ndocker restart ID\n```\n#### \n```shell\ndocker stop ID   \n\ndocker kill ID   \n```\n#### \n```shell\ndocker rm ID\n```\n#### \n```shell\ndocker rm  -f $(docker ps -a -q)\n# \ndocker ps -a -q|xagrgs docker rm\n```\n\n```shell\ndocker inspect ID\n```\n#### IP\n```shell\ndocker inspect ID |grep \"IPAddress\"\n```\n#### \n```shell\ndocker exec -it ID bashShell(shell)\n```\n#### \n```shell\ndocker attach ID\n```\n**exec attach**\n\n- attach :\n- exec\n\n","slug":"2023/docker","published":1,"updated":"2024-08-05T11:07:24.333Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiuz0009vaib59789ptl","content":"<p><img src=\"/post/2023/docker/img.png\" alt=\"img.png\"></p>\n<ul>\n<li><a href=\"https://dockerdocs.cn/index.html\"></a></li>\n<li><a href=\"https://docs.docker.com/\"></a></li>\n<li><a href=\"https://hub.docker.com/\">DockerHub</a></li>\n<li><a href=\"https://gist.github.com/y0ngb1n/7e8f16af3242c7815e7ca2f0833d3ea6\"></a></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>CentOS7 643.10<br>CentOS6 6.5642.6.32-431<br></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname -r #</span><br><span class=\"line\"></span><br><span class=\"line\">cat /etc/os-release #.</span><br></pre></td></tr></table></figure>\n<p>centos-extras<br>Centos 7centos-extras</p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum remove docker \\</span><br><span class=\"line\">                  docker-client \\</span><br><span class=\"line\">                  docker-client-latest \\</span><br><span class=\"line\">                  docker-common \\</span><br><span class=\"line\">                  docker-latest \\</span><br><span class=\"line\">                  docker-latest-logrotate \\</span><br><span class=\"line\">                  docker-logrotate \\</span><br><span class=\"line\">                  docker-engine</span><br></pre></td></tr></table></figure>\n<p>Docker</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo rm /var/lib/docker/ -rf</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><h4 id=\"yum\"><a href=\"#yum\" class=\"headerlink\" title=\"yum\"></a>yum</h4><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y yum-utils \\</span><br><span class=\"line\">  device-mapper-persistent-data \\</span><br><span class=\"line\">  lvm2</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\"></span></span><br><span class=\"line\">sudo rm -f /etc/yum.repos.d/docker-ce.repo</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\"></span></span><br><span class=\"line\">sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>\n<h4 id=\"yum\"><a href=\"#yum\" class=\"headerlink\" title=\"yum\"></a>yum</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum makecache fast</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-Docker-CE\"><a href=\"#4-Docker-CE\" class=\"headerlink\" title=\"4.Docker-CE\"></a>4.Docker-CE</h3><p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list docker-ce --showduplicates | sort -r</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">docker-ce.x86_64  3:18.09.1-3.el7                     docker-ce-stable</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">docker-ce.x86_64  3:18.09.0-3.el7                     docker-ce-stable</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">docker-ce.x86_64  18.06.1.ce-3.el7                    docker-ce-stable</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">docker-ce.x86_64  18.06.0.ce-3.el7                    docker-ce-stable</span></span><br></pre></td></tr></table></figure>\n<p><br>18.06.0.ce-3.el7</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><p><strong>Docker</strong><br><a href=\"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors\">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start docker</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run  hello-world</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/21973095/1672381927401-6e68e3d2-847d-42e8-aeba-d5aec4ca9a9c.png#averageHue=%23262a2c&id=xsf1S&originHeight=77&originWidth=821&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\"></p>\n<ul>\n<li>REPOSITORY: </li>\n<li>TAG:  :</li>\n<li>IMAGE ID :ID</li>\n<li>CREATED :</li>\n<li>SIZE: </li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images -a</span><br></pre></td></tr></table></figure>\n<h3 id=\"ID\"><a href=\"#ID\" class=\"headerlink\" title=\"ID\"></a>ID</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images -q</span><br></pre></td></tr></table></figure>\n<h3 id=\"ID\"><a href=\"#ID\" class=\"headerlink\" title=\"ID\"></a>ID</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images -qa</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images --digests</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images --digests --no-trunc</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker search </span><br></pre></td></tr></table></figure>\n<h3 id=\"Start30tomca\"><a href=\"#Start30tomca\" class=\"headerlink\" title=\"Start30tomca\"></a>Start30tomca</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker search -s 30 tomcat</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull :latest   </span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi </span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi -f </span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi   :TAG  2:TAG</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi -f $(docker images -q)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br></pre></td></tr></table></figure>\n<h4 id=\"OPTIONS\"><a href=\"#OPTIONS\" class=\"headerlink\" title=\"OPTIONS\"></a>OPTIONS</h4><ul>\n<li><strong>-a stdin:</strong> STDIN&#x2F;STDOUT&#x2F;STDERR </li>\n<li><strong>-d:</strong>ID</li>\n<li><strong>-i:</strong> -t </li>\n<li><strong>-t:</strong> -i </li>\n<li><strong>-P:</strong><strong></strong></li>\n<li><strong>-p:</strong><strong>():</strong></li>\n<li><strong>name&#x3D;nginx-lb:</strong></li>\n<li><strong>dns 8.8.8.8:</strong>DNS</li>\n<li><strong>dns-search example.com:</strong>DNS</li>\n<li><strong>-h mars:</strong>hostname</li>\n<li><strong>-e username&#x3D;ritchie:</strong></li>\n<li><strong>env-file&#x3D;[]:</strong></li>\n<li><strong>cpuset&#x3D;0-2 or cpuset&#x3D;0,1,2:</strong>CPU</li>\n<li>**-m :**</li>\n<li><strong>net&#x3D;bridge:</strong> bridge&#x2F;host&#x2F;none&#x2F;container:</li>\n<li><strong>link&#x3D;[]:</strong></li>\n<li><strong>expose&#x3D;[]:</strong></li>\n<li>**volume , -v:**</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>dockernginx:latest,mynginx<br><code>docker run --name mynginx -d nginx:latest</code><br>nginx:latest,80<br><code>docker run -P -d nginx:latest</code><br> nginx:latest, 80  80 , &#x2F;data  &#x2F;data<br><code>docker run -p 80:80 -v /data:/data -d nginx:latest</code><br> 8080  127.0.0.1  80 <br><code>$docker run -p 127.0.0.1:80:8080/tcp ubuntu bash</code><br>nginx:latest**-n:**N,&#x2F;bin&#x2F;bash<br><code>docker run -it nginx:latest /bin/bash</code></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker ps  [OPTIONS] </span><br></pre></td></tr></table></figure>\n<h4 id=\"OPTIONS\"><a href=\"#OPTIONS\" class=\"headerlink\" title=\"OPTIONS\"></a>OPTIONS</h4><ul>\n<li>**-a :**+</li>\n<li><strong>-l:</strong>ID</li>\n<li><strong>-n:</strong>N</li>\n<li><strong>-q:</strong>Id</li>\n<li>-<strong>-no -trunc</strong></li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><code>exit</code> <br><code>ctrl+P+Q </code></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker start ID</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker restart ID</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker stop ID   </span><br><span class=\"line\"></span><br><span class=\"line\">docker kill ID   </span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rm ID</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rm  -f $(docker ps -a -q)</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"></span></span><br><span class=\"line\">docker ps -a -q|xagrgs docker rm</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker inspect ID</span><br></pre></td></tr></table></figure>\n<h4 id=\"IP\"><a href=\"#IP\" class=\"headerlink\" title=\"IP\"></a>IP</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker inspect ID |grep &quot;IPAddress&quot;</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it ID bashShell(shell)</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker attach ID</span><br></pre></td></tr></table></figure>\n<p><strong>exec attach</strong></p>\n<ul>\n<li>attach :</li>\n<li>exec</li>\n</ul>\n","cover":false,"excerpt":"","more":"<p><img src=\"/post/2023/docker/img.png\" alt=\"img.png\"></p>\n<ul>\n<li><a href=\"https://dockerdocs.cn/index.html\"></a></li>\n<li><a href=\"https://docs.docker.com/\"></a></li>\n<li><a href=\"https://hub.docker.com/\">DockerHub</a></li>\n<li><a href=\"https://gist.github.com/y0ngb1n/7e8f16af3242c7815e7ca2f0833d3ea6\"></a></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>CentOS7 643.10<br>CentOS6 6.5642.6.32-431<br></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname -r #</span><br><span class=\"line\"></span><br><span class=\"line\">cat /etc/os-release #.</span><br></pre></td></tr></table></figure>\n<p>centos-extras<br>Centos 7centos-extras</p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum remove docker \\</span><br><span class=\"line\">                  docker-client \\</span><br><span class=\"line\">                  docker-client-latest \\</span><br><span class=\"line\">                  docker-common \\</span><br><span class=\"line\">                  docker-latest \\</span><br><span class=\"line\">                  docker-latest-logrotate \\</span><br><span class=\"line\">                  docker-logrotate \\</span><br><span class=\"line\">                  docker-engine</span><br></pre></td></tr></table></figure>\n<p>Docker</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo rm /var/lib/docker/ -rf</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><h4 id=\"yum\"><a href=\"#yum\" class=\"headerlink\" title=\"yum\"></a>yum</h4><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y yum-utils \\</span><br><span class=\"line\">  device-mapper-persistent-data \\</span><br><span class=\"line\">  lvm2</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\"></span></span><br><span class=\"line\">sudo rm -f /etc/yum.repos.d/docker-ce.repo</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\"></span></span><br><span class=\"line\">sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>\n<h4 id=\"yum\"><a href=\"#yum\" class=\"headerlink\" title=\"yum\"></a>yum</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum makecache fast</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-Docker-CE\"><a href=\"#4-Docker-CE\" class=\"headerlink\" title=\"4.Docker-CE\"></a>4.Docker-CE</h3><p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list docker-ce --showduplicates | sort -r</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">docker-ce.x86_64  3:18.09.1-3.el7                     docker-ce-stable</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">docker-ce.x86_64  3:18.09.0-3.el7                     docker-ce-stable</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">docker-ce.x86_64  18.06.1.ce-3.el7                    docker-ce-stable</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">docker-ce.x86_64  18.06.0.ce-3.el7                    docker-ce-stable</span></span><br></pre></td></tr></table></figure>\n<p><br>18.06.0.ce-3.el7</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><p><strong>Docker</strong><br><a href=\"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors\">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start docker</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run  hello-world</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2022/png/21973095/1672381927401-6e68e3d2-847d-42e8-aeba-d5aec4ca9a9c.png#averageHue=%23262a2c&id=xsf1S&originHeight=77&originWidth=821&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\"></p>\n<ul>\n<li>REPOSITORY: </li>\n<li>TAG:  :</li>\n<li>IMAGE ID :ID</li>\n<li>CREATED :</li>\n<li>SIZE: </li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images -a</span><br></pre></td></tr></table></figure>\n<h3 id=\"ID\"><a href=\"#ID\" class=\"headerlink\" title=\"ID\"></a>ID</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images -q</span><br></pre></td></tr></table></figure>\n<h3 id=\"ID\"><a href=\"#ID\" class=\"headerlink\" title=\"ID\"></a>ID</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images -qa</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images --digests</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images --digests --no-trunc</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker search </span><br></pre></td></tr></table></figure>\n<h3 id=\"Start30tomca\"><a href=\"#Start30tomca\" class=\"headerlink\" title=\"Start30tomca\"></a>Start30tomca</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker search -s 30 tomcat</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull :latest   </span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi </span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi -f </span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi   :TAG  2:TAG</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rmi -f $(docker images -q)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br></pre></td></tr></table></figure>\n<h4 id=\"OPTIONS\"><a href=\"#OPTIONS\" class=\"headerlink\" title=\"OPTIONS\"></a>OPTIONS</h4><ul>\n<li><strong>-a stdin:</strong> STDIN&#x2F;STDOUT&#x2F;STDERR </li>\n<li><strong>-d:</strong>ID</li>\n<li><strong>-i:</strong> -t </li>\n<li><strong>-t:</strong> -i </li>\n<li><strong>-P:</strong><strong></strong></li>\n<li><strong>-p:</strong><strong>():</strong></li>\n<li><strong>name&#x3D;nginx-lb:</strong></li>\n<li><strong>dns 8.8.8.8:</strong>DNS</li>\n<li><strong>dns-search example.com:</strong>DNS</li>\n<li><strong>-h mars:</strong>hostname</li>\n<li><strong>-e username&#x3D;ritchie:</strong></li>\n<li><strong>env-file&#x3D;[]:</strong></li>\n<li><strong>cpuset&#x3D;0-2 or cpuset&#x3D;0,1,2:</strong>CPU</li>\n<li>**-m :**</li>\n<li><strong>net&#x3D;bridge:</strong> bridge&#x2F;host&#x2F;none&#x2F;container:</li>\n<li><strong>link&#x3D;[]:</strong></li>\n<li><strong>expose&#x3D;[]:</strong></li>\n<li>**volume , -v:**</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>dockernginx:latest,mynginx<br><code>docker run --name mynginx -d nginx:latest</code><br>nginx:latest,80<br><code>docker run -P -d nginx:latest</code><br> nginx:latest, 80  80 , &#x2F;data  &#x2F;data<br><code>docker run -p 80:80 -v /data:/data -d nginx:latest</code><br> 8080  127.0.0.1  80 <br><code>$docker run -p 127.0.0.1:80:8080/tcp ubuntu bash</code><br>nginx:latest**-n:**N,&#x2F;bin&#x2F;bash<br><code>docker run -it nginx:latest /bin/bash</code></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker ps  [OPTIONS] </span><br></pre></td></tr></table></figure>\n<h4 id=\"OPTIONS\"><a href=\"#OPTIONS\" class=\"headerlink\" title=\"OPTIONS\"></a>OPTIONS</h4><ul>\n<li>**-a :**+</li>\n<li><strong>-l:</strong>ID</li>\n<li><strong>-n:</strong>N</li>\n<li><strong>-q:</strong>Id</li>\n<li>-<strong>-no -trunc</strong></li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><code>exit</code> <br><code>ctrl+P+Q </code></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker start ID</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker restart ID</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker stop ID   </span><br><span class=\"line\"></span><br><span class=\"line\">docker kill ID   </span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rm ID</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker rm  -f $(docker ps -a -q)</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"></span></span><br><span class=\"line\">docker ps -a -q|xagrgs docker rm</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker inspect ID</span><br></pre></td></tr></table></figure>\n<h4 id=\"IP\"><a href=\"#IP\" class=\"headerlink\" title=\"IP\"></a>IP</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker inspect ID |grep &quot;IPAddress&quot;</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it ID bashShell(shell)</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker attach ID</span><br></pre></td></tr></table></figure>\n<p><strong>exec attach</strong></p>\n<ul>\n<li>attach :</li>\n<li>exec</li>\n</ul>\n"},{"title":"Dockerfile ","date":"2021-12-20T04:30:00.000Z","_content":"\n# \n## FROM\n\n## MAINTAINER\n\n## RUN\n\n## EXPOSE\n\n## WORKDIR\n\n##  ENV (key value)\n()\n## ADD\n\n```dockerfile\nADD   \n```\nCOPY\n## \n```dockerfile\nCOPY   \n```\n##  VOLUME\n\n##  CMD (exec/shell)\ncmd ,CMD docker run \n##  ENTRYPOINT XXX\n docker run \n##  ONBUILD XXX\nDockerfile ONBUILD \n\n# \n## mycentos \nmycentos \n\n- lujing\n- vim \n-  ipconfig\n```dockerfile\nFROM centos\nMAINTAINER Mr.Wang<wry10150@outlook.com>\nENV mypath /temp\nWORKDIR  $mypath\nRUN yum -y install vim\nRUN yum -y install net-tools\nEXPOSE 80\nCMD /bin/bash\n```\n","source":"_posts/2023/dockerfile.md","raw":"---\ntitle: Dockerfile \ndate: 2021-12-20 12:30:00\ntags:\n - docker\ncategories:\n - Docker\n---\n\n# \n## FROM\n\n## MAINTAINER\n\n## RUN\n\n## EXPOSE\n\n## WORKDIR\n\n##  ENV (key value)\n()\n## ADD\n\n```dockerfile\nADD   \n```\nCOPY\n## \n```dockerfile\nCOPY   \n```\n##  VOLUME\n\n##  CMD (exec/shell)\ncmd ,CMD docker run \n##  ENTRYPOINT XXX\n docker run \n##  ONBUILD XXX\nDockerfile ONBUILD \n\n# \n## mycentos \nmycentos \n\n- lujing\n- vim \n-  ipconfig\n```dockerfile\nFROM centos\nMAINTAINER Mr.Wang<wry10150@outlook.com>\nENV mypath /temp\nWORKDIR  $mypath\nRUN yum -y install vim\nRUN yum -y install net-tools\nEXPOSE 80\nCMD /bin/bash\n```\n","slug":"2023/dockerfile","published":1,"updated":"2024-08-05T11:07:24.333Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiv0000avaib3j383d7m","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"FROM\"><a href=\"#FROM\" class=\"headerlink\" title=\"FROM\"></a>FROM</h2><p></p>\n<h2 id=\"MAINTAINER\"><a href=\"#MAINTAINER\" class=\"headerlink\" title=\"MAINTAINER\"></a>MAINTAINER</h2><p></p>\n<h2 id=\"RUN\"><a href=\"#RUN\" class=\"headerlink\" title=\"RUN\"></a>RUN</h2><p></p>\n<h2 id=\"EXPOSE\"><a href=\"#EXPOSE\" class=\"headerlink\" title=\"EXPOSE\"></a>EXPOSE</h2><p></p>\n<h2 id=\"WORKDIR\"><a href=\"#WORKDIR\" class=\"headerlink\" title=\"WORKDIR\"></a>WORKDIR</h2><p></p>\n<h2 id=\"ENV-key-value\"><a href=\"#ENV-key-value\" class=\"headerlink\" title=\"ENV (key value)\"></a>ENV (key value)</h2><p>()</p>\n<h2 id=\"ADD\"><a href=\"#ADD\" class=\"headerlink\" title=\"ADD\"></a>ADD</h2><p></p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ADD</span><span class=\"language-bash\">   </span></span><br></pre></td></tr></table></figure>\n<p>COPY</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\">   </span></span><br></pre></td></tr></table></figure>\n<h2 id=\"VOLUME\"><a href=\"#VOLUME\" class=\"headerlink\" title=\"VOLUME\"></a>VOLUME</h2><p></p>\n<h2 id=\"CMD-exec-shell\"><a href=\"#CMD-exec-shell\" class=\"headerlink\" title=\"CMD (exec&#x2F;shell)\"></a>CMD (exec&#x2F;shell)</h2><p>cmd ,CMD docker run </p>\n<h2 id=\"ENTRYPOINT-XXX\"><a href=\"#ENTRYPOINT-XXX\" class=\"headerlink\" title=\"ENTRYPOINT XXX\"></a>ENTRYPOINT XXX</h2><p> docker run </p>\n<h2 id=\"ONBUILD-XXX\"><a href=\"#ONBUILD-XXX\" class=\"headerlink\" title=\"ONBUILD XXX\"></a>ONBUILD XXX</h2><p>Dockerfile ONBUILD </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"mycentos-\"><a href=\"#mycentos-\" class=\"headerlink\" title=\"mycentos \"></a>mycentos </h2><p>mycentos </p>\n<ul>\n<li>lujing</li>\n<li>vim </li>\n<li> ipconfig<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> centos</span><br><span class=\"line\"><span class=\"keyword\">MAINTAINER</span> Mr.Wang&lt;wry10150@outlook.com&gt;</span><br><span class=\"line\"><span class=\"keyword\">ENV</span> mypath /temp</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\">  <span class=\"variable\">$mypath</span></span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> yum -y install vim</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> yum -y install net-tools</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">80</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> /bin/bash</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n","cover":false,"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"FROM\"><a href=\"#FROM\" class=\"headerlink\" title=\"FROM\"></a>FROM</h2><p></p>\n<h2 id=\"MAINTAINER\"><a href=\"#MAINTAINER\" class=\"headerlink\" title=\"MAINTAINER\"></a>MAINTAINER</h2><p></p>\n<h2 id=\"RUN\"><a href=\"#RUN\" class=\"headerlink\" title=\"RUN\"></a>RUN</h2><p></p>\n<h2 id=\"EXPOSE\"><a href=\"#EXPOSE\" class=\"headerlink\" title=\"EXPOSE\"></a>EXPOSE</h2><p></p>\n<h2 id=\"WORKDIR\"><a href=\"#WORKDIR\" class=\"headerlink\" title=\"WORKDIR\"></a>WORKDIR</h2><p></p>\n<h2 id=\"ENV-key-value\"><a href=\"#ENV-key-value\" class=\"headerlink\" title=\"ENV (key value)\"></a>ENV (key value)</h2><p>()</p>\n<h2 id=\"ADD\"><a href=\"#ADD\" class=\"headerlink\" title=\"ADD\"></a>ADD</h2><p></p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ADD</span><span class=\"language-bash\">   </span></span><br></pre></td></tr></table></figure>\n<p>COPY</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\">   </span></span><br></pre></td></tr></table></figure>\n<h2 id=\"VOLUME\"><a href=\"#VOLUME\" class=\"headerlink\" title=\"VOLUME\"></a>VOLUME</h2><p></p>\n<h2 id=\"CMD-exec-shell\"><a href=\"#CMD-exec-shell\" class=\"headerlink\" title=\"CMD (exec&#x2F;shell)\"></a>CMD (exec&#x2F;shell)</h2><p>cmd ,CMD docker run </p>\n<h2 id=\"ENTRYPOINT-XXX\"><a href=\"#ENTRYPOINT-XXX\" class=\"headerlink\" title=\"ENTRYPOINT XXX\"></a>ENTRYPOINT XXX</h2><p> docker run </p>\n<h2 id=\"ONBUILD-XXX\"><a href=\"#ONBUILD-XXX\" class=\"headerlink\" title=\"ONBUILD XXX\"></a>ONBUILD XXX</h2><p>Dockerfile ONBUILD </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"mycentos-\"><a href=\"#mycentos-\" class=\"headerlink\" title=\"mycentos \"></a>mycentos </h2><p>mycentos </p>\n<ul>\n<li>lujing</li>\n<li>vim </li>\n<li> ipconfig<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> centos</span><br><span class=\"line\"><span class=\"keyword\">MAINTAINER</span> Mr.Wang&lt;wry10150@outlook.com&gt;</span><br><span class=\"line\"><span class=\"keyword\">ENV</span> mypath /temp</span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\">  <span class=\"variable\">$mypath</span></span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> yum -y install vim</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> yum -y install net-tools</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">80</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"language-bash\"> /bin/bash</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n"},{"title":"GitLab-CI-SpringBoot","date":"2021-12-20T04:30:00.000Z","_content":"\n# GitLab-CI\n[](https://docs.gitlab.cn/ee/ci/index.html)\n# .gitlab-ci.yml\n[.gitlab-ci.yml](https://docs.gitlab.cn/ee/ci/yaml/index.html)\n# SpringBoot\n\n\n# GoogleJibdocker\n[](https://github.com/GoogleContainerTools/jib/tree/v2.0.0-gradle/jib-gradle-plugin#quickstart)\n```kotlin\nimport org.jetbrains.kotlin.gradle.tasks.KotlinCompile\n\nplugins {\n    // GoogleJib\n    id(\"com.google.cloud.tools.jib\") version \"3.3.1\"\n    \n    id(\"org.springframework.boot\") version \"2.6.8\"\n    id(\"io.spring.dependency-management\") version \"1.0.11.RELEASE\"\n    kotlin(\"jvm\") version \"1.6.21\"\n    kotlin(\"plugin.spring\") version \"1.6.21\"\n    java\n}\napply<JavaPlugin>()\napply<JavaLibraryPlugin>()\n\ngroup = \"com.wry\"\nversion = \"0.0.1-SNAPSHOT\"\njava.sourceCompatibility = JavaVersion.VERSION_1_8\n\nrepositories {\n    // \n    maven(\"https://maven.aliyun.com/repository/public/\")\n    mavenCentral()\n}\n\ndependencies {\n    implementation(\"org.springframework.boot:spring-boot-starter-web\")\n    implementation(\"com.fasterxml.jackson.module:jackson-module-kotlin\")\n    implementation(\"org.jetbrains.kotlin:kotlin-reflect\")\n    implementation(\"org.jetbrains.kotlin:kotlin-stdlib-jdk8\")\n    testImplementation(\"org.springframework.boot:spring-boot-starter-test\")\n}\n\n// \nconfigure<com.google.cloud.tools.jib.gradle.JibExtension>{\n    setAllowInsecureRegistries(true)\n    from {\n        image = \"openjdk:8\"\n    }\n    to {\n        image = \"wry/${project.name}\"\n        tags = mutableSetOf(\"latest\")\n    }\n    container {\n        appRoot = \"/app\"\n        workingDirectory = \"/app\"\n        jvmFlags = mutableListOf(\n            \"-Dspring.backgroundpreinitializer.ignore=true\", // spring\n            \"-Duser.timezone=Asia/Shanghai\",\n            \"-Dproject.name=${project.name}\"\n        )\n        ports = mutableListOf(\"8080\")\n    }\n}\n\ntasks.withType<KotlinCompile> {\n    kotlinOptions {\n        freeCompilerArgs = listOf(\"-Xjsr305=strict\")\n        jvmTarget = \"1.8\"\n    }\n}\n\ntasks.withType<Test> {\n    useJUnitPlatform()\n}\n\n```\n# .gitlab-ci.yml\n```yaml\ndefault:\n  image: openjdk:8\n\n# \nstages:\n  - build\n  - deploy\n\n# docker image\nbuild:\n  stage: build\n  image: openjdk:8\n  script:\n    - chmod +x gradlew\n    - CURRENT_PATH=$PWD\n    - echo \"$CURRENT_PATH\"\n    - ./gradlew jibDockerBuild\n\n\n# \ndeploy:\n  stage: deploy\n  script:\n    - echo \"\"\n    - docker stop test-spring-boot\n    - docker rm test-spring-boot\n    - docker run -itd --restart=always -p 8081:8080 --name test-spring-boot wry/test-spring-boot\n```\n# `Docker-runner`CI\n## CI\n![image.png](img_12.png)\n## \n`GitLab-CI ``docker`,`docker` `docker`docker **\n\n## \nGitLab,GitLab-runnerDocker-In-Dockerdocker\n[](https://docs.gitlab.cn/jh/ci/docker/using_docker_build.html)\n# Docker-In-DockerGitLab-runner\n## docker\n`docker`\n```shell\ndocker version\n```\n![image.png](img_5.png)\n\n## GitLab-Runner\n```yaml\ndocker-compose exec <compose-service-name> gitlab-runner register -n \\\n  --url \"<url>\" \\\n  --registration-token \"<token>\" \\\n  --executor docker \\\n  --description \"Docker In Docker Runner\" \\\n  --docker-image \"docker:20.10.22\" \\\n  --docker-privileged \\\n  --tag-list \"docker-in-docker\" \n  \n  # \n  # \n  # docker-compose exec gitlab-runner gitlab-runner register -n \\\n  # --url \"http://120.76.142.218\" \\\n  # --registration-token \"RB3asxbMJMv3GXXX\" \\\n  # --executor docker \\\n  # --description \"Docker In Docker Runner\" \\\n  # --docker-image \"docker:20.10.22\" \\\n  # --docker-privileged \\\n  # --tag-list \"docker-in-docker\" \n```\n## \nhttp://IP:PORT/admin/runners\n\n![image.png](img_6.png)\n\n# `.gitlab-ci.yml`\n```yaml\ndefault:\n  image: docker:20.10.22\n  tags:\n    - docker-in-docker\nvariables:\n  DOCKER_HOST: tcp://120.76.142.218:2375\n\nservices:\n  - docker:20.10.22-dind\n\nstages:\n  - build\n  - deploy\n\nbuild:\n  stage: build\n  script:\n    - chmod +x gradlew\n    - CURRENT_PATH=$PWD\n    - echo \"$CURRENT_PATH\"\n    - docker version\n    - ./gradlew jibDockerBuild\n\ndeploy:\n  stage: deploy\n  script:\n    - echo \"\"\n    - docker stop test-spring-boot\n    - docker rm test-spring-boot\n    - docker run -itd --restart=always -p 8081:8080 --name test-spring-boot wry/test-spring-boot\n```\n# dockerjava\n`GitLab-runner``docker``gradlew`docker\n`JAVA`\n![image.png](img_7.png)\n\n## \n### javadocker )\n\n- javadocker\n- dockerdocker\n\n### JAVAdocker)\n\n- javadockerdocker\n\n[https://stackoverflow.com/questions/71109409/gitlab-ci-docker-inside-java-image](https://stackoverflow.com/questions/71109409/gitlab-ci-docker-inside-java-image)\n# `.gitlab-ci.yml`\n`docker-in-docker``.gitlab-ci.yml`\n[](https://docs.gitlab.cn/jh/ci/docker/using_docker_build.html#%E4%BD%BF%E7%94%A8-docker-in-docker)\n## \n**javadocker**\n```yaml\n# \ndefault:\n  image: docker:20.10.22\n  tags:\n    - docker-in-docker\nvariables:\n  DOCKER_HOST: tcp://120.76.142.218:2375\nservices:\n  - docker:20.10.22-dind\n\n# \nstages:\n  - build\n  - docker-image\n  - deploy\n\n# Job\ncache:\n  paths:\n    - build  \n    - .gradle/wrapper\n    - .gradle/caches\n\n# docker\necho:\n  stage: .pre\n  script:\n    - docker info\n\n# docker image\nbuild:\n  stage: build\n  image: openjdk:8\n  script:\n    - chmod +x gradlew\n    - CURRENT_PATH=$PWD\n    - echo \"$CURRENT_PATH\"\n    - ./gradlew jibBuildTar\n\n# docker image\ndocker-image:\n  stage: docker-image\n  script:\n    - CURRENT_PATH=$PWD\n    - echo \"$CURRENT_PATH\"\n    - docker load --input build/jib-image.tar\n\n# \ndeploy:\n  stage: deploy\n  script:\n    - echo \"\"\n    - docker stop test-spring-boot\n    - docker rm test-spring-boot\n    - docker run -itd --restart=always -p 8081:8080 --name test-spring-boot wry/test-spring-boot\n```\n## \n**JAVAdocker**\n```yaml\ndefault:\n  image: docker:20.10.22\n  tags:\n    - docker-in-docker\nvariables:\n  DOCKER_HOST: tcp://120.76.142.218:2375\n\nservices:\n  - docker:20.10.22-dind\n\nstages:\n  - build\n  - deploy\n\n\necho:\n  stage: .pre\n  script:\n    - docker info\n\nbuild:\n  stage: build\n  image: gradle:jdk8  \n  services:\n    - docker:20.10.22-dind\n  variables:\n    DOCKER_HOST: tcp://120.76.142.218:2375\n  before_script:\n    - apt update && apt install --no-install-recommends -y docker.io \n  script:\n    - chmod +x gradlew\n    - CURRENT_PATH=$PWD\n    - echo \"$CURRENT_PATH\"\n    - docker version\n    - ./gradlew jibDockerBuild\n\n\ndeploy:\n  stage: deploy\n  script:\n    - echo \"\"\n    - docker stop test-spring-boot\n    - docker rm test-spring-boot\n    - docker run -itd --restart=always -p 8081:8080 --name test-spring-boot wry/test-spring-boot\n```\n# CI\n![image.png](img_8.png)\n![image.png](img_9.png)\n\n# docker\n![image.png](img_10.png)\n\n# \n![image.png](img_11.png)\n","source":"_posts/2023/gitlab-ci-springboot.md","raw":"---\ntitle: GitLab-CI-SpringBoot\ndate: 2021-12-20 12:30:00\ntags:\n - docker\ncategories:\n - Docker\n---\n\n# GitLab-CI\n[](https://docs.gitlab.cn/ee/ci/index.html)\n# .gitlab-ci.yml\n[.gitlab-ci.yml](https://docs.gitlab.cn/ee/ci/yaml/index.html)\n# SpringBoot\n\n\n# GoogleJibdocker\n[](https://github.com/GoogleContainerTools/jib/tree/v2.0.0-gradle/jib-gradle-plugin#quickstart)\n```kotlin\nimport org.jetbrains.kotlin.gradle.tasks.KotlinCompile\n\nplugins {\n    // GoogleJib\n    id(\"com.google.cloud.tools.jib\") version \"3.3.1\"\n    \n    id(\"org.springframework.boot\") version \"2.6.8\"\n    id(\"io.spring.dependency-management\") version \"1.0.11.RELEASE\"\n    kotlin(\"jvm\") version \"1.6.21\"\n    kotlin(\"plugin.spring\") version \"1.6.21\"\n    java\n}\napply<JavaPlugin>()\napply<JavaLibraryPlugin>()\n\ngroup = \"com.wry\"\nversion = \"0.0.1-SNAPSHOT\"\njava.sourceCompatibility = JavaVersion.VERSION_1_8\n\nrepositories {\n    // \n    maven(\"https://maven.aliyun.com/repository/public/\")\n    mavenCentral()\n}\n\ndependencies {\n    implementation(\"org.springframework.boot:spring-boot-starter-web\")\n    implementation(\"com.fasterxml.jackson.module:jackson-module-kotlin\")\n    implementation(\"org.jetbrains.kotlin:kotlin-reflect\")\n    implementation(\"org.jetbrains.kotlin:kotlin-stdlib-jdk8\")\n    testImplementation(\"org.springframework.boot:spring-boot-starter-test\")\n}\n\n// \nconfigure<com.google.cloud.tools.jib.gradle.JibExtension>{\n    setAllowInsecureRegistries(true)\n    from {\n        image = \"openjdk:8\"\n    }\n    to {\n        image = \"wry/${project.name}\"\n        tags = mutableSetOf(\"latest\")\n    }\n    container {\n        appRoot = \"/app\"\n        workingDirectory = \"/app\"\n        jvmFlags = mutableListOf(\n            \"-Dspring.backgroundpreinitializer.ignore=true\", // spring\n            \"-Duser.timezone=Asia/Shanghai\",\n            \"-Dproject.name=${project.name}\"\n        )\n        ports = mutableListOf(\"8080\")\n    }\n}\n\ntasks.withType<KotlinCompile> {\n    kotlinOptions {\n        freeCompilerArgs = listOf(\"-Xjsr305=strict\")\n        jvmTarget = \"1.8\"\n    }\n}\n\ntasks.withType<Test> {\n    useJUnitPlatform()\n}\n\n```\n# .gitlab-ci.yml\n```yaml\ndefault:\n  image: openjdk:8\n\n# \nstages:\n  - build\n  - deploy\n\n# docker image\nbuild:\n  stage: build\n  image: openjdk:8\n  script:\n    - chmod +x gradlew\n    - CURRENT_PATH=$PWD\n    - echo \"$CURRENT_PATH\"\n    - ./gradlew jibDockerBuild\n\n\n# \ndeploy:\n  stage: deploy\n  script:\n    - echo \"\"\n    - docker stop test-spring-boot\n    - docker rm test-spring-boot\n    - docker run -itd --restart=always -p 8081:8080 --name test-spring-boot wry/test-spring-boot\n```\n# `Docker-runner`CI\n## CI\n![image.png](img_12.png)\n## \n`GitLab-CI ``docker`,`docker` `docker`docker **\n\n## \nGitLab,GitLab-runnerDocker-In-Dockerdocker\n[](https://docs.gitlab.cn/jh/ci/docker/using_docker_build.html)\n# Docker-In-DockerGitLab-runner\n## docker\n`docker`\n```shell\ndocker version\n```\n![image.png](img_5.png)\n\n## GitLab-Runner\n```yaml\ndocker-compose exec <compose-service-name> gitlab-runner register -n \\\n  --url \"<url>\" \\\n  --registration-token \"<token>\" \\\n  --executor docker \\\n  --description \"Docker In Docker Runner\" \\\n  --docker-image \"docker:20.10.22\" \\\n  --docker-privileged \\\n  --tag-list \"docker-in-docker\" \n  \n  # \n  # \n  # docker-compose exec gitlab-runner gitlab-runner register -n \\\n  # --url \"http://120.76.142.218\" \\\n  # --registration-token \"RB3asxbMJMv3GXXX\" \\\n  # --executor docker \\\n  # --description \"Docker In Docker Runner\" \\\n  # --docker-image \"docker:20.10.22\" \\\n  # --docker-privileged \\\n  # --tag-list \"docker-in-docker\" \n```\n## \nhttp://IP:PORT/admin/runners\n\n![image.png](img_6.png)\n\n# `.gitlab-ci.yml`\n```yaml\ndefault:\n  image: docker:20.10.22\n  tags:\n    - docker-in-docker\nvariables:\n  DOCKER_HOST: tcp://120.76.142.218:2375\n\nservices:\n  - docker:20.10.22-dind\n\nstages:\n  - build\n  - deploy\n\nbuild:\n  stage: build\n  script:\n    - chmod +x gradlew\n    - CURRENT_PATH=$PWD\n    - echo \"$CURRENT_PATH\"\n    - docker version\n    - ./gradlew jibDockerBuild\n\ndeploy:\n  stage: deploy\n  script:\n    - echo \"\"\n    - docker stop test-spring-boot\n    - docker rm test-spring-boot\n    - docker run -itd --restart=always -p 8081:8080 --name test-spring-boot wry/test-spring-boot\n```\n# dockerjava\n`GitLab-runner``docker``gradlew`docker\n`JAVA`\n![image.png](img_7.png)\n\n## \n### javadocker )\n\n- javadocker\n- dockerdocker\n\n### JAVAdocker)\n\n- javadockerdocker\n\n[https://stackoverflow.com/questions/71109409/gitlab-ci-docker-inside-java-image](https://stackoverflow.com/questions/71109409/gitlab-ci-docker-inside-java-image)\n# `.gitlab-ci.yml`\n`docker-in-docker``.gitlab-ci.yml`\n[](https://docs.gitlab.cn/jh/ci/docker/using_docker_build.html#%E4%BD%BF%E7%94%A8-docker-in-docker)\n## \n**javadocker**\n```yaml\n# \ndefault:\n  image: docker:20.10.22\n  tags:\n    - docker-in-docker\nvariables:\n  DOCKER_HOST: tcp://120.76.142.218:2375\nservices:\n  - docker:20.10.22-dind\n\n# \nstages:\n  - build\n  - docker-image\n  - deploy\n\n# Job\ncache:\n  paths:\n    - build  \n    - .gradle/wrapper\n    - .gradle/caches\n\n# docker\necho:\n  stage: .pre\n  script:\n    - docker info\n\n# docker image\nbuild:\n  stage: build\n  image: openjdk:8\n  script:\n    - chmod +x gradlew\n    - CURRENT_PATH=$PWD\n    - echo \"$CURRENT_PATH\"\n    - ./gradlew jibBuildTar\n\n# docker image\ndocker-image:\n  stage: docker-image\n  script:\n    - CURRENT_PATH=$PWD\n    - echo \"$CURRENT_PATH\"\n    - docker load --input build/jib-image.tar\n\n# \ndeploy:\n  stage: deploy\n  script:\n    - echo \"\"\n    - docker stop test-spring-boot\n    - docker rm test-spring-boot\n    - docker run -itd --restart=always -p 8081:8080 --name test-spring-boot wry/test-spring-boot\n```\n## \n**JAVAdocker**\n```yaml\ndefault:\n  image: docker:20.10.22\n  tags:\n    - docker-in-docker\nvariables:\n  DOCKER_HOST: tcp://120.76.142.218:2375\n\nservices:\n  - docker:20.10.22-dind\n\nstages:\n  - build\n  - deploy\n\n\necho:\n  stage: .pre\n  script:\n    - docker info\n\nbuild:\n  stage: build\n  image: gradle:jdk8  \n  services:\n    - docker:20.10.22-dind\n  variables:\n    DOCKER_HOST: tcp://120.76.142.218:2375\n  before_script:\n    - apt update && apt install --no-install-recommends -y docker.io \n  script:\n    - chmod +x gradlew\n    - CURRENT_PATH=$PWD\n    - echo \"$CURRENT_PATH\"\n    - docker version\n    - ./gradlew jibDockerBuild\n\n\ndeploy:\n  stage: deploy\n  script:\n    - echo \"\"\n    - docker stop test-spring-boot\n    - docker rm test-spring-boot\n    - docker run -itd --restart=always -p 8081:8080 --name test-spring-boot wry/test-spring-boot\n```\n# CI\n![image.png](img_8.png)\n![image.png](img_9.png)\n\n# docker\n![image.png](img_10.png)\n\n# \n![image.png](img_11.png)\n","slug":"2023/gitlab-ci-springboot","published":1,"updated":"2024-08-05T11:07:24.333Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiv2000evaib1jzn7wmb","content":"<h1 id=\"GitLab-CI\"><a href=\"#GitLab-CI\" class=\"headerlink\" title=\"GitLab-CI\"></a>GitLab-CI</h1><p><a href=\"https://docs.gitlab.cn/ee/ci/index.html\"></a></p>\n<h1 id=\"gitlab-ci-yml\"><a href=\"#gitlab-ci-yml\" class=\"headerlink\" title=\".gitlab-ci.yml\"></a>.gitlab-ci.yml</h1><p><a href=\"https://docs.gitlab.cn/ee/ci/yaml/index.html\">.gitlab-ci.yml</a></p>\n<h1 id=\"SpringBoot\"><a href=\"#SpringBoot\" class=\"headerlink\" title=\"SpringBoot\"></a>SpringBoot</h1><h1 id=\"GoogleJibdocker\"><a href=\"#GoogleJibdocker\" class=\"headerlink\" title=\"GoogleJibdocker\"></a>GoogleJibdocker</h1><p><a href=\"https://github.com/GoogleContainerTools/jib/tree/v2.0.0-gradle/jib-gradle-plugin#quickstart\"></a></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.jetbrains.kotlin.gradle.tasks.KotlinCompile</span><br><span class=\"line\"></span><br><span class=\"line\">plugins &#123;</span><br><span class=\"line\">    <span class=\"comment\">// GoogleJib</span></span><br><span class=\"line\">    id(<span class=\"string\">&quot;com.google.cloud.tools.jib&quot;</span>) version <span class=\"string\">&quot;3.3.1&quot;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    id(<span class=\"string\">&quot;org.springframework.boot&quot;</span>) version <span class=\"string\">&quot;2.6.8&quot;</span></span><br><span class=\"line\">    id(<span class=\"string\">&quot;io.spring.dependency-management&quot;</span>) version <span class=\"string\">&quot;1.0.11.RELEASE&quot;</span></span><br><span class=\"line\">    kotlin(<span class=\"string\">&quot;jvm&quot;</span>) version <span class=\"string\">&quot;1.6.21&quot;</span></span><br><span class=\"line\">    kotlin(<span class=\"string\">&quot;plugin.spring&quot;</span>) version <span class=\"string\">&quot;1.6.21&quot;</span></span><br><span class=\"line\">    java</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">apply&lt;JavaPlugin&gt;()</span><br><span class=\"line\">apply&lt;JavaLibraryPlugin&gt;()</span><br><span class=\"line\"></span><br><span class=\"line\">group = <span class=\"string\">&quot;com.wry&quot;</span></span><br><span class=\"line\">version = <span class=\"string\">&quot;0.0.1-SNAPSHOT&quot;</span></span><br><span class=\"line\">java.sourceCompatibility = JavaVersion.VERSION_1_8</span><br><span class=\"line\"></span><br><span class=\"line\">repositories &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    maven(<span class=\"string\">&quot;https://maven.aliyun.com/repository/public/&quot;</span>)</span><br><span class=\"line\">    mavenCentral()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    implementation(<span class=\"string\">&quot;org.springframework.boot:spring-boot-starter-web&quot;</span>)</span><br><span class=\"line\">    implementation(<span class=\"string\">&quot;com.fasterxml.jackson.module:jackson-module-kotlin&quot;</span>)</span><br><span class=\"line\">    implementation(<span class=\"string\">&quot;org.jetbrains.kotlin:kotlin-reflect&quot;</span>)</span><br><span class=\"line\">    implementation(<span class=\"string\">&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8&quot;</span>)</span><br><span class=\"line\">    testImplementation(<span class=\"string\">&quot;org.springframework.boot:spring-boot-starter-test&quot;</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">configure&lt;com.google.cloud.tools.jib.gradle.JibExtension&gt;&#123;</span><br><span class=\"line\">    setAllowInsecureRegistries(<span class=\"literal\">true</span>)</span><br><span class=\"line\">    from &#123;</span><br><span class=\"line\">        image = <span class=\"string\">&quot;openjdk:8&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    to &#123;</span><br><span class=\"line\">        image = <span class=\"string\">&quot;wry/<span class=\"subst\">$&#123;project.name&#125;</span>&quot;</span></span><br><span class=\"line\">        tags = mutableSetOf(<span class=\"string\">&quot;latest&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    container &#123;</span><br><span class=\"line\">        appRoot = <span class=\"string\">&quot;/app&quot;</span></span><br><span class=\"line\">        workingDirectory = <span class=\"string\">&quot;/app&quot;</span></span><br><span class=\"line\">        jvmFlags = mutableListOf(</span><br><span class=\"line\">            <span class=\"string\">&quot;-Dspring.backgroundpreinitializer.ignore=true&quot;</span>, <span class=\"comment\">// spring</span></span><br><span class=\"line\">            <span class=\"string\">&quot;-Duser.timezone=Asia/Shanghai&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;-Dproject.name=<span class=\"subst\">$&#123;project.name&#125;</span>&quot;</span></span><br><span class=\"line\">        )</span><br><span class=\"line\">        ports = mutableListOf(<span class=\"string\">&quot;8080&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">tasks.withType&lt;KotlinCompile&gt; &#123;</span><br><span class=\"line\">    kotlinOptions &#123;</span><br><span class=\"line\">        freeCompilerArgs = listOf(<span class=\"string\">&quot;-Xjsr305=strict&quot;</span>)</span><br><span class=\"line\">        jvmTarget = <span class=\"string\">&quot;1.8&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">tasks.withType&lt;Test&gt; &#123;</span><br><span class=\"line\">    useJUnitPlatform()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"-gitlab-ci-yml\"><a href=\"#-gitlab-ci-yml\" class=\"headerlink\" title=\".gitlab-ci.yml\"></a>.gitlab-ci.yml</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">default:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">openjdk:8</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># docker image</span></span><br><span class=\"line\"><span class=\"attr\">build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">openjdk:8</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">chmod</span> <span class=\"string\">+x</span> <span class=\"string\">gradlew</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">CURRENT_PATH=$PWD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;$CURRENT_PATH&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./gradlew</span> <span class=\"string\">jibDockerBuild</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">stop</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">rm</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">run</span> <span class=\"string\">-itd</span> <span class=\"string\">--restart=always</span> <span class=\"string\">-p</span> <span class=\"number\">8081</span><span class=\"string\">:8080</span> <span class=\"string\">--name</span> <span class=\"string\">test-spring-boot</span> <span class=\"string\">wry/test-spring-boot</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"Docker-runnerCI\"><a href=\"#Docker-runnerCI\" class=\"headerlink\" title=\"Docker-runnerCI\"></a><code>Docker-runner</code>CI</h1><h2 id=\"CI\"><a href=\"#CI\" class=\"headerlink\" title=\"CI\"></a>CI</h2><p><img src=\"/post/2023/gitlab-ci-springboot/img_12.png\" alt=\"image.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>GitLab-CI </code><code>docker</code>,<code>docker</code> <code>docker</code>docker **</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>GitLab,GitLab-runnerDocker-In-Dockerdocker<br><a href=\"https://docs.gitlab.cn/jh/ci/docker/using_docker_build.html\"></a></p>\n<h1 id=\"Docker-In-DockerGitLab-runner\"><a href=\"#Docker-In-DockerGitLab-runner\" class=\"headerlink\" title=\"Docker-In-DockerGitLab-runner\"></a>Docker-In-DockerGitLab-runner</h1><h2 id=\"docker\"><a href=\"#docker\" class=\"headerlink\" title=\"docker\"></a>docker</h2><p><code>docker</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker version</span><br></pre></td></tr></table></figure>\n<p><img src=\"/post/2023/gitlab-ci-springboot/img_5.png\" alt=\"image.png\"></p>\n<h2 id=\"GitLab-Runner\"><a href=\"#GitLab-Runner\" class=\"headerlink\" title=\"GitLab-Runner\"></a>GitLab-Runner</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">docker-compose</span> <span class=\"string\">exec</span> <span class=\"string\">&lt;compose-service-name&gt;</span> <span class=\"string\">gitlab-runner</span> <span class=\"string\">register</span> <span class=\"string\">-n</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--url</span> <span class=\"string\">&quot;&lt;url&gt;&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--registration-token</span> <span class=\"string\">&quot;&lt;token&gt;&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--executor</span> <span class=\"string\">docker</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--description</span> <span class=\"string\">&quot;Docker In Docker Runner&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--docker-image</span> <span class=\"string\">&quot;docker:20.10.22&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--docker-privileged</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--tag-list</span> <span class=\"string\">&quot;docker-in-docker&quot;</span> </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\"># </span></span><br><span class=\"line\">  <span class=\"comment\"># </span></span><br><span class=\"line\">  <span class=\"comment\"># docker-compose exec gitlab-runner gitlab-runner register -n \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --url &quot;http://120.76.142.218&quot; \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --registration-token &quot;RB3asxbMJMv3GXXX&quot; \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --executor docker \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --description &quot;Docker In Docker Runner&quot; \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --docker-image &quot;docker:20.10.22&quot; \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --docker-privileged \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --tag-list &quot;docker-in-docker&quot; </span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"http://IP:PORT/admin/runners\">http://IP:PORT/admin/runners</a></p>\n<p><img src=\"/post/2023/gitlab-ci-springboot/img_6.png\" alt=\"image.png\"></p>\n<h1 id=\"-gitlab-ci-yml\"><a href=\"#-gitlab-ci-yml\" class=\"headerlink\" title=\".gitlab-ci.yml\"></a><code>.gitlab-ci.yml</code></h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">default:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">docker:20.10.22</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker-in-docker</span></span><br><span class=\"line\"><span class=\"attr\">variables:</span></span><br><span class=\"line\">  <span class=\"attr\">DOCKER_HOST:</span> <span class=\"string\">tcp://120.76.142.218:2375</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">docker:20.10.22-dind</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">chmod</span> <span class=\"string\">+x</span> <span class=\"string\">gradlew</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">CURRENT_PATH=$PWD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;$CURRENT_PATH&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./gradlew</span> <span class=\"string\">jibDockerBuild</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">stop</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">rm</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">run</span> <span class=\"string\">-itd</span> <span class=\"string\">--restart=always</span> <span class=\"string\">-p</span> <span class=\"number\">8081</span><span class=\"string\">:8080</span> <span class=\"string\">--name</span> <span class=\"string\">test-spring-boot</span> <span class=\"string\">wry/test-spring-boot</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"dockerjava\"><a href=\"#dockerjava\" class=\"headerlink\" title=\"dockerjava\"></a>dockerjava</h1><p><code>GitLab-runner</code><code>docker</code><code>gradlew</code>docker<br><code>JAVA</code><br><img src=\"/post/2023/gitlab-ci-springboot/img_7.png\" alt=\"image.png\"></p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"javadocker-\"><a href=\"#javadocker-\" class=\"headerlink\" title=\"javadocker )\"></a>javadocker )</h3><ul>\n<li>javadocker</li>\n<li>dockerdocker</li>\n</ul>\n<h3 id=\"JAVAdocker\"><a href=\"#JAVAdocker\" class=\"headerlink\" title=\"JAVAdocker)\"></a>JAVAdocker)</h3><ul>\n<li>javadockerdocker</li>\n</ul>\n<p><a href=\"https://stackoverflow.com/questions/71109409/gitlab-ci-docker-inside-java-image\">https://stackoverflow.com/questions/71109409/gitlab-ci-docker-inside-java-image</a></p>\n<h1 id=\"-gitlab-ci-yml-1\"><a href=\"#-gitlab-ci-yml-1\" class=\"headerlink\" title=\".gitlab-ci.yml\"></a><code>.gitlab-ci.yml</code></h1><p><code>docker-in-docker</code><code>.gitlab-ci.yml</code><br><a href=\"https://docs.gitlab.cn/jh/ci/docker/using_docker_build.html#%E4%BD%BF%E7%94%A8-docker-in-docker\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>javadocker</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">default:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">docker:20.10.22</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker-in-docker</span></span><br><span class=\"line\"><span class=\"attr\">variables:</span></span><br><span class=\"line\">  <span class=\"attr\">DOCKER_HOST:</span> <span class=\"string\">tcp://120.76.142.218:2375</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">docker:20.10.22-dind</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">docker-image</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Job</span></span><br><span class=\"line\"><span class=\"attr\">cache:</span></span><br><span class=\"line\">  <span class=\"attr\">paths:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">build</span>  </span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">.gradle/wrapper</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">.gradle/caches</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># docker</span></span><br><span class=\"line\"><span class=\"attr\">echo:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">.pre</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">info</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># docker image</span></span><br><span class=\"line\"><span class=\"attr\">build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">openjdk:8</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">chmod</span> <span class=\"string\">+x</span> <span class=\"string\">gradlew</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">CURRENT_PATH=$PWD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;$CURRENT_PATH&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./gradlew</span> <span class=\"string\">jibBuildTar</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># docker image</span></span><br><span class=\"line\"><span class=\"attr\">docker-image:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">docker-image</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">CURRENT_PATH=$PWD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;$CURRENT_PATH&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">load</span> <span class=\"string\">--input</span> <span class=\"string\">build/jib-image.tar</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">stop</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">rm</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">run</span> <span class=\"string\">-itd</span> <span class=\"string\">--restart=always</span> <span class=\"string\">-p</span> <span class=\"number\">8081</span><span class=\"string\">:8080</span> <span class=\"string\">--name</span> <span class=\"string\">test-spring-boot</span> <span class=\"string\">wry/test-spring-boot</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>JAVAdocker</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">default:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">docker:20.10.22</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker-in-docker</span></span><br><span class=\"line\"><span class=\"attr\">variables:</span></span><br><span class=\"line\">  <span class=\"attr\">DOCKER_HOST:</span> <span class=\"string\">tcp://120.76.142.218:2375</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">docker:20.10.22-dind</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">echo:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">.pre</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">info</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">gradle:jdk8</span>  </span><br><span class=\"line\">  <span class=\"attr\">services:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker:20.10.22-dind</span></span><br><span class=\"line\">  <span class=\"attr\">variables:</span></span><br><span class=\"line\">    <span class=\"attr\">DOCKER_HOST:</span> <span class=\"string\">tcp://120.76.142.218:2375</span></span><br><span class=\"line\">  <span class=\"attr\">before_script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">apt</span> <span class=\"string\">update</span> <span class=\"string\">&amp;&amp;</span> <span class=\"string\">apt</span> <span class=\"string\">install</span> <span class=\"string\">--no-install-recommends</span> <span class=\"string\">-y</span> <span class=\"string\">docker.io</span> </span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">chmod</span> <span class=\"string\">+x</span> <span class=\"string\">gradlew</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">CURRENT_PATH=$PWD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;$CURRENT_PATH&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./gradlew</span> <span class=\"string\">jibDockerBuild</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">stop</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">rm</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">run</span> <span class=\"string\">-itd</span> <span class=\"string\">--restart=always</span> <span class=\"string\">-p</span> <span class=\"number\">8081</span><span class=\"string\">:8080</span> <span class=\"string\">--name</span> <span class=\"string\">test-spring-boot</span> <span class=\"string\">wry/test-spring-boot</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"CI\"><a href=\"#CI\" class=\"headerlink\" title=\"CI\"></a>CI</h1><p><img src=\"/post/2023/gitlab-ci-springboot/img_8.png\" alt=\"image.png\"><br><img src=\"/post/2023/gitlab-ci-springboot/img_9.png\" alt=\"image.png\"></p>\n<h1 id=\"docker\"><a href=\"#docker\" class=\"headerlink\" title=\"docker\"></a>docker</h1><p><img src=\"/post/2023/gitlab-ci-springboot/img_10.png\" alt=\"image.png\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"/post/2023/gitlab-ci-springboot/img_11.png\" alt=\"image.png\"></p>\n","cover":false,"excerpt":"","more":"<h1 id=\"GitLab-CI\"><a href=\"#GitLab-CI\" class=\"headerlink\" title=\"GitLab-CI\"></a>GitLab-CI</h1><p><a href=\"https://docs.gitlab.cn/ee/ci/index.html\"></a></p>\n<h1 id=\"gitlab-ci-yml\"><a href=\"#gitlab-ci-yml\" class=\"headerlink\" title=\".gitlab-ci.yml\"></a>.gitlab-ci.yml</h1><p><a href=\"https://docs.gitlab.cn/ee/ci/yaml/index.html\">.gitlab-ci.yml</a></p>\n<h1 id=\"SpringBoot\"><a href=\"#SpringBoot\" class=\"headerlink\" title=\"SpringBoot\"></a>SpringBoot</h1><h1 id=\"GoogleJibdocker\"><a href=\"#GoogleJibdocker\" class=\"headerlink\" title=\"GoogleJibdocker\"></a>GoogleJibdocker</h1><p><a href=\"https://github.com/GoogleContainerTools/jib/tree/v2.0.0-gradle/jib-gradle-plugin#quickstart\"></a></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.jetbrains.kotlin.gradle.tasks.KotlinCompile</span><br><span class=\"line\"></span><br><span class=\"line\">plugins &#123;</span><br><span class=\"line\">    <span class=\"comment\">// GoogleJib</span></span><br><span class=\"line\">    id(<span class=\"string\">&quot;com.google.cloud.tools.jib&quot;</span>) version <span class=\"string\">&quot;3.3.1&quot;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    id(<span class=\"string\">&quot;org.springframework.boot&quot;</span>) version <span class=\"string\">&quot;2.6.8&quot;</span></span><br><span class=\"line\">    id(<span class=\"string\">&quot;io.spring.dependency-management&quot;</span>) version <span class=\"string\">&quot;1.0.11.RELEASE&quot;</span></span><br><span class=\"line\">    kotlin(<span class=\"string\">&quot;jvm&quot;</span>) version <span class=\"string\">&quot;1.6.21&quot;</span></span><br><span class=\"line\">    kotlin(<span class=\"string\">&quot;plugin.spring&quot;</span>) version <span class=\"string\">&quot;1.6.21&quot;</span></span><br><span class=\"line\">    java</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">apply&lt;JavaPlugin&gt;()</span><br><span class=\"line\">apply&lt;JavaLibraryPlugin&gt;()</span><br><span class=\"line\"></span><br><span class=\"line\">group = <span class=\"string\">&quot;com.wry&quot;</span></span><br><span class=\"line\">version = <span class=\"string\">&quot;0.0.1-SNAPSHOT&quot;</span></span><br><span class=\"line\">java.sourceCompatibility = JavaVersion.VERSION_1_8</span><br><span class=\"line\"></span><br><span class=\"line\">repositories &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    maven(<span class=\"string\">&quot;https://maven.aliyun.com/repository/public/&quot;</span>)</span><br><span class=\"line\">    mavenCentral()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    implementation(<span class=\"string\">&quot;org.springframework.boot:spring-boot-starter-web&quot;</span>)</span><br><span class=\"line\">    implementation(<span class=\"string\">&quot;com.fasterxml.jackson.module:jackson-module-kotlin&quot;</span>)</span><br><span class=\"line\">    implementation(<span class=\"string\">&quot;org.jetbrains.kotlin:kotlin-reflect&quot;</span>)</span><br><span class=\"line\">    implementation(<span class=\"string\">&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8&quot;</span>)</span><br><span class=\"line\">    testImplementation(<span class=\"string\">&quot;org.springframework.boot:spring-boot-starter-test&quot;</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">configure&lt;com.google.cloud.tools.jib.gradle.JibExtension&gt;&#123;</span><br><span class=\"line\">    setAllowInsecureRegistries(<span class=\"literal\">true</span>)</span><br><span class=\"line\">    from &#123;</span><br><span class=\"line\">        image = <span class=\"string\">&quot;openjdk:8&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    to &#123;</span><br><span class=\"line\">        image = <span class=\"string\">&quot;wry/<span class=\"subst\">$&#123;project.name&#125;</span>&quot;</span></span><br><span class=\"line\">        tags = mutableSetOf(<span class=\"string\">&quot;latest&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    container &#123;</span><br><span class=\"line\">        appRoot = <span class=\"string\">&quot;/app&quot;</span></span><br><span class=\"line\">        workingDirectory = <span class=\"string\">&quot;/app&quot;</span></span><br><span class=\"line\">        jvmFlags = mutableListOf(</span><br><span class=\"line\">            <span class=\"string\">&quot;-Dspring.backgroundpreinitializer.ignore=true&quot;</span>, <span class=\"comment\">// spring</span></span><br><span class=\"line\">            <span class=\"string\">&quot;-Duser.timezone=Asia/Shanghai&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;-Dproject.name=<span class=\"subst\">$&#123;project.name&#125;</span>&quot;</span></span><br><span class=\"line\">        )</span><br><span class=\"line\">        ports = mutableListOf(<span class=\"string\">&quot;8080&quot;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">tasks.withType&lt;KotlinCompile&gt; &#123;</span><br><span class=\"line\">    kotlinOptions &#123;</span><br><span class=\"line\">        freeCompilerArgs = listOf(<span class=\"string\">&quot;-Xjsr305=strict&quot;</span>)</span><br><span class=\"line\">        jvmTarget = <span class=\"string\">&quot;1.8&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">tasks.withType&lt;Test&gt; &#123;</span><br><span class=\"line\">    useJUnitPlatform()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"-gitlab-ci-yml\"><a href=\"#-gitlab-ci-yml\" class=\"headerlink\" title=\".gitlab-ci.yml\"></a>.gitlab-ci.yml</h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">default:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">openjdk:8</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># docker image</span></span><br><span class=\"line\"><span class=\"attr\">build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">openjdk:8</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">chmod</span> <span class=\"string\">+x</span> <span class=\"string\">gradlew</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">CURRENT_PATH=$PWD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;$CURRENT_PATH&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./gradlew</span> <span class=\"string\">jibDockerBuild</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">stop</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">rm</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">run</span> <span class=\"string\">-itd</span> <span class=\"string\">--restart=always</span> <span class=\"string\">-p</span> <span class=\"number\">8081</span><span class=\"string\">:8080</span> <span class=\"string\">--name</span> <span class=\"string\">test-spring-boot</span> <span class=\"string\">wry/test-spring-boot</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"Docker-runnerCI\"><a href=\"#Docker-runnerCI\" class=\"headerlink\" title=\"Docker-runnerCI\"></a><code>Docker-runner</code>CI</h1><h2 id=\"CI\"><a href=\"#CI\" class=\"headerlink\" title=\"CI\"></a>CI</h2><p><img src=\"/post/2023/gitlab-ci-springboot/img_12.png\" alt=\"image.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>GitLab-CI </code><code>docker</code>,<code>docker</code> <code>docker</code>docker **</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>GitLab,GitLab-runnerDocker-In-Dockerdocker<br><a href=\"https://docs.gitlab.cn/jh/ci/docker/using_docker_build.html\"></a></p>\n<h1 id=\"Docker-In-DockerGitLab-runner\"><a href=\"#Docker-In-DockerGitLab-runner\" class=\"headerlink\" title=\"Docker-In-DockerGitLab-runner\"></a>Docker-In-DockerGitLab-runner</h1><h2 id=\"docker\"><a href=\"#docker\" class=\"headerlink\" title=\"docker\"></a>docker</h2><p><code>docker</code></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker version</span><br></pre></td></tr></table></figure>\n<p><img src=\"/post/2023/gitlab-ci-springboot/img_5.png\" alt=\"image.png\"></p>\n<h2 id=\"GitLab-Runner\"><a href=\"#GitLab-Runner\" class=\"headerlink\" title=\"GitLab-Runner\"></a>GitLab-Runner</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">docker-compose</span> <span class=\"string\">exec</span> <span class=\"string\">&lt;compose-service-name&gt;</span> <span class=\"string\">gitlab-runner</span> <span class=\"string\">register</span> <span class=\"string\">-n</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--url</span> <span class=\"string\">&quot;&lt;url&gt;&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--registration-token</span> <span class=\"string\">&quot;&lt;token&gt;&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--executor</span> <span class=\"string\">docker</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--description</span> <span class=\"string\">&quot;Docker In Docker Runner&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--docker-image</span> <span class=\"string\">&quot;docker:20.10.22&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--docker-privileged</span> <span class=\"string\">\\</span></span><br><span class=\"line\">  <span class=\"string\">--tag-list</span> <span class=\"string\">&quot;docker-in-docker&quot;</span> </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\"># </span></span><br><span class=\"line\">  <span class=\"comment\"># </span></span><br><span class=\"line\">  <span class=\"comment\"># docker-compose exec gitlab-runner gitlab-runner register -n \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --url &quot;http://120.76.142.218&quot; \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --registration-token &quot;RB3asxbMJMv3GXXX&quot; \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --executor docker \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --description &quot;Docker In Docker Runner&quot; \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --docker-image &quot;docker:20.10.22&quot; \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --docker-privileged \\</span></span><br><span class=\"line\">  <span class=\"comment\"># --tag-list &quot;docker-in-docker&quot; </span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"http://IP:PORT/admin/runners\">http://IP:PORT/admin/runners</a></p>\n<p><img src=\"/post/2023/gitlab-ci-springboot/img_6.png\" alt=\"image.png\"></p>\n<h1 id=\"-gitlab-ci-yml\"><a href=\"#-gitlab-ci-yml\" class=\"headerlink\" title=\".gitlab-ci.yml\"></a><code>.gitlab-ci.yml</code></h1><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">default:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">docker:20.10.22</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker-in-docker</span></span><br><span class=\"line\"><span class=\"attr\">variables:</span></span><br><span class=\"line\">  <span class=\"attr\">DOCKER_HOST:</span> <span class=\"string\">tcp://120.76.142.218:2375</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">docker:20.10.22-dind</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">chmod</span> <span class=\"string\">+x</span> <span class=\"string\">gradlew</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">CURRENT_PATH=$PWD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;$CURRENT_PATH&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./gradlew</span> <span class=\"string\">jibDockerBuild</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">stop</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">rm</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">run</span> <span class=\"string\">-itd</span> <span class=\"string\">--restart=always</span> <span class=\"string\">-p</span> <span class=\"number\">8081</span><span class=\"string\">:8080</span> <span class=\"string\">--name</span> <span class=\"string\">test-spring-boot</span> <span class=\"string\">wry/test-spring-boot</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"dockerjava\"><a href=\"#dockerjava\" class=\"headerlink\" title=\"dockerjava\"></a>dockerjava</h1><p><code>GitLab-runner</code><code>docker</code><code>gradlew</code>docker<br><code>JAVA</code><br><img src=\"/post/2023/gitlab-ci-springboot/img_7.png\" alt=\"image.png\"></p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"javadocker-\"><a href=\"#javadocker-\" class=\"headerlink\" title=\"javadocker )\"></a>javadocker )</h3><ul>\n<li>javadocker</li>\n<li>dockerdocker</li>\n</ul>\n<h3 id=\"JAVAdocker\"><a href=\"#JAVAdocker\" class=\"headerlink\" title=\"JAVAdocker)\"></a>JAVAdocker)</h3><ul>\n<li>javadockerdocker</li>\n</ul>\n<p><a href=\"https://stackoverflow.com/questions/71109409/gitlab-ci-docker-inside-java-image\">https://stackoverflow.com/questions/71109409/gitlab-ci-docker-inside-java-image</a></p>\n<h1 id=\"-gitlab-ci-yml-1\"><a href=\"#-gitlab-ci-yml-1\" class=\"headerlink\" title=\".gitlab-ci.yml\"></a><code>.gitlab-ci.yml</code></h1><p><code>docker-in-docker</code><code>.gitlab-ci.yml</code><br><a href=\"https://docs.gitlab.cn/jh/ci/docker/using_docker_build.html#%E4%BD%BF%E7%94%A8-docker-in-docker\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>javadocker</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">default:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">docker:20.10.22</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker-in-docker</span></span><br><span class=\"line\"><span class=\"attr\">variables:</span></span><br><span class=\"line\">  <span class=\"attr\">DOCKER_HOST:</span> <span class=\"string\">tcp://120.76.142.218:2375</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">docker:20.10.22-dind</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">docker-image</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Job</span></span><br><span class=\"line\"><span class=\"attr\">cache:</span></span><br><span class=\"line\">  <span class=\"attr\">paths:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">build</span>  </span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">.gradle/wrapper</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">.gradle/caches</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># docker</span></span><br><span class=\"line\"><span class=\"attr\">echo:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">.pre</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">info</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># docker image</span></span><br><span class=\"line\"><span class=\"attr\">build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">openjdk:8</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">chmod</span> <span class=\"string\">+x</span> <span class=\"string\">gradlew</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">CURRENT_PATH=$PWD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;$CURRENT_PATH&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./gradlew</span> <span class=\"string\">jibBuildTar</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># docker image</span></span><br><span class=\"line\"><span class=\"attr\">docker-image:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">docker-image</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">CURRENT_PATH=$PWD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;$CURRENT_PATH&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">load</span> <span class=\"string\">--input</span> <span class=\"string\">build/jib-image.tar</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">stop</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">rm</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">run</span> <span class=\"string\">-itd</span> <span class=\"string\">--restart=always</span> <span class=\"string\">-p</span> <span class=\"number\">8081</span><span class=\"string\">:8080</span> <span class=\"string\">--name</span> <span class=\"string\">test-spring-boot</span> <span class=\"string\">wry/test-spring-boot</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>JAVAdocker</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">default:</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">docker:20.10.22</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker-in-docker</span></span><br><span class=\"line\"><span class=\"attr\">variables:</span></span><br><span class=\"line\">  <span class=\"attr\">DOCKER_HOST:</span> <span class=\"string\">tcp://120.76.142.218:2375</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">docker:20.10.22-dind</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">stages:</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"bullet\">-</span> <span class=\"string\">deploy</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">echo:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">.pre</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">info</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">build:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">build</span></span><br><span class=\"line\">  <span class=\"attr\">image:</span> <span class=\"string\">gradle:jdk8</span>  </span><br><span class=\"line\">  <span class=\"attr\">services:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker:20.10.22-dind</span></span><br><span class=\"line\">  <span class=\"attr\">variables:</span></span><br><span class=\"line\">    <span class=\"attr\">DOCKER_HOST:</span> <span class=\"string\">tcp://120.76.142.218:2375</span></span><br><span class=\"line\">  <span class=\"attr\">before_script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">apt</span> <span class=\"string\">update</span> <span class=\"string\">&amp;&amp;</span> <span class=\"string\">apt</span> <span class=\"string\">install</span> <span class=\"string\">--no-install-recommends</span> <span class=\"string\">-y</span> <span class=\"string\">docker.io</span> </span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">chmod</span> <span class=\"string\">+x</span> <span class=\"string\">gradlew</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">CURRENT_PATH=$PWD</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;$CURRENT_PATH&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">version</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./gradlew</span> <span class=\"string\">jibDockerBuild</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">stage:</span> <span class=\"string\">deploy</span></span><br><span class=\"line\">  <span class=\"attr\">script:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">echo</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">stop</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">rm</span> <span class=\"string\">test-spring-boot</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">docker</span> <span class=\"string\">run</span> <span class=\"string\">-itd</span> <span class=\"string\">--restart=always</span> <span class=\"string\">-p</span> <span class=\"number\">8081</span><span class=\"string\">:8080</span> <span class=\"string\">--name</span> <span class=\"string\">test-spring-boot</span> <span class=\"string\">wry/test-spring-boot</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"CI\"><a href=\"#CI\" class=\"headerlink\" title=\"CI\"></a>CI</h1><p><img src=\"/post/2023/gitlab-ci-springboot/img_8.png\" alt=\"image.png\"><br><img src=\"/post/2023/gitlab-ci-springboot/img_9.png\" alt=\"image.png\"></p>\n<h1 id=\"docker\"><a href=\"#docker\" class=\"headerlink\" title=\"docker\"></a>docker</h1><p><img src=\"/post/2023/gitlab-ci-springboot/img_10.png\" alt=\"image.png\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"/post/2023/gitlab-ci-springboot/img_11.png\" alt=\"image.png\"></p>\n"},{"title":"https","date":"2023-05-28T13:01:21.000Z","_content":"\n\n![https](https.png)","source":"_posts/2023/https.md","raw":"---\ntitle: https\ndate: 2023-05-28 21:01:21\ntags:\n---\n\n\n![https](https.png)","slug":"2023/https","published":1,"updated":"2024-08-05T11:07:24.339Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiv3000fvaib6tmwdoli","content":"<p><img src=\"/post/2023/https/https.png\" alt=\"https\"></p>\n","cover":false,"excerpt":"","more":"<p><img src=\"/post/2023/https/https.png\" alt=\"https\"></p>\n"},{"title":"GitLab","date":"2021-12-20T04:30:00.000Z","_content":"\n`docker-compose``docker`\n\n- [Docker](https://www.yuque.com/yangleduo-cg2ct/fgrxr9)\n# GitLab-ce\n\n- [](https://docs.gitlab.cn/ee/install/docker.html)\n## docker-compose\n```yaml\nversion: '3'\nservices:\n  gitlab-ce:\n   image: 'gitlab/gitlab-ce:latest'\n   container_name: 'gitlab-ce'\n   privileged: true\n   hostname: 'gitlab'\n   environment:\n     TZ: 'Asia/Shanghai'\n     GITLAB_OMNIBUS_CONFIG: |\n       external_url 'http://120.76.142.218'\n       gitlab_rails['time_zone'] = 'Asia/Shanghai'\n       gitlab_rails['smtp_enable'] = true\n       gitlab_rails['gitlab_shell_ssh_port'] = 1022\n   ports:\n     - '80:80'\n     - '443:443'\n     - '1022:22'\n   volumes:\n     - ./config:/etc/gitlab\n     - ./data:/var/opt/gitlab\n     - ./logs:/var/log/gitlab\n   shm_size: '256m'\n```\n## GitLab\n[GitLab-ce](https://hub.docker.com/r/gitlab/gitlab-ce/tags)\n gitlab/gitlab-ce:latest GitLab \n: gitlab/gitlab-ce:15.6.0-ce.0\n## \n`docker-compose.yml`\n```yaml\ndocker-compose up -d\n```\n## \n```yaml\ndocker-componse logs -f\n```\n\n## \n![image.png](img_0.png)\n## \n### \n```yaml\ndocker exec -it $(docker ps | grep gitlab | awk '{print $1}') grep 'Password:' /etc/gitlab/initial_root_password\n```\n### \n`initial_root_password`\n```yaml\ngrep 'Password:' ./initial_root_password\n```\n\n## \n`root` \n## \n`Edit profile` `Password`\n![image.png](img_1.png)\n# GitLab-runner\n## \n[](https://docs.gitlab.cn/runner/)\n## \n\n- [runner](https://docs.gitlab.cn/runner/install/docker.html)\n- [runner](https://docs.gitlab.cn/runner/register/index.html#docker)\n- [runner](https://docs.gitlab.cn/runner/configuration/advanced-configuration.html)\n- [.gitlab-ci.yml](https://docs.gitlab.cn/ee/ci/yaml/index.html)\n## docker-compose\n```yaml\nversion: '3'\nservices:\n  gitlab-ce:\n   image: 'gitlab/gitlab-ce'\n   container_name: 'gitlab-ce'\n   privileged: true\n   hostname: 'gitlab'\n   environment:\n     TZ: 'Asia/Shanghai'\n     GITLAB_OMNIBUS_CONFIG: |\n       external_url 'http://120.76.142.218'\n       gitlab_rails['time_zone'] = 'Asia/Shanghai'\n       gitlab_rails['smtp_enable'] = true\n       gitlab_rails['gitlab_shell_ssh_port'] = 1022\n   ports:\n     - '80:80'\n     - '443:443'\n     - '1022:22'\n   volumes:\n     - ./config:/etc/gitlab\n     - ./data:/var/opt/gitlab\n     - ./logs:/var/log/gitlab\n   shm_size: '256m'\n  gitlab-runner:\n    image: gitlab/gitlab-runner:latest\n    container_name: gitlab-runner\n    restart: always\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n    volumes:\n      - ./gitlab-runner-conf/:/etc/gitlab-runner/\n      - /var/run/docker.sock:/var/run/docker.sock \n```\n## GitLab-runner\n[GitLab-runner](https://hub.docker.com/r/gitlab/gitlab-runner/tags)\n gitlab/gitlab-runner:latest GitLab-runner \n: gitlab/gitlab-latest:v15.6.0\n## runnergitlab\n[](https://docs.gitlab.cn/15.5/runner/register/index.html)\n Runner\n```yaml\ndocker-compose exec <compose-service-name> gitlab-runner register \\\n--non-interactive \\\n--executor \"docker\" \\\n--docker-image alpine:latest \\\n--url \"<url>\" \\\n--registration-token \"<token>\" \\\n--description \"docker-runner\" \\\n--maintenance-note \"Free-form maintainer notes about this runner\" \\\n--tag-list \"docker,deploy,server\" \\\n--run-untagged=\"true\" \\\n--locked=\"false\" \\\n--access-level=\"not_protected\"\n```\n## token\n![image.png](img_1.png)\n![image.png](img_2.png)\n\n## \n![image.png](img_3.png)\n## \n![image.png](img_4.png)\n","source":"_posts/2023/gitlab.md","raw":"---\ntitle: GitLab\ndate: 2021-12-20 12:30:00\ntags:\n - docker\ncategories:\n - Docker\n---\n\n`docker-compose``docker`\n\n- [Docker](https://www.yuque.com/yangleduo-cg2ct/fgrxr9)\n# GitLab-ce\n\n- [](https://docs.gitlab.cn/ee/install/docker.html)\n## docker-compose\n```yaml\nversion: '3'\nservices:\n  gitlab-ce:\n   image: 'gitlab/gitlab-ce:latest'\n   container_name: 'gitlab-ce'\n   privileged: true\n   hostname: 'gitlab'\n   environment:\n     TZ: 'Asia/Shanghai'\n     GITLAB_OMNIBUS_CONFIG: |\n       external_url 'http://120.76.142.218'\n       gitlab_rails['time_zone'] = 'Asia/Shanghai'\n       gitlab_rails['smtp_enable'] = true\n       gitlab_rails['gitlab_shell_ssh_port'] = 1022\n   ports:\n     - '80:80'\n     - '443:443'\n     - '1022:22'\n   volumes:\n     - ./config:/etc/gitlab\n     - ./data:/var/opt/gitlab\n     - ./logs:/var/log/gitlab\n   shm_size: '256m'\n```\n## GitLab\n[GitLab-ce](https://hub.docker.com/r/gitlab/gitlab-ce/tags)\n gitlab/gitlab-ce:latest GitLab \n: gitlab/gitlab-ce:15.6.0-ce.0\n## \n`docker-compose.yml`\n```yaml\ndocker-compose up -d\n```\n## \n```yaml\ndocker-componse logs -f\n```\n\n## \n![image.png](img_0.png)\n## \n### \n```yaml\ndocker exec -it $(docker ps | grep gitlab | awk '{print $1}') grep 'Password:' /etc/gitlab/initial_root_password\n```\n### \n`initial_root_password`\n```yaml\ngrep 'Password:' ./initial_root_password\n```\n\n## \n`root` \n## \n`Edit profile` `Password`\n![image.png](img_1.png)\n# GitLab-runner\n## \n[](https://docs.gitlab.cn/runner/)\n## \n\n- [runner](https://docs.gitlab.cn/runner/install/docker.html)\n- [runner](https://docs.gitlab.cn/runner/register/index.html#docker)\n- [runner](https://docs.gitlab.cn/runner/configuration/advanced-configuration.html)\n- [.gitlab-ci.yml](https://docs.gitlab.cn/ee/ci/yaml/index.html)\n## docker-compose\n```yaml\nversion: '3'\nservices:\n  gitlab-ce:\n   image: 'gitlab/gitlab-ce'\n   container_name: 'gitlab-ce'\n   privileged: true\n   hostname: 'gitlab'\n   environment:\n     TZ: 'Asia/Shanghai'\n     GITLAB_OMNIBUS_CONFIG: |\n       external_url 'http://120.76.142.218'\n       gitlab_rails['time_zone'] = 'Asia/Shanghai'\n       gitlab_rails['smtp_enable'] = true\n       gitlab_rails['gitlab_shell_ssh_port'] = 1022\n   ports:\n     - '80:80'\n     - '443:443'\n     - '1022:22'\n   volumes:\n     - ./config:/etc/gitlab\n     - ./data:/var/opt/gitlab\n     - ./logs:/var/log/gitlab\n   shm_size: '256m'\n  gitlab-runner:\n    image: gitlab/gitlab-runner:latest\n    container_name: gitlab-runner\n    restart: always\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n    volumes:\n      - ./gitlab-runner-conf/:/etc/gitlab-runner/\n      - /var/run/docker.sock:/var/run/docker.sock \n```\n## GitLab-runner\n[GitLab-runner](https://hub.docker.com/r/gitlab/gitlab-runner/tags)\n gitlab/gitlab-runner:latest GitLab-runner \n: gitlab/gitlab-latest:v15.6.0\n## runnergitlab\n[](https://docs.gitlab.cn/15.5/runner/register/index.html)\n Runner\n```yaml\ndocker-compose exec <compose-service-name> gitlab-runner register \\\n--non-interactive \\\n--executor \"docker\" \\\n--docker-image alpine:latest \\\n--url \"<url>\" \\\n--registration-token \"<token>\" \\\n--description \"docker-runner\" \\\n--maintenance-note \"Free-form maintainer notes about this runner\" \\\n--tag-list \"docker,deploy,server\" \\\n--run-untagged=\"true\" \\\n--locked=\"false\" \\\n--access-level=\"not_protected\"\n```\n## token\n![image.png](img_1.png)\n![image.png](img_2.png)\n\n## \n![image.png](img_3.png)\n## \n![image.png](img_4.png)\n","slug":"2023/gitlab","published":1,"updated":"2024-08-05T11:07:24.336Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiv4000jvaibgufq8njy","content":"<p><code>docker-compose</code><code>docker</code></p>\n<ul>\n<li><a href=\"https://www.yuque.com/yangleduo-cg2ct/fgrxr9\">Docker</a></li>\n</ul>\n<h1 id=\"GitLab-ce\"><a href=\"#GitLab-ce\" class=\"headerlink\" title=\"GitLab-ce\"></a>GitLab-ce</h1><ul>\n<li><a href=\"https://docs.gitlab.cn/ee/install/docker.html\"></a></li>\n</ul>\n<h2 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker-compose\"></a>docker-compose</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">&#x27;3&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">gitlab-ce:</span></span><br><span class=\"line\">   <span class=\"attr\">image:</span> <span class=\"string\">&#x27;gitlab/gitlab-ce:latest&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">container_name:</span> <span class=\"string\">&#x27;gitlab-ce&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">privileged:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">   <span class=\"attr\">hostname:</span> <span class=\"string\">&#x27;gitlab&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">environment:</span></span><br><span class=\"line\">     <span class=\"attr\">TZ:</span> <span class=\"string\">&#x27;Asia/Shanghai&#x27;</span></span><br><span class=\"line\">     <span class=\"attr\">GITLAB_OMNIBUS_CONFIG:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">       external_url &#x27;http://120.76.142.218&#x27;</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;time_zone&#x27;] = &#x27;Asia/Shanghai&#x27;</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;smtp_enable&#x27;] = true</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;gitlab_shell_ssh_port&#x27;] = 1022</span></span><br><span class=\"line\"><span class=\"string\"></span>   <span class=\"attr\">ports:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;80:80&#x27;</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;443:443&#x27;</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;1022:22&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">volumes:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./config:/etc/gitlab</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./data:/var/opt/gitlab</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./logs:/var/log/gitlab</span></span><br><span class=\"line\">   <span class=\"attr\">shm_size:</span> <span class=\"string\">&#x27;256m&#x27;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"GitLab\"><a href=\"#GitLab\" class=\"headerlink\" title=\"GitLab\"></a>GitLab</h2><p><a href=\"https://hub.docker.com/r/gitlab/gitlab-ce/tags\">GitLab-ce</a><br> gitlab&#x2F;gitlab-ce:latest GitLab <br>: gitlab&#x2F;gitlab-ce:15.6.0-ce.0</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>docker-compose.yml</code></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">docker-compose</span> <span class=\"string\">up</span> <span class=\"string\">-d</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">docker-componse</span> <span class=\"string\">logs</span> <span class=\"string\">-f</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/post/2023/gitlab/img_0.png\" alt=\"image.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">docker</span> <span class=\"string\">exec</span> <span class=\"string\">-it</span> <span class=\"string\">$(docker</span> <span class=\"string\">ps</span> <span class=\"string\">|</span> <span class=\"string\">grep</span> <span class=\"string\">gitlab</span> <span class=\"string\">|</span> <span class=\"string\">awk</span> <span class=\"string\">&#x27;&#123;print $1&#125;&#x27;</span><span class=\"string\">)</span> <span class=\"string\">grep</span> <span class=\"string\">&#x27;Password:&#x27;</span> <span class=\"string\">/etc/gitlab/initial_root_password</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>initial_root_password</code></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">grep</span> <span class=\"string\">&#x27;Password:&#x27;</span> <span class=\"string\">./initial_root_password</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>root</code> </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>Edit profile</code> <code>Password</code><br><img src=\"/post/2023/gitlab/img_1.png\" alt=\"image.png\"></p>\n<h1 id=\"GitLab-runner\"><a href=\"#GitLab-runner\" class=\"headerlink\" title=\"GitLab-runner\"></a>GitLab-runner</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"https://docs.gitlab.cn/runner/\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><a href=\"https://docs.gitlab.cn/runner/install/docker.html\">runner</a></li>\n<li><a href=\"https://docs.gitlab.cn/runner/register/index.html#docker\">runner</a></li>\n<li><a href=\"https://docs.gitlab.cn/runner/configuration/advanced-configuration.html\">runner</a></li>\n<li><a href=\"https://docs.gitlab.cn/ee/ci/yaml/index.html\">.gitlab-ci.yml</a></li>\n</ul>\n<h2 id=\"docker-compose-1\"><a href=\"#docker-compose-1\" class=\"headerlink\" title=\"docker-compose\"></a>docker-compose</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">&#x27;3&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">gitlab-ce:</span></span><br><span class=\"line\">   <span class=\"attr\">image:</span> <span class=\"string\">&#x27;gitlab/gitlab-ce&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">container_name:</span> <span class=\"string\">&#x27;gitlab-ce&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">privileged:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">   <span class=\"attr\">hostname:</span> <span class=\"string\">&#x27;gitlab&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">environment:</span></span><br><span class=\"line\">     <span class=\"attr\">TZ:</span> <span class=\"string\">&#x27;Asia/Shanghai&#x27;</span></span><br><span class=\"line\">     <span class=\"attr\">GITLAB_OMNIBUS_CONFIG:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">       external_url &#x27;http://120.76.142.218&#x27;</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;time_zone&#x27;] = &#x27;Asia/Shanghai&#x27;</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;smtp_enable&#x27;] = true</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;gitlab_shell_ssh_port&#x27;] = 1022</span></span><br><span class=\"line\"><span class=\"string\"></span>   <span class=\"attr\">ports:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;80:80&#x27;</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;443:443&#x27;</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;1022:22&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">volumes:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./config:/etc/gitlab</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./data:/var/opt/gitlab</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./logs:/var/log/gitlab</span></span><br><span class=\"line\">   <span class=\"attr\">shm_size:</span> <span class=\"string\">&#x27;256m&#x27;</span></span><br><span class=\"line\">  <span class=\"attr\">gitlab-runner:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">gitlab/gitlab-runner:latest</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">gitlab-runner</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">ulimits:</span></span><br><span class=\"line\">      <span class=\"attr\">memlock:</span></span><br><span class=\"line\">        <span class=\"attr\">soft:</span> <span class=\"number\">-1</span></span><br><span class=\"line\">        <span class=\"attr\">hard:</span> <span class=\"number\">-1</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./gitlab-runner-conf/:/etc/gitlab-runner/</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/var/run/docker.sock:/var/run/docker.sock</span> </span><br></pre></td></tr></table></figure>\n<h2 id=\"GitLab-runner\"><a href=\"#GitLab-runner\" class=\"headerlink\" title=\"GitLab-runner\"></a>GitLab-runner</h2><p><a href=\"https://hub.docker.com/r/gitlab/gitlab-runner/tags\">GitLab-runner</a><br> gitlab&#x2F;gitlab-runner:latest GitLab-runner <br>: gitlab&#x2F;gitlab-latest:v15.6.0</p>\n<h2 id=\"runnergitlab\"><a href=\"#runnergitlab\" class=\"headerlink\" title=\"runnergitlab\"></a>runnergitlab</h2><p><a href=\"https://docs.gitlab.cn/15.5/runner/register/index.html\"></a><br> Runner</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">docker-compose</span> <span class=\"string\">exec</span> <span class=\"string\">&lt;compose-service-name&gt;</span> <span class=\"string\">gitlab-runner</span> <span class=\"string\">register</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--non-interactive</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--executor</span> <span class=\"string\">&quot;docker&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--docker-image</span> <span class=\"string\">alpine:latest</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--url</span> <span class=\"string\">&quot;&lt;url&gt;&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--registration-token</span> <span class=\"string\">&quot;&lt;token&gt;&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--description</span> <span class=\"string\">&quot;docker-runner&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--maintenance-note</span> <span class=\"string\">&quot;Free-form maintainer notes about this runner&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--tag-list</span> <span class=\"string\">&quot;docker,deploy,server&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--run-untagged=&quot;true&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--locked=&quot;false&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--access-level=&quot;not_protected&quot;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"token\"><a href=\"#token\" class=\"headerlink\" title=\"token\"></a>token</h2><p><img src=\"/post/2023/gitlab/img_1.png\" alt=\"image.png\"><br><img src=\"/post/2023/gitlab/img_2.png\" alt=\"image.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/post/2023/gitlab/img_3.png\" alt=\"image.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/post/2023/gitlab/img_4.png\" alt=\"image.png\"></p>\n","cover":false,"excerpt":"","more":"<p><code>docker-compose</code><code>docker</code></p>\n<ul>\n<li><a href=\"https://www.yuque.com/yangleduo-cg2ct/fgrxr9\">Docker</a></li>\n</ul>\n<h1 id=\"GitLab-ce\"><a href=\"#GitLab-ce\" class=\"headerlink\" title=\"GitLab-ce\"></a>GitLab-ce</h1><ul>\n<li><a href=\"https://docs.gitlab.cn/ee/install/docker.html\"></a></li>\n</ul>\n<h2 id=\"docker-compose\"><a href=\"#docker-compose\" class=\"headerlink\" title=\"docker-compose\"></a>docker-compose</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">&#x27;3&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">gitlab-ce:</span></span><br><span class=\"line\">   <span class=\"attr\">image:</span> <span class=\"string\">&#x27;gitlab/gitlab-ce:latest&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">container_name:</span> <span class=\"string\">&#x27;gitlab-ce&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">privileged:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">   <span class=\"attr\">hostname:</span> <span class=\"string\">&#x27;gitlab&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">environment:</span></span><br><span class=\"line\">     <span class=\"attr\">TZ:</span> <span class=\"string\">&#x27;Asia/Shanghai&#x27;</span></span><br><span class=\"line\">     <span class=\"attr\">GITLAB_OMNIBUS_CONFIG:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">       external_url &#x27;http://120.76.142.218&#x27;</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;time_zone&#x27;] = &#x27;Asia/Shanghai&#x27;</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;smtp_enable&#x27;] = true</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;gitlab_shell_ssh_port&#x27;] = 1022</span></span><br><span class=\"line\"><span class=\"string\"></span>   <span class=\"attr\">ports:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;80:80&#x27;</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;443:443&#x27;</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;1022:22&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">volumes:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./config:/etc/gitlab</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./data:/var/opt/gitlab</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./logs:/var/log/gitlab</span></span><br><span class=\"line\">   <span class=\"attr\">shm_size:</span> <span class=\"string\">&#x27;256m&#x27;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"GitLab\"><a href=\"#GitLab\" class=\"headerlink\" title=\"GitLab\"></a>GitLab</h2><p><a href=\"https://hub.docker.com/r/gitlab/gitlab-ce/tags\">GitLab-ce</a><br> gitlab&#x2F;gitlab-ce:latest GitLab <br>: gitlab&#x2F;gitlab-ce:15.6.0-ce.0</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>docker-compose.yml</code></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">docker-compose</span> <span class=\"string\">up</span> <span class=\"string\">-d</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">docker-componse</span> <span class=\"string\">logs</span> <span class=\"string\">-f</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/post/2023/gitlab/img_0.png\" alt=\"image.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">docker</span> <span class=\"string\">exec</span> <span class=\"string\">-it</span> <span class=\"string\">$(docker</span> <span class=\"string\">ps</span> <span class=\"string\">|</span> <span class=\"string\">grep</span> <span class=\"string\">gitlab</span> <span class=\"string\">|</span> <span class=\"string\">awk</span> <span class=\"string\">&#x27;&#123;print $1&#125;&#x27;</span><span class=\"string\">)</span> <span class=\"string\">grep</span> <span class=\"string\">&#x27;Password:&#x27;</span> <span class=\"string\">/etc/gitlab/initial_root_password</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>initial_root_password</code></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">grep</span> <span class=\"string\">&#x27;Password:&#x27;</span> <span class=\"string\">./initial_root_password</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>root</code> </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>Edit profile</code> <code>Password</code><br><img src=\"/post/2023/gitlab/img_1.png\" alt=\"image.png\"></p>\n<h1 id=\"GitLab-runner\"><a href=\"#GitLab-runner\" class=\"headerlink\" title=\"GitLab-runner\"></a>GitLab-runner</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"https://docs.gitlab.cn/runner/\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><a href=\"https://docs.gitlab.cn/runner/install/docker.html\">runner</a></li>\n<li><a href=\"https://docs.gitlab.cn/runner/register/index.html#docker\">runner</a></li>\n<li><a href=\"https://docs.gitlab.cn/runner/configuration/advanced-configuration.html\">runner</a></li>\n<li><a href=\"https://docs.gitlab.cn/ee/ci/yaml/index.html\">.gitlab-ci.yml</a></li>\n</ul>\n<h2 id=\"docker-compose-1\"><a href=\"#docker-compose-1\" class=\"headerlink\" title=\"docker-compose\"></a>docker-compose</h2><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">&#x27;3&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">gitlab-ce:</span></span><br><span class=\"line\">   <span class=\"attr\">image:</span> <span class=\"string\">&#x27;gitlab/gitlab-ce&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">container_name:</span> <span class=\"string\">&#x27;gitlab-ce&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">privileged:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">   <span class=\"attr\">hostname:</span> <span class=\"string\">&#x27;gitlab&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">environment:</span></span><br><span class=\"line\">     <span class=\"attr\">TZ:</span> <span class=\"string\">&#x27;Asia/Shanghai&#x27;</span></span><br><span class=\"line\">     <span class=\"attr\">GITLAB_OMNIBUS_CONFIG:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">       external_url &#x27;http://120.76.142.218&#x27;</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;time_zone&#x27;] = &#x27;Asia/Shanghai&#x27;</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;smtp_enable&#x27;] = true</span></span><br><span class=\"line\"><span class=\"string\">       gitlab_rails[&#x27;gitlab_shell_ssh_port&#x27;] = 1022</span></span><br><span class=\"line\"><span class=\"string\"></span>   <span class=\"attr\">ports:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;80:80&#x27;</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;443:443&#x27;</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">&#x27;1022:22&#x27;</span></span><br><span class=\"line\">   <span class=\"attr\">volumes:</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./config:/etc/gitlab</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./data:/var/opt/gitlab</span></span><br><span class=\"line\">     <span class=\"bullet\">-</span> <span class=\"string\">./logs:/var/log/gitlab</span></span><br><span class=\"line\">   <span class=\"attr\">shm_size:</span> <span class=\"string\">&#x27;256m&#x27;</span></span><br><span class=\"line\">  <span class=\"attr\">gitlab-runner:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">gitlab/gitlab-runner:latest</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">gitlab-runner</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">ulimits:</span></span><br><span class=\"line\">      <span class=\"attr\">memlock:</span></span><br><span class=\"line\">        <span class=\"attr\">soft:</span> <span class=\"number\">-1</span></span><br><span class=\"line\">        <span class=\"attr\">hard:</span> <span class=\"number\">-1</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./gitlab-runner-conf/:/etc/gitlab-runner/</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/var/run/docker.sock:/var/run/docker.sock</span> </span><br></pre></td></tr></table></figure>\n<h2 id=\"GitLab-runner\"><a href=\"#GitLab-runner\" class=\"headerlink\" title=\"GitLab-runner\"></a>GitLab-runner</h2><p><a href=\"https://hub.docker.com/r/gitlab/gitlab-runner/tags\">GitLab-runner</a><br> gitlab&#x2F;gitlab-runner:latest GitLab-runner <br>: gitlab&#x2F;gitlab-latest:v15.6.0</p>\n<h2 id=\"runnergitlab\"><a href=\"#runnergitlab\" class=\"headerlink\" title=\"runnergitlab\"></a>runnergitlab</h2><p><a href=\"https://docs.gitlab.cn/15.5/runner/register/index.html\"></a><br> Runner</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">docker-compose</span> <span class=\"string\">exec</span> <span class=\"string\">&lt;compose-service-name&gt;</span> <span class=\"string\">gitlab-runner</span> <span class=\"string\">register</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--non-interactive</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--executor</span> <span class=\"string\">&quot;docker&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--docker-image</span> <span class=\"string\">alpine:latest</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--url</span> <span class=\"string\">&quot;&lt;url&gt;&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--registration-token</span> <span class=\"string\">&quot;&lt;token&gt;&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--description</span> <span class=\"string\">&quot;docker-runner&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--maintenance-note</span> <span class=\"string\">&quot;Free-form maintainer notes about this runner&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--tag-list</span> <span class=\"string\">&quot;docker,deploy,server&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--run-untagged=&quot;true&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--locked=&quot;false&quot;</span> <span class=\"string\">\\</span></span><br><span class=\"line\"><span class=\"string\">--access-level=&quot;not_protected&quot;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"token\"><a href=\"#token\" class=\"headerlink\" title=\"token\"></a>token</h2><p><img src=\"/post/2023/gitlab/img_1.png\" alt=\"image.png\"><br><img src=\"/post/2023/gitlab/img_2.png\" alt=\"image.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/post/2023/gitlab/img_3.png\" alt=\"image.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/post/2023/gitlab/img_4.png\" alt=\"image.png\"></p>\n"},{"title":"JVM","date":"2023-03-20T16:00:00.000Z","_content":"\n## JVM \n\n\n\n![](./jvm/ecac62a6-7c65-4df3-ba5e-19c0630fb78f.png)\n\n## ClassLoad()\n\n![](./jvm/6bcb9fd5-1105-4a75-b6c5-55dc08af5c50.png)\n\n> classclass classClassLoaderclassExecution Engine\n\n![](./jvm/3cd7e3a5-2b1d-4eb6-83c9-fedc27a2bfc1.png)\n\n### \n\n1. Bootstrap C++\n\n   javaBootstrapClassLoader`c++``java` `java.*`,`ExtClassLoader``AppClassLoader`\n\n2. Extension Java\n\n   jdkExtensionClassLoader`java``classpath``jre` `javax.*``java.ext.dir` \n\n3. AppClassLoader\n\n   AppClassLoader`java``user.dir``class` \n\n4. CustomClassLoader\n\n   `java`,,`class`\n\n\n\n``` java\npublic class MyObject {\n    public static void main(String[] args) {\n        Object object = new Object();\n        System.out.println(object.getClass().getName() + \"  \" + object.getClass().getClassLoader());\n\n        MyObject myObject = new MyObject();\n        System.out.println(myObject.getClass().getName() + \"  \" + myObject.getClass().getClassLoader());\n        System.out.println(myObject.getClass().getName() + \"  \" + myObject.getClass().getClassLoader().getParent());\n        System.out.println(myObject.getClass().getName() + \"  \" + myObject.getClass().getClassLoader().getParent().getParent());\n\n    }\n}\n```\n\n![](./jvm/626353d2-1f73-46e9-858d-732ed7bee94a.png)\n\nBootStropClassLoader java  null \n\n\n\nJAVA classpath\n\n\n\n### \n\n  java.lang.ClassLoader\n\n![](./jvm/a670f078-2260-4276-8db9-79112eb9e979.png)\n\n\n\n### ClassLoad\n\n`.class`\n\n####  \n\n``` java\nprotected Class<?> loadClass(String name, boolean resolve)\n            throws ClassNotFoundException\n    {\n        synchronized (getClassLoadingLock(name)) {\n            // classsh\n            Class<?> c = findLoadedClass(name);\n            if (c == null) {\n                long t0 = System.nanoTime();\n                try {\n                    // c==null\n                    if (parent != null) {\n                        c = parent.loadClass(name, false);\n                    } else {\n                        // bootStrapClassloader\n                        //bootStrapClassloaderget\n                        c = findBootstrapClassOrNull(name);\n                    }\n                } catch (ClassNotFoundException e) {}\n                if (c == null) {\n                    //bootstrapClassLoader class\n                    long t1 = System.nanoTime();\n                    c = findClass(name);\n                    sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);\n                    sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);\n                    sun.misc.PerfCounter.getFindClasses().increment();\n                }\n            }\n            if (resolve) {\n                resolveClass(c);\n            }\n            return c;\n        }\n    }\n```\n\n#### \n\n![](./jvm/745b992d-fcff-46df-8a33-150b65bf47ca.png)\n\n####  \n1.  `.class`\n2. `.class``.class``.class``.class``Class``Class`\n\n## Execution Engine \n\n- Java\n- \n- JVMJVM\n- Java/JVM\n- Java\n- PC\n- PC\n- Java\n\n## Native Interface\n\n`native`Native MethodJava[Java](https://baike.baidu.com/item/Java/85979)JavaCC++\n\nJavaC/C++ JavaC/C++C/C++ nativeNative Method StacknativeExecution Enginenative libraies\nJavaJavaSocketWeb Service\n\n\n\n[](https://baike.baidu.com/item/)native[java](https://baike.baidu.com/item/java)abstractnativejavaabstractnativejavaNative Methodnative staticnative methodCnative synchronizedJVM[](https://baike.baidu.com/item/)java\n\n###  \n\n#### \n\n``` java\npublic class MyObject {  \n    public static void main(String[] args) {\n        Thread thread = new Thread();\n        thread.start();\n    }\n}\n\n```\n\n####  \n\nstrat()start0()\n\n``` java\n   /**\n     * Causes this thread to begin execution; the Java Virtual Machine\n     * calls the <code>run</code> method of this thread.\n     * <p>\n     * The result is that two threads are running concurrently: the\n     * current thread (which returns from the call to the\n     * <code>start</code> method) and the other thread (which executes its\n     * <code>run</code> method).\n     * <p>\n     * It is never legal to start a thread more than once.\n     * In particular, a thread may not be restarted once it has completed\n     * execution.\n     *\n     * @exception  IllegalThreadStateException  if the thread was already\n     *               started.\n     * @see        #run()\n     * @see        #stop()\n     */\n    public synchronized void start() {\n        /**\n         * This method is not invoked for the main method thread or \"system\"\n         * group threads created/set up by the VM. Any new functionality added\n         * to this method in the future may have to also be added to the VM.\n         *\n         * A zero status value corresponds to state \"NEW\".\n         */\n        if (threadStatus != 0)\n            throw new IllegalThreadStateException();\n\n        /* Notify the group that this thread is about to be started\n         * so that it can be added to the group's list of threads\n         * and the group's unstarted count can be decremented. */\n        group.add(this);\n\n        boolean started = false;\n        try {\n            start0();\n            started = true;\n        } finally {\n            try {\n                if (!started) {\n                    group.threadStartFailed(this);\n                }\n            } catch (Throwable ignore) {\n                /* do nothing. If start0 threw a Throwable then\n                  it will be passed up the call stack */\n            }\n        }\n    }\n\n    private native void start0();\n```\n\n##  Native Method Stack\nNative Method Stack`native`Execution\n`Engine`\n\n\n\n## Program Counter Register PC\n\n- PC\n\n- \n\n- JVM\n\n- javaJVMnativeundefined\n\n- \n\n- \n\n- JavaOOM\n\n### \n\n![](./jvm/0c1c2fd0-acb6-4197-801f-a9ff12f5ced4.png)\n![](./jvm/3d67796c-0dc7-4f12-9af0-39b20fab7cbf.png)\n\n\n\n###  \n#### PC\n\nCPU\n\n#### PC\n\nJVMpc\n\n![](./jvm/5f12c1e3-2e47-4997-a887-b395b511490b.png)\n\n### PC?\n\nCPUpc\n\ncpu\n\n\n\n\n\n## Method Area \n\n****( Runtime Constant Pool)****(PermGen space) (Metaspace)\n\njdk 1.7 jdk1.8 \n\n,\n\n    \n\n - \n - \n - ,,,\n - ,.:  \n\n\n\n##  Stackd \n\n****\n\n> = + \n\n> = +\n\n###  FIFO \n\n\n\n###   FILO \n\n\n\n\n\n\n\nJava--Over**8++**\n****\n\n### ?\n\n=java \n\n3:\n\n-  (Local Variables) :;\n-  (Operand Stack) :;\n-  (Frame Data) :\n\n\n\n###  :\n(Stack Frame) \n(Method)\nAF1 \nAB F2\nBCF3\nF3F2F1.....\n\n/\n\n****\n****\n\nJVM256K\" ~756K1Mb\n\n\n\n![](./jvm/95c89389-d9e7-42e1-9d80-4886d458a48b.png)\n\n\n\n:2,211212,\n\n(),\n\n\n\n###   SOF\n\n**Exception in thread \"main\" java.lang.StackOverflowError**  \n\n\n\n![](./jvm/90434413-5431-408e-878f-3b76d5118d64.png)\n\n\n\n### ++\n\n![](./jvm/d404438c-1def-4366-90a5-3f304dd1ddf2.png)\n\n**HotSpot:Java``reference**\n\n![](./jvm/5066a220-0f28-4b94-8934-f54c722697a9.png)\n\n\n\n## Heap \n\n\nJVM:\n\n- Young Generation Space\t\t\tYoung/New\n- Tenure generation space\t\t\tOld/ Tenure\n- Permanent Space\t\t\t\t  \t\tPerm\n\n\n\n### JAVA7 \n\n![](./jvm/bedb0d3f-90d8-4867-84c2-cea52a58412f.png)\n\n\n\n### JAVA8 \n\n\n\n\n\n**````++**\n\n**````+**\n\n\n\n()\n\n\n\n> :(Eden space) (Survivorpacee)new: 0 (Survivor 0 pace) 1(Survivor 1 space) JVM(MinorGC)0011?,Ma jorGC (Fu11GC) Ful1 GC00MQutOfMemoryError\"\n\njava.lang.OutOfMemoryError: Java heap spaceJava\n\n1. Java-Xms-Xmx \n2. (\n   )\n\n\n\n##  GC\n\nJavaGC:( EdenFrom Survivor)To Survivor\n\n![](./jvm/bece6bf1-f9a8-475d-9911-6293e225d84e.png)\n\n\n\n###  MinorGC(->->)\n\n1. Eden SurvivorFrom SurvivorTo+1Eden GC,SurvivorFrom EdenGCEdenFrom,,To()+1\n2. Eden SurvivorFromEdenSurvivorFrom to\n3. SurvivorTo SurvivorFromSurvivorToSurvivorFromSurvivorTo GCSurvivorFromFromTo15(JVMMaxTenuringThreshold15),,\n\n**HotSpot**\n\n![](./jvm/5fb46273-081b-4271-b94c-e2ba6eea5f69.png)\n\n\n\n### (java7)\nJDKClass, Interface**JVM**\n\n\n\n## \n\n**JAVA7**\n\n![](./jvm/8b2d9ee5-a0da-460c-9296-71cd9bae71cb.png)\n\n\n\n**JAVA8**\n\nJDK 1.8\n\n![](./jvm/db1f5266-c920-4379-a82d-f0dadbe1a1c3.png)\n\n\n\n\n\nJava8 \n\n\n\n**JVMjava8**\n\n\n\nnative memory,javaMaxPermSize,\n\n### JVMJVM\n\n* JVMhttps://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html\n\n* HotSpot\n\n  >  - HotSpot\n  >\n  > -X HotSpot\n  >\n  > -XX \n\n  java -version\n\n  java -X\n\n  java -XX:+PrintFlagsWithComments //debug\n\n### \n\n|                 |                                      |\n| :-----------------: | ---------------------------------------- |\n|        -Xms         | \"1/64\" |\n|        -Xmx         | \"1/4\"      |\n| -XX:+PrintGCDetails | GC                     |\n\n``` java\npublic class T1 {\n    public static void main(String[] args) {\n\n        int availableProcessors = Runtime.getRuntime().availableProcessors();\n        System.out.println(\"\" + availableProcessors);\n\n        //\"1/4\"\n        long maxMemory = Runtime.getRuntime().maxMemory();\n        System.out.println(\"-Xmx (MAX_MEMORY) = \" + maxMemory + \"\" + maxMemory / 1024 / 1024 + \"M\");\n\n        //\"1/64\"\n        long totalMemory = Runtime.getRuntime().totalMemory();\n        System.out.println(\"-Xms (TOTAL_MEMORY) = \" + totalMemory + \"\" + totalMemory / 1024 / 1024 + \"M\");\n    }\n}\n```\n\n![](./jvm/4f6873cb-c0f9-4955-8600-bf37e24f4fbf.png)\n\nJVM\n\n![](./jvm/f0d5cf63-e51f-4309-b8ff-448f90ca78fb.png)\n\nJAVA8\n\n![](./jvm/d215e636-ea46-4b84-a861-4aff3dbdbf0e.png)\n\nJAVA7\n\n![](./jvm/befee5fe-233e-4ca1-8a63-1b8908311845.png)\n\n###  OOM\n\n``` java\nimport java.util.Random;\n\npublic class T2 {\n    public static void main(String[] args) {\n        while (true) {\n            String str = \"Mr.Wang\";\n            str += new Random().nextInt(88888888) + new Random().nextInt(99999999);\n        }\n    }\n}\n```\n\n\n\n![](./jvm/787d871b-0d4c-403a-ae3f-cbc6ea587dc1.png)\n\n![](./jvm/d5649d47-ed1b-4797-8a8f-73634873cd9d.png)\n\n**Exception: java.lang.OutOfMemoryError** \n\n![](./jvm/9111c342-79fb-4def-aef6-d266daea6078.png)\n\n### GC \n\n![](./jvm/d9b58c91-421c-4afe-b359-2cde68c12eca.png)\n\n![](./jvm/3e60331e-2742-4047-8383-e107945f85c4.png)\n\n![](./jvm/3bfa032a-2a4e-4f01-b03d-90c4c39df0aa.png)\n\nJVMGC ****GCGC (minor GC)GC (major GC or FullGC)\n\n**Minor GC Full GC**\n\n- GC (minor GC) :GC,JavaMinor GC \n\n- GC (major GC or Full GC) :Major GC,Minor GC () **Major GC Minor GC10,2/31/3**\n","source":"_posts/2023/jvm.md","raw":"---\ntitle: JVM\ndate: 2023-03-21\ntags:\n- jvm\ncategories:\n- JAVA\n---\n\n## JVM \n\n\n\n![](./jvm/ecac62a6-7c65-4df3-ba5e-19c0630fb78f.png)\n\n## ClassLoad()\n\n![](./jvm/6bcb9fd5-1105-4a75-b6c5-55dc08af5c50.png)\n\n> classclass classClassLoaderclassExecution Engine\n\n![](./jvm/3cd7e3a5-2b1d-4eb6-83c9-fedc27a2bfc1.png)\n\n### \n\n1. Bootstrap C++\n\n   javaBootstrapClassLoader`c++``java` `java.*`,`ExtClassLoader``AppClassLoader`\n\n2. Extension Java\n\n   jdkExtensionClassLoader`java``classpath``jre` `javax.*``java.ext.dir` \n\n3. AppClassLoader\n\n   AppClassLoader`java``user.dir``class` \n\n4. CustomClassLoader\n\n   `java`,,`class`\n\n\n\n``` java\npublic class MyObject {\n    public static void main(String[] args) {\n        Object object = new Object();\n        System.out.println(object.getClass().getName() + \"  \" + object.getClass().getClassLoader());\n\n        MyObject myObject = new MyObject();\n        System.out.println(myObject.getClass().getName() + \"  \" + myObject.getClass().getClassLoader());\n        System.out.println(myObject.getClass().getName() + \"  \" + myObject.getClass().getClassLoader().getParent());\n        System.out.println(myObject.getClass().getName() + \"  \" + myObject.getClass().getClassLoader().getParent().getParent());\n\n    }\n}\n```\n\n![](./jvm/626353d2-1f73-46e9-858d-732ed7bee94a.png)\n\nBootStropClassLoader java  null \n\n\n\nJAVA classpath\n\n\n\n### \n\n  java.lang.ClassLoader\n\n![](./jvm/a670f078-2260-4276-8db9-79112eb9e979.png)\n\n\n\n### ClassLoad\n\n`.class`\n\n####  \n\n``` java\nprotected Class<?> loadClass(String name, boolean resolve)\n            throws ClassNotFoundException\n    {\n        synchronized (getClassLoadingLock(name)) {\n            // classsh\n            Class<?> c = findLoadedClass(name);\n            if (c == null) {\n                long t0 = System.nanoTime();\n                try {\n                    // c==null\n                    if (parent != null) {\n                        c = parent.loadClass(name, false);\n                    } else {\n                        // bootStrapClassloader\n                        //bootStrapClassloaderget\n                        c = findBootstrapClassOrNull(name);\n                    }\n                } catch (ClassNotFoundException e) {}\n                if (c == null) {\n                    //bootstrapClassLoader class\n                    long t1 = System.nanoTime();\n                    c = findClass(name);\n                    sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);\n                    sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);\n                    sun.misc.PerfCounter.getFindClasses().increment();\n                }\n            }\n            if (resolve) {\n                resolveClass(c);\n            }\n            return c;\n        }\n    }\n```\n\n#### \n\n![](./jvm/745b992d-fcff-46df-8a33-150b65bf47ca.png)\n\n####  \n1.  `.class`\n2. `.class``.class``.class``.class``Class``Class`\n\n## Execution Engine \n\n- Java\n- \n- JVMJVM\n- Java/JVM\n- Java\n- PC\n- PC\n- Java\n\n## Native Interface\n\n`native`Native MethodJava[Java](https://baike.baidu.com/item/Java/85979)JavaCC++\n\nJavaC/C++ JavaC/C++C/C++ nativeNative Method StacknativeExecution Enginenative libraies\nJavaJavaSocketWeb Service\n\n\n\n[](https://baike.baidu.com/item/)native[java](https://baike.baidu.com/item/java)abstractnativejavaabstractnativejavaNative Methodnative staticnative methodCnative synchronizedJVM[](https://baike.baidu.com/item/)java\n\n###  \n\n#### \n\n``` java\npublic class MyObject {  \n    public static void main(String[] args) {\n        Thread thread = new Thread();\n        thread.start();\n    }\n}\n\n```\n\n####  \n\nstrat()start0()\n\n``` java\n   /**\n     * Causes this thread to begin execution; the Java Virtual Machine\n     * calls the <code>run</code> method of this thread.\n     * <p>\n     * The result is that two threads are running concurrently: the\n     * current thread (which returns from the call to the\n     * <code>start</code> method) and the other thread (which executes its\n     * <code>run</code> method).\n     * <p>\n     * It is never legal to start a thread more than once.\n     * In particular, a thread may not be restarted once it has completed\n     * execution.\n     *\n     * @exception  IllegalThreadStateException  if the thread was already\n     *               started.\n     * @see        #run()\n     * @see        #stop()\n     */\n    public synchronized void start() {\n        /**\n         * This method is not invoked for the main method thread or \"system\"\n         * group threads created/set up by the VM. Any new functionality added\n         * to this method in the future may have to also be added to the VM.\n         *\n         * A zero status value corresponds to state \"NEW\".\n         */\n        if (threadStatus != 0)\n            throw new IllegalThreadStateException();\n\n        /* Notify the group that this thread is about to be started\n         * so that it can be added to the group's list of threads\n         * and the group's unstarted count can be decremented. */\n        group.add(this);\n\n        boolean started = false;\n        try {\n            start0();\n            started = true;\n        } finally {\n            try {\n                if (!started) {\n                    group.threadStartFailed(this);\n                }\n            } catch (Throwable ignore) {\n                /* do nothing. If start0 threw a Throwable then\n                  it will be passed up the call stack */\n            }\n        }\n    }\n\n    private native void start0();\n```\n\n##  Native Method Stack\nNative Method Stack`native`Execution\n`Engine`\n\n\n\n## Program Counter Register PC\n\n- PC\n\n- \n\n- JVM\n\n- javaJVMnativeundefined\n\n- \n\n- \n\n- JavaOOM\n\n### \n\n![](./jvm/0c1c2fd0-acb6-4197-801f-a9ff12f5ced4.png)\n![](./jvm/3d67796c-0dc7-4f12-9af0-39b20fab7cbf.png)\n\n\n\n###  \n#### PC\n\nCPU\n\n#### PC\n\nJVMpc\n\n![](./jvm/5f12c1e3-2e47-4997-a887-b395b511490b.png)\n\n### PC?\n\nCPUpc\n\ncpu\n\n\n\n\n\n## Method Area \n\n****( Runtime Constant Pool)****(PermGen space) (Metaspace)\n\njdk 1.7 jdk1.8 \n\n,\n\n    \n\n - \n - \n - ,,,\n - ,.:  \n\n\n\n##  Stackd \n\n****\n\n> = + \n\n> = +\n\n###  FIFO \n\n\n\n###   FILO \n\n\n\n\n\n\n\nJava--Over**8++**\n****\n\n### ?\n\n=java \n\n3:\n\n-  (Local Variables) :;\n-  (Operand Stack) :;\n-  (Frame Data) :\n\n\n\n###  :\n(Stack Frame) \n(Method)\nAF1 \nAB F2\nBCF3\nF3F2F1.....\n\n/\n\n****\n****\n\nJVM256K\" ~756K1Mb\n\n\n\n![](./jvm/95c89389-d9e7-42e1-9d80-4886d458a48b.png)\n\n\n\n:2,211212,\n\n(),\n\n\n\n###   SOF\n\n**Exception in thread \"main\" java.lang.StackOverflowError**  \n\n\n\n![](./jvm/90434413-5431-408e-878f-3b76d5118d64.png)\n\n\n\n### ++\n\n![](./jvm/d404438c-1def-4366-90a5-3f304dd1ddf2.png)\n\n**HotSpot:Java``reference**\n\n![](./jvm/5066a220-0f28-4b94-8934-f54c722697a9.png)\n\n\n\n## Heap \n\n\nJVM:\n\n- Young Generation Space\t\t\tYoung/New\n- Tenure generation space\t\t\tOld/ Tenure\n- Permanent Space\t\t\t\t  \t\tPerm\n\n\n\n### JAVA7 \n\n![](./jvm/bedb0d3f-90d8-4867-84c2-cea52a58412f.png)\n\n\n\n### JAVA8 \n\n\n\n\n\n**````++**\n\n**````+**\n\n\n\n()\n\n\n\n> :(Eden space) (Survivorpacee)new: 0 (Survivor 0 pace) 1(Survivor 1 space) JVM(MinorGC)0011?,Ma jorGC (Fu11GC) Ful1 GC00MQutOfMemoryError\"\n\njava.lang.OutOfMemoryError: Java heap spaceJava\n\n1. Java-Xms-Xmx \n2. (\n   )\n\n\n\n##  GC\n\nJavaGC:( EdenFrom Survivor)To Survivor\n\n![](./jvm/bece6bf1-f9a8-475d-9911-6293e225d84e.png)\n\n\n\n###  MinorGC(->->)\n\n1. Eden SurvivorFrom SurvivorTo+1Eden GC,SurvivorFrom EdenGCEdenFrom,,To()+1\n2. Eden SurvivorFromEdenSurvivorFrom to\n3. SurvivorTo SurvivorFromSurvivorToSurvivorFromSurvivorTo GCSurvivorFromFromTo15(JVMMaxTenuringThreshold15),,\n\n**HotSpot**\n\n![](./jvm/5fb46273-081b-4271-b94c-e2ba6eea5f69.png)\n\n\n\n### (java7)\nJDKClass, Interface**JVM**\n\n\n\n## \n\n**JAVA7**\n\n![](./jvm/8b2d9ee5-a0da-460c-9296-71cd9bae71cb.png)\n\n\n\n**JAVA8**\n\nJDK 1.8\n\n![](./jvm/db1f5266-c920-4379-a82d-f0dadbe1a1c3.png)\n\n\n\n\n\nJava8 \n\n\n\n**JVMjava8**\n\n\n\nnative memory,javaMaxPermSize,\n\n### JVMJVM\n\n* JVMhttps://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html\n\n* HotSpot\n\n  >  - HotSpot\n  >\n  > -X HotSpot\n  >\n  > -XX \n\n  java -version\n\n  java -X\n\n  java -XX:+PrintFlagsWithComments //debug\n\n### \n\n|                 |                                      |\n| :-----------------: | ---------------------------------------- |\n|        -Xms         | \"1/64\" |\n|        -Xmx         | \"1/4\"      |\n| -XX:+PrintGCDetails | GC                     |\n\n``` java\npublic class T1 {\n    public static void main(String[] args) {\n\n        int availableProcessors = Runtime.getRuntime().availableProcessors();\n        System.out.println(\"\" + availableProcessors);\n\n        //\"1/4\"\n        long maxMemory = Runtime.getRuntime().maxMemory();\n        System.out.println(\"-Xmx (MAX_MEMORY) = \" + maxMemory + \"\" + maxMemory / 1024 / 1024 + \"M\");\n\n        //\"1/64\"\n        long totalMemory = Runtime.getRuntime().totalMemory();\n        System.out.println(\"-Xms (TOTAL_MEMORY) = \" + totalMemory + \"\" + totalMemory / 1024 / 1024 + \"M\");\n    }\n}\n```\n\n![](./jvm/4f6873cb-c0f9-4955-8600-bf37e24f4fbf.png)\n\nJVM\n\n![](./jvm/f0d5cf63-e51f-4309-b8ff-448f90ca78fb.png)\n\nJAVA8\n\n![](./jvm/d215e636-ea46-4b84-a861-4aff3dbdbf0e.png)\n\nJAVA7\n\n![](./jvm/befee5fe-233e-4ca1-8a63-1b8908311845.png)\n\n###  OOM\n\n``` java\nimport java.util.Random;\n\npublic class T2 {\n    public static void main(String[] args) {\n        while (true) {\n            String str = \"Mr.Wang\";\n            str += new Random().nextInt(88888888) + new Random().nextInt(99999999);\n        }\n    }\n}\n```\n\n\n\n![](./jvm/787d871b-0d4c-403a-ae3f-cbc6ea587dc1.png)\n\n![](./jvm/d5649d47-ed1b-4797-8a8f-73634873cd9d.png)\n\n**Exception: java.lang.OutOfMemoryError** \n\n![](./jvm/9111c342-79fb-4def-aef6-d266daea6078.png)\n\n### GC \n\n![](./jvm/d9b58c91-421c-4afe-b359-2cde68c12eca.png)\n\n![](./jvm/3e60331e-2742-4047-8383-e107945f85c4.png)\n\n![](./jvm/3bfa032a-2a4e-4f01-b03d-90c4c39df0aa.png)\n\nJVMGC ****GCGC (minor GC)GC (major GC or FullGC)\n\n**Minor GC Full GC**\n\n- GC (minor GC) :GC,JavaMinor GC \n\n- GC (major GC or Full GC) :Major GC,Minor GC () **Major GC Minor GC10,2/31/3**\n","slug":"2023/jvm","published":1,"updated":"2024-08-05T11:07:24.339Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiv5000kvaib951o7vdr","content":"<h2 id=\"JVM-\"><a href=\"#JVM-\" class=\"headerlink\" title=\"JVM \"></a>JVM </h2><p></p>\n<p><img src=\"/./jvm/ecac62a6-7c65-4df3-ba5e-19c0630fb78f.png\"></p>\n<h2 id=\"ClassLoad-\"><a href=\"#ClassLoad-\" class=\"headerlink\" title=\"ClassLoad()\"></a>ClassLoad()</h2><p><img src=\"/./jvm/6bcb9fd5-1105-4a75-b6c5-55dc08af5c50.png\"></p>\n<blockquote>\n<p>classclass classClassLoaderclassExecution Engine</p>\n</blockquote>\n<p><img src=\"/./jvm/3cd7e3a5-2b1d-4eb6-83c9-fedc27a2bfc1.png\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><p>Bootstrap C++</p>\n<p>javaBootstrapClassLoader<code>c++</code><code>java</code> <code>java.*</code>,<code>ExtClassLoader</code><code>AppClassLoader</code></p>\n</li>\n<li><p>Extension Java</p>\n<p>jdkExtensionClassLoader<code>java</code><code>classpath</code><code>jre</code> <code>javax.*</code><code>java.ext.dir</code> </p>\n</li>\n<li><p>AppClassLoader</p>\n<p>AppClassLoader<code>java</code><code>user.dir</code><code>class</code> </p>\n</li>\n<li><p>CustomClassLoader</p>\n<p><code>java</code>,,<code>class</code></p>\n</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyObject</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">object</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">        System.out.println(object.getClass().getName() + <span class=\"string\">&quot;  &quot;</span> + object.getClass().getClassLoader());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">MyObject</span> <span class=\"variable\">myObject</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyObject</span>();</span><br><span class=\"line\">        System.out.println(myObject.getClass().getName() + <span class=\"string\">&quot;  &quot;</span> + myObject.getClass().getClassLoader());</span><br><span class=\"line\">        System.out.println(myObject.getClass().getName() + <span class=\"string\">&quot;  &quot;</span> + myObject.getClass().getClassLoader().getParent());</span><br><span class=\"line\">        System.out.println(myObject.getClass().getName() + <span class=\"string\">&quot;  &quot;</span> + myObject.getClass().getClassLoader().getParent().getParent());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/./jvm/626353d2-1f73-46e9-858d-732ed7bee94a.png\"></p>\n<p>BootStropClassLoader java  null </p>\n<p>JAVA classpath</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>  java.lang.ClassLoader</p>\n<p><img src=\"/./jvm/a670f078-2260-4276-8db9-79112eb9e979.png\"></p>\n<h3 id=\"ClassLoad\"><a href=\"#ClassLoad\" class=\"headerlink\" title=\"ClassLoad\"></a>ClassLoad</h3><p><code>.class</code></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> Class&lt;?&gt; loadClass(String name, <span class=\"type\">boolean</span> resolve)</span><br><span class=\"line\">            <span class=\"keyword\">throws</span> ClassNotFoundException</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (getClassLoadingLock(name)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// classsh</span></span><br><span class=\"line\">            Class&lt;?&gt; c = findLoadedClass(name);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"type\">long</span> <span class=\"variable\">t0</span> <span class=\"operator\">=</span> System.nanoTime();</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// c==null</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (parent != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        c = parent.loadClass(name, <span class=\"literal\">false</span>);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// bootStrapClassloader</span></span><br><span class=\"line\">                        <span class=\"comment\">//bootStrapClassloaderget</span></span><br><span class=\"line\">                        c = findBootstrapClassOrNull(name);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;&#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (c == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//bootstrapClassLoader class</span></span><br><span class=\"line\">                    <span class=\"type\">long</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> System.nanoTime();</span><br><span class=\"line\">                    c = findClass(name);</span><br><span class=\"line\">                    sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);</span><br><span class=\"line\">                    sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);</span><br><span class=\"line\">                    sun.misc.PerfCounter.getFindClasses().increment();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (resolve) &#123;</span><br><span class=\"line\">                resolveClass(c);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> c;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><img src=\"/./jvm/745b992d-fcff-46df-8a33-150b65bf47ca.png\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><code>.class</code></li>\n<li><code>.class</code><code>.class</code><code>.class</code><code>.class</code><code>Class</code><code>Class</code></li>\n</ol>\n<h2 id=\"Execution-Engine-\"><a href=\"#Execution-Engine-\" class=\"headerlink\" title=\"Execution Engine \"></a>Execution Engine </h2><ul>\n<li>Java</li>\n<li></li>\n<li>JVMJVM</li>\n<li>Java&#x2F;JVM</li>\n<li>Java</li>\n<li>PC</li>\n<li>PC</li>\n<li>Java</li>\n</ul>\n<h2 id=\"Native-Interface\"><a href=\"#Native-Interface\" class=\"headerlink\" title=\"Native Interface\"></a>Native Interface</h2><p><code>native</code>Native MethodJava<a href=\"https://baike.baidu.com/item/Java/85979\">Java</a>JavaCC++</p>\n<p>JavaC&#x2F;C++ JavaC&#x2F;C++C&#x2F;C++ nativeNative Method StacknativeExecution Enginenative libraies<br>JavaJavaSocketWeb Service</p>\n<p><a href=\"https://baike.baidu.com/item/%E6%A0%87%E8%AF%86%E7%AC%A6\"></a>native<a href=\"https://baike.baidu.com/item/java%E6%A0%87%E8%AF%86%E7%AC%A6\">java</a>abstractnativejavaabstractnativejavaNative Methodnative staticnative methodCnative synchronizedJVM<a href=\"https://baike.baidu.com/item/%E5%90%8C%E6%AD%A5%E9%94%81\"></a>java</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyObject</span> &#123;  </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>();</span><br><span class=\"line\">        thread.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>strat()start0()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * Causes this thread to begin execution; the Java Virtual Machine</span></span><br><span class=\"line\"><span class=\"comment\">  * calls the &lt;code&gt;run&lt;/code&gt; method of this thread.</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\">  * The result is that two threads are running concurrently: the</span></span><br><span class=\"line\"><span class=\"comment\">  * current thread (which returns from the call to the</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;code&gt;start&lt;/code&gt; method) and the other thread (which executes its</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;code&gt;run&lt;/code&gt; method).</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\">  * It is never legal to start a thread more than once.</span></span><br><span class=\"line\"><span class=\"comment\">  * In particular, a thread may not be restarted once it has completed</span></span><br><span class=\"line\"><span class=\"comment\">  * execution.</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@exception</span>  IllegalThreadStateException  if the thread was already</span></span><br><span class=\"line\"><span class=\"comment\">  *               started.</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@see</span>        #run()</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@see</span>        #stop()</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">     <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">      * This method is not invoked for the main method thread or &quot;system&quot;</span></span><br><span class=\"line\"><span class=\"comment\">      * group threads created/set up by the VM. Any new functionality added</span></span><br><span class=\"line\"><span class=\"comment\">      * to this method in the future may have to also be added to the VM.</span></span><br><span class=\"line\"><span class=\"comment\">      *</span></span><br><span class=\"line\"><span class=\"comment\">      * A zero status value corresponds to state &quot;NEW&quot;.</span></span><br><span class=\"line\"><span class=\"comment\">      */</span></span><br><span class=\"line\">     <span class=\"keyword\">if</span> (threadStatus != <span class=\"number\">0</span>)</span><br><span class=\"line\">         <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalThreadStateException</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"comment\">/* Notify the group that this thread is about to be started</span></span><br><span class=\"line\"><span class=\"comment\">      * so that it can be added to the group&#x27;s list of threads</span></span><br><span class=\"line\"><span class=\"comment\">      * and the group&#x27;s unstarted count can be decremented. */</span></span><br><span class=\"line\">     group.add(<span class=\"built_in\">this</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"type\">boolean</span> <span class=\"variable\">started</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">     <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">         start0();</span><br><span class=\"line\">         started = <span class=\"literal\">true</span>;</span><br><span class=\"line\">     &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">         <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">             <span class=\"keyword\">if</span> (!started) &#123;</span><br><span class=\"line\">                 group.threadStartFailed(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">         &#125; <span class=\"keyword\">catch</span> (Throwable ignore) &#123;</span><br><span class=\"line\">             <span class=\"comment\">/* do nothing. If start0 threw a Throwable then</span></span><br><span class=\"line\"><span class=\"comment\">               it will be passed up the call stack */</span></span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start0</span><span class=\"params\">()</span>;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Native-Method-Stack\"><a href=\"#Native-Method-Stack\" class=\"headerlink\" title=\"Native Method Stack\"></a>Native Method Stack</h2><p>Native Method Stack<code>native</code>Execution<br><code>Engine</code></p>\n<h2 id=\"Program-Counter-Register-PC\"><a href=\"#Program-Counter-Register-PC\" class=\"headerlink\" title=\"Program Counter Register PC\"></a>Program Counter Register PC</h2><ul>\n<li><p>PC</p>\n</li>\n<li><p></p>\n</li>\n<li><p>JVM</p>\n</li>\n<li><p>javaJVMnativeundefined</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>JavaOOM</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/./jvm/0c1c2fd0-acb6-4197-801f-a9ff12f5ced4.png\"><br><img src=\"/./jvm/3d67796c-0dc7-4f12-9af0-39b20fab7cbf.png\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"PC\"><a href=\"#PC\" class=\"headerlink\" title=\"PC\"></a>PC</h4><p>CPU</p>\n<h4 id=\"PC\"><a href=\"#PC\" class=\"headerlink\" title=\"PC\"></a>PC</h4><p>JVMpc</p>\n<p><img src=\"/./jvm/5f12c1e3-2e47-4997-a887-b395b511490b.png\"></p>\n<h3 id=\"PC\"><a href=\"#PC\" class=\"headerlink\" title=\"PC?\"></a>PC?</h3><p>CPUpc</p>\n<p>cpu</p>\n<p></p>\n<h2 id=\"Method-Area-\"><a href=\"#Method-Area-\" class=\"headerlink\" title=\"Method Area \"></a>Method Area </h2><p><strong></strong>( Runtime Constant Pool)<strong></strong>(PermGen space) (Metaspace)</p>\n<p>jdk 1.7 jdk1.8 </p>\n<p>,</p>\n<p>    </p>\n<ul>\n<li></li>\n<li></li>\n<li>,,,</li>\n<li>,.:</li>\n</ul>\n<h2 id=\"Stackd-\"><a href=\"#Stackd-\" class=\"headerlink\" title=\"Stackd \"></a>Stackd </h2><p><strong></strong></p>\n<blockquote>\n<p>&#x3D; + </p>\n</blockquote>\n<blockquote>\n<p>&#x3D; +</p>\n</blockquote>\n<h3 id=\"-FIFO-\"><a href=\"#-FIFO-\" class=\"headerlink\" title=\" FIFO \"></a> FIFO </h3><p></p>\n<h3 id=\"-FILO-\"><a href=\"#-FILO-\" class=\"headerlink\" title=\"  FILO \"></a>  FILO </h3><p></p>\n<p>JavaOver<strong>8++</strong><br><strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"?\"></a>?</h3><p>&#x3D;java </p>\n<p>3:</p>\n<ul>\n<li>(Local Variables) :;</li>\n<li>(Operand Stack) :;</li>\n<li>(Frame Data) :</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\":\"></a>:</h3><p>(Stack Frame) <br>(Method)<br>AF1 <br>AB F2<br>BCF3<br>F3F2F1..</p>\n<p>&#x2F;</p>\n<p><strong></strong><br><strong></strong><br><br>JVM256K ~756K1Mb</p>\n<p><img src=\"/./jvm/95c89389-d9e7-42e1-9d80-4886d458a48b.png\"></p>\n<p>:2,211212,</p>\n<p>(),</p>\n<h3 id=\"-SOF\"><a href=\"#-SOF\" class=\"headerlink\" title=\" SOF\"></a> SOF</h3><p><strong>Exception in thread main java.lang.StackOverflowError</strong>  </p>\n<p></p>\n<p><img src=\"/./jvm/90434413-5431-408e-878f-3b76d5118d64.png\"></p>\n<h3 id=\"--\"><a href=\"#--\" class=\"headerlink\" title=\"++\"></a>++</h3><p><img src=\"/./jvm/d404438c-1def-4366-90a5-3f304dd1ddf2.png\"></p>\n<p><strong>HotSpot:Java<code></code>reference</strong></p>\n<p><img src=\"/./jvm/5066a220-0f28-4b94-8934-f54c722697a9.png\"></p>\n<h2 id=\"Heap-\"><a href=\"#Heap-\" class=\"headerlink\" title=\"Heap \"></a>Heap </h2><p>JVM:</p>\n<ul>\n<li>Young Generation Space\t\t\tYoung&#x2F;New</li>\n<li>Tenure generation space\t\t\tOld&#x2F; Tenure</li>\n<li>Permanent Space\t\t\t\t  \t\tPerm</li>\n</ul>\n<h3 id=\"JAVA7-\"><a href=\"#JAVA7-\" class=\"headerlink\" title=\"JAVA7 \"></a>JAVA7 </h3><p><img src=\"/./jvm/bedb0d3f-90d8-4867-84c2-cea52a58412f.png\"></p>\n<h3 id=\"JAVA8-\"><a href=\"#JAVA8-\" class=\"headerlink\" title=\"JAVA8 \"></a>JAVA8 </h3><p></p>\n<p><strong><code></code><code></code>++</strong></p>\n<p><strong><code></code><code></code>+</strong></p>\n<p>()</p>\n<p></p>\n<blockquote>\n<p>:(Eden space) (Survivorpacee)new: 0 (Survivor 0 pace) 1(Survivor 1 space) JVM(MinorGC)0011?,Ma jorGC (Fu11GC) Ful1 GC00MQutOfMemoryError</p>\n</blockquote>\n<p>java.lang.OutOfMemoryError: Java heap spaceJava</p>\n<ol>\n<li>Java-Xms-Xmx </li>\n<li>(<br>)</li>\n</ol>\n<h2 id=\"GC\"><a href=\"#GC\" class=\"headerlink\" title=\"GC\"></a>GC</h2><p>JavaGC:( EdenFrom Survivor)To Survivor</p>\n<p><img src=\"/./jvm/bece6bf1-f9a8-475d-9911-6293e225d84e.png\"></p>\n<h3 id=\"MinorGC---\"><a href=\"#MinorGC---\" class=\"headerlink\" title=\"MinorGC(-&gt;-&gt;)\"></a>MinorGC(-&gt;-&gt;)</h3><ol>\n<li>Eden SurvivorFrom SurvivorTo+1Eden GC,SurvivorFrom EdenGCEdenFrom,,To()+1</li>\n<li>Eden SurvivorFromEdenSurvivorFrom to</li>\n<li>SurvivorTo SurvivorFromSurvivorToSurvivorFromSurvivorTo GCSurvivorFromFromTo15(JVMMaxTenuringThreshold15),,</li>\n</ol>\n<p><strong>HotSpot</strong></p>\n<p><img src=\"/./jvm/5fb46273-081b-4271-b94c-e2ba6eea5f69.png\"></p>\n<h3 id=\"-java7\"><a href=\"#-java7\" class=\"headerlink\" title=\"(java7)\"></a>(java7)</h3><p>JDKClass, Interface<strong>JVM</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>JAVA7</strong></p>\n<p><img src=\"/./jvm/8b2d9ee5-a0da-460c-9296-71cd9bae71cb.png\"></p>\n<p><strong>JAVA8</strong></p>\n<p>JDK 1.8</p>\n<p><img src=\"/./jvm/db1f5266-c920-4379-a82d-f0dadbe1a1c3.png\"></p>\n<p>Java8 </p>\n<p><strong>JVMjava8</strong></p>\n<p>native memory,javaMaxPermSize,</p>\n<h3 id=\"JVMJVM\"><a href=\"#JVMJVM\" class=\"headerlink\" title=\"JVMJVM\"></a>JVMJVM</h3><ul>\n<li><p>JVM<a href=\"https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html\">https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html</a></p>\n</li>\n<li><p>HotSpot</p>\n<blockquote>\n<p> - HotSpot</p>\n<p>-X HotSpot</p>\n<p>-XX </p>\n</blockquote>\n<p>java -version</p>\n<p>java -X</p>\n<p>java -XX:+PrintFlagsWithComments &#x2F;&#x2F;debug</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-Xms</td>\n<td>1&#x2F;64</td>\n</tr>\n<tr>\n<td align=\"center\">-Xmx</td>\n<td>1&#x2F;4</td>\n</tr>\n<tr>\n<td align=\"center\">-XX:+PrintGCDetails</td>\n<td>GC</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T1</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">availableProcessors</span> <span class=\"operator\">=</span> Runtime.getRuntime().availableProcessors();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span> + availableProcessors);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//&quot;1/4&quot;</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">maxMemory</span> <span class=\"operator\">=</span> Runtime.getRuntime().maxMemory();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;-Xmx (MAX_MEMORY) = &quot;</span> + maxMemory + <span class=\"string\">&quot;&quot;</span> + maxMemory / <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;M&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//&quot;1/64&quot;</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">totalMemory</span> <span class=\"operator\">=</span> Runtime.getRuntime().totalMemory();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;-Xms (TOTAL_MEMORY) = &quot;</span> + totalMemory + <span class=\"string\">&quot;&quot;</span> + totalMemory / <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;M&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/./jvm/4f6873cb-c0f9-4955-8600-bf37e24f4fbf.png\"></p>\n<p>JVM</p>\n<p><img src=\"/./jvm/f0d5cf63-e51f-4309-b8ff-448f90ca78fb.png\"></p>\n<p>JAVA8</p>\n<p><img src=\"/./jvm/d215e636-ea46-4b84-a861-4aff3dbdbf0e.png\"></p>\n<p>JAVA7</p>\n<p><img src=\"/./jvm/befee5fe-233e-4ca1-8a63-1b8908311845.png\"></p>\n<h3 id=\"-OOM\"><a href=\"#-OOM\" class=\"headerlink\" title=\" OOM\"></a> OOM</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;Mr.Wang&quot;</span>;</span><br><span class=\"line\">            str += <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>().nextInt(<span class=\"number\">88888888</span>) + <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>().nextInt(<span class=\"number\">99999999</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><img src=\"/./jvm/787d871b-0d4c-403a-ae3f-cbc6ea587dc1.png\"></p>\n<p><img src=\"/./jvm/d5649d47-ed1b-4797-8a8f-73634873cd9d.png\"></p>\n<p><strong>Exception: java.lang.OutOfMemoryError</strong> </p>\n<p><img src=\"/./jvm/9111c342-79fb-4def-aef6-d266daea6078.png\"></p>\n<h3 id=\"GC-\"><a href=\"#GC-\" class=\"headerlink\" title=\"GC \"></a>GC </h3><p><img src=\"/./jvm/d9b58c91-421c-4afe-b359-2cde68c12eca.png\"></p>\n<p><img src=\"/./jvm/3e60331e-2742-4047-8383-e107945f85c4.png\"></p>\n<p><img src=\"/./jvm/3bfa032a-2a4e-4f01-b03d-90c4c39df0aa.png\"></p>\n<p>JVMGC <strong></strong>GCGC (minor GC)GC (major GC or FullGC)</p>\n<p><strong>Minor GC Full GC</strong></p>\n<ul>\n<li><p>GC (minor GC) :GC,JavaMinor GC </p>\n</li>\n<li><p>GC (major GC or Full GC) :Major GC,Minor GC () <strong>Major GC Minor GC10,2&#x2F;31&#x2F;3</strong></p>\n</li>\n</ul>\n","cover":false,"excerpt":"","more":"<h2 id=\"JVM-\"><a href=\"#JVM-\" class=\"headerlink\" title=\"JVM \"></a>JVM </h2><p></p>\n<p><img src=\"/./jvm/ecac62a6-7c65-4df3-ba5e-19c0630fb78f.png\"></p>\n<h2 id=\"ClassLoad-\"><a href=\"#ClassLoad-\" class=\"headerlink\" title=\"ClassLoad()\"></a>ClassLoad()</h2><p><img src=\"/./jvm/6bcb9fd5-1105-4a75-b6c5-55dc08af5c50.png\"></p>\n<blockquote>\n<p>classclass classClassLoaderclassExecution Engine</p>\n</blockquote>\n<p><img src=\"/./jvm/3cd7e3a5-2b1d-4eb6-83c9-fedc27a2bfc1.png\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><p>Bootstrap C++</p>\n<p>javaBootstrapClassLoader<code>c++</code><code>java</code> <code>java.*</code>,<code>ExtClassLoader</code><code>AppClassLoader</code></p>\n</li>\n<li><p>Extension Java</p>\n<p>jdkExtensionClassLoader<code>java</code><code>classpath</code><code>jre</code> <code>javax.*</code><code>java.ext.dir</code> </p>\n</li>\n<li><p>AppClassLoader</p>\n<p>AppClassLoader<code>java</code><code>user.dir</code><code>class</code> </p>\n</li>\n<li><p>CustomClassLoader</p>\n<p><code>java</code>,,<code>class</code></p>\n</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyObject</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">object</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">        System.out.println(object.getClass().getName() + <span class=\"string\">&quot;  &quot;</span> + object.getClass().getClassLoader());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">MyObject</span> <span class=\"variable\">myObject</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyObject</span>();</span><br><span class=\"line\">        System.out.println(myObject.getClass().getName() + <span class=\"string\">&quot;  &quot;</span> + myObject.getClass().getClassLoader());</span><br><span class=\"line\">        System.out.println(myObject.getClass().getName() + <span class=\"string\">&quot;  &quot;</span> + myObject.getClass().getClassLoader().getParent());</span><br><span class=\"line\">        System.out.println(myObject.getClass().getName() + <span class=\"string\">&quot;  &quot;</span> + myObject.getClass().getClassLoader().getParent().getParent());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/./jvm/626353d2-1f73-46e9-858d-732ed7bee94a.png\"></p>\n<p>BootStropClassLoader java  null </p>\n<p>JAVA classpath</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>  java.lang.ClassLoader</p>\n<p><img src=\"/./jvm/a670f078-2260-4276-8db9-79112eb9e979.png\"></p>\n<h3 id=\"ClassLoad\"><a href=\"#ClassLoad\" class=\"headerlink\" title=\"ClassLoad\"></a>ClassLoad</h3><p><code>.class</code></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> Class&lt;?&gt; loadClass(String name, <span class=\"type\">boolean</span> resolve)</span><br><span class=\"line\">            <span class=\"keyword\">throws</span> ClassNotFoundException</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (getClassLoadingLock(name)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// classsh</span></span><br><span class=\"line\">            Class&lt;?&gt; c = findLoadedClass(name);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"type\">long</span> <span class=\"variable\">t0</span> <span class=\"operator\">=</span> System.nanoTime();</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// c==null</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (parent != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        c = parent.loadClass(name, <span class=\"literal\">false</span>);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// bootStrapClassloader</span></span><br><span class=\"line\">                        <span class=\"comment\">//bootStrapClassloaderget</span></span><br><span class=\"line\">                        c = findBootstrapClassOrNull(name);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;&#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (c == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//bootstrapClassLoader class</span></span><br><span class=\"line\">                    <span class=\"type\">long</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> System.nanoTime();</span><br><span class=\"line\">                    c = findClass(name);</span><br><span class=\"line\">                    sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);</span><br><span class=\"line\">                    sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);</span><br><span class=\"line\">                    sun.misc.PerfCounter.getFindClasses().increment();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (resolve) &#123;</span><br><span class=\"line\">                resolveClass(c);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> c;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><img src=\"/./jvm/745b992d-fcff-46df-8a33-150b65bf47ca.png\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><code>.class</code></li>\n<li><code>.class</code><code>.class</code><code>.class</code><code>.class</code><code>Class</code><code>Class</code></li>\n</ol>\n<h2 id=\"Execution-Engine-\"><a href=\"#Execution-Engine-\" class=\"headerlink\" title=\"Execution Engine \"></a>Execution Engine </h2><ul>\n<li>Java</li>\n<li></li>\n<li>JVMJVM</li>\n<li>Java&#x2F;JVM</li>\n<li>Java</li>\n<li>PC</li>\n<li>PC</li>\n<li>Java</li>\n</ul>\n<h2 id=\"Native-Interface\"><a href=\"#Native-Interface\" class=\"headerlink\" title=\"Native Interface\"></a>Native Interface</h2><p><code>native</code>Native MethodJava<a href=\"https://baike.baidu.com/item/Java/85979\">Java</a>JavaCC++</p>\n<p>JavaC&#x2F;C++ JavaC&#x2F;C++C&#x2F;C++ nativeNative Method StacknativeExecution Enginenative libraies<br>JavaJavaSocketWeb Service</p>\n<p><a href=\"https://baike.baidu.com/item/%E6%A0%87%E8%AF%86%E7%AC%A6\"></a>native<a href=\"https://baike.baidu.com/item/java%E6%A0%87%E8%AF%86%E7%AC%A6\">java</a>abstractnativejavaabstractnativejavaNative Methodnative staticnative methodCnative synchronizedJVM<a href=\"https://baike.baidu.com/item/%E5%90%8C%E6%AD%A5%E9%94%81\"></a>java</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyObject</span> &#123;  </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>();</span><br><span class=\"line\">        thread.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>strat()start0()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">  * Causes this thread to begin execution; the Java Virtual Machine</span></span><br><span class=\"line\"><span class=\"comment\">  * calls the &lt;code&gt;run&lt;/code&gt; method of this thread.</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\">  * The result is that two threads are running concurrently: the</span></span><br><span class=\"line\"><span class=\"comment\">  * current thread (which returns from the call to the</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;code&gt;start&lt;/code&gt; method) and the other thread (which executes its</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;code&gt;run&lt;/code&gt; method).</span></span><br><span class=\"line\"><span class=\"comment\">  * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\">  * It is never legal to start a thread more than once.</span></span><br><span class=\"line\"><span class=\"comment\">  * In particular, a thread may not be restarted once it has completed</span></span><br><span class=\"line\"><span class=\"comment\">  * execution.</span></span><br><span class=\"line\"><span class=\"comment\">  *</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@exception</span>  IllegalThreadStateException  if the thread was already</span></span><br><span class=\"line\"><span class=\"comment\">  *               started.</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@see</span>        #run()</span></span><br><span class=\"line\"><span class=\"comment\">  * <span class=\"doctag\">@see</span>        #stop()</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">     <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">      * This method is not invoked for the main method thread or &quot;system&quot;</span></span><br><span class=\"line\"><span class=\"comment\">      * group threads created/set up by the VM. Any new functionality added</span></span><br><span class=\"line\"><span class=\"comment\">      * to this method in the future may have to also be added to the VM.</span></span><br><span class=\"line\"><span class=\"comment\">      *</span></span><br><span class=\"line\"><span class=\"comment\">      * A zero status value corresponds to state &quot;NEW&quot;.</span></span><br><span class=\"line\"><span class=\"comment\">      */</span></span><br><span class=\"line\">     <span class=\"keyword\">if</span> (threadStatus != <span class=\"number\">0</span>)</span><br><span class=\"line\">         <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalThreadStateException</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"comment\">/* Notify the group that this thread is about to be started</span></span><br><span class=\"line\"><span class=\"comment\">      * so that it can be added to the group&#x27;s list of threads</span></span><br><span class=\"line\"><span class=\"comment\">      * and the group&#x27;s unstarted count can be decremented. */</span></span><br><span class=\"line\">     group.add(<span class=\"built_in\">this</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"type\">boolean</span> <span class=\"variable\">started</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">     <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">         start0();</span><br><span class=\"line\">         started = <span class=\"literal\">true</span>;</span><br><span class=\"line\">     &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">         <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">             <span class=\"keyword\">if</span> (!started) &#123;</span><br><span class=\"line\">                 group.threadStartFailed(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">         &#125; <span class=\"keyword\">catch</span> (Throwable ignore) &#123;</span><br><span class=\"line\">             <span class=\"comment\">/* do nothing. If start0 threw a Throwable then</span></span><br><span class=\"line\"><span class=\"comment\">               it will be passed up the call stack */</span></span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start0</span><span class=\"params\">()</span>;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Native-Method-Stack\"><a href=\"#Native-Method-Stack\" class=\"headerlink\" title=\"Native Method Stack\"></a>Native Method Stack</h2><p>Native Method Stack<code>native</code>Execution<br><code>Engine</code></p>\n<h2 id=\"Program-Counter-Register-PC\"><a href=\"#Program-Counter-Register-PC\" class=\"headerlink\" title=\"Program Counter Register PC\"></a>Program Counter Register PC</h2><ul>\n<li><p>PC</p>\n</li>\n<li><p></p>\n</li>\n<li><p>JVM</p>\n</li>\n<li><p>javaJVMnativeundefined</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>JavaOOM</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/./jvm/0c1c2fd0-acb6-4197-801f-a9ff12f5ced4.png\"><br><img src=\"/./jvm/3d67796c-0dc7-4f12-9af0-39b20fab7cbf.png\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"PC\"><a href=\"#PC\" class=\"headerlink\" title=\"PC\"></a>PC</h4><p>CPU</p>\n<h4 id=\"PC\"><a href=\"#PC\" class=\"headerlink\" title=\"PC\"></a>PC</h4><p>JVMpc</p>\n<p><img src=\"/./jvm/5f12c1e3-2e47-4997-a887-b395b511490b.png\"></p>\n<h3 id=\"PC\"><a href=\"#PC\" class=\"headerlink\" title=\"PC?\"></a>PC?</h3><p>CPUpc</p>\n<p>cpu</p>\n<p></p>\n<h2 id=\"Method-Area-\"><a href=\"#Method-Area-\" class=\"headerlink\" title=\"Method Area \"></a>Method Area </h2><p><strong></strong>( Runtime Constant Pool)<strong></strong>(PermGen space) (Metaspace)</p>\n<p>jdk 1.7 jdk1.8 </p>\n<p>,</p>\n<p>    </p>\n<ul>\n<li></li>\n<li></li>\n<li>,,,</li>\n<li>,.:</li>\n</ul>\n<h2 id=\"Stackd-\"><a href=\"#Stackd-\" class=\"headerlink\" title=\"Stackd \"></a>Stackd </h2><p><strong></strong></p>\n<blockquote>\n<p>&#x3D; + </p>\n</blockquote>\n<blockquote>\n<p>&#x3D; +</p>\n</blockquote>\n<h3 id=\"-FIFO-\"><a href=\"#-FIFO-\" class=\"headerlink\" title=\" FIFO \"></a> FIFO </h3><p></p>\n<h3 id=\"-FILO-\"><a href=\"#-FILO-\" class=\"headerlink\" title=\"  FILO \"></a>  FILO </h3><p></p>\n<p>JavaOver<strong>8++</strong><br><strong></strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"?\"></a>?</h3><p>&#x3D;java </p>\n<p>3:</p>\n<ul>\n<li>(Local Variables) :;</li>\n<li>(Operand Stack) :;</li>\n<li>(Frame Data) :</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\":\"></a>:</h3><p>(Stack Frame) <br>(Method)<br>AF1 <br>AB F2<br>BCF3<br>F3F2F1..</p>\n<p>&#x2F;</p>\n<p><strong></strong><br><strong></strong><br><br>JVM256K ~756K1Mb</p>\n<p><img src=\"/./jvm/95c89389-d9e7-42e1-9d80-4886d458a48b.png\"></p>\n<p>:2,211212,</p>\n<p>(),</p>\n<h3 id=\"-SOF\"><a href=\"#-SOF\" class=\"headerlink\" title=\" SOF\"></a> SOF</h3><p><strong>Exception in thread main java.lang.StackOverflowError</strong>  </p>\n<p></p>\n<p><img src=\"/./jvm/90434413-5431-408e-878f-3b76d5118d64.png\"></p>\n<h3 id=\"--\"><a href=\"#--\" class=\"headerlink\" title=\"++\"></a>++</h3><p><img src=\"/./jvm/d404438c-1def-4366-90a5-3f304dd1ddf2.png\"></p>\n<p><strong>HotSpot:Java<code></code>reference</strong></p>\n<p><img src=\"/./jvm/5066a220-0f28-4b94-8934-f54c722697a9.png\"></p>\n<h2 id=\"Heap-\"><a href=\"#Heap-\" class=\"headerlink\" title=\"Heap \"></a>Heap </h2><p>JVM:</p>\n<ul>\n<li>Young Generation Space\t\t\tYoung&#x2F;New</li>\n<li>Tenure generation space\t\t\tOld&#x2F; Tenure</li>\n<li>Permanent Space\t\t\t\t  \t\tPerm</li>\n</ul>\n<h3 id=\"JAVA7-\"><a href=\"#JAVA7-\" class=\"headerlink\" title=\"JAVA7 \"></a>JAVA7 </h3><p><img src=\"/./jvm/bedb0d3f-90d8-4867-84c2-cea52a58412f.png\"></p>\n<h3 id=\"JAVA8-\"><a href=\"#JAVA8-\" class=\"headerlink\" title=\"JAVA8 \"></a>JAVA8 </h3><p></p>\n<p><strong><code></code><code></code>++</strong></p>\n<p><strong><code></code><code></code>+</strong></p>\n<p>()</p>\n<p></p>\n<blockquote>\n<p>:(Eden space) (Survivorpacee)new: 0 (Survivor 0 pace) 1(Survivor 1 space) JVM(MinorGC)0011?,Ma jorGC (Fu11GC) Ful1 GC00MQutOfMemoryError</p>\n</blockquote>\n<p>java.lang.OutOfMemoryError: Java heap spaceJava</p>\n<ol>\n<li>Java-Xms-Xmx </li>\n<li>(<br>)</li>\n</ol>\n<h2 id=\"GC\"><a href=\"#GC\" class=\"headerlink\" title=\"GC\"></a>GC</h2><p>JavaGC:( EdenFrom Survivor)To Survivor</p>\n<p><img src=\"/./jvm/bece6bf1-f9a8-475d-9911-6293e225d84e.png\"></p>\n<h3 id=\"MinorGC---\"><a href=\"#MinorGC---\" class=\"headerlink\" title=\"MinorGC(-&gt;-&gt;)\"></a>MinorGC(-&gt;-&gt;)</h3><ol>\n<li>Eden SurvivorFrom SurvivorTo+1Eden GC,SurvivorFrom EdenGCEdenFrom,,To()+1</li>\n<li>Eden SurvivorFromEdenSurvivorFrom to</li>\n<li>SurvivorTo SurvivorFromSurvivorToSurvivorFromSurvivorTo GCSurvivorFromFromTo15(JVMMaxTenuringThreshold15),,</li>\n</ol>\n<p><strong>HotSpot</strong></p>\n<p><img src=\"/./jvm/5fb46273-081b-4271-b94c-e2ba6eea5f69.png\"></p>\n<h3 id=\"-java7\"><a href=\"#-java7\" class=\"headerlink\" title=\"(java7)\"></a>(java7)</h3><p>JDKClass, Interface<strong>JVM</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>JAVA7</strong></p>\n<p><img src=\"/./jvm/8b2d9ee5-a0da-460c-9296-71cd9bae71cb.png\"></p>\n<p><strong>JAVA8</strong></p>\n<p>JDK 1.8</p>\n<p><img src=\"/./jvm/db1f5266-c920-4379-a82d-f0dadbe1a1c3.png\"></p>\n<p>Java8 </p>\n<p><strong>JVMjava8</strong></p>\n<p>native memory,javaMaxPermSize,</p>\n<h3 id=\"JVMJVM\"><a href=\"#JVMJVM\" class=\"headerlink\" title=\"JVMJVM\"></a>JVMJVM</h3><ul>\n<li><p>JVM<a href=\"https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html\">https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html</a></p>\n</li>\n<li><p>HotSpot</p>\n<blockquote>\n<p> - HotSpot</p>\n<p>-X HotSpot</p>\n<p>-XX </p>\n</blockquote>\n<p>java -version</p>\n<p>java -X</p>\n<p>java -XX:+PrintFlagsWithComments &#x2F;&#x2F;debug</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-Xms</td>\n<td>1&#x2F;64</td>\n</tr>\n<tr>\n<td align=\"center\">-Xmx</td>\n<td>1&#x2F;4</td>\n</tr>\n<tr>\n<td align=\"center\">-XX:+PrintGCDetails</td>\n<td>GC</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T1</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">availableProcessors</span> <span class=\"operator\">=</span> Runtime.getRuntime().availableProcessors();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span> + availableProcessors);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//&quot;1/4&quot;</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">maxMemory</span> <span class=\"operator\">=</span> Runtime.getRuntime().maxMemory();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;-Xmx (MAX_MEMORY) = &quot;</span> + maxMemory + <span class=\"string\">&quot;&quot;</span> + maxMemory / <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;M&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//&quot;1/64&quot;</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">totalMemory</span> <span class=\"operator\">=</span> Runtime.getRuntime().totalMemory();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;-Xms (TOTAL_MEMORY) = &quot;</span> + totalMemory + <span class=\"string\">&quot;&quot;</span> + totalMemory / <span class=\"number\">1024</span> / <span class=\"number\">1024</span> + <span class=\"string\">&quot;M&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/./jvm/4f6873cb-c0f9-4955-8600-bf37e24f4fbf.png\"></p>\n<p>JVM</p>\n<p><img src=\"/./jvm/f0d5cf63-e51f-4309-b8ff-448f90ca78fb.png\"></p>\n<p>JAVA8</p>\n<p><img src=\"/./jvm/d215e636-ea46-4b84-a861-4aff3dbdbf0e.png\"></p>\n<p>JAVA7</p>\n<p><img src=\"/./jvm/befee5fe-233e-4ca1-8a63-1b8908311845.png\"></p>\n<h3 id=\"-OOM\"><a href=\"#-OOM\" class=\"headerlink\" title=\" OOM\"></a> OOM</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;Mr.Wang&quot;</span>;</span><br><span class=\"line\">            str += <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>().nextInt(<span class=\"number\">88888888</span>) + <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>().nextInt(<span class=\"number\">99999999</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><img src=\"/./jvm/787d871b-0d4c-403a-ae3f-cbc6ea587dc1.png\"></p>\n<p><img src=\"/./jvm/d5649d47-ed1b-4797-8a8f-73634873cd9d.png\"></p>\n<p><strong>Exception: java.lang.OutOfMemoryError</strong> </p>\n<p><img src=\"/./jvm/9111c342-79fb-4def-aef6-d266daea6078.png\"></p>\n<h3 id=\"GC-\"><a href=\"#GC-\" class=\"headerlink\" title=\"GC \"></a>GC </h3><p><img src=\"/./jvm/d9b58c91-421c-4afe-b359-2cde68c12eca.png\"></p>\n<p><img src=\"/./jvm/3e60331e-2742-4047-8383-e107945f85c4.png\"></p>\n<p><img src=\"/./jvm/3bfa032a-2a4e-4f01-b03d-90c4c39df0aa.png\"></p>\n<p>JVMGC <strong></strong>GCGC (minor GC)GC (major GC or FullGC)</p>\n<p><strong>Minor GC Full GC</strong></p>\n<ul>\n<li><p>GC (minor GC) :GC,JavaMinor GC </p>\n</li>\n<li><p>GC (major GC or Full GC) :Major GC,Minor GC () <strong>Major GC Minor GC10,2&#x2F;31&#x2F;3</strong></p>\n</li>\n</ul>\n"},{"title":"KotlinSpringBootJackson","date":"2023-06-05T02:00:00.000Z","cover":"/post/2023/kotlin-springboot/kotlin.png","_content":"\n## \n\nkotlinSpringBootKotlin,JacksonJSON\n```\n(No Creators, like default construct, exist): cannot deserialize from Object value (no delegate- or property-based Creator\n```\n\n## \nJacksonkotlinjacksonkotlin-module\n## \n[jackson-module-kotlin](https://mvnrepository.com/artifact/com.fasterxml.jackson.module/jackson-module-kotlin)\n#### gradle(kotlin)\n```kotlin\nimplementation(\"com.fasterxml.jackson.module:jackson-module-kotlin:last-version\")\n```\n#### gradle(groovy)\n```groovy\nimplementation group: 'com.fasterxml.jackson.module', name: 'jackson-module-kotlin', version: 'last-version'\n```\n\n#### maven\n```xml\n<dependency>\n    <groupId>com.fasterxml.jackson.module</groupId>\n    <artifactId>jackson-module-kotlin</artifactId>\n    <version>last-version</version>\n</dependency>\n```\n\n## \n```kotlin\n@Configuration\nclass AppConfig {\n    \n    @Bean\n    fun customJackson2HttpMessageConverter(): MappingJackson2HttpMessageConverter {\n        val jsonConverter = MappingJackson2HttpMessageConverter()\n        val objectMapper = ObjectMapper()\n      \n        //kotlinModule,\n        objectMapper.registerModule(kotlinModule())\n      \n        jsonConverter.objectMapper = objectMapper\n        return jsonConverter\n    }\n}\n```\n\n\n\n\n\n","source":"_posts/2023/kotlin-springboot.md","raw":"---\ntitle: KotlinSpringBootJackson\ndate: 2023-06-05 10:00:00\ncategories:\n  - SpringBoot\n\ncover: /post/2023/kotlin-springboot/kotlin.png\n---\n\n## \n\nkotlinSpringBootKotlin,JacksonJSON\n```\n(No Creators, like default construct, exist): cannot deserialize from Object value (no delegate- or property-based Creator\n```\n\n## \nJacksonkotlinjacksonkotlin-module\n## \n[jackson-module-kotlin](https://mvnrepository.com/artifact/com.fasterxml.jackson.module/jackson-module-kotlin)\n#### gradle(kotlin)\n```kotlin\nimplementation(\"com.fasterxml.jackson.module:jackson-module-kotlin:last-version\")\n```\n#### gradle(groovy)\n```groovy\nimplementation group: 'com.fasterxml.jackson.module', name: 'jackson-module-kotlin', version: 'last-version'\n```\n\n#### maven\n```xml\n<dependency>\n    <groupId>com.fasterxml.jackson.module</groupId>\n    <artifactId>jackson-module-kotlin</artifactId>\n    <version>last-version</version>\n</dependency>\n```\n\n## \n```kotlin\n@Configuration\nclass AppConfig {\n    \n    @Bean\n    fun customJackson2HttpMessageConverter(): MappingJackson2HttpMessageConverter {\n        val jsonConverter = MappingJackson2HttpMessageConverter()\n        val objectMapper = ObjectMapper()\n      \n        //kotlinModule,\n        objectMapper.registerModule(kotlinModule())\n      \n        jsonConverter.objectMapper = objectMapper\n        return jsonConverter\n    }\n}\n```\n\n\n\n\n\n","slug":"2023/kotlin-springboot","published":1,"updated":"2024-08-05T12:27:55.738Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiv7000ovaibhi7c7wk3","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>kotlinSpringBootKotlin,JacksonJSON</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(No Creators, like default construct, exist): cannot deserialize from Object value (no delegate- or property-based Creator</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Jacksonkotlinjacksonkotlin-module</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"https://mvnrepository.com/artifact/com.fasterxml.jackson.module/jackson-module-kotlin\">jackson-module-kotlin</a></p>\n<h4 id=\"gradle-kotlin\"><a href=\"#gradle-kotlin\" class=\"headerlink\" title=\"gradle(kotlin)\"></a>gradle(kotlin)</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">implementation(<span class=\"string\">&quot;com.fasterxml.jackson.module:jackson-module-kotlin:last-version&quot;</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"gradle-groovy\"><a href=\"#gradle-groovy\" class=\"headerlink\" title=\"gradle(groovy)\"></a>gradle(groovy)</h4><figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">implementation <span class=\"attr\">group:</span> <span class=\"string\">&#x27;com.fasterxml.jackson.module&#x27;</span>, <span class=\"attr\">name:</span> <span class=\"string\">&#x27;jackson-module-kotlin&#x27;</span>, <span class=\"attr\">version:</span> <span class=\"string\">&#x27;last-version&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"maven\"><a href=\"#maven\" class=\"headerlink\" title=\"maven\"></a>maven</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.fasterxml.jackson.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jackson-module-kotlin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>last-version<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">AppConfig</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">customJackson2HttpMessageConverter</span><span class=\"params\">()</span></span>: MappingJackson2HttpMessageConverter &#123;</span><br><span class=\"line\">        <span class=\"keyword\">val</span> jsonConverter = MappingJackson2HttpMessageConverter()</span><br><span class=\"line\">        <span class=\"keyword\">val</span> objectMapper = ObjectMapper()</span><br><span class=\"line\">      </span><br><span class=\"line\">        <span class=\"comment\">//kotlinModule,</span></span><br><span class=\"line\">        objectMapper.registerModule(kotlinModule())</span><br><span class=\"line\">      </span><br><span class=\"line\">        jsonConverter.objectMapper = objectMapper</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jsonConverter</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n","cover_type":"img","excerpt":"","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>kotlinSpringBootKotlin,JacksonJSON</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(No Creators, like default construct, exist): cannot deserialize from Object value (no delegate- or property-based Creator</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Jacksonkotlinjacksonkotlin-module</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"https://mvnrepository.com/artifact/com.fasterxml.jackson.module/jackson-module-kotlin\">jackson-module-kotlin</a></p>\n<h4 id=\"gradle-kotlin\"><a href=\"#gradle-kotlin\" class=\"headerlink\" title=\"gradle(kotlin)\"></a>gradle(kotlin)</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">implementation(<span class=\"string\">&quot;com.fasterxml.jackson.module:jackson-module-kotlin:last-version&quot;</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"gradle-groovy\"><a href=\"#gradle-groovy\" class=\"headerlink\" title=\"gradle(groovy)\"></a>gradle(groovy)</h4><figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">implementation <span class=\"attr\">group:</span> <span class=\"string\">&#x27;com.fasterxml.jackson.module&#x27;</span>, <span class=\"attr\">name:</span> <span class=\"string\">&#x27;jackson-module-kotlin&#x27;</span>, <span class=\"attr\">version:</span> <span class=\"string\">&#x27;last-version&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"maven\"><a href=\"#maven\" class=\"headerlink\" title=\"maven\"></a>maven</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.fasterxml.jackson.module<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jackson-module-kotlin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>last-version<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">AppConfig</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">customJackson2HttpMessageConverter</span><span class=\"params\">()</span></span>: MappingJackson2HttpMessageConverter &#123;</span><br><span class=\"line\">        <span class=\"keyword\">val</span> jsonConverter = MappingJackson2HttpMessageConverter()</span><br><span class=\"line\">        <span class=\"keyword\">val</span> objectMapper = ObjectMapper()</span><br><span class=\"line\">      </span><br><span class=\"line\">        <span class=\"comment\">//kotlinModule,</span></span><br><span class=\"line\">        objectMapper.registerModule(kotlinModule())</span><br><span class=\"line\">      </span><br><span class=\"line\">        jsonConverter.objectMapper = objectMapper</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jsonConverter</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n"},{"title":"SpringBootDateLocalDateLocalDateTime","date":"2023-06-05T02:00:00.000Z","cover":"/post/2023/localdate-springboot/kotlin.jpg","_content":"\n## \n\nSpringBootLocalDate\n\n## 1:( Jackson  @JsonFormat ) \n### java\n```java\n@Data\npublic class Obj {\n    @JsonFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\n    private LocalDateTime time;\n}\n```\n### kotlin\n```kotlin\n@Data\n class Obj (\n        @JsonFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\n        var  time:LocalDateTime,\n )\n```\n## 2:(@JsonSerialize@JsonDeserialize ) \n@JsonSerialize@JsonDeserialize \n### java\n```java\npublic class MyLocalDateTimeSerializer extends com.fasterxml.jackson.datatype.jsr310.ser.LocalDateTimeSerializer {\n    public MyLocalDateTimeSerializer() {\n        super(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\"));\n    }\n}\n\npublic class MyLocalDateTimeDeserializer extends com.fasterxml.jackson.datatype.jsr310.deser.LocalDateTimeDeserializer {\n    public MyLocalDateTimeDeserializer() {\n        super(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\"));\n    }\n}\n\n@Data\npublic class Obj {\n    @JsonSerialize(using = MyLocalDateTimeSerializer.class)\n    @JsonDeserialize(using = MyLocalDateTimeDeserializer.class)\n    private LocalDateTime time;\n}\n```\n### kotlin\n```kotlin\nclass MyLocalDateTimeSerializer : LocalDateTimeSerializer(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\"))\n\nclass MyLocalDateTimeDeserializer : LocalDateTimeDeserializer(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\"))\n\nclass Obj (\n        @JsonSerialize(using = MyLocalDateTimeSerializer::class)\n        @JsonDeserialize(using = MyLocalDateTimeDeserializer::class)\n      val time: LocalDateTime? = null\n)\n```\n\n\n\n## 3:( JacksonJavaTimeModule ) \n jackson-datatype-jsr310  ObjectMapper\n### \n[com.fasterxml.jackson.datatype:jackson-datatype-jsr310](https://mvnrepository.com/artifact/com.fasterxml.jackson.datatype/jackson-datatype-jsr310)\n#### gradle(kotlin)\n```kotlin\nimplementation(\"com.fasterxml.jackson.datatype:jackson-datatype-jsr310:last-version\")\n```\n#### gradle(groovy)\n```groovy\nimplementation group: 'com.fasterxml.jackson.datatype', name: 'jackson-datatype-jsr310', version: 'last-version'\n```\n\n#### maven\n```xml\n<dependency>\n    <groupId>com.fasterxml.jackson.datatype</groupId>\n    <artifactId>jackson-datatype-jsr310</artifactId>\n    <version>last-version</version>\n</dependency>\n```\n### java\n```java\n@Configuration\npublic class AppConfig {\n    \n    @Bean\n    public MappingJackson2HttpMessageConverter customJackson2HttpMessageConverter() {\n        MappingJackson2HttpMessageConverter jsonConverter = new MappingJackson2HttpMessageConverter();\n        ObjectMapper objectMapper = ObjectMapper();\n\n        //JavaTimeModuleLocalDateLocalDateTime\n        objectMapper.registerModule(new JavaTimeModule());\n      \n        jsonConverter.objectMapper = objectMapper;\n        return jsonConverter;\n    }\n}\n```      \n\n### kotlin\n```kotlin\n@Configuration\nclass AppConfig {\n    \n    @Bean\n    fun customJackson2HttpMessageConverter(): MappingJackson2HttpMessageConverter {\n        val jsonConverter = MappingJackson2HttpMessageConverter()\n        val objectMapper = ObjectMapper()\n\n        //JavaTimeModuleLocalDateLocalDateTime\n        objectMapper.registerModule(JavaTimeModule())\n      \n        jsonConverter.objectMapper = objectMapper\n        return jsonConverter\n    }\n}\n```\n\n\n\n\n\n\n","source":"_posts/2023/localdate-springboot.md","raw":"---\ntitle: SpringBootDateLocalDateLocalDateTime\ndate: 2023-06-05 10:00:00\ncategories:\n  - SpringBoot\ncover: /post/2023/localdate-springboot/kotlin.jpg\n---\n\n## \n\nSpringBootLocalDate\n\n## 1:( Jackson  @JsonFormat ) \n### java\n```java\n@Data\npublic class Obj {\n    @JsonFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\n    private LocalDateTime time;\n}\n```\n### kotlin\n```kotlin\n@Data\n class Obj (\n        @JsonFormat(pattern = \"yyyy-MM-dd HH:mm:ss\")\n        var  time:LocalDateTime,\n )\n```\n## 2:(@JsonSerialize@JsonDeserialize ) \n@JsonSerialize@JsonDeserialize \n### java\n```java\npublic class MyLocalDateTimeSerializer extends com.fasterxml.jackson.datatype.jsr310.ser.LocalDateTimeSerializer {\n    public MyLocalDateTimeSerializer() {\n        super(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\"));\n    }\n}\n\npublic class MyLocalDateTimeDeserializer extends com.fasterxml.jackson.datatype.jsr310.deser.LocalDateTimeDeserializer {\n    public MyLocalDateTimeDeserializer() {\n        super(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\"));\n    }\n}\n\n@Data\npublic class Obj {\n    @JsonSerialize(using = MyLocalDateTimeSerializer.class)\n    @JsonDeserialize(using = MyLocalDateTimeDeserializer.class)\n    private LocalDateTime time;\n}\n```\n### kotlin\n```kotlin\nclass MyLocalDateTimeSerializer : LocalDateTimeSerializer(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\"))\n\nclass MyLocalDateTimeDeserializer : LocalDateTimeDeserializer(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\"))\n\nclass Obj (\n        @JsonSerialize(using = MyLocalDateTimeSerializer::class)\n        @JsonDeserialize(using = MyLocalDateTimeDeserializer::class)\n      val time: LocalDateTime? = null\n)\n```\n\n\n\n## 3:( JacksonJavaTimeModule ) \n jackson-datatype-jsr310  ObjectMapper\n### \n[com.fasterxml.jackson.datatype:jackson-datatype-jsr310](https://mvnrepository.com/artifact/com.fasterxml.jackson.datatype/jackson-datatype-jsr310)\n#### gradle(kotlin)\n```kotlin\nimplementation(\"com.fasterxml.jackson.datatype:jackson-datatype-jsr310:last-version\")\n```\n#### gradle(groovy)\n```groovy\nimplementation group: 'com.fasterxml.jackson.datatype', name: 'jackson-datatype-jsr310', version: 'last-version'\n```\n\n#### maven\n```xml\n<dependency>\n    <groupId>com.fasterxml.jackson.datatype</groupId>\n    <artifactId>jackson-datatype-jsr310</artifactId>\n    <version>last-version</version>\n</dependency>\n```\n### java\n```java\n@Configuration\npublic class AppConfig {\n    \n    @Bean\n    public MappingJackson2HttpMessageConverter customJackson2HttpMessageConverter() {\n        MappingJackson2HttpMessageConverter jsonConverter = new MappingJackson2HttpMessageConverter();\n        ObjectMapper objectMapper = ObjectMapper();\n\n        //JavaTimeModuleLocalDateLocalDateTime\n        objectMapper.registerModule(new JavaTimeModule());\n      \n        jsonConverter.objectMapper = objectMapper;\n        return jsonConverter;\n    }\n}\n```      \n\n### kotlin\n```kotlin\n@Configuration\nclass AppConfig {\n    \n    @Bean\n    fun customJackson2HttpMessageConverter(): MappingJackson2HttpMessageConverter {\n        val jsonConverter = MappingJackson2HttpMessageConverter()\n        val objectMapper = ObjectMapper()\n\n        //JavaTimeModuleLocalDateLocalDateTime\n        objectMapper.registerModule(JavaTimeModule())\n      \n        jsonConverter.objectMapper = objectMapper\n        return jsonConverter\n    }\n}\n```\n\n\n\n\n\n\n","slug":"2023/localdate-springboot","published":1,"updated":"2024-08-05T12:27:55.731Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaiv9000qvaib7dpxeqgc","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SpringBootLocalDate</p>\n<h2 id=\"1--Jackson--JsonFormat--\"><a href=\"#1--Jackson--JsonFormat--\" class=\"headerlink\" title=\"1:( Jackson  @JsonFormat ) \"></a>1:( Jackson  @JsonFormat ) </h2><h3 id=\"java\"><a href=\"#java\" class=\"headerlink\" title=\"java\"></a>java</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Obj</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> LocalDateTime time;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"kotlin\"><a href=\"#kotlin\" class=\"headerlink\" title=\"kotlin\"></a>kotlin</h3><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"> <span class=\"keyword\">class</span> <span class=\"title class_\">Obj</span> (</span><br><span class=\"line\">        <span class=\"meta\">@JsonFormat(pattern = <span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>)</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span>  time:LocalDateTime,</span><br><span class=\"line\"> )</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-JsonSerialize-JsonDeserialize--\"><a href=\"#2-JsonSerialize-JsonDeserialize--\" class=\"headerlink\" title=\"2:(@JsonSerialize@JsonDeserialize ) \"></a>2:(@JsonSerialize@JsonDeserialize ) </h2><p>@JsonSerialize@JsonDeserialize </p>\n<h3 id=\"java-1\"><a href=\"#java-1\" class=\"headerlink\" title=\"java\"></a>java</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyLocalDateTimeSerializer</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">com</span>.fasterxml.jackson.datatype.jsr310.ser.LocalDateTimeSerializer &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyLocalDateTimeSerializer</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyLocalDateTimeDeserializer</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">com</span>.fasterxml.jackson.datatype.jsr310.deser.LocalDateTimeDeserializer &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyLocalDateTimeDeserializer</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Obj</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@JsonSerialize(using = MyLocalDateTimeSerializer.class)</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonDeserialize(using = MyLocalDateTimeDeserializer.class)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> LocalDateTime time;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"kotlin-1\"><a href=\"#kotlin-1\" class=\"headerlink\" title=\"kotlin\"></a>kotlin</h3><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyLocalDateTimeSerializer</span> : <span class=\"type\">LocalDateTimeSerializer</span>(DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyLocalDateTimeDeserializer</span> : <span class=\"type\">LocalDateTimeDeserializer</span>(DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Obj</span> (</span><br><span class=\"line\">        <span class=\"meta\">@JsonSerialize(using = MyLocalDateTimeSerializer::class)</span></span><br><span class=\"line\">        <span class=\"meta\">@JsonDeserialize(using = MyLocalDateTimeDeserializer::class)</span></span><br><span class=\"line\">      <span class=\"keyword\">val</span> time: LocalDateTime? = <span class=\"literal\">null</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"3--JacksonJavaTimeModule-\"><a href=\"#3--JacksonJavaTimeModule-\" class=\"headerlink\" title=\"3:( JacksonJavaTimeModule ) \"></a>3:( JacksonJavaTimeModule ) </h2><p> jackson-datatype-jsr310  ObjectMapper</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://mvnrepository.com/artifact/com.fasterxml.jackson.datatype/jackson-datatype-jsr310\">com.fasterxml.jackson.datatype:jackson-datatype-jsr310</a></p>\n<h4 id=\"gradle-kotlin\"><a href=\"#gradle-kotlin\" class=\"headerlink\" title=\"gradle(kotlin)\"></a>gradle(kotlin)</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">implementation(<span class=\"string\">&quot;com.fasterxml.jackson.datatype:jackson-datatype-jsr310:last-version&quot;</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"gradle-groovy\"><a href=\"#gradle-groovy\" class=\"headerlink\" title=\"gradle(groovy)\"></a>gradle(groovy)</h4><figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">implementation <span class=\"attr\">group:</span> <span class=\"string\">&#x27;com.fasterxml.jackson.datatype&#x27;</span>, <span class=\"attr\">name:</span> <span class=\"string\">&#x27;jackson-datatype-jsr310&#x27;</span>, <span class=\"attr\">version:</span> <span class=\"string\">&#x27;last-version&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"maven\"><a href=\"#maven\" class=\"headerlink\" title=\"maven\"></a>maven</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.fasterxml.jackson.datatype<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jackson-datatype-jsr310<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>last-version<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"java-2\"><a href=\"#java-2\" class=\"headerlink\" title=\"java\"></a>java</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">AppConfig</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> MappingJackson2HttpMessageConverter <span class=\"title function_\">customJackson2HttpMessageConverter</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">MappingJackson2HttpMessageConverter</span> <span class=\"variable\">jsonConverter</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MappingJackson2HttpMessageConverter</span>();</span><br><span class=\"line\">        <span class=\"type\">ObjectMapper</span> <span class=\"variable\">objectMapper</span> <span class=\"operator\">=</span> ObjectMapper();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//JavaTimeModuleLocalDateLocalDateTime</span></span><br><span class=\"line\">        objectMapper.registerModule(<span class=\"keyword\">new</span> <span class=\"title class_\">JavaTimeModule</span>());</span><br><span class=\"line\">      </span><br><span class=\"line\">        jsonConverter.objectMapper = objectMapper;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jsonConverter;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">```      </span><br><span class=\"line\"></span><br><span class=\"line\">### kotlin</span><br><span class=\"line\">```kotlin</span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">AppConfig</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    fun <span class=\"title function_\">customJackson2HttpMessageConverter</span><span class=\"params\">()</span>: MappingJackson2HttpMessageConverter &#123;</span><br><span class=\"line\">        <span class=\"type\">val</span> <span class=\"variable\">jsonConverter</span> <span class=\"operator\">=</span> MappingJackson2HttpMessageConverter()</span><br><span class=\"line\">        <span class=\"type\">val</span> <span class=\"variable\">objectMapper</span> <span class=\"operator\">=</span> ObjectMapper()</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//JavaTimeModuleLocalDateLocalDateTime</span></span><br><span class=\"line\">        objectMapper.registerModule(JavaTimeModule())</span><br><span class=\"line\">      </span><br><span class=\"line\">        jsonConverter.objectMapper = objectMapper</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jsonConverter</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n","cover_type":"img","excerpt":"","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SpringBootLocalDate</p>\n<h2 id=\"1--Jackson--JsonFormat--\"><a href=\"#1--Jackson--JsonFormat--\" class=\"headerlink\" title=\"1:( Jackson  @JsonFormat ) \"></a>1:( Jackson  @JsonFormat ) </h2><h3 id=\"java\"><a href=\"#java\" class=\"headerlink\" title=\"java\"></a>java</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Obj</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> LocalDateTime time;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"kotlin\"><a href=\"#kotlin\" class=\"headerlink\" title=\"kotlin\"></a>kotlin</h3><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"> <span class=\"keyword\">class</span> <span class=\"title class_\">Obj</span> (</span><br><span class=\"line\">        <span class=\"meta\">@JsonFormat(pattern = <span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>)</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span>  time:LocalDateTime,</span><br><span class=\"line\"> )</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-JsonSerialize-JsonDeserialize--\"><a href=\"#2-JsonSerialize-JsonDeserialize--\" class=\"headerlink\" title=\"2:(@JsonSerialize@JsonDeserialize ) \"></a>2:(@JsonSerialize@JsonDeserialize ) </h2><p>@JsonSerialize@JsonDeserialize </p>\n<h3 id=\"java-1\"><a href=\"#java-1\" class=\"headerlink\" title=\"java\"></a>java</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyLocalDateTimeSerializer</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">com</span>.fasterxml.jackson.datatype.jsr310.ser.LocalDateTimeSerializer &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyLocalDateTimeSerializer</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyLocalDateTimeDeserializer</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">com</span>.fasterxml.jackson.datatype.jsr310.deser.LocalDateTimeDeserializer &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyLocalDateTimeDeserializer</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Obj</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@JsonSerialize(using = MyLocalDateTimeSerializer.class)</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonDeserialize(using = MyLocalDateTimeDeserializer.class)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> LocalDateTime time;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"kotlin-1\"><a href=\"#kotlin-1\" class=\"headerlink\" title=\"kotlin\"></a>kotlin</h3><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyLocalDateTimeSerializer</span> : <span class=\"type\">LocalDateTimeSerializer</span>(DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyLocalDateTimeDeserializer</span> : <span class=\"type\">LocalDateTimeDeserializer</span>(DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Obj</span> (</span><br><span class=\"line\">        <span class=\"meta\">@JsonSerialize(using = MyLocalDateTimeSerializer::class)</span></span><br><span class=\"line\">        <span class=\"meta\">@JsonDeserialize(using = MyLocalDateTimeDeserializer::class)</span></span><br><span class=\"line\">      <span class=\"keyword\">val</span> time: LocalDateTime? = <span class=\"literal\">null</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"3--JacksonJavaTimeModule-\"><a href=\"#3--JacksonJavaTimeModule-\" class=\"headerlink\" title=\"3:( JacksonJavaTimeModule ) \"></a>3:( JacksonJavaTimeModule ) </h2><p> jackson-datatype-jsr310  ObjectMapper</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://mvnrepository.com/artifact/com.fasterxml.jackson.datatype/jackson-datatype-jsr310\">com.fasterxml.jackson.datatype:jackson-datatype-jsr310</a></p>\n<h4 id=\"gradle-kotlin\"><a href=\"#gradle-kotlin\" class=\"headerlink\" title=\"gradle(kotlin)\"></a>gradle(kotlin)</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">implementation(<span class=\"string\">&quot;com.fasterxml.jackson.datatype:jackson-datatype-jsr310:last-version&quot;</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"gradle-groovy\"><a href=\"#gradle-groovy\" class=\"headerlink\" title=\"gradle(groovy)\"></a>gradle(groovy)</h4><figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">implementation <span class=\"attr\">group:</span> <span class=\"string\">&#x27;com.fasterxml.jackson.datatype&#x27;</span>, <span class=\"attr\">name:</span> <span class=\"string\">&#x27;jackson-datatype-jsr310&#x27;</span>, <span class=\"attr\">version:</span> <span class=\"string\">&#x27;last-version&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"maven\"><a href=\"#maven\" class=\"headerlink\" title=\"maven\"></a>maven</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.fasterxml.jackson.datatype<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jackson-datatype-jsr310<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>last-version<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"java-2\"><a href=\"#java-2\" class=\"headerlink\" title=\"java\"></a>java</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">AppConfig</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> MappingJackson2HttpMessageConverter <span class=\"title function_\">customJackson2HttpMessageConverter</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">MappingJackson2HttpMessageConverter</span> <span class=\"variable\">jsonConverter</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MappingJackson2HttpMessageConverter</span>();</span><br><span class=\"line\">        <span class=\"type\">ObjectMapper</span> <span class=\"variable\">objectMapper</span> <span class=\"operator\">=</span> ObjectMapper();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//JavaTimeModuleLocalDateLocalDateTime</span></span><br><span class=\"line\">        objectMapper.registerModule(<span class=\"keyword\">new</span> <span class=\"title class_\">JavaTimeModule</span>());</span><br><span class=\"line\">      </span><br><span class=\"line\">        jsonConverter.objectMapper = objectMapper;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jsonConverter;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">```      </span><br><span class=\"line\"></span><br><span class=\"line\">### kotlin</span><br><span class=\"line\">```kotlin</span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">AppConfig</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    fun <span class=\"title function_\">customJackson2HttpMessageConverter</span><span class=\"params\">()</span>: MappingJackson2HttpMessageConverter &#123;</span><br><span class=\"line\">        <span class=\"type\">val</span> <span class=\"variable\">jsonConverter</span> <span class=\"operator\">=</span> MappingJackson2HttpMessageConverter()</span><br><span class=\"line\">        <span class=\"type\">val</span> <span class=\"variable\">objectMapper</span> <span class=\"operator\">=</span> ObjectMapper()</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//JavaTimeModuleLocalDateLocalDateTime</span></span><br><span class=\"line\">        objectMapper.registerModule(JavaTimeModule())</span><br><span class=\"line\">      </span><br><span class=\"line\">        jsonConverter.objectMapper = objectMapper</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jsonConverter</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n"},{"title":"SSHShell","date":"2024-08-05T12:00:00.000Z","cover":"/post/2024/jsch/jsch/ssh.webp","_content":"\n![img.png](img.png)","source":"_posts/2024/jsch/jsch.md","raw":"---\ntitle: SSHShell\ndate: 2024-08-05 20:00:00\ntags:\n- ssh\n- java\ncategories:\n- JAVA\n\ncover: /post/2024/jsch/jsch/ssh.webp\n---\n\n![img.png](img.png)","slug":"2024/jsch/jsch","published":1,"updated":"2024-08-05T12:34:21.624Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaivg001gvaibgxk4hryj","content":"<p><img src=\"/img.png\" alt=\"img.png\"></p>\n","cover_type":"img","excerpt":"","more":"<p><img src=\"/img.png\" alt=\"img.png\"></p>\n"},{"title":"","date":"2023-03-20T16:00:00.000Z","_content":"\n\n# \n## 1\n>new Thread(() -> {...})********newThreadfornew1000Thread\n## 2\n>****NN\n# \n## 1\n  \n\n>ABC \n## 2\n### 2.1\n``` java\npublic ThreadPoolExecutor(int corePoolSize,\n    int maximumPoolSize,\n    long keepAliveTime,\n    TimeUnit unit,\n    BlockingQueue<Runnable> workQueue,\n    ThreadFactory threadFactory,\n    RejectedExecutionHandler handler) {}\n```\n### 2.2\n- **corePoolSize**  \n\n   \n  \n- **maximumPoolSize**  \n\n   **maximumPoolSize**\n\n- **keepAliveTime**\n\n  **corePoolSize****keepAliveTime**\n\n- **unit**\n\n  TimeUnit.MILLISECONDSTimeUnit.SECONDS\n\n- **workQueue**\n  \n  workQueue  \n  \n  workQueue\n  -  **LinkedBlockingQueue**int\n  - **ArrayBlockingQueue**maximumPoolSize\n  - **SynchronousQueue****Executors.newCachedThreadPool()**;\n\n  **LinkedBlockingQueue****ArrayBlockingQueue**\n\n- **threadFactory****threadFactory**\n\n  **DefaultThreadFactory**newThread()\n  \n- **handler**shutdownhandler\n\n  **AbortPolicy****RejectedExecutionException**\n  \n## 3\n### 3.1\n\n- 0\n\n- \n\n- corePoolSize\n\n- corePoolSizeworkQueue\n\n- maximumPoolSize\n\n- maximumPoolSize\n### 3.2\n\n![](./thread-pool/e0733727-92bd-4438-a628-3b3989d8e838.png)\n### 3.3\n\n510100\n\n659999991100510RUNNING1001\n\n### 3.4\n``` java\npublic void execute(Runnable command) {\n    int c = ctl.get();\n    // workerCountOf(c)\n    // workerworker\n    if (workerCountOf(c) < corePoolSize) {\n        // addWorker\n        if (addWorker(command, true))\n            return;\n        c = ctl.get();\n    }\n    // worker\n    if (isRunning(c) && workQueue.offer(command)) {\n        int recheck = ctl.get();\n        // RUNNINGshutdownreject()\n        // recheck\n        if (! isRunning(recheck) && remove(command))\n            reject(command);\n        // 00\n        else if (workerCountOf(recheck) == 0)\n            addWorker(null, false);\n    }\n    // worker\n    // 3\n    // 1. addWorker\n    // 2. addWorker2\n    // 3. addWorkerfalsereject\n    else if (!addWorker(command, false))\n        reject(command);\n}\n```\n## 4Executors\n### 4.1\n\n\n\nExecutorsExecutors\n\n### 4.2\n#### 4.2.1\n\n\n0ms**LinkedBlockingQueue****DefaultThreadFactory****AbortPolicy**\n\n#### 4.2.2api\n\n**Executors.newFixedThreadPool(n);**\n\n#### 4.2.3demo\n\n``` java\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\n/**\n * Description: 210\n */\npublic class ThreadPoolTest {\n    public static void main(String[] args) {\n        ExecutorService executorService = Executors.newFixedThreadPool(2);\n        for (int i = 0; i < 10; i++) {\n            // name\n            executorService.execute(() -> System.out.println(Thread.currentThread().getName()));\n        }\n    }\n}\n```\n####  4.2.4\n\n****intOOMjvmRedis\n\n#### 4.2.5\n``` java\npublic static ExecutorService newFixedThreadPool(int nThreads) {\n    return new ThreadPoolExecutor(\n                // nThreads\n                nThreads, nThreads,\n                                  0L, TimeUnit.MILLISECONDS,\n                                  // \n                                  new LinkedBlockingQueue<Runnable>());\n}\n```\n### 4.3\n#### 4.3.1\n1\n\n**Executors.newFixedThreadPool(1)**;\n\n0ms**LinkedBlockingQueue****DefaultThreadFactory****AbortPolicy**\n#### 4.3.2api\n\n**Executors.newSingleThreadExecutor();**\n\n#### 4.3.3demo\n``` java\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\n/**\n * Description: 110\n */\npublic class ThreadPoolTest {\n    public static void main(String[] args) {\n        ExecutorService executorService = Executors.newSingleThreadExecutor();\n        for (int i = 0; i < 10; i++) {\n            // namepool-1-thread-1\n            executorService.execute(() -> System.out.println(Thread.currentThread().getName()));\n        }\n    }\n}\n```\n#### 4.3.4\n4.2\n#### 4.3.5\n``` java \n\npublic static ExecutorService newSingleThreadExecutor() {\n    return new FinalizableDelegatedExecutorService\n        (new ThreadPoolExecutor(\n        // 1\n                 1, 1,\n                                0L, TimeUnit.MILLISECONDS,\n                 // \n                                new LinkedBlockingQueue<Runnable>()));\n}\n```\n\n### 4.4\n#### 4.4.1\n**SynchronousQueue****keepAliveTime**60S60S\n\n0int\n\n1min60s**SynchronousQueue****DefaultThreadFactory****AbortPolicy**\n\n#### 4.4.2api\n**Executors.newCachedThreadPool();**\n#### 4.4.3demo\n``` java\n\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\n/**\n * Description: 10\n *\n * @author TongWei.Chen 2020-07-09 21:28:34\n */\npublic class ThreadPoolTest {\n    public static void main(String[] args) {\n        ExecutorService executorService = Executors.newCachedThreadPool();\n        for (int i = 0; i < 10; i++) {\n            // name10\n            executorService.execute(() -> System.out.println(Thread.currentThread().getName()));\n        }\n    }\n}\n```\n#### 4.4.4\nint**SynchronousQueue**\n\n#### 4.4.5\n``` java\n\npublic static ExecutorService newCachedThreadPool() {\n    return new ThreadPoolExecutor(\n                // 0Integer.MAX_VALUE\n                0, Integer.MAX_VALUE,\n                                  60L, TimeUnit.SECONDS,\n                                  new SynchronousQueue<Runnable>());\n}\n````\n\n\n###  4.5\n#### 4.5.1\nRocketMQ\n\nInteger.MAX_VALUE\n0ns**DelayedWorkQueue****DefaultThreadFactory****AbortPolicy**\n\n#### 4.5.2api\n**Executors.newScheduledThreadPool(n);**\n#### 4.5.3demo\n``` java \n\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\n/**\n * Description: \n *\n * @author TongWei.Chen 2020-07-09 21:28:34\n */\npublic class ThreadPoolTest {\n    public static void main(String[] args) {\n        ScheduledExecutorService scheduledExecutorService = Executors.newScheduledThreadPool(2);\n        // \n        scheduledExecutorService.schedule(() -> System.out.println(Thread.currentThread().getName()), 5, TimeUnit.SECONDS);\n        // 1s\n        scheduledExecutorService.scheduleAtFixedRate(() -> System.out.println(Thread.currentThread().getName()), 5, 1, TimeUnit.SECONDS);\n    }\n}\n```\n#### 4.5.4\n4.4\n\nint\n#### 4.5.5\n``` java\n\npublic ScheduledThreadPoolExecutor(int corePoolSize) {\n    // newCachedThreadPoolInteger.MAX_VALUE\n    super(corePoolSize, Integer.MAX_VALUE, 0, NANOSECONDS,\n          new DelayedWorkQueue());\n}\n```\n\n## 4.6\n### 4.6.1shutdown\n\nshutdownshutdownshutdown\n\n### 4.6.2isShutdown\n\nshutdown\n\n### 4.6.3shutdownNow\nlog\n### 4.7\n**newFixedThreadPool****LinkedBlockingQueue****newCachedThreadPool****SynchronousQueue**\n\n**newFixedThreadPool****newCachedThreadPool**int\n\n## 5\n\n### 1\n- RUNNING\n- SHUTDOWN4.6.1shutdown\n- STOP\n- TIDYING0 terminate()\n- TERMINATEDterminate()\n\n### 2\nExecutors\n### 3\nCPUCPU+1\nIOCPU2X=CPU *1+/\n### 4before&after\nlog\n\n``` java\n// before\nbeforeExecute(wt, task);\nThrowable thrown = null;\ntry {\n    // \n    task.run();\n} catch (RuntimeException x) {\n    thrown = x; throw x;\n} catch (Error x) {\n    thrown = x; throw x;\n} catch (Throwable x) {\n    thrown = x; throw new Error(x);\n} finally {\n    // after\n    afterExecute(task, thrown);\n}\n```\n\n## 6\n\n### 1\n``` java\n// 1. `ctl`int329worker\nprivate final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0));\n// 2. `COUNT_BITS``Integer.SIZE`32`COUNT_BITS`29\nprivate static final int COUNT_BITS = Integer.SIZE - 3;\n// 3. `CAPACITY`1291 2^29 - 1\nprivate static final int CAPACITY   = (1 << COUNT_BITS) - 1;\n\n// runState is stored in the high-order bits\n// 4. 5RUNNING < SHUTDOWN < STOP < TIDYING < TERMINATED\nprivate static final int RUNNING    = -1 << COUNT_BITS;\nprivate static final int SHUTDOWN   =  0 << COUNT_BITS;\nprivate static final int STOP       =  1 << COUNT_BITS;\nprivate static final int TIDYING    =  2 << COUNT_BITS;\nprivate static final int TERMINATED =  3 << COUNT_BITS;\n\n// Packing and unpacking ctl\n// 5. `runStateOf()`290\nprivate static int runStateOf(int c)     { return c & ~CAPACITY; }\n// 6. `workerCountOf()`worker30\nprivate static int workerCountOf(int c)  { return c & CAPACITY; }\n// 7. `ctlOf()`workerctl\nprivate static int ctlOf(int rs, int wc) { return rs | wc; }\n\n/*\n * Bit field accessors that don't require unpacking ctl.\n * These depend on the bit layout and on workerCount being never negative.\n */\n// 8. `runStateLessThan()`xx\nprivate static boolean runStateLessThan(int c, int s) {\n    return c < s;\n}\n// 9. `runStateAtLeast()`xx\nprivate static boolean runStateAtLeast(int c, int s) {\n    return c >= s;\n}\n```\n### 2\n``` java\npublic ThreadPoolExecutor(int corePoolSize,\n                          int maximumPoolSize,\n                          long keepAliveTime,\n                          TimeUnit unit,\n                          BlockingQueue<Runnable> workQueue,\n                          ThreadFactory threadFactory,\n                          RejectedExecutionHandler handler) {\n    // \n    if (corePoolSize < 0 ||\n        maximumPoolSize <= 0 ||\n        maximumPoolSize < corePoolSize ||\n        keepAliveTime < 0)\n        throw new IllegalArgumentException();\n    // \n    if (workQueue == null || threadFactory == null || handler == null)\n        throw new NullPointerException();\n    this.corePoolSize = corePoolSize;\n    this.maximumPoolSize = maximumPoolSize;\n    this.workQueue = workQueue;\n    // `unit``keepAliveTime``keepAliveTime `\n    this.keepAliveTime = unit.toNanos(keepAliveTime);\n    this.threadFactory = threadFactory;\n    this.handler = handler;\n}\n```\n\n### 3task\n``` java\npublic void execute(Runnable command) {\n    if (command == null)\n        throw new NullPointerException();\n    /*\n     * Proceed in 3 steps:\n     *\n     * 1. If fewer than corePoolSize threads are running, try to\n     * start a new thread with the given command as its first\n     * task.  The call to addWorker atomically checks runState and\n     * workerCount, and so prevents false alarms that would add\n     * threads when it shouldn't, by returning false.\n     *\n     * 2. If a task can be successfully queued, then we still need\n     * to double-check whether we should have added a thread\n     * (because existing ones died since last checking) or that\n     * the pool shut down since entry into this method. So we\n     * recheck state and if necessary roll back the enqueuing if\n     * stopped, or start a new thread if there are none.\n     *\n     * 3. If we cannot queue task, then we try to add a new\n     * thread.  If it fails, we know we are shut down or saturated\n     * and so reject the task.\n     */\n    int c = ctl.get();\n    // workerworker\n    if (workerCountOf(c) < corePoolSize) {\n        if (addWorker(command, true))\n            return;\n        c = ctl.get();\n    }\n    // worker\n    if (isRunning(c) && workQueue.offer(command)) {\n        int recheck = ctl.get();\n        // RUNNINGshutdownreject()\n        // recheck\n        if (! isRunning(recheck) && remove(command))\n            reject(command);\n        // 00\n        else if (workerCountOf(recheck) == 0)\n            addWorker(null, false);\n    }\n    // worker\n    // 3\n    // 1. addWorker\n    // 2. addWorker2\n    // 3. addWorkerfalsereject\n    else if (!addWorker(command, false))\n        reject(command);\n}\n```\n\n### 4addworker\n``` java\n\nprivate boolean addWorker(Runnable firstTask, boolean core) {\n    retry:\n    // \n    for (;;) {\n        int c = ctl.get();\n        int rs = runStateOf(c);\n\n        // \n        // (rs > SHUTDOWN) || \n        // (rs == SHUTDOWN && firstTask != null) || \n        // (rs == SHUTDOWN && workQueue.isEmpty())\n        // 1. SHUTDOWNfalse\n        // 2. SHUTDOWNfirstTasknullfalse\n        // 3. SHUTDOWNfalse\n        // Check if queue empty only if necessary.\n        if (rs >= SHUTDOWN &&\n            ! (rs == SHUTDOWN &&\n               firstTask == null &&\n               ! workQueue.isEmpty()))\n            return false;\n\n        // \n        for (;;) {\n            int wc = workerCountOf(c);\n            // workerfalse\n            if (wc >= CAPACITY ||\n                wc >= (core ? corePoolSize : maximumPoolSize))\n                return false;\n            // CASworker\n            // \n            if (compareAndIncrementWorkerCount(c))\n                break retry;\n            c = ctl.get();  // Re-read ctl\n            // \n            if (runStateOf(c) != rs)\n                continue retry;\n            // \n            // else CAS failed due to workerCount change; retry inner loop\n        } \n    }\n    boolean workerStarted = false;\n    boolean workerAdded = false;\n    Worker w = null;\n    try {\n        w = new Worker(firstTask);\n        final Thread t = w.thread;\n        if (t != null) {\n            final ReentrantLock mainLock = this.mainLock;\n            // worker\n            mainLock.lock();\n            try {\n                // Recheck while holding lock.\n                // Back out on ThreadFactory failure or if\n                // shut down before lock acquired.\n                // \n                int rs = runStateOf(ctl.get());\n\n                if (rs < SHUTDOWN ||\n                    (rs == SHUTDOWN && firstTask == null)) {\n                    // workerstart()worker\n                    if (t.isAlive()) // precheck that t is startable\n                        throw new IllegalThreadStateException();\n                    // workerworkers\n                    workers.add(w);\n                    // `largestPoolSize`\n                    int s = workers.size();\n                    if (s > largestPoolSize)\n                        largestPoolSize = s;\n                    workerAdded = true;\n                }\n            } finally {\n                mainLock.unlock();\n            }\n            // worker\n            if (workerAdded) {\n                t.start();\n                workerStarted = true;\n            }\n        }\n    } finally {\n        // workershutdown\n        if (! workerStarted)\n            addWorkerFailed(w);\n    }\n    return workerStarted;\n}\n```\n###  5worker\n``` java\nprivate final class Worker\n    extends AbstractQueuedSynchronizer\n    implements Runnable\n{\n    /**\n     * This class will never be serialized, but we provide a\n     * serialVersionUID to suppress a javac warning.\n     */\n    private static final long serialVersionUID = 6138294804551838833L;\n\n    /** Thread this worker is running in.  Null if factory fails. */\n    final Thread thread;\n    /** Initial task to run.  Possibly null. */\n    Runnable firstTask;\n    /** Per-thread task counter */\n    volatile long completedTasks;\n\n    /**\n     * Creates with given first task and thread from ThreadFactory.\n     * @param firstTask the first task (null if none)\n     */\n    Worker(Runnable firstTask) {\n        setState(-1); // inhibit interrupts until runWorker\n        this.firstTask = firstTask;\n        // Workerworker\n        this.thread = getThreadFactory().newThread(this);\n    }\n\n    /** Delegates main run loop to outer runWorker  */\n    public void run() {\n        runWorker(this);\n    }\n\n    // ...\n}\n```\n### 6-runworker\n``` java\n\nfinal void runWorker(Worker w) {\n    Thread wt = Thread.currentThread();\n    Runnable task = w.firstTask;\n    w.firstTask = null;\n    // unlock()\n    w.unlock(); // allow interrupts\n    // while\n    boolean completedAbruptly = true;\n    try {\n        // \n        // 1. firstTasknullfirstTask\n        // 2. firstTasknullgetTask()\n        // 3. \n        while (task != null || (task = getTask()) != null) {\n            // worker\n            // 1. \n            // 2. worker\n            w.lock();\n            // If pool is stopping, ensure thread is interrupted;\n            // if not, ensure thread is not interrupted.  This\n            // requires a recheck in second case to deal with\n            // shutdownNow race while clearing interrupt\n            // \n            if ((runStateAtLeast(ctl.get(), STOP) ||\n                 (Thread.interrupted() &&\n                  runStateAtLeast(ctl.get(), STOP))) &&\n                !wt.isInterrupted())\n                wt.interrupt();\n            // `beforeExecute()``afterExecute()`\n            // \n            try {\n                beforeExecute(wt, task);\n                Throwable thrown = null;\n                try {\n                    task.run();\n                } catch (RuntimeException x) {\n                    thrown = x; throw x;\n                } catch (Error x) {\n                    thrown = x; throw x;\n                } catch (Throwable x) {\n                    thrown = x; throw new Error(x);\n                } finally {\n                    afterExecute(task, thrown);\n                }\n            } finally {\n                // gc\n                task = null;\n                //  \n                w.completedTasks++;\n                w.unlock();\n            }\n        }\n        completedAbruptly = false;\n    } finally {\n        // \n        processWorkerExit(w, completedAbruptly);\n    }\n}\n```\n\n### 7\n\n- \n- \n\n-   \n\n  **CPU+1**,\n- \n  \n  **2*CPU+1**,\n- loglog\n\n``` java\n\nThreadPoolExecutor executor = new ThreadPoolExecutor(CPU + 1, 2 * CPU + 1,\n      5, TimeUnit.SECONDS, new ArrayBlockingQueue<>(2000),\n         // pay-account\n          new DefaultThreadFactory(\"pay-account\"), (r1, executor) -> {\n         // log \n });\n```\n\n\n\n","source":"_posts/2023/thread-pool.md","raw":"---\ntitle: \ndate: 2023-03-21\ntags:\n- thread\ncategories:\n- JAVA\n---\n\n\n# \n## 1\n>new Thread(() -> {...})********newThreadfornew1000Thread\n## 2\n>****NN\n# \n## 1\n  \n\n>ABC \n## 2\n### 2.1\n``` java\npublic ThreadPoolExecutor(int corePoolSize,\n    int maximumPoolSize,\n    long keepAliveTime,\n    TimeUnit unit,\n    BlockingQueue<Runnable> workQueue,\n    ThreadFactory threadFactory,\n    RejectedExecutionHandler handler) {}\n```\n### 2.2\n- **corePoolSize**  \n\n   \n  \n- **maximumPoolSize**  \n\n   **maximumPoolSize**\n\n- **keepAliveTime**\n\n  **corePoolSize****keepAliveTime**\n\n- **unit**\n\n  TimeUnit.MILLISECONDSTimeUnit.SECONDS\n\n- **workQueue**\n  \n  workQueue  \n  \n  workQueue\n  -  **LinkedBlockingQueue**int\n  - **ArrayBlockingQueue**maximumPoolSize\n  - **SynchronousQueue****Executors.newCachedThreadPool()**;\n\n  **LinkedBlockingQueue****ArrayBlockingQueue**\n\n- **threadFactory****threadFactory**\n\n  **DefaultThreadFactory**newThread()\n  \n- **handler**shutdownhandler\n\n  **AbortPolicy****RejectedExecutionException**\n  \n## 3\n### 3.1\n\n- 0\n\n- \n\n- corePoolSize\n\n- corePoolSizeworkQueue\n\n- maximumPoolSize\n\n- maximumPoolSize\n### 3.2\n\n![](./thread-pool/e0733727-92bd-4438-a628-3b3989d8e838.png)\n### 3.3\n\n510100\n\n659999991100510RUNNING1001\n\n### 3.4\n``` java\npublic void execute(Runnable command) {\n    int c = ctl.get();\n    // workerCountOf(c)\n    // workerworker\n    if (workerCountOf(c) < corePoolSize) {\n        // addWorker\n        if (addWorker(command, true))\n            return;\n        c = ctl.get();\n    }\n    // worker\n    if (isRunning(c) && workQueue.offer(command)) {\n        int recheck = ctl.get();\n        // RUNNINGshutdownreject()\n        // recheck\n        if (! isRunning(recheck) && remove(command))\n            reject(command);\n        // 00\n        else if (workerCountOf(recheck) == 0)\n            addWorker(null, false);\n    }\n    // worker\n    // 3\n    // 1. addWorker\n    // 2. addWorker2\n    // 3. addWorkerfalsereject\n    else if (!addWorker(command, false))\n        reject(command);\n}\n```\n## 4Executors\n### 4.1\n\n\n\nExecutorsExecutors\n\n### 4.2\n#### 4.2.1\n\n\n0ms**LinkedBlockingQueue****DefaultThreadFactory****AbortPolicy**\n\n#### 4.2.2api\n\n**Executors.newFixedThreadPool(n);**\n\n#### 4.2.3demo\n\n``` java\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\n/**\n * Description: 210\n */\npublic class ThreadPoolTest {\n    public static void main(String[] args) {\n        ExecutorService executorService = Executors.newFixedThreadPool(2);\n        for (int i = 0; i < 10; i++) {\n            // name\n            executorService.execute(() -> System.out.println(Thread.currentThread().getName()));\n        }\n    }\n}\n```\n####  4.2.4\n\n****intOOMjvmRedis\n\n#### 4.2.5\n``` java\npublic static ExecutorService newFixedThreadPool(int nThreads) {\n    return new ThreadPoolExecutor(\n                // nThreads\n                nThreads, nThreads,\n                                  0L, TimeUnit.MILLISECONDS,\n                                  // \n                                  new LinkedBlockingQueue<Runnable>());\n}\n```\n### 4.3\n#### 4.3.1\n1\n\n**Executors.newFixedThreadPool(1)**;\n\n0ms**LinkedBlockingQueue****DefaultThreadFactory****AbortPolicy**\n#### 4.3.2api\n\n**Executors.newSingleThreadExecutor();**\n\n#### 4.3.3demo\n``` java\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\n/**\n * Description: 110\n */\npublic class ThreadPoolTest {\n    public static void main(String[] args) {\n        ExecutorService executorService = Executors.newSingleThreadExecutor();\n        for (int i = 0; i < 10; i++) {\n            // namepool-1-thread-1\n            executorService.execute(() -> System.out.println(Thread.currentThread().getName()));\n        }\n    }\n}\n```\n#### 4.3.4\n4.2\n#### 4.3.5\n``` java \n\npublic static ExecutorService newSingleThreadExecutor() {\n    return new FinalizableDelegatedExecutorService\n        (new ThreadPoolExecutor(\n        // 1\n                 1, 1,\n                                0L, TimeUnit.MILLISECONDS,\n                 // \n                                new LinkedBlockingQueue<Runnable>()));\n}\n```\n\n### 4.4\n#### 4.4.1\n**SynchronousQueue****keepAliveTime**60S60S\n\n0int\n\n1min60s**SynchronousQueue****DefaultThreadFactory****AbortPolicy**\n\n#### 4.4.2api\n**Executors.newCachedThreadPool();**\n#### 4.4.3demo\n``` java\n\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\n/**\n * Description: 10\n *\n * @author TongWei.Chen 2020-07-09 21:28:34\n */\npublic class ThreadPoolTest {\n    public static void main(String[] args) {\n        ExecutorService executorService = Executors.newCachedThreadPool();\n        for (int i = 0; i < 10; i++) {\n            // name10\n            executorService.execute(() -> System.out.println(Thread.currentThread().getName()));\n        }\n    }\n}\n```\n#### 4.4.4\nint**SynchronousQueue**\n\n#### 4.4.5\n``` java\n\npublic static ExecutorService newCachedThreadPool() {\n    return new ThreadPoolExecutor(\n                // 0Integer.MAX_VALUE\n                0, Integer.MAX_VALUE,\n                                  60L, TimeUnit.SECONDS,\n                                  new SynchronousQueue<Runnable>());\n}\n````\n\n\n###  4.5\n#### 4.5.1\nRocketMQ\n\nInteger.MAX_VALUE\n0ns**DelayedWorkQueue****DefaultThreadFactory****AbortPolicy**\n\n#### 4.5.2api\n**Executors.newScheduledThreadPool(n);**\n#### 4.5.3demo\n``` java \n\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\n/**\n * Description: \n *\n * @author TongWei.Chen 2020-07-09 21:28:34\n */\npublic class ThreadPoolTest {\n    public static void main(String[] args) {\n        ScheduledExecutorService scheduledExecutorService = Executors.newScheduledThreadPool(2);\n        // \n        scheduledExecutorService.schedule(() -> System.out.println(Thread.currentThread().getName()), 5, TimeUnit.SECONDS);\n        // 1s\n        scheduledExecutorService.scheduleAtFixedRate(() -> System.out.println(Thread.currentThread().getName()), 5, 1, TimeUnit.SECONDS);\n    }\n}\n```\n#### 4.5.4\n4.4\n\nint\n#### 4.5.5\n``` java\n\npublic ScheduledThreadPoolExecutor(int corePoolSize) {\n    // newCachedThreadPoolInteger.MAX_VALUE\n    super(corePoolSize, Integer.MAX_VALUE, 0, NANOSECONDS,\n          new DelayedWorkQueue());\n}\n```\n\n## 4.6\n### 4.6.1shutdown\n\nshutdownshutdownshutdown\n\n### 4.6.2isShutdown\n\nshutdown\n\n### 4.6.3shutdownNow\nlog\n### 4.7\n**newFixedThreadPool****LinkedBlockingQueue****newCachedThreadPool****SynchronousQueue**\n\n**newFixedThreadPool****newCachedThreadPool**int\n\n## 5\n\n### 1\n- RUNNING\n- SHUTDOWN4.6.1shutdown\n- STOP\n- TIDYING0 terminate()\n- TERMINATEDterminate()\n\n### 2\nExecutors\n### 3\nCPUCPU+1\nIOCPU2X=CPU *1+/\n### 4before&after\nlog\n\n``` java\n// before\nbeforeExecute(wt, task);\nThrowable thrown = null;\ntry {\n    // \n    task.run();\n} catch (RuntimeException x) {\n    thrown = x; throw x;\n} catch (Error x) {\n    thrown = x; throw x;\n} catch (Throwable x) {\n    thrown = x; throw new Error(x);\n} finally {\n    // after\n    afterExecute(task, thrown);\n}\n```\n\n## 6\n\n### 1\n``` java\n// 1. `ctl`int329worker\nprivate final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0));\n// 2. `COUNT_BITS``Integer.SIZE`32`COUNT_BITS`29\nprivate static final int COUNT_BITS = Integer.SIZE - 3;\n// 3. `CAPACITY`1291 2^29 - 1\nprivate static final int CAPACITY   = (1 << COUNT_BITS) - 1;\n\n// runState is stored in the high-order bits\n// 4. 5RUNNING < SHUTDOWN < STOP < TIDYING < TERMINATED\nprivate static final int RUNNING    = -1 << COUNT_BITS;\nprivate static final int SHUTDOWN   =  0 << COUNT_BITS;\nprivate static final int STOP       =  1 << COUNT_BITS;\nprivate static final int TIDYING    =  2 << COUNT_BITS;\nprivate static final int TERMINATED =  3 << COUNT_BITS;\n\n// Packing and unpacking ctl\n// 5. `runStateOf()`290\nprivate static int runStateOf(int c)     { return c & ~CAPACITY; }\n// 6. `workerCountOf()`worker30\nprivate static int workerCountOf(int c)  { return c & CAPACITY; }\n// 7. `ctlOf()`workerctl\nprivate static int ctlOf(int rs, int wc) { return rs | wc; }\n\n/*\n * Bit field accessors that don't require unpacking ctl.\n * These depend on the bit layout and on workerCount being never negative.\n */\n// 8. `runStateLessThan()`xx\nprivate static boolean runStateLessThan(int c, int s) {\n    return c < s;\n}\n// 9. `runStateAtLeast()`xx\nprivate static boolean runStateAtLeast(int c, int s) {\n    return c >= s;\n}\n```\n### 2\n``` java\npublic ThreadPoolExecutor(int corePoolSize,\n                          int maximumPoolSize,\n                          long keepAliveTime,\n                          TimeUnit unit,\n                          BlockingQueue<Runnable> workQueue,\n                          ThreadFactory threadFactory,\n                          RejectedExecutionHandler handler) {\n    // \n    if (corePoolSize < 0 ||\n        maximumPoolSize <= 0 ||\n        maximumPoolSize < corePoolSize ||\n        keepAliveTime < 0)\n        throw new IllegalArgumentException();\n    // \n    if (workQueue == null || threadFactory == null || handler == null)\n        throw new NullPointerException();\n    this.corePoolSize = corePoolSize;\n    this.maximumPoolSize = maximumPoolSize;\n    this.workQueue = workQueue;\n    // `unit``keepAliveTime``keepAliveTime `\n    this.keepAliveTime = unit.toNanos(keepAliveTime);\n    this.threadFactory = threadFactory;\n    this.handler = handler;\n}\n```\n\n### 3task\n``` java\npublic void execute(Runnable command) {\n    if (command == null)\n        throw new NullPointerException();\n    /*\n     * Proceed in 3 steps:\n     *\n     * 1. If fewer than corePoolSize threads are running, try to\n     * start a new thread with the given command as its first\n     * task.  The call to addWorker atomically checks runState and\n     * workerCount, and so prevents false alarms that would add\n     * threads when it shouldn't, by returning false.\n     *\n     * 2. If a task can be successfully queued, then we still need\n     * to double-check whether we should have added a thread\n     * (because existing ones died since last checking) or that\n     * the pool shut down since entry into this method. So we\n     * recheck state and if necessary roll back the enqueuing if\n     * stopped, or start a new thread if there are none.\n     *\n     * 3. If we cannot queue task, then we try to add a new\n     * thread.  If it fails, we know we are shut down or saturated\n     * and so reject the task.\n     */\n    int c = ctl.get();\n    // workerworker\n    if (workerCountOf(c) < corePoolSize) {\n        if (addWorker(command, true))\n            return;\n        c = ctl.get();\n    }\n    // worker\n    if (isRunning(c) && workQueue.offer(command)) {\n        int recheck = ctl.get();\n        // RUNNINGshutdownreject()\n        // recheck\n        if (! isRunning(recheck) && remove(command))\n            reject(command);\n        // 00\n        else if (workerCountOf(recheck) == 0)\n            addWorker(null, false);\n    }\n    // worker\n    // 3\n    // 1. addWorker\n    // 2. addWorker2\n    // 3. addWorkerfalsereject\n    else if (!addWorker(command, false))\n        reject(command);\n}\n```\n\n### 4addworker\n``` java\n\nprivate boolean addWorker(Runnable firstTask, boolean core) {\n    retry:\n    // \n    for (;;) {\n        int c = ctl.get();\n        int rs = runStateOf(c);\n\n        // \n        // (rs > SHUTDOWN) || \n        // (rs == SHUTDOWN && firstTask != null) || \n        // (rs == SHUTDOWN && workQueue.isEmpty())\n        // 1. SHUTDOWNfalse\n        // 2. SHUTDOWNfirstTasknullfalse\n        // 3. SHUTDOWNfalse\n        // Check if queue empty only if necessary.\n        if (rs >= SHUTDOWN &&\n            ! (rs == SHUTDOWN &&\n               firstTask == null &&\n               ! workQueue.isEmpty()))\n            return false;\n\n        // \n        for (;;) {\n            int wc = workerCountOf(c);\n            // workerfalse\n            if (wc >= CAPACITY ||\n                wc >= (core ? corePoolSize : maximumPoolSize))\n                return false;\n            // CASworker\n            // \n            if (compareAndIncrementWorkerCount(c))\n                break retry;\n            c = ctl.get();  // Re-read ctl\n            // \n            if (runStateOf(c) != rs)\n                continue retry;\n            // \n            // else CAS failed due to workerCount change; retry inner loop\n        } \n    }\n    boolean workerStarted = false;\n    boolean workerAdded = false;\n    Worker w = null;\n    try {\n        w = new Worker(firstTask);\n        final Thread t = w.thread;\n        if (t != null) {\n            final ReentrantLock mainLock = this.mainLock;\n            // worker\n            mainLock.lock();\n            try {\n                // Recheck while holding lock.\n                // Back out on ThreadFactory failure or if\n                // shut down before lock acquired.\n                // \n                int rs = runStateOf(ctl.get());\n\n                if (rs < SHUTDOWN ||\n                    (rs == SHUTDOWN && firstTask == null)) {\n                    // workerstart()worker\n                    if (t.isAlive()) // precheck that t is startable\n                        throw new IllegalThreadStateException();\n                    // workerworkers\n                    workers.add(w);\n                    // `largestPoolSize`\n                    int s = workers.size();\n                    if (s > largestPoolSize)\n                        largestPoolSize = s;\n                    workerAdded = true;\n                }\n            } finally {\n                mainLock.unlock();\n            }\n            // worker\n            if (workerAdded) {\n                t.start();\n                workerStarted = true;\n            }\n        }\n    } finally {\n        // workershutdown\n        if (! workerStarted)\n            addWorkerFailed(w);\n    }\n    return workerStarted;\n}\n```\n###  5worker\n``` java\nprivate final class Worker\n    extends AbstractQueuedSynchronizer\n    implements Runnable\n{\n    /**\n     * This class will never be serialized, but we provide a\n     * serialVersionUID to suppress a javac warning.\n     */\n    private static final long serialVersionUID = 6138294804551838833L;\n\n    /** Thread this worker is running in.  Null if factory fails. */\n    final Thread thread;\n    /** Initial task to run.  Possibly null. */\n    Runnable firstTask;\n    /** Per-thread task counter */\n    volatile long completedTasks;\n\n    /**\n     * Creates with given first task and thread from ThreadFactory.\n     * @param firstTask the first task (null if none)\n     */\n    Worker(Runnable firstTask) {\n        setState(-1); // inhibit interrupts until runWorker\n        this.firstTask = firstTask;\n        // Workerworker\n        this.thread = getThreadFactory().newThread(this);\n    }\n\n    /** Delegates main run loop to outer runWorker  */\n    public void run() {\n        runWorker(this);\n    }\n\n    // ...\n}\n```\n### 6-runworker\n``` java\n\nfinal void runWorker(Worker w) {\n    Thread wt = Thread.currentThread();\n    Runnable task = w.firstTask;\n    w.firstTask = null;\n    // unlock()\n    w.unlock(); // allow interrupts\n    // while\n    boolean completedAbruptly = true;\n    try {\n        // \n        // 1. firstTasknullfirstTask\n        // 2. firstTasknullgetTask()\n        // 3. \n        while (task != null || (task = getTask()) != null) {\n            // worker\n            // 1. \n            // 2. worker\n            w.lock();\n            // If pool is stopping, ensure thread is interrupted;\n            // if not, ensure thread is not interrupted.  This\n            // requires a recheck in second case to deal with\n            // shutdownNow race while clearing interrupt\n            // \n            if ((runStateAtLeast(ctl.get(), STOP) ||\n                 (Thread.interrupted() &&\n                  runStateAtLeast(ctl.get(), STOP))) &&\n                !wt.isInterrupted())\n                wt.interrupt();\n            // `beforeExecute()``afterExecute()`\n            // \n            try {\n                beforeExecute(wt, task);\n                Throwable thrown = null;\n                try {\n                    task.run();\n                } catch (RuntimeException x) {\n                    thrown = x; throw x;\n                } catch (Error x) {\n                    thrown = x; throw x;\n                } catch (Throwable x) {\n                    thrown = x; throw new Error(x);\n                } finally {\n                    afterExecute(task, thrown);\n                }\n            } finally {\n                // gc\n                task = null;\n                //  \n                w.completedTasks++;\n                w.unlock();\n            }\n        }\n        completedAbruptly = false;\n    } finally {\n        // \n        processWorkerExit(w, completedAbruptly);\n    }\n}\n```\n\n### 7\n\n- \n- \n\n-   \n\n  **CPU+1**,\n- \n  \n  **2*CPU+1**,\n- loglog\n\n``` java\n\nThreadPoolExecutor executor = new ThreadPoolExecutor(CPU + 1, 2 * CPU + 1,\n      5, TimeUnit.SECONDS, new ArrayBlockingQueue<>(2000),\n         // pay-account\n          new DefaultThreadFactory(\"pay-account\"), (r1, executor) -> {\n         // log \n });\n```\n\n\n\n","slug":"2023/thread-pool","published":1,"updated":"2024-08-05T11:07:24.366Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaivh001hvaibc20b68lj","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h2><blockquote>\n<p>new Thread(() -&gt; {})<strong></strong><strong></strong>newThreadfornew1000Thread</p>\n</blockquote>\n<h2 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h2><blockquote>\n<p><strong></strong>NN</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h2><p><br></p>\n<blockquote>\n<p>ABC </p>\n</blockquote>\n<h2 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h2><h3 id=\"2-1\"><a href=\"#2-1\" class=\"headerlink\" title=\"2.1\"></a>2.1</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">ThreadPoolExecutor</span><span class=\"params\">(<span class=\"type\">int</span> corePoolSize,</span></span><br><span class=\"line\"><span class=\"params\">    <span class=\"type\">int</span> maximumPoolSize,</span></span><br><span class=\"line\"><span class=\"params\">    <span class=\"type\">long</span> keepAliveTime,</span></span><br><span class=\"line\"><span class=\"params\">    TimeUnit unit,</span></span><br><span class=\"line\"><span class=\"params\">    BlockingQueue&lt;Runnable&gt; workQueue,</span></span><br><span class=\"line\"><span class=\"params\">    ThreadFactory threadFactory,</span></span><br><span class=\"line\"><span class=\"params\">    RejectedExecutionHandler handler)</span> &#123;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2\"><a href=\"#2-2\" class=\"headerlink\" title=\"2.2\"></a>2.2</h3><ul>\n<li><p><strong>corePoolSize</strong>  </p>\n<p> </p>\n</li>\n<li><p><strong>maximumPoolSize</strong>  </p>\n<p> <strong>maximumPoolSize</strong></p>\n</li>\n<li><p><strong>keepAliveTime</strong></p>\n<p><strong>corePoolSize</strong><strong>keepAliveTime</strong></p>\n</li>\n<li><p><strong>unit</strong></p>\n<p>TimeUnit.MILLISECONDSTimeUnit.SECONDS</p>\n</li>\n<li><p><strong>workQueue</strong></p>\n<p>workQueue  </p>\n<p>workQueue</p>\n<ul>\n<li><strong>LinkedBlockingQueue</strong>int</li>\n<li><strong>ArrayBlockingQueue</strong>maximumPoolSize</li>\n<li><strong>SynchronousQueue</strong><strong>Executors.newCachedThreadPool()</strong>;</li>\n</ul>\n<p><strong>LinkedBlockingQueue</strong><strong>ArrayBlockingQueue</strong></p>\n</li>\n<li><p><strong>threadFactory</strong><strong>threadFactory</strong></p>\n<p><strong>DefaultThreadFactory</strong>newThread()</p>\n</li>\n<li><p><strong>handler</strong>shutdownhandler</p>\n<p><strong>AbortPolicy</strong><strong>RejectedExecutionException</strong></p>\n</li>\n</ul>\n<h2 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h2><h3 id=\"3-1\"><a href=\"#3-1\" class=\"headerlink\" title=\"3.1\"></a>3.1</h3><ul>\n<li><p>0</p>\n</li>\n<li><p></p>\n</li>\n<li><p>corePoolSize</p>\n</li>\n<li><p>corePoolSizeworkQueue</p>\n</li>\n<li><p>maximumPoolSize</p>\n</li>\n<li><p>maximumPoolSize</p>\n</li>\n</ul>\n<h3 id=\"3-2\"><a href=\"#3-2\" class=\"headerlink\" title=\"3.2\"></a>3.2</h3><p><img src=\"/./thread-pool/e0733727-92bd-4438-a628-3b3989d8e838.png\"></p>\n<h3 id=\"3-3\"><a href=\"#3-3\" class=\"headerlink\" title=\"3.3\"></a>3.3</h3><p>510100</p>\n<p>659999991100510RUNNING1001</p>\n<h3 id=\"3-4\"><a href=\"#3-4\" class=\"headerlink\" title=\"3.4\"></a>3.4</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(Runnable command)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> ctl.get();</span><br><span class=\"line\">    <span class=\"comment\">// workerCountOf(c)</span></span><br><span class=\"line\">    <span class=\"comment\">// workerworker</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// addWorker</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (addWorker(command, <span class=\"literal\">true</span>))</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        c = ctl.get();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// worker</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">recheck</span> <span class=\"operator\">=</span> ctl.get();</span><br><span class=\"line\">        <span class=\"comment\">// RUNNINGshutdownreject()</span></span><br><span class=\"line\">        <span class=\"comment\">// recheck</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! isRunning(recheck) &amp;&amp; remove(command))</span><br><span class=\"line\">            reject(command);</span><br><span class=\"line\">        <span class=\"comment\">// 00</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (workerCountOf(recheck) == <span class=\"number\">0</span>)</span><br><span class=\"line\">            addWorker(<span class=\"literal\">null</span>, <span class=\"literal\">false</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// worker</span></span><br><span class=\"line\">    <span class=\"comment\">// 3</span></span><br><span class=\"line\">    <span class=\"comment\">// 1. addWorker</span></span><br><span class=\"line\">    <span class=\"comment\">// 2. addWorker2</span></span><br><span class=\"line\">    <span class=\"comment\">// 3. addWorkerfalsereject</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!addWorker(command, <span class=\"literal\">false</span>))</span><br><span class=\"line\">        reject(command);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"4Executors\"><a href=\"#4Executors\" class=\"headerlink\" title=\"4Executors\"></a>4Executors</h2><h3 id=\"4-1\"><a href=\"#4-1\" class=\"headerlink\" title=\"4.1\"></a>4.1</h3><p></p>\n<p>ExecutorsExecutors</p>\n<h3 id=\"4-2\"><a href=\"#4-2\" class=\"headerlink\" title=\"4.2\"></a>4.2</h3><h4 id=\"4-2-1\"><a href=\"#4-2-1\" class=\"headerlink\" title=\"4.2.1\"></a>4.2.1</h4><p></p>\n<p>0ms<strong>LinkedBlockingQueue</strong><strong>DefaultThreadFactory</strong><strong>AbortPolicy</strong></p>\n<h4 id=\"4-2-2api\"><a href=\"#4-2-2api\" class=\"headerlink\" title=\"4.2.2api\"></a>4.2.2api</h4><p><strong>Executors.newFixedThreadPool(n);</strong></p>\n<h4 id=\"4-2-3demo\"><a href=\"#4-2-3demo\" class=\"headerlink\" title=\"4.2.3demo\"></a>4.2.3demo</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutorService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Executors;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Description: 210</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPoolTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ExecutorService</span> <span class=\"variable\">executorService</span> <span class=\"operator\">=</span> Executors.newFixedThreadPool(<span class=\"number\">2</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// name</span></span><br><span class=\"line\">            executorService.execute(() -&gt; System.out.println(Thread.currentThread().getName()));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-2-4\"><a href=\"#4-2-4\" class=\"headerlink\" title=\"4.2.4\"></a>4.2.4</h4><p><strong></strong>intOOMjvmRedis</p>\n<h4 id=\"4-2-5\"><a href=\"#4-2-5\" class=\"headerlink\" title=\"4.2.5\"></a>4.2.5</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ExecutorService <span class=\"title function_\">newFixedThreadPool</span><span class=\"params\">(<span class=\"type\">int</span> nThreads)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>(</span><br><span class=\"line\">                <span class=\"comment\">// nThreads</span></span><br><span class=\"line\">                nThreads, nThreads,</span><br><span class=\"line\">                                  <span class=\"number\">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class=\"line\">                                  <span class=\"comment\">// </span></span><br><span class=\"line\">                                  <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedBlockingQueue</span>&lt;Runnable&gt;());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-3\"><a href=\"#4-3\" class=\"headerlink\" title=\"4.3\"></a>4.3</h3><h4 id=\"4-3-1\"><a href=\"#4-3-1\" class=\"headerlink\" title=\"4.3.1\"></a>4.3.1</h4><p>1</p>\n<p><strong>Executors.newFixedThreadPool(1)</strong>;</p>\n<p>0ms<strong>LinkedBlockingQueue</strong><strong>DefaultThreadFactory</strong><strong>AbortPolicy</strong></p>\n<h4 id=\"4-3-2api\"><a href=\"#4-3-2api\" class=\"headerlink\" title=\"4.3.2api\"></a>4.3.2api</h4><p><strong>Executors.newSingleThreadExecutor();</strong></p>\n<h4 id=\"4-3-3demo\"><a href=\"#4-3-3demo\" class=\"headerlink\" title=\"4.3.3demo\"></a>4.3.3demo</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutorService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Executors;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Description: 110</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPoolTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ExecutorService</span> <span class=\"variable\">executorService</span> <span class=\"operator\">=</span> Executors.newSingleThreadExecutor();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// namepool-1-thread-1</span></span><br><span class=\"line\">            executorService.execute(() -&gt; System.out.println(Thread.currentThread().getName()));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-3-4\"><a href=\"#4-3-4\" class=\"headerlink\" title=\"4.3.4\"></a>4.3.4</h4><p>4.2</p>\n<h4 id=\"4-3-5\"><a href=\"#4-3-5\" class=\"headerlink\" title=\"4.3.5\"></a>4.3.5</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ExecutorService <span class=\"title function_\">newSingleThreadExecutor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FinalizableDelegatedExecutorService</span></span><br><span class=\"line\">        (<span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>(</span><br><span class=\"line\">        <span class=\"comment\">// 1</span></span><br><span class=\"line\">                 <span class=\"number\">1</span>, <span class=\"number\">1</span>,</span><br><span class=\"line\">                                <span class=\"number\">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class=\"line\">                 <span class=\"comment\">// </span></span><br><span class=\"line\">                                <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedBlockingQueue</span>&lt;Runnable&gt;()));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-4\"><a href=\"#4-4\" class=\"headerlink\" title=\"4.4\"></a>4.4</h3><h4 id=\"4-4-1\"><a href=\"#4-4-1\" class=\"headerlink\" title=\"4.4.1\"></a>4.4.1</h4><p><strong>SynchronousQueue</strong><strong>keepAliveTime</strong>60S60S</p>\n<p>0int</p>\n<p>1min60s<strong>SynchronousQueue</strong><strong>DefaultThreadFactory</strong><strong>AbortPolicy</strong></p>\n<h4 id=\"4-4-2api\"><a href=\"#4-4-2api\" class=\"headerlink\" title=\"4.4.2api\"></a>4.4.2api</h4><p><strong>Executors.newCachedThreadPool();</strong></p>\n<h4 id=\"4-4-3demo\"><a href=\"#4-4-3demo\" class=\"headerlink\" title=\"4.4.3demo\"></a>4.4.3demo</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutorService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Executors;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Description: 10</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> TongWei.Chen 2020-07-09 21:28:34</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPoolTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ExecutorService</span> <span class=\"variable\">executorService</span> <span class=\"operator\">=</span> Executors.newCachedThreadPool();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// name10</span></span><br><span class=\"line\">            executorService.execute(() -&gt; System.out.println(Thread.currentThread().getName()));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-4-4\"><a href=\"#4-4-4\" class=\"headerlink\" title=\"4.4.4\"></a>4.4.4</h4><p>int<strong>SynchronousQueue</strong></p>\n<h4 id=\"4-4-5\"><a href=\"#4-4-5\" class=\"headerlink\" title=\"4.4.5\"></a>4.4.5</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ExecutorService <span class=\"title function_\">newCachedThreadPool</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>(</span><br><span class=\"line\">                <span class=\"comment\">// 0Integer.MAX_VALUE</span></span><br><span class=\"line\">                <span class=\"number\">0</span>, Integer.MAX_VALUE,</span><br><span class=\"line\">                                  <span class=\"number\">60L</span>, TimeUnit.SECONDS,</span><br><span class=\"line\">                                  <span class=\"keyword\">new</span> <span class=\"title class_\">SynchronousQueue</span>&lt;Runnable&gt;());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">````</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">###  <span class=\"number\">4.5</span></span><br><span class=\"line\">#### <span class=\"number\">4.5</span><span class=\"number\">.1</span></span><br><span class=\"line\">RocketMQ</span><br><span class=\"line\"></span><br><span class=\"line\">Integer.MAX_VALUE</span><br><span class=\"line\">0ns**DelayedWorkQueue****DefaultThreadFactory****AbortPolicy**</span><br><span class=\"line\"></span><br><span class=\"line\">#### <span class=\"number\">4.5</span><span class=\"number\">.2</span>api</span><br><span class=\"line\">**Executors.newScheduledThreadPool(n);**</span><br><span class=\"line\">#### <span class=\"number\">4.5</span><span class=\"number\">.3</span>demo</span><br><span class=\"line\">``` java </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutorService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Executors;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Description: </span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> TongWei.Chen 2020-07-09 21:28:34</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPoolTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ScheduledExecutorService</span> <span class=\"variable\">scheduledExecutorService</span> <span class=\"operator\">=</span> Executors.newScheduledThreadPool(<span class=\"number\">2</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        scheduledExecutorService.schedule(() -&gt; System.out.println(Thread.currentThread().getName()), <span class=\"number\">5</span>, TimeUnit.SECONDS);</span><br><span class=\"line\">        <span class=\"comment\">// 1s</span></span><br><span class=\"line\">        scheduledExecutorService.scheduleAtFixedRate(() -&gt; System.out.println(Thread.currentThread().getName()), <span class=\"number\">5</span>, <span class=\"number\">1</span>, TimeUnit.SECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-5-4\"><a href=\"#4-5-4\" class=\"headerlink\" title=\"4.5.4\"></a>4.5.4</h4><p>4.4</p>\n<p>int</p>\n<h4 id=\"4-5-5\"><a href=\"#4-5-5\" class=\"headerlink\" title=\"4.5.5\"></a>4.5.5</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">ScheduledThreadPoolExecutor</span><span class=\"params\">(<span class=\"type\">int</span> corePoolSize)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// newCachedThreadPoolInteger.MAX_VALUE</span></span><br><span class=\"line\">    <span class=\"built_in\">super</span>(corePoolSize, Integer.MAX_VALUE, <span class=\"number\">0</span>, NANOSECONDS,</span><br><span class=\"line\">          <span class=\"keyword\">new</span> <span class=\"title class_\">DelayedWorkQueue</span>());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-6\"><a href=\"#4-6\" class=\"headerlink\" title=\"4.6\"></a>4.6</h2><h3 id=\"4-6-1shutdown\"><a href=\"#4-6-1shutdown\" class=\"headerlink\" title=\"4.6.1shutdown\"></a>4.6.1shutdown</h3><p>shutdownshutdownshutdown</p>\n<h3 id=\"4-6-2isShutdown\"><a href=\"#4-6-2isShutdown\" class=\"headerlink\" title=\"4.6.2isShutdown\"></a>4.6.2isShutdown</h3><p>shutdown</p>\n<h3 id=\"4-6-3shutdownNow\"><a href=\"#4-6-3shutdownNow\" class=\"headerlink\" title=\"4.6.3shutdownNow\"></a>4.6.3shutdownNow</h3><p>log</p>\n<h3 id=\"4-7\"><a href=\"#4-7\" class=\"headerlink\" title=\"4.7\"></a>4.7</h3><p><strong>newFixedThreadPool</strong><strong>LinkedBlockingQueue</strong><strong>newCachedThreadPool</strong><strong>SynchronousQueue</strong></p>\n<p><strong>newFixedThreadPool</strong><strong>newCachedThreadPool</strong>int</p>\n<h2 id=\"5\"><a href=\"#5\" class=\"headerlink\" title=\"5\"></a>5</h2><h3 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h3><ul>\n<li>RUNNING</li>\n<li>SHUTDOWN4.6.1shutdown</li>\n<li>STOP</li>\n<li>TIDYING0 terminate()</li>\n<li>TERMINATEDterminate()</li>\n</ul>\n<h3 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h3><p>Executors</p>\n<h3 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h3><p>CPUCPU+1<br>IOCPU2X&#x3D;CPU *1+&#x2F;</p>\n<h3 id=\"4before-after\"><a href=\"#4before-after\" class=\"headerlink\" title=\"4before&amp;after\"></a>4before&amp;after</h3><p>log<br></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// before</span></span><br><span class=\"line\">beforeExecute(wt, task);</span><br><span class=\"line\"><span class=\"type\">Throwable</span> <span class=\"variable\">thrown</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    task.run();</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (RuntimeException x) &#123;</span><br><span class=\"line\">    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Error x) &#123;</span><br><span class=\"line\">    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Throwable x) &#123;</span><br><span class=\"line\">    thrown = x; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(x);</span><br><span class=\"line\">&#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// after</span></span><br><span class=\"line\">    afterExecute(task, thrown);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6\"><a href=\"#6\" class=\"headerlink\" title=\"6\"></a>6</h2><h3 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1. `ctl`int329worker</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"type\">AtomicInteger</span> <span class=\"variable\">ctl</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">AtomicInteger</span>(ctlOf(RUNNING, <span class=\"number\">0</span>));</span><br><span class=\"line\"><span class=\"comment\">// 2. `COUNT_BITS``Integer.SIZE`32`COUNT_BITS`29</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">COUNT_BITS</span> <span class=\"operator\">=</span> Integer.SIZE - <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"comment\">// 3. `CAPACITY`1291 2^29 - 1</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">CAPACITY</span>   <span class=\"operator\">=</span> (<span class=\"number\">1</span> &lt;&lt; COUNT_BITS) - <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// runState is stored in the high-order bits</span></span><br><span class=\"line\"><span class=\"comment\">// 4. 5RUNNING &lt; SHUTDOWN &lt; STOP &lt; TIDYING &lt; TERMINATED</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">RUNNING</span>    <span class=\"operator\">=</span> -<span class=\"number\">1</span> &lt;&lt; COUNT_BITS;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">SHUTDOWN</span>   <span class=\"operator\">=</span>  <span class=\"number\">0</span> &lt;&lt; COUNT_BITS;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">STOP</span>       <span class=\"operator\">=</span>  <span class=\"number\">1</span> &lt;&lt; COUNT_BITS;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">TIDYING</span>    <span class=\"operator\">=</span>  <span class=\"number\">2</span> &lt;&lt; COUNT_BITS;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">TERMINATED</span> <span class=\"operator\">=</span>  <span class=\"number\">3</span> &lt;&lt; COUNT_BITS;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Packing and unpacking ctl</span></span><br><span class=\"line\"><span class=\"comment\">// 5. `runStateOf()`290</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">runStateOf</span><span class=\"params\">(<span class=\"type\">int</span> c)</span>     &#123; <span class=\"keyword\">return</span> c &amp; ~CAPACITY; &#125;</span><br><span class=\"line\"><span class=\"comment\">// 6. `workerCountOf()`worker30</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">workerCountOf</span><span class=\"params\">(<span class=\"type\">int</span> c)</span>  &#123; <span class=\"keyword\">return</span> c &amp; CAPACITY; &#125;</span><br><span class=\"line\"><span class=\"comment\">// 7. `ctlOf()`workerctl</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">ctlOf</span><span class=\"params\">(<span class=\"type\">int</span> rs, <span class=\"type\">int</span> wc)</span> &#123; <span class=\"keyword\">return</span> rs | wc; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * Bit field accessors that don&#x27;t require unpacking ctl.</span></span><br><span class=\"line\"><span class=\"comment\"> * These depend on the bit layout and on workerCount being never negative.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"comment\">// 8. `runStateLessThan()`xx</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">runStateLessThan</span><span class=\"params\">(<span class=\"type\">int</span> c, <span class=\"type\">int</span> s)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> c &lt; s;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 9. `runStateAtLeast()`xx</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">runStateAtLeast</span><span class=\"params\">(<span class=\"type\">int</span> c, <span class=\"type\">int</span> s)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> c &gt;= s;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">ThreadPoolExecutor</span><span class=\"params\">(<span class=\"type\">int</span> corePoolSize,</span></span><br><span class=\"line\"><span class=\"params\">                          <span class=\"type\">int</span> maximumPoolSize,</span></span><br><span class=\"line\"><span class=\"params\">                          <span class=\"type\">long</span> keepAliveTime,</span></span><br><span class=\"line\"><span class=\"params\">                          TimeUnit unit,</span></span><br><span class=\"line\"><span class=\"params\">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span><br><span class=\"line\"><span class=\"params\">                          ThreadFactory threadFactory,</span></span><br><span class=\"line\"><span class=\"params\">                          RejectedExecutionHandler handler)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (corePoolSize &lt; <span class=\"number\">0</span> ||</span><br><span class=\"line\">        maximumPoolSize &lt;= <span class=\"number\">0</span> ||</span><br><span class=\"line\">        maximumPoolSize &lt; corePoolSize ||</span><br><span class=\"line\">        keepAliveTime &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (workQueue == <span class=\"literal\">null</span> || threadFactory == <span class=\"literal\">null</span> || handler == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>();</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.corePoolSize = corePoolSize;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.maximumPoolSize = maximumPoolSize;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.workQueue = workQueue;</span><br><span class=\"line\">    <span class=\"comment\">// `unit``keepAliveTime``keepAliveTime `</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.threadFactory = threadFactory;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.handler = handler;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3task\"><a href=\"#3task\" class=\"headerlink\" title=\"3task\"></a>3task</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(Runnable command)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (command == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>();</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * Proceed in 3 steps:</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * 1. If fewer than corePoolSize threads are running, try to</span></span><br><span class=\"line\"><span class=\"comment\">     * start a new thread with the given command as its first</span></span><br><span class=\"line\"><span class=\"comment\">     * task.  The call to addWorker atomically checks runState and</span></span><br><span class=\"line\"><span class=\"comment\">     * workerCount, and so prevents false alarms that would add</span></span><br><span class=\"line\"><span class=\"comment\">     * threads when it shouldn&#x27;t, by returning false.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * 2. If a task can be successfully queued, then we still need</span></span><br><span class=\"line\"><span class=\"comment\">     * to double-check whether we should have added a thread</span></span><br><span class=\"line\"><span class=\"comment\">     * (because existing ones died since last checking) or that</span></span><br><span class=\"line\"><span class=\"comment\">     * the pool shut down since entry into this method. So we</span></span><br><span class=\"line\"><span class=\"comment\">     * recheck state and if necessary roll back the enqueuing if</span></span><br><span class=\"line\"><span class=\"comment\">     * stopped, or start a new thread if there are none.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * 3. If we cannot queue task, then we try to add a new</span></span><br><span class=\"line\"><span class=\"comment\">     * thread.  If it fails, we know we are shut down or saturated</span></span><br><span class=\"line\"><span class=\"comment\">     * and so reject the task.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> ctl.get();</span><br><span class=\"line\">    <span class=\"comment\">// workerworker</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (addWorker(command, <span class=\"literal\">true</span>))</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        c = ctl.get();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// worker</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">recheck</span> <span class=\"operator\">=</span> ctl.get();</span><br><span class=\"line\">        <span class=\"comment\">// RUNNINGshutdownreject()</span></span><br><span class=\"line\">        <span class=\"comment\">// recheck</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! isRunning(recheck) &amp;&amp; remove(command))</span><br><span class=\"line\">            reject(command);</span><br><span class=\"line\">        <span class=\"comment\">// 00</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (workerCountOf(recheck) == <span class=\"number\">0</span>)</span><br><span class=\"line\">            addWorker(<span class=\"literal\">null</span>, <span class=\"literal\">false</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// worker</span></span><br><span class=\"line\">    <span class=\"comment\">// 3</span></span><br><span class=\"line\">    <span class=\"comment\">// 1. addWorker</span></span><br><span class=\"line\">    <span class=\"comment\">// 2. addWorker2</span></span><br><span class=\"line\">    <span class=\"comment\">// 3. addWorkerfalsereject</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!addWorker(command, <span class=\"literal\">false</span>))</span><br><span class=\"line\">        reject(command);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4addworker\"><a href=\"#4addworker\" class=\"headerlink\" title=\"4addworker\"></a>4addworker</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"type\">boolean</span> <span class=\"title function_\">addWorker</span><span class=\"params\">(Runnable firstTask, <span class=\"type\">boolean</span> core)</span> &#123;</span><br><span class=\"line\">    retry:</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> ctl.get();</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">rs</span> <span class=\"operator\">=</span> runStateOf(c);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">// (rs &gt; SHUTDOWN) || </span></span><br><span class=\"line\">        <span class=\"comment\">// (rs == SHUTDOWN &amp;&amp; firstTask != null) || </span></span><br><span class=\"line\">        <span class=\"comment\">// (rs == SHUTDOWN &amp;&amp; workQueue.isEmpty())</span></span><br><span class=\"line\">        <span class=\"comment\">// 1. SHUTDOWNfalse</span></span><br><span class=\"line\">        <span class=\"comment\">// 2. SHUTDOWNfirstTasknullfalse</span></span><br><span class=\"line\">        <span class=\"comment\">// 3. SHUTDOWNfalse</span></span><br><span class=\"line\">        <span class=\"comment\">// Check if queue empty only if necessary.</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rs &gt;= SHUTDOWN &amp;&amp;</span><br><span class=\"line\">            ! (rs == SHUTDOWN &amp;&amp;</span><br><span class=\"line\">               firstTask == <span class=\"literal\">null</span> &amp;&amp;</span><br><span class=\"line\">               ! workQueue.isEmpty()))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">wc</span> <span class=\"operator\">=</span> workerCountOf(c);</span><br><span class=\"line\">            <span class=\"comment\">// workerfalse</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (wc &gt;= CAPACITY ||</span><br><span class=\"line\">                wc &gt;= (core ? corePoolSize : maximumPoolSize))</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"comment\">// CASworker</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (compareAndIncrementWorkerCount(c))</span><br><span class=\"line\">                <span class=\"keyword\">break</span> retry;</span><br><span class=\"line\">            c = ctl.get();  <span class=\"comment\">// Re-read ctl</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (runStateOf(c) != rs)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span> retry;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"comment\">// else CAS failed due to workerCount change; retry inner loop</span></span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">workerStarted</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">workerAdded</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"type\">Worker</span> <span class=\"variable\">w</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        w = <span class=\"keyword\">new</span> <span class=\"title class_\">Worker</span>(firstTask);</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Thread</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> w.thread;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (t != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">final</span> <span class=\"type\">ReentrantLock</span> <span class=\"variable\">mainLock</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.mainLock;</span><br><span class=\"line\">            <span class=\"comment\">// worker</span></span><br><span class=\"line\">            mainLock.lock();</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Recheck while holding lock.</span></span><br><span class=\"line\">                <span class=\"comment\">// Back out on ThreadFactory failure or if</span></span><br><span class=\"line\">                <span class=\"comment\">// shut down before lock acquired.</span></span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"type\">int</span> <span class=\"variable\">rs</span> <span class=\"operator\">=</span> runStateOf(ctl.get());</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (rs &lt; SHUTDOWN ||</span><br><span class=\"line\">                    (rs == SHUTDOWN &amp;&amp; firstTask == <span class=\"literal\">null</span>)) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// workerstart()worker</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (t.isAlive()) <span class=\"comment\">// precheck that t is startable</span></span><br><span class=\"line\">                        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalThreadStateException</span>();</span><br><span class=\"line\">                    <span class=\"comment\">// workerworkers</span></span><br><span class=\"line\">                    workers.add(w);</span><br><span class=\"line\">                    <span class=\"comment\">// `largestPoolSize`</span></span><br><span class=\"line\">                    <span class=\"type\">int</span> <span class=\"variable\">s</span> <span class=\"operator\">=</span> workers.size();</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (s &gt; largestPoolSize)</span><br><span class=\"line\">                        largestPoolSize = s;</span><br><span class=\"line\">                    workerAdded = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                mainLock.unlock();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// worker</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (workerAdded) &#123;</span><br><span class=\"line\">                t.start();</span><br><span class=\"line\">                workerStarted = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// workershutdown</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! workerStarted)</span><br><span class=\"line\">            addWorkerFailed(w);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> workerStarted;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"5worker\"><a href=\"#5worker\" class=\"headerlink\" title=\"5worker\"></a>5worker</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Worker</span></span><br><span class=\"line\">    <span class=\"keyword\">extends</span> <span class=\"title class_\">AbstractQueuedSynchronizer</span></span><br><span class=\"line\">    <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * This class will never be serialized, but we provide a</span></span><br><span class=\"line\"><span class=\"comment\">     * serialVersionUID to suppress a javac warning.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">6138294804551838833L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** Thread this worker is running in.  Null if factory fails. */</span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> Thread thread;</span><br><span class=\"line\">    <span class=\"comment\">/** Initial task to run.  Possibly null. */</span></span><br><span class=\"line\">    Runnable firstTask;</span><br><span class=\"line\">    <span class=\"comment\">/** Per-thread task counter */</span></span><br><span class=\"line\">    <span class=\"keyword\">volatile</span> <span class=\"type\">long</span> completedTasks;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Creates with given first task and thread from ThreadFactory.</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> firstTask the first task (null if none)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    Worker(Runnable firstTask) &#123;</span><br><span class=\"line\">        setState(-<span class=\"number\">1</span>); <span class=\"comment\">// inhibit interrupts until runWorker</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.firstTask = firstTask;</span><br><span class=\"line\">        <span class=\"comment\">// Workerworker</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.thread = getThreadFactory().newThread(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** Delegates main run loop to outer runWorker  */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        runWorker(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"6-runworker\"><a href=\"#6-runworker\" class=\"headerlink\" title=\"6-runworker\"></a>6-runworker</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">runWorker</span><span class=\"params\">(Worker w)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">Thread</span> <span class=\"variable\">wt</span> <span class=\"operator\">=</span> Thread.currentThread();</span><br><span class=\"line\">    <span class=\"type\">Runnable</span> <span class=\"variable\">task</span> <span class=\"operator\">=</span> w.firstTask;</span><br><span class=\"line\">    w.firstTask = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// unlock()</span></span><br><span class=\"line\">    w.unlock(); <span class=\"comment\">// allow interrupts</span></span><br><span class=\"line\">    <span class=\"comment\">// while</span></span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">completedAbruptly</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">// 1. firstTasknullfirstTask</span></span><br><span class=\"line\">        <span class=\"comment\">// 2. firstTasknullgetTask()</span></span><br><span class=\"line\">        <span class=\"comment\">// 3. </span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (task != <span class=\"literal\">null</span> || (task = getTask()) != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// worker</span></span><br><span class=\"line\">            <span class=\"comment\">// 1. </span></span><br><span class=\"line\">            <span class=\"comment\">// 2. worker</span></span><br><span class=\"line\">            w.lock();</span><br><span class=\"line\">            <span class=\"comment\">// If pool is stopping, ensure thread is interrupted;</span></span><br><span class=\"line\">            <span class=\"comment\">// if not, ensure thread is not interrupted.  This</span></span><br><span class=\"line\">            <span class=\"comment\">// requires a recheck in second case to deal with</span></span><br><span class=\"line\">            <span class=\"comment\">// shutdownNow race while clearing interrupt</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((runStateAtLeast(ctl.get(), STOP) ||</span><br><span class=\"line\">                 (Thread.interrupted() &amp;&amp;</span><br><span class=\"line\">                  runStateAtLeast(ctl.get(), STOP))) &amp;&amp;</span><br><span class=\"line\">                !wt.isInterrupted())</span><br><span class=\"line\">                wt.interrupt();</span><br><span class=\"line\">            <span class=\"comment\">// `beforeExecute()``afterExecute()`</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                beforeExecute(wt, task);</span><br><span class=\"line\">                <span class=\"type\">Throwable</span> <span class=\"variable\">thrown</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    task.run();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (RuntimeException x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Error x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Throwable x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(x);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                    afterExecute(task, thrown);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// gc</span></span><br><span class=\"line\">                task = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                <span class=\"comment\">//  </span></span><br><span class=\"line\">                w.completedTasks++;</span><br><span class=\"line\">                w.unlock();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        completedAbruptly = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        processWorkerExit(w, completedAbruptly);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7\"><a href=\"#7\" class=\"headerlink\" title=\"7\"></a>7</h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>  </p>\n<p><strong>CPU+1</strong>,</p>\n</li>\n<li><p></p>\n<p><strong>2*CPU+1</strong>,</p>\n</li>\n<li><p>loglog<br></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">ThreadPoolExecutor</span> <span class=\"variable\">executor</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>(CPU + <span class=\"number\">1</span>, <span class=\"number\">2</span> * CPU + <span class=\"number\">1</span>,</span><br><span class=\"line\">      <span class=\"number\">5</span>, TimeUnit.SECONDS, <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayBlockingQueue</span>&lt;&gt;(<span class=\"number\">2000</span>),</span><br><span class=\"line\">         <span class=\"comment\">// pay-account</span></span><br><span class=\"line\">          <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultThreadFactory</span>(<span class=\"string\">&quot;pay-account&quot;</span>), (r1, executor) -&gt; &#123;</span><br><span class=\"line\">         <span class=\"comment\">// log </span></span><br><span class=\"line\"> &#125;);</span><br></pre></td></tr></table></figure></li>\n</ul>\n","cover":false,"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h2><blockquote>\n<p>new Thread(() -&gt; {})<strong></strong><strong></strong>newThreadfornew1000Thread</p>\n</blockquote>\n<h2 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h2><blockquote>\n<p><strong></strong>NN</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h2><p><br></p>\n<blockquote>\n<p>ABC </p>\n</blockquote>\n<h2 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h2><h3 id=\"2-1\"><a href=\"#2-1\" class=\"headerlink\" title=\"2.1\"></a>2.1</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">ThreadPoolExecutor</span><span class=\"params\">(<span class=\"type\">int</span> corePoolSize,</span></span><br><span class=\"line\"><span class=\"params\">    <span class=\"type\">int</span> maximumPoolSize,</span></span><br><span class=\"line\"><span class=\"params\">    <span class=\"type\">long</span> keepAliveTime,</span></span><br><span class=\"line\"><span class=\"params\">    TimeUnit unit,</span></span><br><span class=\"line\"><span class=\"params\">    BlockingQueue&lt;Runnable&gt; workQueue,</span></span><br><span class=\"line\"><span class=\"params\">    ThreadFactory threadFactory,</span></span><br><span class=\"line\"><span class=\"params\">    RejectedExecutionHandler handler)</span> &#123;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2\"><a href=\"#2-2\" class=\"headerlink\" title=\"2.2\"></a>2.2</h3><ul>\n<li><p><strong>corePoolSize</strong>  </p>\n<p> </p>\n</li>\n<li><p><strong>maximumPoolSize</strong>  </p>\n<p> <strong>maximumPoolSize</strong></p>\n</li>\n<li><p><strong>keepAliveTime</strong></p>\n<p><strong>corePoolSize</strong><strong>keepAliveTime</strong></p>\n</li>\n<li><p><strong>unit</strong></p>\n<p>TimeUnit.MILLISECONDSTimeUnit.SECONDS</p>\n</li>\n<li><p><strong>workQueue</strong></p>\n<p>workQueue  </p>\n<p>workQueue</p>\n<ul>\n<li><strong>LinkedBlockingQueue</strong>int</li>\n<li><strong>ArrayBlockingQueue</strong>maximumPoolSize</li>\n<li><strong>SynchronousQueue</strong><strong>Executors.newCachedThreadPool()</strong>;</li>\n</ul>\n<p><strong>LinkedBlockingQueue</strong><strong>ArrayBlockingQueue</strong></p>\n</li>\n<li><p><strong>threadFactory</strong><strong>threadFactory</strong></p>\n<p><strong>DefaultThreadFactory</strong>newThread()</p>\n</li>\n<li><p><strong>handler</strong>shutdownhandler</p>\n<p><strong>AbortPolicy</strong><strong>RejectedExecutionException</strong></p>\n</li>\n</ul>\n<h2 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h2><h3 id=\"3-1\"><a href=\"#3-1\" class=\"headerlink\" title=\"3.1\"></a>3.1</h3><ul>\n<li><p>0</p>\n</li>\n<li><p></p>\n</li>\n<li><p>corePoolSize</p>\n</li>\n<li><p>corePoolSizeworkQueue</p>\n</li>\n<li><p>maximumPoolSize</p>\n</li>\n<li><p>maximumPoolSize</p>\n</li>\n</ul>\n<h3 id=\"3-2\"><a href=\"#3-2\" class=\"headerlink\" title=\"3.2\"></a>3.2</h3><p><img src=\"/./thread-pool/e0733727-92bd-4438-a628-3b3989d8e838.png\"></p>\n<h3 id=\"3-3\"><a href=\"#3-3\" class=\"headerlink\" title=\"3.3\"></a>3.3</h3><p>510100</p>\n<p>659999991100510RUNNING1001</p>\n<h3 id=\"3-4\"><a href=\"#3-4\" class=\"headerlink\" title=\"3.4\"></a>3.4</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(Runnable command)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> ctl.get();</span><br><span class=\"line\">    <span class=\"comment\">// workerCountOf(c)</span></span><br><span class=\"line\">    <span class=\"comment\">// workerworker</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// addWorker</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (addWorker(command, <span class=\"literal\">true</span>))</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        c = ctl.get();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// worker</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">recheck</span> <span class=\"operator\">=</span> ctl.get();</span><br><span class=\"line\">        <span class=\"comment\">// RUNNINGshutdownreject()</span></span><br><span class=\"line\">        <span class=\"comment\">// recheck</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! isRunning(recheck) &amp;&amp; remove(command))</span><br><span class=\"line\">            reject(command);</span><br><span class=\"line\">        <span class=\"comment\">// 00</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (workerCountOf(recheck) == <span class=\"number\">0</span>)</span><br><span class=\"line\">            addWorker(<span class=\"literal\">null</span>, <span class=\"literal\">false</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// worker</span></span><br><span class=\"line\">    <span class=\"comment\">// 3</span></span><br><span class=\"line\">    <span class=\"comment\">// 1. addWorker</span></span><br><span class=\"line\">    <span class=\"comment\">// 2. addWorker2</span></span><br><span class=\"line\">    <span class=\"comment\">// 3. addWorkerfalsereject</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!addWorker(command, <span class=\"literal\">false</span>))</span><br><span class=\"line\">        reject(command);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"4Executors\"><a href=\"#4Executors\" class=\"headerlink\" title=\"4Executors\"></a>4Executors</h2><h3 id=\"4-1\"><a href=\"#4-1\" class=\"headerlink\" title=\"4.1\"></a>4.1</h3><p></p>\n<p>ExecutorsExecutors</p>\n<h3 id=\"4-2\"><a href=\"#4-2\" class=\"headerlink\" title=\"4.2\"></a>4.2</h3><h4 id=\"4-2-1\"><a href=\"#4-2-1\" class=\"headerlink\" title=\"4.2.1\"></a>4.2.1</h4><p></p>\n<p>0ms<strong>LinkedBlockingQueue</strong><strong>DefaultThreadFactory</strong><strong>AbortPolicy</strong></p>\n<h4 id=\"4-2-2api\"><a href=\"#4-2-2api\" class=\"headerlink\" title=\"4.2.2api\"></a>4.2.2api</h4><p><strong>Executors.newFixedThreadPool(n);</strong></p>\n<h4 id=\"4-2-3demo\"><a href=\"#4-2-3demo\" class=\"headerlink\" title=\"4.2.3demo\"></a>4.2.3demo</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutorService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Executors;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Description: 210</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPoolTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ExecutorService</span> <span class=\"variable\">executorService</span> <span class=\"operator\">=</span> Executors.newFixedThreadPool(<span class=\"number\">2</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// name</span></span><br><span class=\"line\">            executorService.execute(() -&gt; System.out.println(Thread.currentThread().getName()));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-2-4\"><a href=\"#4-2-4\" class=\"headerlink\" title=\"4.2.4\"></a>4.2.4</h4><p><strong></strong>intOOMjvmRedis</p>\n<h4 id=\"4-2-5\"><a href=\"#4-2-5\" class=\"headerlink\" title=\"4.2.5\"></a>4.2.5</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ExecutorService <span class=\"title function_\">newFixedThreadPool</span><span class=\"params\">(<span class=\"type\">int</span> nThreads)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>(</span><br><span class=\"line\">                <span class=\"comment\">// nThreads</span></span><br><span class=\"line\">                nThreads, nThreads,</span><br><span class=\"line\">                                  <span class=\"number\">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class=\"line\">                                  <span class=\"comment\">// </span></span><br><span class=\"line\">                                  <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedBlockingQueue</span>&lt;Runnable&gt;());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-3\"><a href=\"#4-3\" class=\"headerlink\" title=\"4.3\"></a>4.3</h3><h4 id=\"4-3-1\"><a href=\"#4-3-1\" class=\"headerlink\" title=\"4.3.1\"></a>4.3.1</h4><p>1</p>\n<p><strong>Executors.newFixedThreadPool(1)</strong>;</p>\n<p>0ms<strong>LinkedBlockingQueue</strong><strong>DefaultThreadFactory</strong><strong>AbortPolicy</strong></p>\n<h4 id=\"4-3-2api\"><a href=\"#4-3-2api\" class=\"headerlink\" title=\"4.3.2api\"></a>4.3.2api</h4><p><strong>Executors.newSingleThreadExecutor();</strong></p>\n<h4 id=\"4-3-3demo\"><a href=\"#4-3-3demo\" class=\"headerlink\" title=\"4.3.3demo\"></a>4.3.3demo</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutorService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Executors;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Description: 110</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPoolTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ExecutorService</span> <span class=\"variable\">executorService</span> <span class=\"operator\">=</span> Executors.newSingleThreadExecutor();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// namepool-1-thread-1</span></span><br><span class=\"line\">            executorService.execute(() -&gt; System.out.println(Thread.currentThread().getName()));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-3-4\"><a href=\"#4-3-4\" class=\"headerlink\" title=\"4.3.4\"></a>4.3.4</h4><p>4.2</p>\n<h4 id=\"4-3-5\"><a href=\"#4-3-5\" class=\"headerlink\" title=\"4.3.5\"></a>4.3.5</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ExecutorService <span class=\"title function_\">newSingleThreadExecutor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FinalizableDelegatedExecutorService</span></span><br><span class=\"line\">        (<span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>(</span><br><span class=\"line\">        <span class=\"comment\">// 1</span></span><br><span class=\"line\">                 <span class=\"number\">1</span>, <span class=\"number\">1</span>,</span><br><span class=\"line\">                                <span class=\"number\">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class=\"line\">                 <span class=\"comment\">// </span></span><br><span class=\"line\">                                <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedBlockingQueue</span>&lt;Runnable&gt;()));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-4\"><a href=\"#4-4\" class=\"headerlink\" title=\"4.4\"></a>4.4</h3><h4 id=\"4-4-1\"><a href=\"#4-4-1\" class=\"headerlink\" title=\"4.4.1\"></a>4.4.1</h4><p><strong>SynchronousQueue</strong><strong>keepAliveTime</strong>60S60S</p>\n<p>0int</p>\n<p>1min60s<strong>SynchronousQueue</strong><strong>DefaultThreadFactory</strong><strong>AbortPolicy</strong></p>\n<h4 id=\"4-4-2api\"><a href=\"#4-4-2api\" class=\"headerlink\" title=\"4.4.2api\"></a>4.4.2api</h4><p><strong>Executors.newCachedThreadPool();</strong></p>\n<h4 id=\"4-4-3demo\"><a href=\"#4-4-3demo\" class=\"headerlink\" title=\"4.4.3demo\"></a>4.4.3demo</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutorService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Executors;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Description: 10</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> TongWei.Chen 2020-07-09 21:28:34</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPoolTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ExecutorService</span> <span class=\"variable\">executorService</span> <span class=\"operator\">=</span> Executors.newCachedThreadPool();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// name10</span></span><br><span class=\"line\">            executorService.execute(() -&gt; System.out.println(Thread.currentThread().getName()));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-4-4\"><a href=\"#4-4-4\" class=\"headerlink\" title=\"4.4.4\"></a>4.4.4</h4><p>int<strong>SynchronousQueue</strong></p>\n<h4 id=\"4-4-5\"><a href=\"#4-4-5\" class=\"headerlink\" title=\"4.4.5\"></a>4.4.5</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ExecutorService <span class=\"title function_\">newCachedThreadPool</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>(</span><br><span class=\"line\">                <span class=\"comment\">// 0Integer.MAX_VALUE</span></span><br><span class=\"line\">                <span class=\"number\">0</span>, Integer.MAX_VALUE,</span><br><span class=\"line\">                                  <span class=\"number\">60L</span>, TimeUnit.SECONDS,</span><br><span class=\"line\">                                  <span class=\"keyword\">new</span> <span class=\"title class_\">SynchronousQueue</span>&lt;Runnable&gt;());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">````</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">###  <span class=\"number\">4.5</span></span><br><span class=\"line\">#### <span class=\"number\">4.5</span><span class=\"number\">.1</span></span><br><span class=\"line\">RocketMQ</span><br><span class=\"line\"></span><br><span class=\"line\">Integer.MAX_VALUE</span><br><span class=\"line\">0ns**DelayedWorkQueue****DefaultThreadFactory****AbortPolicy**</span><br><span class=\"line\"></span><br><span class=\"line\">#### <span class=\"number\">4.5</span><span class=\"number\">.2</span>api</span><br><span class=\"line\">**Executors.newScheduledThreadPool(n);**</span><br><span class=\"line\">#### <span class=\"number\">4.5</span><span class=\"number\">.3</span>demo</span><br><span class=\"line\">``` java </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutorService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Executors;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Description: </span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> TongWei.Chen 2020-07-09 21:28:34</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPoolTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ScheduledExecutorService</span> <span class=\"variable\">scheduledExecutorService</span> <span class=\"operator\">=</span> Executors.newScheduledThreadPool(<span class=\"number\">2</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        scheduledExecutorService.schedule(() -&gt; System.out.println(Thread.currentThread().getName()), <span class=\"number\">5</span>, TimeUnit.SECONDS);</span><br><span class=\"line\">        <span class=\"comment\">// 1s</span></span><br><span class=\"line\">        scheduledExecutorService.scheduleAtFixedRate(() -&gt; System.out.println(Thread.currentThread().getName()), <span class=\"number\">5</span>, <span class=\"number\">1</span>, TimeUnit.SECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-5-4\"><a href=\"#4-5-4\" class=\"headerlink\" title=\"4.5.4\"></a>4.5.4</h4><p>4.4</p>\n<p>int</p>\n<h4 id=\"4-5-5\"><a href=\"#4-5-5\" class=\"headerlink\" title=\"4.5.5\"></a>4.5.5</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">ScheduledThreadPoolExecutor</span><span class=\"params\">(<span class=\"type\">int</span> corePoolSize)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// newCachedThreadPoolInteger.MAX_VALUE</span></span><br><span class=\"line\">    <span class=\"built_in\">super</span>(corePoolSize, Integer.MAX_VALUE, <span class=\"number\">0</span>, NANOSECONDS,</span><br><span class=\"line\">          <span class=\"keyword\">new</span> <span class=\"title class_\">DelayedWorkQueue</span>());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-6\"><a href=\"#4-6\" class=\"headerlink\" title=\"4.6\"></a>4.6</h2><h3 id=\"4-6-1shutdown\"><a href=\"#4-6-1shutdown\" class=\"headerlink\" title=\"4.6.1shutdown\"></a>4.6.1shutdown</h3><p>shutdownshutdownshutdown</p>\n<h3 id=\"4-6-2isShutdown\"><a href=\"#4-6-2isShutdown\" class=\"headerlink\" title=\"4.6.2isShutdown\"></a>4.6.2isShutdown</h3><p>shutdown</p>\n<h3 id=\"4-6-3shutdownNow\"><a href=\"#4-6-3shutdownNow\" class=\"headerlink\" title=\"4.6.3shutdownNow\"></a>4.6.3shutdownNow</h3><p>log</p>\n<h3 id=\"4-7\"><a href=\"#4-7\" class=\"headerlink\" title=\"4.7\"></a>4.7</h3><p><strong>newFixedThreadPool</strong><strong>LinkedBlockingQueue</strong><strong>newCachedThreadPool</strong><strong>SynchronousQueue</strong></p>\n<p><strong>newFixedThreadPool</strong><strong>newCachedThreadPool</strong>int</p>\n<h2 id=\"5\"><a href=\"#5\" class=\"headerlink\" title=\"5\"></a>5</h2><h3 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h3><ul>\n<li>RUNNING</li>\n<li>SHUTDOWN4.6.1shutdown</li>\n<li>STOP</li>\n<li>TIDYING0 terminate()</li>\n<li>TERMINATEDterminate()</li>\n</ul>\n<h3 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h3><p>Executors</p>\n<h3 id=\"3\"><a href=\"#3\" class=\"headerlink\" title=\"3\"></a>3</h3><p>CPUCPU+1<br>IOCPU2X&#x3D;CPU *1+&#x2F;</p>\n<h3 id=\"4before-after\"><a href=\"#4before-after\" class=\"headerlink\" title=\"4before&amp;after\"></a>4before&amp;after</h3><p>log<br></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// before</span></span><br><span class=\"line\">beforeExecute(wt, task);</span><br><span class=\"line\"><span class=\"type\">Throwable</span> <span class=\"variable\">thrown</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    task.run();</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (RuntimeException x) &#123;</span><br><span class=\"line\">    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Error x) &#123;</span><br><span class=\"line\">    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Throwable x) &#123;</span><br><span class=\"line\">    thrown = x; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(x);</span><br><span class=\"line\">&#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// after</span></span><br><span class=\"line\">    afterExecute(task, thrown);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6\"><a href=\"#6\" class=\"headerlink\" title=\"6\"></a>6</h2><h3 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1. `ctl`int329worker</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"type\">AtomicInteger</span> <span class=\"variable\">ctl</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">AtomicInteger</span>(ctlOf(RUNNING, <span class=\"number\">0</span>));</span><br><span class=\"line\"><span class=\"comment\">// 2. `COUNT_BITS``Integer.SIZE`32`COUNT_BITS`29</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">COUNT_BITS</span> <span class=\"operator\">=</span> Integer.SIZE - <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"comment\">// 3. `CAPACITY`1291 2^29 - 1</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">CAPACITY</span>   <span class=\"operator\">=</span> (<span class=\"number\">1</span> &lt;&lt; COUNT_BITS) - <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// runState is stored in the high-order bits</span></span><br><span class=\"line\"><span class=\"comment\">// 4. 5RUNNING &lt; SHUTDOWN &lt; STOP &lt; TIDYING &lt; TERMINATED</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">RUNNING</span>    <span class=\"operator\">=</span> -<span class=\"number\">1</span> &lt;&lt; COUNT_BITS;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">SHUTDOWN</span>   <span class=\"operator\">=</span>  <span class=\"number\">0</span> &lt;&lt; COUNT_BITS;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">STOP</span>       <span class=\"operator\">=</span>  <span class=\"number\">1</span> &lt;&lt; COUNT_BITS;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">TIDYING</span>    <span class=\"operator\">=</span>  <span class=\"number\">2</span> &lt;&lt; COUNT_BITS;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">TERMINATED</span> <span class=\"operator\">=</span>  <span class=\"number\">3</span> &lt;&lt; COUNT_BITS;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Packing and unpacking ctl</span></span><br><span class=\"line\"><span class=\"comment\">// 5. `runStateOf()`290</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">runStateOf</span><span class=\"params\">(<span class=\"type\">int</span> c)</span>     &#123; <span class=\"keyword\">return</span> c &amp; ~CAPACITY; &#125;</span><br><span class=\"line\"><span class=\"comment\">// 6. `workerCountOf()`worker30</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">workerCountOf</span><span class=\"params\">(<span class=\"type\">int</span> c)</span>  &#123; <span class=\"keyword\">return</span> c &amp; CAPACITY; &#125;</span><br><span class=\"line\"><span class=\"comment\">// 7. `ctlOf()`workerctl</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">ctlOf</span><span class=\"params\">(<span class=\"type\">int</span> rs, <span class=\"type\">int</span> wc)</span> &#123; <span class=\"keyword\">return</span> rs | wc; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * Bit field accessors that don&#x27;t require unpacking ctl.</span></span><br><span class=\"line\"><span class=\"comment\"> * These depend on the bit layout and on workerCount being never negative.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"comment\">// 8. `runStateLessThan()`xx</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">runStateLessThan</span><span class=\"params\">(<span class=\"type\">int</span> c, <span class=\"type\">int</span> s)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> c &lt; s;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 9. `runStateAtLeast()`xx</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">runStateAtLeast</span><span class=\"params\">(<span class=\"type\">int</span> c, <span class=\"type\">int</span> s)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> c &gt;= s;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">ThreadPoolExecutor</span><span class=\"params\">(<span class=\"type\">int</span> corePoolSize,</span></span><br><span class=\"line\"><span class=\"params\">                          <span class=\"type\">int</span> maximumPoolSize,</span></span><br><span class=\"line\"><span class=\"params\">                          <span class=\"type\">long</span> keepAliveTime,</span></span><br><span class=\"line\"><span class=\"params\">                          TimeUnit unit,</span></span><br><span class=\"line\"><span class=\"params\">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span><br><span class=\"line\"><span class=\"params\">                          ThreadFactory threadFactory,</span></span><br><span class=\"line\"><span class=\"params\">                          RejectedExecutionHandler handler)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (corePoolSize &lt; <span class=\"number\">0</span> ||</span><br><span class=\"line\">        maximumPoolSize &lt;= <span class=\"number\">0</span> ||</span><br><span class=\"line\">        maximumPoolSize &lt; corePoolSize ||</span><br><span class=\"line\">        keepAliveTime &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (workQueue == <span class=\"literal\">null</span> || threadFactory == <span class=\"literal\">null</span> || handler == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>();</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.corePoolSize = corePoolSize;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.maximumPoolSize = maximumPoolSize;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.workQueue = workQueue;</span><br><span class=\"line\">    <span class=\"comment\">// `unit``keepAliveTime``keepAliveTime `</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.threadFactory = threadFactory;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.handler = handler;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3task\"><a href=\"#3task\" class=\"headerlink\" title=\"3task\"></a>3task</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(Runnable command)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (command == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>();</span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * Proceed in 3 steps:</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * 1. If fewer than corePoolSize threads are running, try to</span></span><br><span class=\"line\"><span class=\"comment\">     * start a new thread with the given command as its first</span></span><br><span class=\"line\"><span class=\"comment\">     * task.  The call to addWorker atomically checks runState and</span></span><br><span class=\"line\"><span class=\"comment\">     * workerCount, and so prevents false alarms that would add</span></span><br><span class=\"line\"><span class=\"comment\">     * threads when it shouldn&#x27;t, by returning false.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * 2. If a task can be successfully queued, then we still need</span></span><br><span class=\"line\"><span class=\"comment\">     * to double-check whether we should have added a thread</span></span><br><span class=\"line\"><span class=\"comment\">     * (because existing ones died since last checking) or that</span></span><br><span class=\"line\"><span class=\"comment\">     * the pool shut down since entry into this method. So we</span></span><br><span class=\"line\"><span class=\"comment\">     * recheck state and if necessary roll back the enqueuing if</span></span><br><span class=\"line\"><span class=\"comment\">     * stopped, or start a new thread if there are none.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * 3. If we cannot queue task, then we try to add a new</span></span><br><span class=\"line\"><span class=\"comment\">     * thread.  If it fails, we know we are shut down or saturated</span></span><br><span class=\"line\"><span class=\"comment\">     * and so reject the task.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> ctl.get();</span><br><span class=\"line\">    <span class=\"comment\">// workerworker</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (addWorker(command, <span class=\"literal\">true</span>))</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        c = ctl.get();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// worker</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">recheck</span> <span class=\"operator\">=</span> ctl.get();</span><br><span class=\"line\">        <span class=\"comment\">// RUNNINGshutdownreject()</span></span><br><span class=\"line\">        <span class=\"comment\">// recheck</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! isRunning(recheck) &amp;&amp; remove(command))</span><br><span class=\"line\">            reject(command);</span><br><span class=\"line\">        <span class=\"comment\">// 00</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (workerCountOf(recheck) == <span class=\"number\">0</span>)</span><br><span class=\"line\">            addWorker(<span class=\"literal\">null</span>, <span class=\"literal\">false</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// worker</span></span><br><span class=\"line\">    <span class=\"comment\">// 3</span></span><br><span class=\"line\">    <span class=\"comment\">// 1. addWorker</span></span><br><span class=\"line\">    <span class=\"comment\">// 2. addWorker2</span></span><br><span class=\"line\">    <span class=\"comment\">// 3. addWorkerfalsereject</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!addWorker(command, <span class=\"literal\">false</span>))</span><br><span class=\"line\">        reject(command);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4addworker\"><a href=\"#4addworker\" class=\"headerlink\" title=\"4addworker\"></a>4addworker</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"type\">boolean</span> <span class=\"title function_\">addWorker</span><span class=\"params\">(Runnable firstTask, <span class=\"type\">boolean</span> core)</span> &#123;</span><br><span class=\"line\">    retry:</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">c</span> <span class=\"operator\">=</span> ctl.get();</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">rs</span> <span class=\"operator\">=</span> runStateOf(c);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">// (rs &gt; SHUTDOWN) || </span></span><br><span class=\"line\">        <span class=\"comment\">// (rs == SHUTDOWN &amp;&amp; firstTask != null) || </span></span><br><span class=\"line\">        <span class=\"comment\">// (rs == SHUTDOWN &amp;&amp; workQueue.isEmpty())</span></span><br><span class=\"line\">        <span class=\"comment\">// 1. SHUTDOWNfalse</span></span><br><span class=\"line\">        <span class=\"comment\">// 2. SHUTDOWNfirstTasknullfalse</span></span><br><span class=\"line\">        <span class=\"comment\">// 3. SHUTDOWNfalse</span></span><br><span class=\"line\">        <span class=\"comment\">// Check if queue empty only if necessary.</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rs &gt;= SHUTDOWN &amp;&amp;</span><br><span class=\"line\">            ! (rs == SHUTDOWN &amp;&amp;</span><br><span class=\"line\">               firstTask == <span class=\"literal\">null</span> &amp;&amp;</span><br><span class=\"line\">               ! workQueue.isEmpty()))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">wc</span> <span class=\"operator\">=</span> workerCountOf(c);</span><br><span class=\"line\">            <span class=\"comment\">// workerfalse</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (wc &gt;= CAPACITY ||</span><br><span class=\"line\">                wc &gt;= (core ? corePoolSize : maximumPoolSize))</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            <span class=\"comment\">// CASworker</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (compareAndIncrementWorkerCount(c))</span><br><span class=\"line\">                <span class=\"keyword\">break</span> retry;</span><br><span class=\"line\">            c = ctl.get();  <span class=\"comment\">// Re-read ctl</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (runStateOf(c) != rs)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span> retry;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"comment\">// else CAS failed due to workerCount change; retry inner loop</span></span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">workerStarted</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">workerAdded</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"type\">Worker</span> <span class=\"variable\">w</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        w = <span class=\"keyword\">new</span> <span class=\"title class_\">Worker</span>(firstTask);</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Thread</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> w.thread;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (t != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">final</span> <span class=\"type\">ReentrantLock</span> <span class=\"variable\">mainLock</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.mainLock;</span><br><span class=\"line\">            <span class=\"comment\">// worker</span></span><br><span class=\"line\">            mainLock.lock();</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Recheck while holding lock.</span></span><br><span class=\"line\">                <span class=\"comment\">// Back out on ThreadFactory failure or if</span></span><br><span class=\"line\">                <span class=\"comment\">// shut down before lock acquired.</span></span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"type\">int</span> <span class=\"variable\">rs</span> <span class=\"operator\">=</span> runStateOf(ctl.get());</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (rs &lt; SHUTDOWN ||</span><br><span class=\"line\">                    (rs == SHUTDOWN &amp;&amp; firstTask == <span class=\"literal\">null</span>)) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// workerstart()worker</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (t.isAlive()) <span class=\"comment\">// precheck that t is startable</span></span><br><span class=\"line\">                        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalThreadStateException</span>();</span><br><span class=\"line\">                    <span class=\"comment\">// workerworkers</span></span><br><span class=\"line\">                    workers.add(w);</span><br><span class=\"line\">                    <span class=\"comment\">// `largestPoolSize`</span></span><br><span class=\"line\">                    <span class=\"type\">int</span> <span class=\"variable\">s</span> <span class=\"operator\">=</span> workers.size();</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (s &gt; largestPoolSize)</span><br><span class=\"line\">                        largestPoolSize = s;</span><br><span class=\"line\">                    workerAdded = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                mainLock.unlock();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// worker</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (workerAdded) &#123;</span><br><span class=\"line\">                t.start();</span><br><span class=\"line\">                workerStarted = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// workershutdown</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! workerStarted)</span><br><span class=\"line\">            addWorkerFailed(w);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> workerStarted;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"5worker\"><a href=\"#5worker\" class=\"headerlink\" title=\"5worker\"></a>5worker</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Worker</span></span><br><span class=\"line\">    <span class=\"keyword\">extends</span> <span class=\"title class_\">AbstractQueuedSynchronizer</span></span><br><span class=\"line\">    <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * This class will never be serialized, but we provide a</span></span><br><span class=\"line\"><span class=\"comment\">     * serialVersionUID to suppress a javac warning.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> <span class=\"number\">6138294804551838833L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** Thread this worker is running in.  Null if factory fails. */</span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> Thread thread;</span><br><span class=\"line\">    <span class=\"comment\">/** Initial task to run.  Possibly null. */</span></span><br><span class=\"line\">    Runnable firstTask;</span><br><span class=\"line\">    <span class=\"comment\">/** Per-thread task counter */</span></span><br><span class=\"line\">    <span class=\"keyword\">volatile</span> <span class=\"type\">long</span> completedTasks;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Creates with given first task and thread from ThreadFactory.</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> firstTask the first task (null if none)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    Worker(Runnable firstTask) &#123;</span><br><span class=\"line\">        setState(-<span class=\"number\">1</span>); <span class=\"comment\">// inhibit interrupts until runWorker</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.firstTask = firstTask;</span><br><span class=\"line\">        <span class=\"comment\">// Workerworker</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.thread = getThreadFactory().newThread(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** Delegates main run loop to outer runWorker  */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        runWorker(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"6-runworker\"><a href=\"#6-runworker\" class=\"headerlink\" title=\"6-runworker\"></a>6-runworker</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">runWorker</span><span class=\"params\">(Worker w)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">Thread</span> <span class=\"variable\">wt</span> <span class=\"operator\">=</span> Thread.currentThread();</span><br><span class=\"line\">    <span class=\"type\">Runnable</span> <span class=\"variable\">task</span> <span class=\"operator\">=</span> w.firstTask;</span><br><span class=\"line\">    w.firstTask = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// unlock()</span></span><br><span class=\"line\">    w.unlock(); <span class=\"comment\">// allow interrupts</span></span><br><span class=\"line\">    <span class=\"comment\">// while</span></span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"variable\">completedAbruptly</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">// 1. firstTasknullfirstTask</span></span><br><span class=\"line\">        <span class=\"comment\">// 2. firstTasknullgetTask()</span></span><br><span class=\"line\">        <span class=\"comment\">// 3. </span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (task != <span class=\"literal\">null</span> || (task = getTask()) != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// worker</span></span><br><span class=\"line\">            <span class=\"comment\">// 1. </span></span><br><span class=\"line\">            <span class=\"comment\">// 2. worker</span></span><br><span class=\"line\">            w.lock();</span><br><span class=\"line\">            <span class=\"comment\">// If pool is stopping, ensure thread is interrupted;</span></span><br><span class=\"line\">            <span class=\"comment\">// if not, ensure thread is not interrupted.  This</span></span><br><span class=\"line\">            <span class=\"comment\">// requires a recheck in second case to deal with</span></span><br><span class=\"line\">            <span class=\"comment\">// shutdownNow race while clearing interrupt</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((runStateAtLeast(ctl.get(), STOP) ||</span><br><span class=\"line\">                 (Thread.interrupted() &amp;&amp;</span><br><span class=\"line\">                  runStateAtLeast(ctl.get(), STOP))) &amp;&amp;</span><br><span class=\"line\">                !wt.isInterrupted())</span><br><span class=\"line\">                wt.interrupt();</span><br><span class=\"line\">            <span class=\"comment\">// `beforeExecute()``afterExecute()`</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                beforeExecute(wt, task);</span><br><span class=\"line\">                <span class=\"type\">Throwable</span> <span class=\"variable\">thrown</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    task.run();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (RuntimeException x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Error x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Throwable x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(x);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                    afterExecute(task, thrown);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// gc</span></span><br><span class=\"line\">                task = <span class=\"literal\">null</span>;</span><br><span class=\"line\">                <span class=\"comment\">//  </span></span><br><span class=\"line\">                w.completedTasks++;</span><br><span class=\"line\">                w.unlock();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        completedAbruptly = <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        processWorkerExit(w, completedAbruptly);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"7\"><a href=\"#7\" class=\"headerlink\" title=\"7\"></a>7</h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>  </p>\n<p><strong>CPU+1</strong>,</p>\n</li>\n<li><p></p>\n<p><strong>2*CPU+1</strong>,</p>\n</li>\n<li><p>loglog<br></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">ThreadPoolExecutor</span> <span class=\"variable\">executor</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadPoolExecutor</span>(CPU + <span class=\"number\">1</span>, <span class=\"number\">2</span> * CPU + <span class=\"number\">1</span>,</span><br><span class=\"line\">      <span class=\"number\">5</span>, TimeUnit.SECONDS, <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayBlockingQueue</span>&lt;&gt;(<span class=\"number\">2000</span>),</span><br><span class=\"line\">         <span class=\"comment\">// pay-account</span></span><br><span class=\"line\">          <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultThreadFactory</span>(<span class=\"string\">&quot;pay-account&quot;</span>), (r1, executor) -&gt; &#123;</span><br><span class=\"line\">         <span class=\"comment\">// log </span></span><br><span class=\"line\"> &#125;);</span><br></pre></td></tr></table></figure></li>\n</ul>\n"},{"title":"","date":"2023-03-20T16:00:00.000Z","_content":"\n# \n\n## \n\n### \n\n- CPU,IO\n- \n- ( )(360 )\n\n### \n\n- -\n\n- CPU\n\n- Java windows\n\n\n### \n\n- \n- \n- \n  - IPC (Inter-process communication)\n  - ,HTTP\n- --\n- ,-\n\n## \n\ncpu``- -cpu(windows'15)cpu()\n``- -:````CPU concurrent\n\n| CPU  | 1 | 2 | 3 | 4 |\n| :--: | :-----: | :-----: | :-----: | :-----: |\n| core |  1  |  2  |  3  |  4  |\n\n![](thread/453affe8-17db-40b3-940f-162e7597336e.png)\n\nCPUcore\n\n|  CPU  | 1 | 2 | 3 | 4 |\n| :---: | :-----: | :-----: | :-----: | :-----: |\n| core1 |  1  |  1  |  3  |  3  |\n| core2 |  2  |  2  |  4  |  4  |\n\n![](thread/2ed065be-3fb7-4e67-b04e-b8e08980405d.png)\n\nRob Pike:\n\n- (concurrent) - -(dealing with) \n- (parallel) - -(doing) \n\n\n\n- -,\n- -(,)\n- 3\n\n## \n\n### \n\n\n\n**:**\n\n#### \n\n()5\n5,...\n\n``` java\npackage com.wry.concurrent.util;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.io.FileNotFoundException;\nimport java.io.FileReader;\n\n/**\n * <p>\n *\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/26\n */\n@Slf4j\npublic class FileReaderUtil {\n    \n    public static void read(String path) {\n        log.debug(\"FileReader start .....\");\n        try {\n            FileReader reader = new java.io.FileReader(path);\n        } catch (FileNotFoundException e) {\n            e.printStackTrace();\n        }\n        log.debug(\"FileReader end .....\");\n    }\n}\n```\n\n``` java\npackage com.wry.concurrent.n2;\n\nimport com.wry.concurrent.constans.Constans;\nimport com.wry.concurrent.util.FileReaderUtil;\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.io.FileNotFoundException;\nimport java.io.FileReader;\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/26\n */\n@Slf4j\npublic class Sync {\n\n    public static void main(String[] args) {\n        //fileReader\n        FileReaderUtil.read(Constans.FILE_PATH);\n\n        log.debug(\"do other things .....\");\n    }\n\n\n}\n\n```\n\n``` java\npackage com.wry.concurrent.n2;\n\nimport com.wry.concurrent.constans.Constans;\nimport com.wry.concurrent.util.FileReaderUtil;\nimport lombok.extern.slf4j.Slf4j;\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/26\n */\n@Slf4j\npublic class Async {\n\n    public static void main(String[] args) {\n        //\n        new Thread(() -> {\n            FileReaderUtil.read(Constans.FILE_PATH);\n        }).start();\n\n        log.debug(\"do other things .....\");\n    }\n}\n\n```\n\n\n\n#### \n\n- \n- tomcat servlet,tomcat\n- UIui\n\n### ()\n\ncpu,3,\n\n>\t1\t\t10ms\n>\t2\t\t11ms\n>\t3\t\t9 ms\n>\t1 ms\n\n- 10 + 11 + 9 + 1= 31ms\n- cpu, 11,22,33,311ms12ms\n\n** : cpu**\n\n#### \n\n``` java\npackage com.wry.concurrent.n2.example;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.util.Arrays;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.FutureTask;\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/26\n */\n@Slf4j\npublic class MyBenchmark {\n\n    static int[] ARRAY = new int[4000_000_00];\n\n    static {\n        Arrays.fill(ARRAY, 1);\n    }\n\n    /**\n     *  4\n     */\n    public static void async() throws ExecutionException, InterruptedException {\n        //\n        Long start = System.currentTimeMillis();\n        int[] array = ARRAY;\n        FutureTask<Integer> task1 = new FutureTask<Integer>(() -> {\n            int sum = 0;\n            for (int i = 0; i < 1000_000_00; i++) {\n                sum += array[0 + i];\n            }\n            return sum;\n        });\n        FutureTask<Integer> task2 = new FutureTask<Integer>(() -> {\n            int sum = 0;\n            for (int i = 0; i < 1000_000_00; i++) {\n                sum += array[1000_000_00 + i];\n            }\n            return sum;\n        });\n        FutureTask<Integer> task3 = new FutureTask<Integer>(() -> {\n            int sum = 0;\n            for (int i = 0; i < 1000_000_00; i++) {\n                sum += array[2000_000_00 + i];\n            }\n            return sum;\n        });\n        FutureTask<Integer> task4 = new FutureTask<Integer>(() -> {\n            int sum = 0;\n            for (int i = 0; i < 1000_000_00; i++) {\n                sum += array[3000_000_00 + i];\n            }\n            return sum;\n        });\n\n        new Thread(task1).start();\n        new Thread(task2).start();\n        new Thread(task3).start();\n        new Thread(task4).start();\n        int i = task1.get() + task2.get() + task3.get() + task4.get();\n        //\n        Long end = System.currentTimeMillis();\n        System.out.println(\"\" + i + \"\\t\" + (end - start));\n    }\n\n    /**\n     * \n     */\n    private static void sync() {\n        //\n        Long start = System.currentTimeMillis();\n        int[] array = ARRAY;\n        int sum = 0;\n        for (int i = 0; i < 4000_000_00; i++) {\n            sum += array[i];\n        }\n        //\n        Long end = System.currentTimeMillis();\n        System.out.println(\"\" + sum + \"\\t\" + (end - start));\n    }\n\n\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        //\n        sync();\n        //\n        async();\n    }\n\n}\n\n```\n\n![](thread/4f22eeff-a017-46f6-bf49-5359e570fe22.png)\n\n#### \n\n1cpu,cpu, cpu,\n2cpu\n\n    -  ,,([] )\n    -  \n\n3 IOcpu,[IO]cpu,IO[IO][I0]\n\n# JAVA\n\n## \n\njavamain\n\n### 1.Thread\n\n``` java\n/**\n * <p>\n *  Thread\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n\n@Slf4j\npublic class Thread1 {\n    public static void main(String[] args) {\n        Thread thread = new Thread() {\n            @Override\n            public void run() {\n                //\n                log.debug(\"runing....\");\n            }\n        };\n        //\n        thread.setName(\"t1\");\n        //\n        thread.start();\n        \n        log.debug(\"main....\");\n    }\n}\n\n```\n\n### 2.Runnable Thread\n\n````  \n\n- Thread \n- Runnable \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n\n@Slf4j\npublic class Thread2 {\n    public static void main(String[] args) {\n        Runnable runnable = new Runnable() {\n            @Override\n            public void run() {\n                //\n                log.debug(\"runing....\");\n            }\n        };\n\n        //(12)\n        Thread thread = new Thread(runnable,\"t2\");\n        //\n        thread.start();\n        \n        log.debug(\"main....\");\n    }\n}\n\n```\n\nJAVA 8 `lambda`\n\n``` java\n       \t//\n        Runnable lombdaRunnable= () -> {\n            log.debug(\"lombda runging......\"); \n        };\n        //\n        Thread lombdaThead=new Thread(lombdaRunnable,\"lombdaThead\");\n        //\n        lombdaThead.start();\n```\n\n\n\n``` java\n new Thread(() -> {\n     log.debug(\"lombda runging......\");\n }, \"lambdaThread\").start();\n```\n\n### 3.FutureTask Thread\n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n\n@Slf4j\npublic class Thread3 {\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        FutureTask<Integer> task=new FutureTask<>(new Callable<Integer>() {\n            @Override\n            public Integer call() throws Exception {\n                log.debug(\"running.......\");\n                Thread.sleep(1000);\n                return 100;\n            }\n        });\n\n        //(12)\n        Thread thread = new Thread(task,\"t3\");\n        //\n        thread.start();\n        \n        //tasktask\n        Integer integer = task.get();\n        log.debug(\"task {}\",integer);\n    }\n}\n\n```\n\n\n\n\n\n### ThreadRunnable\n\n#### Runnable\n\nRunnableinit\n\n``` java\n    /**\n     * Allocates a new {@code Thread} object. This constructor has the same\n     * effect as {@linkplain #Thread(ThreadGroup,Runnable,String) Thread}\n     * {@code (null, target, name)}.\n     *\n     * @param  target\n     *         the object whose {@code run} method is invoked when this thread\n     *         is started. If {@code null}, this thread's run method is invoked.\n     *\n     * @param  name\n     *         the name of the new thread\n     */\n    public Thread(Runnable target, String name) {\n        init(null, target, name, 0);\n    }\n\n```\n\nInit \n\n``` java\n /**\n     * Initializes a Thread with the current AccessControlContext.\n     * @see #init(ThreadGroup,Runnable,String,long,AccessControlContext,boolean)\n     */\n    private void init(ThreadGroup g, Runnable target, String name,\n                      long stackSize) {\n        init(g, target, name, stackSize, null, true);\n    }\n```\n\ninit `Runable` `target`\n\n``` java\n    /**\n     * Initializes a Thread.\n     *\n     * @param g the Thread group\n     * @param target the object whose run() method gets called\n     * @param name the name of the new Thread\n     * @param stackSize the desired stack size for the new thread, or\n     *        zero to indicate that this parameter is to be ignored.\n     * @param acc the AccessControlContext to inherit, or\n     *            AccessController.getContext() if null\n     * @param inheritThreadLocals if {@code true}, inherit initial values for\n     *            inheritable thread-locals from the constructing thread\n     */\n    private void init(ThreadGroup g, Runnable target, String name,\n                      long stackSize, AccessControlContext acc,\n                      boolean inheritThreadLocals) {\n        if (name == null) {\n            throw new NullPointerException(\"name cannot be null\");\n        }\n\n        this.name = name;\n\n        Thread parent = currentThread();\n        SecurityManager security = System.getSecurityManager();\n        if (g == null) {\n            /* Determine if it's an applet or not */\n\n            /* If there is a security manager, ask the security manager\n               what to do. */\n            if (security != null) {\n                g = security.getThreadGroup();\n            }\n\n            /* If the security doesn't have a strong opinion of the matter\n               use the parent thread group. */\n            if (g == null) {\n                g = parent.getThreadGroup();\n            }\n        }\n\n        /* checkAccess regardless of whether or not threadgroup is\n           explicitly passed in. */\n        g.checkAccess();\n\n        /*\n         * Do we have the required permissions?\n         */\n        if (security != null) {\n            if (isCCLOverridden(getClass())) {\n                security.checkPermission(SUBCLASS_IMPLEMENTATION_PERMISSION);\n            }\n        }\n\n        g.addUnstarted();\n\n        this.group = g;\n        this.daemon = parent.isDaemon();\n        this.priority = parent.getPriority();\n        if (security == null || isCCLOverridden(parent.getClass()))\n            this.contextClassLoader = parent.getContextClassLoader();\n        else\n            this.contextClassLoader = parent.contextClassLoader;\n        this.inheritedAccessControlContext =\n                acc != null ? acc : AccessController.getContext();\n        //Runable \n        this.target = target;\n        setPriority(priority);\n        if (inheritThreadLocals && parent.inheritableThreadLocals != null)\n            this.inheritableThreadLocals =\n                ThreadLocal.createInheritedMap(parent.inheritableThreadLocals);\n        /* Stash the specified stack size in case the VM cares */\n        this.stackSize = stackSize;\n\n        /* Set thread ID */\n        tid = nextThreadID();\n    }\n```\n\nThread ,Thread`run`\n\n``` java\n  /**\n     * If this thread was constructed using a separate\n     * <code>Runnable</code> run object, then that\n     * <code>Runnable</code> object's <code>run</code> method is called;\n     * otherwise, this method does nothing and returns.\n     * <p>\n     * Subclasses of <code>Thread</code> should override this method.\n     *\n     * @see     #start()\n     * @see     #stop()\n     * @see     #Thread(ThreadGroup, Runnable, String)\n     */\n    @Override\n    public void run() {\n        if (target != null) {\n            target.run();\n        }\n    }\n\n```\n\n#### \n\n- ThreadRunnable \n- Runnable API \n- Runnable Thread \n\n## \n\n#### \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class MultiThread {\n    public static void main(String[] args) {\n        new Thread(()->{\n            while (true) {\n                log.debug(\"running.....\");\n            }\n        },\"t1\").start();\n        \n        new Thread(() -> {\n            while (true) {\n                log.debug(\"running.....\");\n            }\n        }, \"t2\").start();\n    }\n}\n\n```\n\n![](thread/e5b813b7-361c-42ec-9326-53b01a2872da.png)\n\n#### \n\n- \n- \n\n\n\n## \n\n### windows\n\n- ,\n- tasklist\n- taskkill\n\n### linux\n\n- ps -fe\n- ps -fT -p <PID>(PID) \n- kill \n- topH\n- top -H -p <PID>(PID) :\n\n### java\n\n- jps JAVA \n- jstack <PID> Java PID\n- jconsole Java \n\n### jconsole\n\njava\n\n>java -Djava. rmi. server . hostname=' ip' -Dcom. sun. management . jmxremote -Dcom. sun. management . jmxremote. port=i-Dcom . sun . management . jmxremote.ssl=-Dcom. sun. management .jmxremote .authenticate=    java\n\n/etc/hosts127.0.0.1 \n\n\n- jmxremote.password \n- jmxremote.passwordjmxremote.access600\n- controlRole ()R&D ()\n\n\n\n## \n\n### \n\nJava Virtual Machine Stacks Java \n\n JVM \n\n\n\n- Frame\n\n- \n\n#### \n\n##### \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class Frames {\n    public static void main(String[] args) {\n        method1(10);\n    }\n\n    private static void method1(int x) {\n        int y = x + 1;\n        Object o = method2();\n        System.out.println(o);\n    }\n\n    private static Object method2() {\n        Object o = new Object();\n        return o;\n    }\n}\n\n```\n\n![](thread/cb65fed7-57dd-404b-b4f1-e365dbe83379.png)\n\n![](thread/210feb5c-150a-43c3-8b3d-440f53e343d1.png)\n\nmethod2\n![](thread/52ebada9-ad0c-45fc-9482-40b961c20bbf.png)\n\n![](thread/51e456b2-69ca-4039-8ec3-137a74a3e57d.png)\n\nmethod2 method2\n![](thread/7d8e2e3b-8f62-4e97-86d1-d8ab88b83ca1.png)\n\n![](thread/ca324ec8-b1a0-419a-a962-640dae424e10.png)\n\n\n\n![](thread/3ce55a24-aeb0-4055-9925-c69a63ec9053.png)\n\n##### \n\n``` java\npackage com.wry.concurrent.thread;\n\n/**\n * <p>\n *  \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class Frames2 {\n    public static void main(String[] args) {\n        new Thread(() -> {\n            //t1\n            method1(20);\n        }, \"t1\").start();\n        //main\n        method1(10);\n    }\n\n    private static void method1(int x) {\n        int y = x + 1;\n        Object o = method2();\n        System.out.println(o);\n    }\n\n    private static Object method2() {\n        Object o = new Object();\n        return o;\n    }\n}\n```\n\nt1 \n\n![](thread/815e324a-777f-4b34-b590-acbb4c624cb0.png)\n\n\n\n![](thread/d05f71ef-bbbb-4b19-a804-6444a74de835.png)\n\nmain\n\n![](thread/75442144-d101-4e7a-97ca-c833a2b827fe.png)\nt1\n![](thread/7bf73e18-7259-45da-93c5-a4183062572e.png)\n\n#### \n\n\n\n\n\n### Thread Context Switch\n\n cpu \n\n-  cpu \n\n- \n\n- \n\n-  sleepyieldwaitjoinparksynchronizedlock \n\n Context Switch ``Java `Program Counter Register` jvm \n\n- \n\n- Context Switch \n\n## \n\n| ****       | **static** | ****                                                 | ****                                                     |\n| :--------------- | :--------: | :----------------------------------------------------------- | :----------------------------------------------------------- |\n| start()          |            |  run               | start CPU startIllegalThreadStateExceptio |\n| run()            |            |                                      |  Thread  Runnable  Runnable  run  Thread  |\n| join()           |            |                                              |                                                              |\n| join(long n)     |            | ,n                               |                                                              |\n| getId()          |            |  id                                          | id                                                       |\n| getName()        |            |                                                    |                                                              |\n| setName(String)  |            |                                                    |                                                              |\n| getPriority()    |            |                                                |                                                              |\n| setPriority(int) |            |                                                | java1~10  CPU  |\n| getState()       |            |                                                  | Java  6  enum NEW, RUNNABLE, BLOCKED, WAITING,TIMED_WAITING, TERMINATED |\n| isInterrupted()  |            |                                                | ``                                           |\n| isAlive()        |            | (                                |                                                              |\n| interrupt()      |            |                                                      |  sleepwaitjoin  InterruptedException````park `` |\n| interrupted()    |   static   |                                        | ``                                             |\n| currentThread()  |   static   |                                        |                                                              |\n| sleep(long n)    |   static   | n cpu  |                                                              |\n| yield()          |   static   | CPU                        |                                          |\n\n\n\n## start\n\n### run\n\n``` java\n/**\n * <p>\n *  run \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class RunMethod {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            log.debug(Thread.currentThread().getName());\n            FileReaderUtil.read(Constants.FILE_PATH);\n        }, \"t1\");\n\n        t1.run();\n    }\n}\n\n```\n\nmain \n\n![](thread/4b22adcb-879c-493e-a6dc-7a50426a6db7.png)\n\n### start\n\n``` java\n/**\n * <p>\n *  run \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class RunMethod {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            log.debug(Thread.currentThread().getName());\n            FileReaderUtil.read(Constants.FILE_PATH);\n        }, \"t1\");\n//        //run\n//        t1.run();\n        //start\n        t1.start();\n    }\n}\n```\n\n![](thread/6d0f8427-4068-4a15-a933-cd3f74e28dbf.png)\n\n### \n``` java\n\n    /**\n     * If this thread was constructed using a separate\n     * <code>Runnable</code> run object, then that\n     * <code>Runnable</code> object's <code>run</code> method is called;\n     * otherwise, this method does nothing and returns.\n     * <p>\n     * Subclasses of <code>Thread</code> should override this method.\n     *\n     * @see     #start()\n     * @see     #stop()\n     * @see     #Thread(ThreadGroup, Runnable, String)\n     */\n    @Override\n    public void run() {\n        if (target != null) {\n            target.run();\n        }\n    }\n```\n``` java\n@FunctionalInterface\npublic interface Runnable {\n    /**\n     * When an object implementing interface <code>Runnable</code> is used\n     * to create a thread, starting the thread causes the object's\n     * <code>run</code> method to be called in that separately executing\n     * thread.\n     * <p>\n     * The general contract of the method <code>run</code> is that it may\n     * take any action whatsoever.\n     *\n     * @see     java.lang.Thread#run()\n     */\n    public abstract void run();\n}\n```\nrun() \n\n``` java\n   public synchronized void start() {\n        /**\n         * This method is not invoked for the main method thread or \"system\"\n         * group threads created/set up by the VM. Any new functionality added\n         * to this method in the future may have to also be added to the VM.\n         *\n         * A zero status value corresponds to state \"NEW\".\n         */\n        if (threadStatus != 0)\n            throw new IllegalThreadStateException();\n\n        /* Notify the group that this thread is about to be started\n         * so that it can be added to the group's list of threads\n         * and the group's unstarted count can be decremented. */\n        group.add(this);\n\n        boolean started = false;\n        try {\n            start0();\n            started = true;\n        } finally {\n            try {\n                if (!started) {\n                    group.threadStartFailed(this);\n                }\n            } catch (Throwable ignore) {\n                /* do nothing. If start0 threw a Throwable then\n                  it will be passed up the call stack */\n            }\n        }\n    }\n    \n     private native void start0();\n\n```\n`start()` `start0()``start0()``native`\n\n### \n\n-  run  run\n\n-  start  run \n\n### \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class ThreadStatus {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            System.out.println(\"running.....\");\n        }, \"t1\");\n\n        //\n        System.out.println(\":\"+t1.getState());\n        //start\n        t1.start();\n        //\n        System.out.println(\":\"+t1.getState());\n    }\n}\n```\n\n![](thread/3a071edf-6ded-487b-abbb-d016a9fe6864.png)\n\n### startjava.lang.IllegalThreadStateException\n\n``` java\n//start\nt1.start();\nt1.start();\n```\n\n![](thread/feed6992-8dff-450c-9010-e2f46caf6243.png)\n\n\n\n## **sleep** **** **yield**\n\n### sleep\n\n1.  sleep  *Running*  *Timed Waiting* \n\n``` java\n/**\n * <p>\n *   sleep\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class ThreadMethod {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            try {\n                Thread.sleep(2000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\");\n\n        t1.start();\n        log.debug(\"t1 {}\",t1.getState());\n\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        log.debug(\"t1 {}\",t1.getState());\n    }\n}\n```\n\n![image-20200822234416578](thread/image-20200822234416578.png)\n\n2.  interrupt  sleep  InterruptedException\n\n``` java\n/**\n * <p>\n *  interrupt \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class ThreadMethod2 {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            try {\n                log.debug(\"enter sleep...... \");\n                Thread.sleep(2000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n                log.debug(\"wake up...... \");\n            }\n        }, \"t1\");\n\n        t1.start();\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        t1.interrupt();\n        log.debug(\"interrupt...... \");\n    }\n}\n```\n\n![](thread/81a4db1a-c8d1-47f7-a955-39db726f5173.png)\n\n3. \n\n4.  TimeUnit  sleep  Thread  sleep \n\n``` java\n/**\n * <p>\n *  TimeUnit\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class ThreadMethod3 {\n    public static void main(String[] args) throws InterruptedException {\n        log.debug(\"start ......\");\n        TimeUnit.SECONDS.sleep(1);\n        log.debug(\"end ......\");\n    }\n}\n```\n\n![](thread/f78c9ec4-6379-48de-b2e6-f529bb063540.png)\n\n\n\n### yield\n\n1.  yield  *Running*  *Runnable* \n\n2. \n\n##  \n\nhint\n\n cpu  cpu \n\n### yield\n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class ThreadPriority {\n    public static void main(String[] args) {\n        Runnable task1 = () -> {\n            int count = 0;\n            for (; ; ) {\n                System.out.println(\"---->1 \" + count++);\n            }\n        };\n        Runnable task2 = () -> {\n            int count = 0;\n            for (; ; ) {\n                // Thread.yield();\n                System.out.println(\"        ---->2 \" + count++);\n            }\n        };\n        Thread t1 = new Thread(task1, \"t1\");\n        Thread t2 = new Thread(task2, \"t2\");\n        t1.start();\n        t2.start();\n    }\n}\n```\n\nt1t2 \n\n![](thread/683dd209-d862-46f9-878f-b9e8f4c2db3b.png)\n\n### yield\n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class ThreadPriority {\n    public static void main(String[] args) {\n        Runnable task1 = () -> {\n            int count = 0;\n            for (; ; ) {\n                System.out.println(\"---->1 \" + count++);\n            }\n        };\n        Runnable task2 = () -> {\n            int count = 0;\n            for (; ; ) {\n                //yield,CPU\n                Thread.yield();\n                System.out.println(\"        ---->2 \" + count++);\n            }\n        };\n        Thread t1 = new Thread(task1, \"t1\");\n        Thread t2 = new Thread(task2, \"t2\");\n        t1.start();\n        t2.start();\n    }\n}\n\n```\n\nt1 t2 \n\n![](thread/d37e0c1b-1e69-4360-937a-edf5296f47ce.png)\n\n### \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class ThreadPriority {\n    public static void main(String[] args) {\n        Runnable task1 = () -> {\n            int count = 0;\n            for (; ; ) {\n                System.out.println(\"---->1 \" + count++);\n            }\n        };\n        Runnable task2 = () -> {\n            int count = 0;\n            for (; ; ) {\n                System.out.println(\"        ---->2 \" + count++);\n            }\n        };\n        Thread t1 = new Thread(task1, \"t1\");\n        Thread t2 = new Thread(task2, \"t2\");\n        //t1\n        t1.setPriority(Thread.MIN_PRIORITY);\n        //t2\n        t2.setPriority(Thread.MAX_PRIORITY);\n        \n        t1.start();\n        t2.start();\n    }\n}\n```\n\nt2 t1 \n\n![](thread/2feee3db-6b39-4e1a-9098-1a5f966742f7.png)\n\n##  \n\n### CPU 100%\n\n#### sleep \n\ncpuwhile(rue)cpu,yieldsleepcpu\n\n``` java\nThread t1 = new Thread(() -> {\n            try {\n                Thread.sleep(500);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }   \n        },\"t1\");\n        t1.start();\n```\n\n\n\n- wait\n- I,\n- sleep\n\n##  join\n\n r \n\n### 1 join\n\nJoin\n\n``` java\n/**\n * <p>\n *  join\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class JoinMethod {\n    private static int r = 0;\n\n    private static void test1() {\n        log.debug(\"......\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"......\");\n            try {\n                TimeUnit.SECONDS.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.debug(\"......\");\n            r = 10;\n        },\"t1\");\n        t1.start();\n        log.debug(\":{}\", r);\n        log.debug(\"......\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n```t1`` r `r\n\n![](thread/5cce206b-f24c-4489-afda-57b5a3102172.png)\n\n### \n\n-  t1 t1  1 ` r=10`\n\n-  r  `r=0`\n\n### \n\n-  sleep \n\n  t1,\n\n-  join t1.start() \n\n  `join()`**\"\"** **join()**\n\n``` java\n/**\n * <p>\n *  join\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class JoinMethod {\n    private static int r = 0;\n\n    private static void test1() throws InterruptedException {\n        log.debug(\"......\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"......\");\n            try {\n                TimeUnit.SECONDS.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.debug(\"......\");\n            r = 10;\n        },\"t1\");\n        t1.start();\n        //t1\n        t1.join();\n        log.debug(\":{}\", r);\n        log.debug(\"......\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n![](thread/86d6badd-f76b-4152-8044-bef85f333017.png)\n\n### 2 \n\n\n\n- \n\n- \n\n#### \n\n cost \n\n``` java\n/**\n * <p>\n *  join \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class JoinMethod2 {\n    private static int r1 = 0;\n    private static int r2 = 0;\n\n    private static void test1() throws InterruptedException {\n        log.debug(\"......\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"......\");\n            try {\n                TimeUnit.SECONDS.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.debug(\"......\");\n            r1 = 10;\n        }, \"t1\");\n\n        Thread t2 = new Thread(() -> {\n            log.debug(\"......\");\n            try {\n                TimeUnit.SECONDS.sleep(2);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.debug(\"......\");\n            r2 = 20;\n        }, \"t2\");\n\n        //\n        t1.start();\n        t2.start();\n\n        //\n        long start = System.currentTimeMillis();\n        log.debug(\"join begin ......\");\n        t1.join();\n        log.debug(\"t1 join end ......\");\n        t2.join();\n        log.debug(\"t2 join end ......\");\n        //\n        long end = System.currentTimeMillis();\n        log.debug(\"t1 :{},t2 :{},{}\", r1, r2, end - start);\n        log.debug(\"......\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n\n\n-  join t1 , t2 , \n\n-  join1s , , t2  1s,  1s\n\n![](thread/9372a527-1cf5-4699-9271-f9724c815f24.png)\n\n join \n\n![](thread/b94de8b0-5933-49dc-b0ff-a29a03280074.png)\n\n### 3 \n\n``` java\n/**\n * <p>\n *  join \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class JoinMethod3 {\n    private static int r1 = 0;\n\n    private static void test1() throws InterruptedException {\n        log.debug(\"......\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"......\");\n            try {\n                //2000\n                TimeUnit.MILLISECONDS.sleep(2000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.debug(\"......\");\n            r1 = 10;\n        }, \"t1\");\n\n        //\n        t1.start();\n\n        //\n        long start = System.currentTimeMillis();\n        log.debug(\"join begin ......\");\n        //1500\n        t1.join(1500);\n        log.debug(\"t1 join end ......\");\n        //\n        long end = System.currentTimeMillis();\n        log.debug(\"t1 :{},{}\", r1,  end - start);\n        log.debug(\"......\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n![](thread/44fc6f61-2e64-414e-be76-0486d270b52b.png)\n\njoin\n\n\n\n## interrupt\n\n###   \n\n sleep wait  join  \n\n sleep ,  sleep \n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.util.concurrent.TimeUnit;\n\n/**\n * <p>\n *   interrupt \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            try {\n                TimeUnit.SECONDS.sleep(2);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\");\n        t1.start();\n        log.debug(\"interrupt... \");\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n        log.debug(\" : {}\", t1.isInterrupted());\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\nfalse\n\n![](thread/d9550ede-fad3-4675-8791-3a1237fab0de.png)\n\n###   \n\n``` java\n/**\n * <p>\n *   interrupt \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod2 {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            while (true) {\n               \n            }\n        }, \"t1\");\n\n        t1.start();\n\n        log.debug(\"interrupt... \");\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n        log.debug(\" : {}\", t1.isInterrupted());\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n\n```\n\nt1\n![](thread/c2203c1e-3091-4832-8061-8ba8bc3b24d1.png)\n\n\n\n``` java\n/**\n * <p>\n *   interrupt \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod2 {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            while (true) {\n                boolean isInterrupt = Thread.currentThread().isInterrupted();\n                if (isInterrupt) {\n                    log.debug(\"\");\n                    break;\n                }\n            }\n        }, \"t1\");\n\n        t1.start();\n\n        log.debug(\"interrupt... \");\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n        log.debug(\" : {}\", t1.isInterrupted());\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n\n![](thread/70691192-ef7e-43b6-b365-d139f036e188.png)\n\n###  park:\n\n park , \n\n``` java\n/**\n * <p>\n *   interrupt park\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod3 {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            log.debug(\"park...\");\n            LockSupport.park();\n            log.debug(\"unpark...\");\n            log.debug(\"{}\", Thread.currentThread().isInterrupted());\n        }, \"t1\");\n        t1.start();\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n![](thread/f5e5190c-2ca0-4467-8618-c9084b18b26f.png)\n\npark park\n\n``` java\n/**\n * <p>\n *   interrupt park\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod3 {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            log.debug(\"park...\");\n            LockSupport.park();\n            log.debug(\"unpark...\");\n            log.debug(\"{}\", Thread.currentThread().isInterrupted());\n            //park\n            LockSupport.park();\n            log.debug(\"unpark...\");\n\n        }, \"t1\");\n        t1.start();\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n![](thread/a6cd39b0-e6e9-4b6f-88ea-3cfb0d899b83.png)\n\nThread Thread.interrupted() \n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.util.concurrent.TimeUnit;\nimport java.util.concurrent.locks.LockSupport;\n\n/**\n * <p>\n *   interrupt park\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod3 {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            log.debug(\"park...\");\n            LockSupport.park();\n            log.debug(\"unpark...\");\n            log.debug(\"{}\", Thread.interrupted());\n            //park\n            LockSupport.park();\n            log.debug(\"unpark...\");\n        }, \"t1\");\n        t1.start();\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n\n```\n\n![](thread/bc0f03b1-c84a-45af-879e-4bdc0f0ff35e.png)\n\n## \n\n### Two Phase Termination\n\nT1T2?\n\nT2\n\n#### \n\n- stop():\n  - stop \n-  System.exit(int)\n  - \n\n### \n\n2s\n\n![](thread/e1c2fc78-6f75-4049-8631-1e2bf400e92b.png)\n\n### \n\n``` java\n/**\n * <p>\n * interrupt\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class TwoPhaseTermination {\n    private Thread monitor;\n\n    /**\n     * \n     */\n    private void start() {\n        monitor = new Thread(() -> {\n            while (true) {\n                Thread currentThread = Thread.currentThread();\n                if (currentThread.isInterrupted()){\n                    log.debug(\"\");\n                    break;\n                }\n                try {\n                    TimeUnit.SECONDS.sleep(1); //  \n                    log.debug(\"\"); //\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                    //,\n                    currentThread.interrupt();\n                }\n            }\n        });\n\n        monitor.start();\n    }\n\n    /**\n     * \n     */\n    private void stop() {\n        monitor.interrupt();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        TwoPhaseTermination termination = new TwoPhaseTermination();\n        termination.start();\n\n        TimeUnit.SECONDS.sleep(3);\n        termination.stop();\n    }\n}\n```\n\n![](thread/d1df5ae9-03d4-4960-a460-86c4eb4f13d9.png)\n\n\n\n## \n\n\n\n|     |  |              |\n| --------- | ---- | -------------------- |\n| stop()    |      |          |\n| suspend() |      |  |\n| resume()  |      |          |\n\n## \n\nJava \n\n``` java\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class DaemonThread {\n    private static void test1() throws InterruptedException {\n        log.debug(\"...\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"...\");\n            while (true) {\n                if (Thread.currentThread().isInterrupted()) {\n                    break;\n                }\n            }\n            log.debug(\"...\");\n        }, \"t1\");\n        t1.start();\n        TimeUnit.SECONDS.sleep(1);\n        log.debug(\"...\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n\n```\n\n`main``t1``java `\n![](thread/0e59c147-a499-4226-bf3b-d6f0a4cabd5a.png)\n\n`setDaemon(boolean)`t1\n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class DaemonThread {\n    private static void test1() throws InterruptedException {\n        log.debug(\"...\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"...\");\n            while (true) {\n                if (Thread.currentThread().isInterrupted()) {\n                    break;\n                }\n            }\n            log.debug(\"...\");\n        }, \"t1\");\n        // \n        t1.setDaemon(true);\n        t1.start();\n        TimeUnit.SECONDS.sleep(1);\n        log.debug(\"...\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n`main``t1`\n\n![](thread/ea4c56c3-75b1-48fa-a40e-dcb6dd63823f.png)\n\n>****\n>\n>- \n>\n>- Tomcat ` Acceptor ` `Poller ` Tomcat  shutdown \n\n## \n\n **** \n\n![](thread/d3f13fb8-e2e2-4692-8b27-2ca13a87ec1a.png)\n\n- \n\n-  CPU \n\n-  CPU \n\n  -  CPU \n\n- \n\n  -  API BIO  CPU\n\n  -  BIO \n\n  - \n\n- \n\n## \n\n **Java API** \n\n Thread.State \n\n``` java\n    public enum State {\n        /**\n         * Thread state for a thread which has not yet started.\n         */\n        NEW,\n\n        /**\n         * Thread state for a runnable thread.  A thread in the runnable\n         * state is executing in the Java virtual machine but it may\n         * be waiting for other resources from the operating system\n         * such as processor.\n         */\n        RUNNABLE,\n\n        /**\n         * Thread state for a thread blocked waiting for a monitor lock.\n         * A thread in the blocked state is waiting for a monitor lock\n         * to enter a synchronized block/method or\n         * reenter a synchronized block/method after calling\n         * {@link Object#wait() Object.wait}.\n         */\n        BLOCKED,\n\n        /**\n         * Thread state for a waiting thread.\n         * A thread is in the waiting state due to calling one of the\n         * following methods:\n         * <ul>\n         *   <li>{@link Object#wait() Object.wait} with no timeout</li>\n         *   <li>{@link #join() Thread.join} with no timeout</li>\n         *   <li>{@link LockSupport#park() LockSupport.park}</li>\n         * </ul>\n         *\n         * <p>A thread in the waiting state is waiting for another thread to\n         * perform a particular action.\n         *\n         * For example, a thread that has called <tt>Object.wait()</tt>\n         * on an object is waiting for another thread to call\n         * <tt>Object.notify()</tt> or <tt>Object.notifyAll()</tt> on\n         * that object. A thread that has called <tt>Thread.join()</tt>\n         * is waiting for a specified thread to terminate.\n         */\n        WAITING,\n\n        /**\n         * Thread state for a waiting thread with a specified waiting time.\n         * A thread is in the timed waiting state due to calling one of\n         * the following methods with a specified positive waiting time:\n         * <ul>\n         *   <li>{@link #sleep Thread.sleep}</li>\n         *   <li>{@link Object#wait(long) Object.wait} with timeout</li>\n         *   <li>{@link #join(long) Thread.join} with timeout</li>\n         *   <li>{@link LockSupport#parkNanos LockSupport.parkNanos}</li>\n         *   <li>{@link LockSupport#parkUntil LockSupport.parkUntil}</li>\n         * </ul>\n         */\n        TIMED_WAITING,\n\n        /**\n         * Thread state for a terminated thread.\n         * The thread has completed execution.\n         */\n        TERMINATED;\n    }\n```\n\n\n\n![](thread/0827c261-3195-4bdc-9b78-e0c664037749.png)\n\n- NEW  start() \n\n- RUNNABLE  start() **Java API**  RUNNABLE  **** \n  -  BIO  Java \n\n- BLOCKED  WAITING  TIMED_WAITING  **Java API** \n\n- TERMINATED \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class ThreadState {\n    private static void test1() {\n        Thread t1 = new Thread(() -> {  //new\n            log.debug(\"runing......\");\n        }, \"t1\");\n\n        Thread t2 = new Thread(() -> {  //running\n           while (true){\n\n           }\n        },\"t2\");\n        t2.start();\n\n        Thread t3 = new Thread(() -> {  //terminted\n            log.debug(\"runing......\");\n        },\"t3\");\n        t3.start();\n\n        Thread t4 = new Thread(() -> {  //timed_waiting\n            synchronized (ThreadState.class) {\n                try {\n                    TimeUnit.SECONDS.sleep(100);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        },\"t4\");\n        t4.start();\n\n        Thread t5 = new Thread(() -> {  //waiting\n                try {\n                    t2.join();\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n        },\"t5\");\n        t5.start();\n\n        Thread t6 = new Thread(() -> {  //blocked\n            synchronized (ThreadState.class) {\n                try {\n                    TimeUnit.SECONDS.sleep(100);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        },\"t6\");\n        t6.start();\n\n        log.debug(\"t1  {}\",t1.getState());\n        log.debug(\"t2  {}\",t2.getState());\n        log.debug(\"t3  {}\",t3.getState());\n        log.debug(\"t4  {}\",t4.getState());\n        log.debug(\"t5  {}\",t5.getState());\n        log.debug(\"t6  {}\",t6.getState());\n\n        \n    }\n\n    public static void main(String[] args) {\n        test1();\n    }\n}\n\n```\n\n![](thread/d1f13ce8-f7cb-4cf1-b2aa-6e8d7204a459.png)\n\n## \n\n### \n\n\n\n- \n  - \n  -  4 \n-  sleep(n) \n\n\n\n>\n>\n>\n>\n>\n>\n> 1 \n>\n> 15\n>\n> 1\n>\n> 2\n>\n> 1\n>\n>\n>\n>\n>\n>\n>\n>- \n>\n>\n>\n>- \n>\n>\n>\n>- \n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>![image-20200806070304756](thread/image-20200806070304756.png)\n>\n>1620\n>\n>4\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>![image-20200806070323056](thread/image-20200806070323056.png)\n>\n>\n>\n>\n>\n>\n\n### \n\n``` java\n/**\n * <p>\n * ,\n *\n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\n@Slf4j\npublic class MakingTea {\n    /**\n     * t2  t1  \n     */\n    private static void t1() {\n        Thread t1 = new Thread(() -> {\n            log.info(\"\");\n            try {\n                TimeUnit.SECONDS.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.info(\"\");\n            try {\n                TimeUnit.SECONDS.sleep(5);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\");\n        t1.start();\n\n        Thread t2 = new Thread(() -> {\n            try {\n                log.info(\"\");\n                TimeUnit.SECONDS.sleep(5);\n\n                //t1\n                t1.join();\n                log.info(\"\");\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t2\");\n        t2.start();\n    }\n\n    public static void main(String[] args) {\n        t1();\n    }\n}\n\n```\n\n![image-20200806072602725](thread/image-20200806072602725.png)\n\n## \n\n\n\n- \n\n-  api startrunsleepjoininterrupt \n\n- \n\n- \n\n  - \n\n  - \n\n  - join\n\n  - \n\n- \n\n  - \n\n  - Thread  \n\n- \n  - \n\n\n\n# \n\n## \n\n### \n\n- CPU\n\n  ![image-20200806080136510](thread/image-20200806080136510.png)\n\n- \n\n- 24sleep io wait\n\n  ![image-20200806080218070](thread/image-20200806080218070.png)\n\n- \n\n- \n\n-  [  ]\n\n- \n\n- \n\n  \n\n- \n\n  ![image-20200806080338819](thread/image-20200806080338819.png)\n\n- \n\n-  0  +1 \n\n-  [  ] [ 11...] \n\n-  [  ] 0  -1  -1 \n\n- [] 1 \n\n  ![image-20200806080425078](thread/image-20200806080425078.png)\n\n-  1  0\n\n### Java\n\n 0  5000  0 \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\n@Slf4j\npublic class SharedVariables {\n    private static int counter = 0;\n    \n    /**\n     * \n     */\n    private static void t1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                counter++;\n            }\n        }, \"t1\");\n        t1.start();\n\n        Thread t2 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                counter--;\n            }\n        }, \"t2\");\n        t2.start();\n\n        t1.join();\n        t2.join();\n\n        log.info(\"counter:{}\", counter);\n    }\n\n    public static void main(String[] args) {\n        t1();\n    }\n}\n```\n\n\n\n### \n\n Java \n\n i++ i  JVM \n\n```\ngetstatic i // i\niconst_1 // 1\niadd // \nputstatic i // i\n```\n\n i-- :\n\n```\ngetstatic i // i\niconst_1 // 1\nisub // \nputstatic i // i\n```\n\n Java \n\n![image-20200806081215362](thread/image-20200806081215362.png)\n\n 8 \n\n![image-20200806081309415](thread/image-20200806081309415.png)\n\n 8 \n\n\n\n![image-20200806081339039](thread/image-20200806081339039.png)\n\n\n\n![image-20200806081409317](thread/image-20200806081409317.png)\n\n### (Critical Section)\n\n- \n\n- ****\n\n  - ****\n\n  - ****\n\n- ********\n\n:\n\n``` java\nstatic int counter = 0;\nstatic void increment() \n// \n{ \n counter++; \n}\nstatic void decrement() \n// \n{ \n counter--; \n}\n```\n\n### (Race Condition)\n\n********\n\n##  synchronized\n\n### ***** ****\n\n\n\n- synchronizedLock\n\n- \n\nsynchronized\n\n\n\n\n\n>****\n>\n> java  synchronized \n>\n>\n>\n>\n\n### synchronized\n\n#### \n\n``` java\nsynchronized() // 1 2(blocked)\n{\n \n}\n```\n\n#### \n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\n@Slf4j\npublic class SharedVariables {\n    private static int counter = 0;\n    private static Object lock = new Object();\n\n    /**\n     * \n     * synchronized\n     */\n    private static void t2() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                synchronized (lock) {\n                    counter++;\n                }\n            }\n        }, \"t1\");\n        t1.start();\n\n        Thread t2 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                synchronized (lock) {\n                    counter--;\n                }\n            }\n        }, \"t2\");\n        t2.start();\n\n        t1.join();\n        t2.join();\n        log.info(\"counter:{}\", counter);\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        t2();\n    }\n}\n\n```\n\n \n\n``` java\n/**\n * <p>\n * ,\n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\n@Slf4j\npublic class Room {\n    private int counter = 0;\n\n    public void increment() {\n        synchronized (this) {\n            counter++;\n        }\n    }\n\n    public void decrement() {\n        synchronized (this) {\n            counter--;\n        }\n    }\n\n    public int getCounter() {\n        synchronized (this) {\n            return counter;\n        }\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        Room room = new Room();\n        Thread t1 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                room.increment();\n            }\n        }, \"t1\");\n        t1.start();\n\n        Thread t2 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                room.decrement();\n            }\n        }, \"t2\");\n        t2.start();\n\n        t1.join();\n        t2.join();\n\n        log.info(\"counter:{}\", room.getCounter());\n    }\n}\n```\n\n\n\n![image-20200806093605366](thread/image-20200806093605366.png)\n\n\n\n- `synchronized()` room t1t2 \n\n-  t1  `synchronized(room)`  t1 `count++` \n\n-  t2  `synchronized(room)` \n\n-  t1  cpu t1 t2  t1 \n\n-  t1  `synchronized{}`  obj  t2 t2  obj  `count--` \n\n\n\n:\n\n![image-20200806093649652](thread/image-20200806093649652.png)\n\n### \n\n`synchronized` ********\n\n:\n\n-  synchronized(obj)  for -- \n\n-  t1 synchronized(obj1)  t2 synchronized(obj2) -- \n\n-  t1 synchronized(obj)  t2 -- \n\n\n\n## synchronized\n\n`synchronized```\n\n``` java\nclass Test {\n    public synchronized void test() {\n\n    }\n}\n\n//\n\nclass Test {\n    public void test() {\n        synchronized (this) {\n\n        }\n    }\n}\n```\n\n`synchronized```\n\n``` java\n\nclass Test{\n    public synchronized static void test() {\n    }\n}\n\n//\n\nclass Test {\n    public static void test() {\n        synchronized (Test.class) {\n\n        }\n    }\n}\n```\n\n### synchronized\n\n synchronzied \n\n### \n\n synchronized \n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\n/**\n * <p>\n *  8\n * </p>\n * <p>\n * <strong> synchronized </strong>\n * <strong>  </strong><strong></strong>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\n@Slf4j\npublic class Thread8Locks {\n    public static void main(String[] args) {\n//        t1();\n//        t2();\n//        t3();\n//        t4();\n//        t5();\n//        t6();\n//        t7();\n//        t8();\n    }\n\n    /**\n     * \n     * t1, 1 2\n     * t2, 2 1\n     */\n    private static void t1() {\n        Number1 n = new Number1();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.a();\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.b();\n        }, \"t2\").start();\n    }\n\n    /**\n     * \n     * t1,1s 1 2\n     * t2, 2 1s 1\n     */\n    private static void t2() {\n        Number2 n = new Number2();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                n.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.b();\n        }, \"t2\").start();\n    }\n\n    /**\n     * \n     * c\n     * t3 3\n     * t1,t3,t2,1s 1 2  ; 3,1s,1,2\n     * t2,t3,t1, 2 1s 1; 2,3,1s,1\n     * t3,t1,t2,1s2 1; 3,1s,1,2\n     * t3,t2,t1 2 1s 1; 3,2,1s,1\n     */\n    private static void t3() {\n        Number3 n = new Number3();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                n.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.b();\n        }, \"t2\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.c();\n        }, \"t3\").start();\n    }\n\n\n    /**\n     * \n     * t1  t2 \n     * t1,t2,21s1; 2,1s,1\n     * t2,t1,21s1; 2,1s,1\n     */\n    private static void t4() {\n        Number4 n1 = new Number4();\n        Number4 n2 = new Number4();\n        new Thread(() -> {\n            try {\n                n1.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            n2.b();\n        }, \"t2\").start();\n    }\n\n\n    /**\n     * a\n     * b\n     * t1  t2 \n     * t1,t2,21s1; 2,1s,1\n     * t2,t1,21s1; 2,1s,1\n     */\n    private static void t5() {\n        Number5 n = new Number5();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                Number5.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.b();\n        }, \"t2\").start();\n    }\n\n\n    /**\n     * \n     * t1,t2,1s12; 1s,1,2\n     * t2,t1,21s1; 2,1s,1\n     */\n    private static void t6() {\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                Number6.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            Number6.b();\n        }, \"t2\").start();\n    }\n\n\n    /**\n     * a\n     * b\n     * t1  t2 \n     * t1,t2,21s1; 2,1s,1\n     * t2,t1,21s1; 2,1s,1\n     */\n    private static void t7() {\n        Number7 n1 = new Number7();\n        Number7 n2 = new Number7();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                n1.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n2.b();\n        }, \"t2\").start();\n    }\n\n\n    /**\n     * \n     * t1,t2,1s12; 1s,1,2\n     * t2,t1,21s1; 2,1s,1\n     */\n    private static void t8() {\n        Number8 n = new Number8();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                n.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.b();\n        }, \"t2\").start();\n    }\n\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number1\")\nclass Number1 {\n    public synchronized void a() {\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number2\")\nclass Number2 {\n    public synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number3\")\nclass Number3 {\n    public synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n\n    public void c() {\n        log.debug(\"3\");\n    }\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number4\")\nclass Number4 {\n    public synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n\n}\n\n/**\n * a\n * b\n */\n@Slf4j(topic = \"c.Number5\")\nclass Number5 {\n    public static synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number6\")\nclass Number6 {\n    public static synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public static synchronized void b() {\n        log.debug(\"2\");\n    }\n\n}\n\n/**\n * a\n * b\n */\n@Slf4j(topic = \"c.Number7\")\nclass Number7 {\n    public static synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number8\")\nclass Number8 {\n    public static synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public static synchronized void b() {\n        log.debug(\"2\");\n    }\n\n}\n\n```\n\n\n\n## \n\n#### \n\n- \n\n- \n\n  - \n\n  - \n\n#### \n\n- \n\n- \n\n  - \n\n  - \n\n``` java\npublic static void test1() {\n\tint i = 10;\n\ti++; \n}\n```\n\n test1()  i.\n\n```\npublic static void test1();\n descriptor: ()V\n flags: ACC_PUBLIC, ACC_STATIC\n Code:\n stack=1, locals=1, args_size=0\n 0: bipush 10\n 2: istore_0\n 3: iinc 0, 1\n 6: return\n LineNumberTable:\n line 10: 0\n line 11: 3\n line 12: 6\n LocalVariableTable:\n Start Length Slot Name Signature\n 3 4 0 i I\n```\n\n![image-20200806112353892](thread/image-20200806112353892.png)\n\n\n\n**,**\n\n``` java\n/**\n * <p>\n *\n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\npublic class ThreadSecurity {\n    static final int THREAD_NUMBER = 2;\n    static final int LOOP_NUMBER = 200;\n\n    public static void main(String[] args) {\n        ThreadUnsafe test = new ThreadUnsafe();\n        for (int i = 0; i < THREAD_NUMBER; i++) {\n            new Thread(() -> {\n                test.method1(LOOP_NUMBER);\n            }, \"Thread\" + i).start();\n        }\n    }\n}\nclass ThreadUnsafe {\n    ArrayList<String> list = new ArrayList<>();\n    public void method1(int loopNumber) {\n        for (int i = 0; i < loopNumber; i++) {\n            // { , \n            method2();\n            method3();\n            // } \n        }\n    }\n    private void method2() {\n        list.add(\"1\");\n    }\n    private void method3() {\n        list.remove(0);\n    }\n}\n```\n\n**2  add1 remove **\n\n![image-20200806113017975](thread/image-20200806113017975.png)\n\n\n\n-  method2  list \n\n- method3  method2 \n\n  ![image-20200806113212737](thread/image-20200806113212737.png)\n\n  ** list **\n\n``` java\npackage com.wry.concurrent.thread;\n\nimport java.util.ArrayList;\n\n/**\n * <p>\n *\n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\npublic class ThreadSecurity {\n    static final int THREAD_NUMBER = 2;\n    static final int LOOP_NUMBER = 200;\n\n    public static void main(String[] args) {\n        Threadsafe test = new Threadsafe();\n        for (int i = 0; i < THREAD_NUMBER; i++) {\n            new Thread(() -> {\n                test.method1(LOOP_NUMBER);\n            }, \"Thread\" + i).start();\n        }\n    }\n}\nclass Threadsafe {\n\n    public void method1(int loopNumber) {\n        ArrayList<String> list = new ArrayList<>();\n        for (int i = 0; i < loopNumber; i++) {\n            // { , \n            method2(list);\n            method3(list);\n            // } \n        }\n    }\n    private void method2(ArrayList<String> list) {\n        list.add(\"1\");\n    }\n    private void method3(ArrayList<String> list) {\n        list.remove(0);\n    }\n}\n```\n\n\n\n\n\n- list \n\n-  method2  method1  method1 \n\n- method3  method2 \n\n![image-20200806113622053](thread/image-20200806113622053.png)\n\n method2  method3  public \n\n- 1 method2  method3\n\n  ``` java\n  /**\n   * <p>\n   *\n   * </p>\n   *\n   * @author wangruiyu\n   * @since 2020/8/6\n   */\n  public class ThreadSecurity2 {\n      static final int THREAD_NUMBER = 2;\n      static final int LOOP_NUMBER = 200;\n  \n      public static void main(String[] args) {\n  \n          Threadsafe2 test = new Threadsafe2();\n          for (int i = 0; i < THREAD_NUMBER; i++) {\n              new Thread(() -> {\n                  test.method1(LOOP_NUMBER);\n              }, \"Thread\" + i).start();\n          }\n      }\n  }\n  \n  class Threadsafe2 {\n  \n      public void method1(int loopNumber) {\n          ArrayList<String> list = new ArrayList<>();\n          for (int i = 0; i < loopNumber; i++) {\n              // { , \n              method2(list);\n              method3(list);\n              // } \n          }\n      }\n      public void method2(ArrayList<String> list) {\n          list.add(\"1\");\n      }\n      public void method3(ArrayList<String> list) {\n          list.remove(0);\n      }\n  }\n  ```\n\n  `method2``method3``method1`list \n\n- 2 1  ThreadSafe  method2  method3 \n\n  ``` java\n  \n  /**\n   * <p>\n   *\n   * </p>\n   *\n   * @author wangruiyu\n   * @since 2020/8/6\n   */\n  public class ThreadSecurity2 {\n      static final int THREAD_NUMBER = 2;\n      static final int LOOP_NUMBER = 200;\n  \n      public static void main(String[] args) {\n  \n          ThreadSafeSubClass test = new ThreadSafeSubClass();\n          for (int i = 0; i < THREAD_NUMBER; i++) {\n              new Thread(() -> {\n                  test.method1(LOOP_NUMBER);\n              }, \"Thread\" + i).start();\n          }\n      }\n  }\n  \n  class Threadsafe2 {\n  \n      public void method1(int loopNumber) {\n          ArrayList<String> list = new ArrayList<>();\n          for (int i = 0; i < loopNumber; i++) {\n              // { , \n              method2(list);\n              method3(list);\n              // } \n          }\n      }\n      public void method2(ArrayList<String> list) {\n          list.add(\"1\");\n      }\n      public void method3(ArrayList<String> list) {\n          list.remove(0);\n      }\n  }\n  \n  class ThreadSafeSubClass extends Threadsafe2{\n      @Override\n      public void method3(ArrayList<String> list) {\n          new Thread(() -> {\n              list.remove(0);\n          }).start();\n      }\n  }\n  ```\n\n- ![image-20200806115634318](thread/image-20200806115634318.png)\n\n\n\n** private  final **\n\n#### \n\n- String\n\n- Integer\n\n- StringBuffffer\n\n- Random\n\n- Vector\n\n- Hashtable\n\n- JAVA.util.concurrent \n\n\n\n``` java\nHashtable table = new Hashtable();\n\nnew Thread(()->{\n table.put(\"key\", \"value1\");\n}).start();\n\nnew Thread(()->{\n table.put(\"key\", \"value2\");\n}).start()\n```\n\n- \n\n- ****\n\n##### \n\n\n\n``` java\nHashtable table = new Hashtable();\n// 12\nif( table.get(\"key\") == null) {\n table.put(\"key\", value);\n}\n```\n\n![image-20200818213438504](thread/image-20200818213438504.png)\n\n##### \n\nStringInteger \n\nString  replacesubstring \n\n\n\n``` java\npublic class Immutable{\n    \n private int value = 0;\n    \n public Immutable(int value){\n \tthis.value = value;\n }\n public int getValue(){\n \treturn this.value;\n }\n}\n```\n\n\n\n``` java\npublic class Immutable{\n    \n private int value = 0;\n    \n public Immutable(int value){\n \tthis.value = value;\n }\n public int getValue(){\n \treturn this.value;\n }\n \n public Immutable add(int v){\n \treturn new Immutable(this.value + v);\n } \n}\n```\n\n#### \n\n##### \n\n\n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Random;\nimport java.util.concurrent.CopyOnWriteArrayList;\n\n/**\n * <p>\n *    -   \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/17\n */\n@Slf4j\npublic class ExerciseSell {\n    public static void main(String[] args) {\n        //\n        TicketWindows ticketWindows = new TicketWindows(2000);\n        //\n        List<Integer> list = new CopyOnWriteArrayList<>();\n        //\n        List<Thread> threadList = new ArrayList<>();\n        for (int i = 0; i < 4000; i++) {\n            Thread thread = new Thread(() -> {\n                //\n                int sell = ticketWindows.sell(randomAmount());\n                list.add(sell);\n            });\n            thread.start();\n            threadList.add(thread);\n        }\n\n        //\n        threadList.forEach(thread -> {\n            try {\n                thread.join();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        });\n        //\n        log.info(\"{}\", ticketWindows.getCount());\n        log.info(\"{}\", list.stream().mapToInt(Integer::intValue).sum());\n    }\n\n    //Random \n    static Random random = new Random();\n\n    //15\n    private static int randomAmount() {\n        return random.nextInt(5) + 1;\n    }\n}\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/17\n */\nclass TicketWindows {\n    private int count;\n\n    public TicketWindows(int count) {\n        this.count = count;\n    }\n\n    public int getCount() {\n        return count;\n    }\n\n    public int sell(int amount) {\n\n        if (count >= amount) {\n            synchronized (this) {\n                count -= amount;\n            }\n            return amount;\n        }\n        return 0;\n\n    }\n}\n\n```\n\n##### \n\n\n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.util.Random;\n\n/**\n * <p>\n *   -   \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/17\n */\n@Slf4j\npublic class ExceriseTransfer {\n    public static void main(String[] args) throws InterruptedException {\n        Account a = new Account(1000);\n        Account b = new Account(1000);\n        Thread threadA = new Thread(() -> {\n            for (int i = 0; i < 1000; i++) {\n                a.transfer(b, randomAmount());\n            }\n        });\n        Thread threadB = new Thread(() -> {\n            for (int i = 0; i < 1000; i++) {\n                b.transfer(a, randomAmount());\n            }\n        });\n        threadA.start();\n        threadB.start();\n        threadA.join();\n        threadB.join();\n        //\n        log.info(\"A {}\", a.getMoney());\n        log.info(\"B {}\", b.getMoney());\n    }\n\n\n    //Random \n    static Random random = new Random();\n\n    //1100\n    private static int randomAmount() {\n        return random.nextInt(100) + 1;\n    }\n}\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/17\n */\nclass Account {\n    private int money;\n\n    public Account(int money) {\n        this.money = money;\n    }\n\n    public int getMoney() {\n        return money;\n    }\n\n    public void setMoney(int money) {\n        this.money = money;\n    }\n\n    /**\n     * \n     *\n     * @param account \n     * @param money   \n     */\n    public void transfer(Account account, int money) {\n        synchronized (Account.class) {\n            if (this.money >= money) {\n                account.setMoney(account.getMoney() + money);\n                this.setMoney(this.getMoney() - money);\n            }\n        }\n    }\n//    //synchronized  \n//    public synchronized  void transfer(Account account, int money) {\n//          if (this.money >= money) {\n//              account.setMoney(account.getMoney() + money);\n//              this.setMoney(this.getMoney() - money);\n//          }\n//    }\n}\n\n```\n\n## Monitor\n\n### Java\n\n 32 \n\n#### \n\n```ruby\n|--------------------------------------------------------------| \n| \t\t\t\t\tObject Header (64 bits)\t\t \t\t       |\n|------------------------------------|-------------------------| \n|\t\t Mark Word (32 bits) \t     | Klass Word (32 bits)    |\n|------------------------------------|-------------------------|\n```\n\n#### \n\n```ruby\n|---------------------------------------------------------------------------------|\n| \t\t\t\t\t\t\t\tObject Header (96 bits)\t\t\t \t\t\t\t  |\n|--------------------------------|-----------------------|------------------------|\n| \t\t\tMark Word(32bits) \t | \tKlass Word(32bits)   | array length(32bits)   |\n|--------------------------------|-----------------------|------------------------|\n```\n\n Mark Word \n\n```ruby\n|-------------------------------------------------------|--------------------|\n| \t\t\t\t\tMark Word (32 bits)\t\t\t\t\t| \t\tState\t\t |\n|-------------------------------------------------------|--------------------|\n| \t\t  hashcode:25 | age:4 | biased_lock:0 \t| 01\t| \t\tNormal\t\t |\n|-------------------------------------------------------|--------------------|\n| thread:23 | epoch:2 | age:4 | biased_lock:1 \t| 01\t| \t\tBiased\t\t |\n|-------------------------------------------------------|--------------------|\n| \t\tptr_to_lock_record:30 \t\t\t\t\t| 00 \t| Lightweight Locked |\n|-------------------------------------------------------|--------------------|\n| \t\tptr_to_heavyweight_monitor:30 \t\t\t| 10 \t| Heavyweight Locked |\n|-------------------------------------------------------|--------------------|\n| \t\t\t\t\t\t\t\t\t\t\t\t| 11\t|\t Marked for GC\t |\n|-------------------------------------------------------|--------------------|\n```\n\n\n\n64  Mark Word\n\n```ruby\n|--------------------------------------------------------------------|--------------------|\n| \t\t\t\t\t\t\tMark Word (64 bits) \t\t\t\t\t | \t\t  State  \t  |\n|--------------------------------------------------------------------|--------------------|\n|  unused:25 | hashcode:31 | unused:1 | age:4 | biased_lock:0 |  01  | \t\t  Normal\t  |\n|--------------------------------------------------------------------|--------------------|\n|  thread:54 | epoch:2     | unused:1 | age:4 | biased_lock:1 |  01  | \t\t  Biased\t  |\n|--------------------------------------------------------------------|--------------------|\n| \t\tptr_to_lock_record:62\t\t\t\t\t\t\t\t  |  00  | Lightweight Locked |\n|--------------------------------------------------------------------|--------------------|\n| \t\tptr_to_heavyweight_monitor:62 \t\t\t\t\t\t  |  10  | Heavyweight Locked |\n|--------------------------------------------------------------------|--------------------|\n| \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  |  11  | \tMarked for GC\t  |\n|--------------------------------------------------------------------|--------------------|\n```\n\n****\n\nhttps://stackoverflflow.com/questions/26357186/what-is-in-java-object-header\n\n## Monitor()\n\n### Monitor\n\nMonitor ********\n\n Java  Monitor  synchronized Mark Word  Monitor Monitor \n\n![image-20200819064936628](thread/image-20200819064936628.png)\n\n\n\n-  Monitor  Owner  null\n\n-  Thread-2  synchronized(obj)  Monitor  Owner  Thread-2Monitor Owner\n\n-  Thread-2  Thread-3Thread-4Thread-5  synchronized(obj)EntryList BLOCKED\n\n- Thread-2  EntryList \n\n-  WaitSet  Thread-0Thread-1  WAITING wait-notify \n\n>****\n>\n>synchronized  monitor \n>\n> synchronized \n\n##  synchronized\n\n****\n\n\n\n-  - JVM\n\n-  - \n\n-  - \n\n-  - \n\n-  -  - Monitor\n\n-  -  - \n\n-  -  - \n\n-  -  20 \n\n-  - \n\n\n\n\n\n\n\n\n\n\n\n 20 \n\n### synchronized\n\n``` java\nstatic final Object lock = new Object();\n\nstatic int counter = 0;\n\npublic static void main(String[] args) {\n synchronized (lock) {\n \tcounter++;\n }\n}\n```\n\n\n\n``` java\npublic static void main(java.lang.String[]);\n descriptor: ([Ljava/lang/String;)V\n flags: ACC_PUBLIC, ACC_STATIC\n Code:\n stack=2, locals=3, args_size=1\n 0: getstatic #2 // <- lock synchronized\n 3: dup\n 4: astore_1 // lock -> slot 1\n 5: monitorenter //  lock MarkWord  Monitor \n 6: getstatic #3 // <- i\n 9: iconst_1 //  1\n 10: iadd // +1\n 11: putstatic #3 // -> i\n 14: aload_1 // <- lock\n 15: monitorexit //  lock MarkWord ,  EntryList\n 16: goto 24\n 19: astore_2 // e -> slot 2 \n 20: aload_1 // <- lock\n 21: monitorexit //  lock MarkWord ,  EntryList\n 22: aload_2 // <- slot 2 (e)\n 23: athrow // throw e\n 24: return\n Exception table:\n from to target type\n 6 16 19 any\n 19 22 19 any\n LineNumberTable:\n line 8: 0\n line 9: 6\n line 10: 14\n line 11: 24\n LocalVariableTable:\n Start Length Slot Name Signature\n 0 25 0 args [Ljava/lang/String;\n StackMapTable: number_of_entries = 2\n frame_type = 255 /* full_frame */\n offset_delta = 19\n locals = [ class \"[Ljava/lang/String;\", class java/lang/Object ]\n stack = [ class java/lang/Throwable ]\n frame_type = 250 /* chop */\n offset_delta = 4              \n```\n\n\n\n>****\n>\n> synchronized \n\n### synchronized\n\n#### 1.\n\n\n\n `synchronized`\n\n\n\n``` java\nstatic final Object obj = new Object();\n\npublic static void method1() {\n synchronized( obj ) {\n //  A\n method2();\n }\n}\npublic static void method2() {\n synchronized( obj ) {\n //  B\n }\n}\n```\n\n- Lock RecordMark Word\n\n![image-20200819065515918](thread/image-20200819065515918.png)\n\n-  Object reference  cas  Object  Mark Word Mark Word \n\n  ![image-20200819065601188](thread/image-20200819065601188.png)\n\n -  cas   00 \n\n   ![image-20200819065708766](thread/image-20200819065708766.png)\n\n-  cas \n\n  -  Object \n  -  synchronized  Lock Record \n\n  ![image-20200819065835524](thread/image-20200819065835524.png)\n\n-  synchronized  null \n\n  ![image-20200819065931928](thread/image-20200819065931928.png)\n\n-  synchronized  null cas  Mark Word \n\n  - \n  - \n\n#### 2.\n\nCAS \n\n``` java\nstatic Object obj = new Object();\n\npublic static void method1() {\n synchronized( obj ) {\n // \n }\n}\n```\n\n-  Thread-1 Thread-0 \n\n  ![image-20200819071006301](thread/image-20200819071006301.png)\n\n-  Thread-1 \n\n  -  Object  `Monitor`  Object \n  -  `Monitor`  `EntryList` BLOCKED\n\n![image-20200819071139042](thread/image-20200819071139042.png)\n\n-  Thread-0  cas  Mark Word  Monitor  Monitor  Owner  null EntryList  BLOCKED \n\n#### 3.\n\n\n\n\n\n| **** **1** ******core 1** **** | **** **Mark**      | **** **2** ******core 2** **** |\n| ---------------------------------------- | ---------------------- | ---------------------------------------- |\n| -                                        | 10           | -                                        |\n|  monitor                 | 10 | -                                        |\n|                              | 10 | -                                        |\n|                                | 10 |                                          |\n|                                | 10 |  monitor                 |\n|                                | 10 |                                  |\n|                                  | 10 |                                  |\n|                              | 01             |                                  |\n| -                                        | 10 |                              |\n| -                                        | 10 |                                |\n| -                                        | 10 |                                |\n| ...                                      | ....                   | ....                                     |\n\n\n\n| **** **1** ******core 1** **** | **** **Mark**        | **** **2** ******core 2** **** |\n| ---------------------------------------- | ------------------------ | ---------------------------------------- |\n| -                                        | 10             | -                                        |\n|  monitor                 | 10   | -                                        |\n|                              | 10   | -                                        |\n|                                | 10   |                                          |\n|                                | 10   |  monitor                 |\n|                                | 10   |                                  |\n|                                | 10   |                                  |\n|                                | 10 |                                  |\n|                                | 10 |                                  |\n|                                | 10 |                                  |\n|                                | 10 |                                      |\n| ...                                      | ...                      | ...                                      |\n\n-  CPU  CPU  CPU \n\n-  Java 6 ****\n\n- Java 7 \n\n#### 4.\n\n CAS \n\nJava 6  CAS  ID  Mark Word  ID  CAS\n\n\n\n``` java\nstatic final Object obj = new Object();\n\npublic static void m1() {\n synchronized( obj ) {\n \t//  A\n \tm2();\n }\n}\npublic static void m2() {\n synchronized( obj ) {\n \t//  B\n \tm3();\n }\n}\npublic static void m3() {\n synchronized( obj ) {\n \t//  C\n }\n}\n```\n\n![image-20200819072452480](thread/image-20200819072452480.png)\n\n![image-20200819072504262](thread/image-20200819072504262.png)\n\n****\n\n\n\n```ruby\n|--------------------------------------------------------------------|--------------------|\n| \t\t\t\t\t\t\tMark Word (64 bits) \t\t\t\t\t | \t\t  State  \t  |\n|--------------------------------------------------------------------|--------------------|\n|  unused:25 | hashcode:31 | unused:1 | age:4 | biased_lock:0 |  01  | \t\t  Normal\t  |\n|--------------------------------------------------------------------|--------------------|\n|  thread:54 | epoch:2     | unused:1 | age:4 | biased_lock:1 |  01  | \t\t  Biased\t  |\n|--------------------------------------------------------------------|--------------------|\n| \t\tptr_to_lock_record:62\t\t\t\t\t\t\t\t  |  00  | Lightweight Locked |\n|--------------------------------------------------------------------|--------------------|\n| \t\tptr_to_heavyweight_monitor:62 \t\t\t\t\t\t  |  10  | Heavyweight Locked |\n|--------------------------------------------------------------------|--------------------|\n| \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  |  11  | \tMarked for GC\t  |\n|--------------------------------------------------------------------|--------------------|\n```\n\n\n\n- markword  0x05  3  101threadepochage  0\n\n-  VM \n\n   `-XX:BiasedLockingStartupDelay=0` \n\n- markword  0x01  3  001 hashcodeage  0 hashcode \n\n1 \n\n2 \n\n``` java\nclass Dog {\n    \n}\n```\n\n jol  jol \n\n``` java\n//  -XX:BiasedLockingStartupDelay=0 \npublic static void main(String[] args) throws IOException {\n \tDog d = new Dog();\n \tClassLayout classLayout = ClassLayout.parseInstance(d);\n \tnew Thread(() -> {\n \t\tlog.debug(\"synchronized \");\n \t\tSystem.out.println(classLayout.toPrintableSimple(true));\n \t\tsynchronized (d) {\n \t\t\tlog.debug(\"synchronized \");\n \t\t\tSystem.out.println(classLayout.toPrintableSimple(true));\n \t\t}\n \t\tlog.debug(\"synchronized \");\n \t\tSystem.out.println(classLayout.toPrintableSimple(true));\n \t}, \"t1\").start();\n}\n```\n\n\n\n```\n11:08:58.117 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000101 \n11:08:58.121 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00011111 11101011 11010000 00000101 \n11:08:58.121 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00011111 11101011 11010000 00000101\n```\n\n>****\n>\n> id \n\n3\n\n VM  `-XX:-UseBiasedLocking` \n\n\n\n```\n11:13:10.018 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n11:13:10.021 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00100000 00010100 11110011 10001000 \n11:13:10.021 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001\n```\n\n4)  hashCode\n\n hashCode \n\n####  **-** hashCode\n\n hashCode MarkWord  id hashCode \n\n-  hashCode\n\n-  Monitor  hashCode\n\n hashCode  `-XX:-UseBiasedLocking`\n\n\n\n```\n11:22:10.386 c.TestBiased [main] -  hashCode:1778535015 \n11:22:10.391 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 01101010 00000010 01001010 01100111 00000001 \n11:22:10.393 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00100000 11000011 11110011 01101000 \n11:22:10.393 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 01101010 00000010 01001010 01100111 00000001\n```\n\n####  **-** \n\n\n\n``` java\nprivate static void test2() throws InterruptedException {\n \tDog d = new Dog();\n \tThread t1 = new Thread(() -> {\n\t\t synchronized (d) {\n \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t}\n \t\tsynchronized (TestBiased.class) {\n \t\t\tTestBiased.class.notify();\n \t\t}\n \t\t//  wait/notify  join \n \t\t// t1  jvm  t2  id \n         /*try {\n         System.in.read();\n         } catch (IOException e) {\n         e.printStackTrace();\n         }*/\n \t}, \"t1\");\n \tt1.start();\n    \n \tThread t2 = new Thread(() -> {\n \t\tsynchronized (TestBiased.class) {\n \t\t\ttry {\n \t\t\t\tTestBiased.class.wait();\n \t\t\t} catch (InterruptedException e) {\n \t\t\t\te.printStackTrace();\n \t\t\t}\n \t\t}\n \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\tsynchronized (d) {\n \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t}\n \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t}, \"t2\");\n \tt2.start();\n}\n```\n\n\n\n```\n[t1] - 00000000 00000000 00000000 00000000 00011111 01000001 00010000 00000101 \n\n[t2] - 00000000 00000000 00000000 00000000 00011111 01000001 00010000 00000101 \n\n[t2] - 00000000 00000000 00000000 00000000 00011111 10110101 11110000 01000000 \n\n[t2] - 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n```\n\n####  -  wait/notify \n\n``` java\npublic static void main(String[] args) throws InterruptedException {\n \tDog d = new Dog();\n \tThread t1 = new Thread(() -> {\n \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\tsynchronized (d) {\n \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t\ttry {\n \t\t\t\td.wait();\n \t\t\t} catch (InterruptedException e) {\n \t\t\t\te.printStackTrace();\n \t\t\t}\n \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t}\n \t}, \"t1\");\n \tt1.start();\n    \n \tnew Thread(() -> {\n \t\ttry {\n \t\t\tThread.sleep(6000);\n \t\t} catch (InterruptedException e) {\n \t\t\te.printStackTrace();\n \t\t}\n\t\tsynchronized (d) {\n \t\t\tlog.debug(\"notify\");\n \t\t\td.notify();\n \t\t}\n \t}, \"t2\").start();\n}\n```\n\n\n\n```\n[t1] - 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000101 \n[t1] - 00000000 00000000 00000000 00000000 00011111 10110011 11111000 00000101 \n[t2] - notify \n[t1] - 00000000 00000000 00000000 00000000 00011100 11010100 00001101 11001010\n```\n\n#### \n\n T1  T2 Thread ID\n\n 20 jvm \n\n``` java\nprivate static void test3() throws InterruptedException {\n \tVector<Dog> list = new Vector<>();\n \tThread t1 = new Thread(() -> {\n \t\tfor (int i = 0; i < 30; i++) {\n \t\t\tDog d = new Dog();\n \t\t\tlist.add(d);\n \t\t\tsynchronized (d) {\n \t\t\t\tlog.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t\t}\n \t\t}\n \t\tsynchronized (list) {\n \t\t\tlist.notify();\n \t\t} \n \t}, \"t1\");\n \tt1.start();\n \n \tThread t2 = new Thread(() -> {\n \t\tsynchronized (list) {\n \t\t\ttry {\n\t\t\t\tlist.wait();\n \t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n \t\t\t}\n \t\t}\n \t\tlog.debug(\"===============> \");\n \t\tfor (int i = 0; i < 30; i++) {\n \t\t\tDog d = list.get(i);\n \t\t\tlog.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t\tsynchronized (d) {\n \t\t\t\tlog.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t\t}\n \t\t\tlog.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t}\n \t}, \"t2\");\n \tt2.start();\n}\n```\n\n\n\n```\n[t1] - 0 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 1 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 2 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 3 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 4 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 5 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 6 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 7 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 8 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 9 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 10 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 11 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 12 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 13 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 14 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 15 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 16 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 17 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 18 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - ===============> \n[t2] - 0 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 0 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 1 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 1 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 1 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 2 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 2 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 2 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 3 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 3 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 3 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 4 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 4 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 4 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 5 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 5 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 5 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 6 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 6 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 6 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 7 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 7 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 7 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 8 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 8 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 8 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 9 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 9 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 9 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 10 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 10 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 10 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 11 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 11 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 11 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 12 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 12 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 12 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 13 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 13 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 13 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 14 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 14 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 14 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 15 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 15 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 15 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 16 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 16 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 16 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 17 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 17 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 17 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 18 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 18 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 18 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101\n```\n\n#### \n\n 40 jvm \n\n``` java\n\n    static Thread t1, t2, t3;\n\n    private static void test4() throws InterruptedException {\n        Vector<Dog> list = new Vector<>();\n        int loopNumber = 39;\n        t1 = new Thread(() -> {\n            for (int i = 0; i < loopNumber; i++) {\n                Dog d = new Dog();\n                list.add(d);\n                synchronized (d) {\n                    log.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n                }\n            }\n            LockSupport.unpark(t2);\n        }, \"t1\");\n        t1.start();\n        t2 = new Thread(() -> {\n            LockSupport.park();\n            log.debug(\"===============> \");\n            for (int i = 0; i < loopNumber; i++) {\n                Dog d = list.get(i);\n                log.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n                synchronized (d) {\n                    log.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n                }\n                log.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n            }\n            LockSupport.unpark(t3);\n        }, \"t2\");\n    }\n```\n\n>****\n>\n>https://github.com/farmerjohngit/myblog/issues/12\n>\n>https://www.cnblogs.com/LemonFive/p/11246086.html\n>\n>https://www.cnblogs.com/LemonFive/p/11248248.html\n>\n>\n\n#### 5.\n\n\n\n``` java\n@Fork(1)\n@BenchmarkMode(Mode.AverageTime)\n@Warmup(iterations=3)\n@Measurement(iterations=5)\n@OutputTimeUnit(TimeUnit.NANOSECONDS)\npublic class MyBenchmark {\n    static int x = 0;\n    @Benchmark\n    public void a() throws Exception {\n        x++;\n    }\n    @Benchmark\n    public void b() throws Exception {\n        Object o = new Object();\n        synchronized (o) {\n            x++;\n        }\n    }\n}\n```\n\n`java -jar benchmarks.jar`\n\n```\nBenchmark\t\t\tMode\t Samples \tScore\t Score error \tUnits \nc.i.MyBenchmark.a \tavgt \t\t5 \t\t1.542 \t\t0.056 \t\tns/op \nc.i.MyBenchmark.b \tavgt \t\t5 \t\t1.518 \t\t0.091 \t\tns/op\n```\n\n`java -XX:-EliminateLocks -jar benchmarks.jar`\n\n```\nBenchmark \t\t\tMode \tSamples \tScore \tScore error \tUnits \nc.i.MyBenchmark.a \tavgt \t\t5 \t\t1.507 \t\t0.108 \t\tns/op \nc.i.MyBenchmark.b \tavgt \t\t5 \t\t16.976 \t\t1.572 \t\tns/op\n```\n\n****\n\n\n","source":"_posts/2023/thread.md","raw":"---\ntitle: \ndate: 2023-03-21\ntags:\n- thread\ncategories:\n- JAVA\n---\n\n# \n\n## \n\n### \n\n- CPU,IO\n- \n- ( )(360 )\n\n### \n\n- -\n\n- CPU\n\n- Java windows\n\n\n### \n\n- \n- \n- \n  - IPC (Inter-process communication)\n  - ,HTTP\n- --\n- ,-\n\n## \n\ncpu``- -cpu(windows'15)cpu()\n``- -:````CPU concurrent\n\n| CPU  | 1 | 2 | 3 | 4 |\n| :--: | :-----: | :-----: | :-----: | :-----: |\n| core |  1  |  2  |  3  |  4  |\n\n![](thread/453affe8-17db-40b3-940f-162e7597336e.png)\n\nCPUcore\n\n|  CPU  | 1 | 2 | 3 | 4 |\n| :---: | :-----: | :-----: | :-----: | :-----: |\n| core1 |  1  |  1  |  3  |  3  |\n| core2 |  2  |  2  |  4  |  4  |\n\n![](thread/2ed065be-3fb7-4e67-b04e-b8e08980405d.png)\n\nRob Pike:\n\n- (concurrent) - -(dealing with) \n- (parallel) - -(doing) \n\n\n\n- -,\n- -(,)\n- 3\n\n## \n\n### \n\n\n\n**:**\n\n#### \n\n()5\n5,...\n\n``` java\npackage com.wry.concurrent.util;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.io.FileNotFoundException;\nimport java.io.FileReader;\n\n/**\n * <p>\n *\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/26\n */\n@Slf4j\npublic class FileReaderUtil {\n    \n    public static void read(String path) {\n        log.debug(\"FileReader start .....\");\n        try {\n            FileReader reader = new java.io.FileReader(path);\n        } catch (FileNotFoundException e) {\n            e.printStackTrace();\n        }\n        log.debug(\"FileReader end .....\");\n    }\n}\n```\n\n``` java\npackage com.wry.concurrent.n2;\n\nimport com.wry.concurrent.constans.Constans;\nimport com.wry.concurrent.util.FileReaderUtil;\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.io.FileNotFoundException;\nimport java.io.FileReader;\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/26\n */\n@Slf4j\npublic class Sync {\n\n    public static void main(String[] args) {\n        //fileReader\n        FileReaderUtil.read(Constans.FILE_PATH);\n\n        log.debug(\"do other things .....\");\n    }\n\n\n}\n\n```\n\n``` java\npackage com.wry.concurrent.n2;\n\nimport com.wry.concurrent.constans.Constans;\nimport com.wry.concurrent.util.FileReaderUtil;\nimport lombok.extern.slf4j.Slf4j;\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/26\n */\n@Slf4j\npublic class Async {\n\n    public static void main(String[] args) {\n        //\n        new Thread(() -> {\n            FileReaderUtil.read(Constans.FILE_PATH);\n        }).start();\n\n        log.debug(\"do other things .....\");\n    }\n}\n\n```\n\n\n\n#### \n\n- \n- tomcat servlet,tomcat\n- UIui\n\n### ()\n\ncpu,3,\n\n>\t1\t\t10ms\n>\t2\t\t11ms\n>\t3\t\t9 ms\n>\t1 ms\n\n- 10 + 11 + 9 + 1= 31ms\n- cpu, 11,22,33,311ms12ms\n\n** : cpu**\n\n#### \n\n``` java\npackage com.wry.concurrent.n2.example;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.util.Arrays;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.FutureTask;\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/26\n */\n@Slf4j\npublic class MyBenchmark {\n\n    static int[] ARRAY = new int[4000_000_00];\n\n    static {\n        Arrays.fill(ARRAY, 1);\n    }\n\n    /**\n     *  4\n     */\n    public static void async() throws ExecutionException, InterruptedException {\n        //\n        Long start = System.currentTimeMillis();\n        int[] array = ARRAY;\n        FutureTask<Integer> task1 = new FutureTask<Integer>(() -> {\n            int sum = 0;\n            for (int i = 0; i < 1000_000_00; i++) {\n                sum += array[0 + i];\n            }\n            return sum;\n        });\n        FutureTask<Integer> task2 = new FutureTask<Integer>(() -> {\n            int sum = 0;\n            for (int i = 0; i < 1000_000_00; i++) {\n                sum += array[1000_000_00 + i];\n            }\n            return sum;\n        });\n        FutureTask<Integer> task3 = new FutureTask<Integer>(() -> {\n            int sum = 0;\n            for (int i = 0; i < 1000_000_00; i++) {\n                sum += array[2000_000_00 + i];\n            }\n            return sum;\n        });\n        FutureTask<Integer> task4 = new FutureTask<Integer>(() -> {\n            int sum = 0;\n            for (int i = 0; i < 1000_000_00; i++) {\n                sum += array[3000_000_00 + i];\n            }\n            return sum;\n        });\n\n        new Thread(task1).start();\n        new Thread(task2).start();\n        new Thread(task3).start();\n        new Thread(task4).start();\n        int i = task1.get() + task2.get() + task3.get() + task4.get();\n        //\n        Long end = System.currentTimeMillis();\n        System.out.println(\"\" + i + \"\\t\" + (end - start));\n    }\n\n    /**\n     * \n     */\n    private static void sync() {\n        //\n        Long start = System.currentTimeMillis();\n        int[] array = ARRAY;\n        int sum = 0;\n        for (int i = 0; i < 4000_000_00; i++) {\n            sum += array[i];\n        }\n        //\n        Long end = System.currentTimeMillis();\n        System.out.println(\"\" + sum + \"\\t\" + (end - start));\n    }\n\n\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        //\n        sync();\n        //\n        async();\n    }\n\n}\n\n```\n\n![](thread/4f22eeff-a017-46f6-bf49-5359e570fe22.png)\n\n#### \n\n1cpu,cpu, cpu,\n2cpu\n\n    -  ,,([] )\n    -  \n\n3 IOcpu,[IO]cpu,IO[IO][I0]\n\n# JAVA\n\n## \n\njavamain\n\n### 1.Thread\n\n``` java\n/**\n * <p>\n *  Thread\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n\n@Slf4j\npublic class Thread1 {\n    public static void main(String[] args) {\n        Thread thread = new Thread() {\n            @Override\n            public void run() {\n                //\n                log.debug(\"runing....\");\n            }\n        };\n        //\n        thread.setName(\"t1\");\n        //\n        thread.start();\n        \n        log.debug(\"main....\");\n    }\n}\n\n```\n\n### 2.Runnable Thread\n\n````  \n\n- Thread \n- Runnable \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n\n@Slf4j\npublic class Thread2 {\n    public static void main(String[] args) {\n        Runnable runnable = new Runnable() {\n            @Override\n            public void run() {\n                //\n                log.debug(\"runing....\");\n            }\n        };\n\n        //(12)\n        Thread thread = new Thread(runnable,\"t2\");\n        //\n        thread.start();\n        \n        log.debug(\"main....\");\n    }\n}\n\n```\n\nJAVA 8 `lambda`\n\n``` java\n       \t//\n        Runnable lombdaRunnable= () -> {\n            log.debug(\"lombda runging......\"); \n        };\n        //\n        Thread lombdaThead=new Thread(lombdaRunnable,\"lombdaThead\");\n        //\n        lombdaThead.start();\n```\n\n\n\n``` java\n new Thread(() -> {\n     log.debug(\"lombda runging......\");\n }, \"lambdaThread\").start();\n```\n\n### 3.FutureTask Thread\n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n\n@Slf4j\npublic class Thread3 {\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        FutureTask<Integer> task=new FutureTask<>(new Callable<Integer>() {\n            @Override\n            public Integer call() throws Exception {\n                log.debug(\"running.......\");\n                Thread.sleep(1000);\n                return 100;\n            }\n        });\n\n        //(12)\n        Thread thread = new Thread(task,\"t3\");\n        //\n        thread.start();\n        \n        //tasktask\n        Integer integer = task.get();\n        log.debug(\"task {}\",integer);\n    }\n}\n\n```\n\n\n\n\n\n### ThreadRunnable\n\n#### Runnable\n\nRunnableinit\n\n``` java\n    /**\n     * Allocates a new {@code Thread} object. This constructor has the same\n     * effect as {@linkplain #Thread(ThreadGroup,Runnable,String) Thread}\n     * {@code (null, target, name)}.\n     *\n     * @param  target\n     *         the object whose {@code run} method is invoked when this thread\n     *         is started. If {@code null}, this thread's run method is invoked.\n     *\n     * @param  name\n     *         the name of the new thread\n     */\n    public Thread(Runnable target, String name) {\n        init(null, target, name, 0);\n    }\n\n```\n\nInit \n\n``` java\n /**\n     * Initializes a Thread with the current AccessControlContext.\n     * @see #init(ThreadGroup,Runnable,String,long,AccessControlContext,boolean)\n     */\n    private void init(ThreadGroup g, Runnable target, String name,\n                      long stackSize) {\n        init(g, target, name, stackSize, null, true);\n    }\n```\n\ninit `Runable` `target`\n\n``` java\n    /**\n     * Initializes a Thread.\n     *\n     * @param g the Thread group\n     * @param target the object whose run() method gets called\n     * @param name the name of the new Thread\n     * @param stackSize the desired stack size for the new thread, or\n     *        zero to indicate that this parameter is to be ignored.\n     * @param acc the AccessControlContext to inherit, or\n     *            AccessController.getContext() if null\n     * @param inheritThreadLocals if {@code true}, inherit initial values for\n     *            inheritable thread-locals from the constructing thread\n     */\n    private void init(ThreadGroup g, Runnable target, String name,\n                      long stackSize, AccessControlContext acc,\n                      boolean inheritThreadLocals) {\n        if (name == null) {\n            throw new NullPointerException(\"name cannot be null\");\n        }\n\n        this.name = name;\n\n        Thread parent = currentThread();\n        SecurityManager security = System.getSecurityManager();\n        if (g == null) {\n            /* Determine if it's an applet or not */\n\n            /* If there is a security manager, ask the security manager\n               what to do. */\n            if (security != null) {\n                g = security.getThreadGroup();\n            }\n\n            /* If the security doesn't have a strong opinion of the matter\n               use the parent thread group. */\n            if (g == null) {\n                g = parent.getThreadGroup();\n            }\n        }\n\n        /* checkAccess regardless of whether or not threadgroup is\n           explicitly passed in. */\n        g.checkAccess();\n\n        /*\n         * Do we have the required permissions?\n         */\n        if (security != null) {\n            if (isCCLOverridden(getClass())) {\n                security.checkPermission(SUBCLASS_IMPLEMENTATION_PERMISSION);\n            }\n        }\n\n        g.addUnstarted();\n\n        this.group = g;\n        this.daemon = parent.isDaemon();\n        this.priority = parent.getPriority();\n        if (security == null || isCCLOverridden(parent.getClass()))\n            this.contextClassLoader = parent.getContextClassLoader();\n        else\n            this.contextClassLoader = parent.contextClassLoader;\n        this.inheritedAccessControlContext =\n                acc != null ? acc : AccessController.getContext();\n        //Runable \n        this.target = target;\n        setPriority(priority);\n        if (inheritThreadLocals && parent.inheritableThreadLocals != null)\n            this.inheritableThreadLocals =\n                ThreadLocal.createInheritedMap(parent.inheritableThreadLocals);\n        /* Stash the specified stack size in case the VM cares */\n        this.stackSize = stackSize;\n\n        /* Set thread ID */\n        tid = nextThreadID();\n    }\n```\n\nThread ,Thread`run`\n\n``` java\n  /**\n     * If this thread was constructed using a separate\n     * <code>Runnable</code> run object, then that\n     * <code>Runnable</code> object's <code>run</code> method is called;\n     * otherwise, this method does nothing and returns.\n     * <p>\n     * Subclasses of <code>Thread</code> should override this method.\n     *\n     * @see     #start()\n     * @see     #stop()\n     * @see     #Thread(ThreadGroup, Runnable, String)\n     */\n    @Override\n    public void run() {\n        if (target != null) {\n            target.run();\n        }\n    }\n\n```\n\n#### \n\n- ThreadRunnable \n- Runnable API \n- Runnable Thread \n\n## \n\n#### \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class MultiThread {\n    public static void main(String[] args) {\n        new Thread(()->{\n            while (true) {\n                log.debug(\"running.....\");\n            }\n        },\"t1\").start();\n        \n        new Thread(() -> {\n            while (true) {\n                log.debug(\"running.....\");\n            }\n        }, \"t2\").start();\n    }\n}\n\n```\n\n![](thread/e5b813b7-361c-42ec-9326-53b01a2872da.png)\n\n#### \n\n- \n- \n\n\n\n## \n\n### windows\n\n- ,\n- tasklist\n- taskkill\n\n### linux\n\n- ps -fe\n- ps -fT -p <PID>(PID) \n- kill \n- topH\n- top -H -p <PID>(PID) :\n\n### java\n\n- jps JAVA \n- jstack <PID> Java PID\n- jconsole Java \n\n### jconsole\n\njava\n\n>java -Djava. rmi. server . hostname=' ip' -Dcom. sun. management . jmxremote -Dcom. sun. management . jmxremote. port=i-Dcom . sun . management . jmxremote.ssl=-Dcom. sun. management .jmxremote .authenticate=    java\n\n/etc/hosts127.0.0.1 \n\n\n- jmxremote.password \n- jmxremote.passwordjmxremote.access600\n- controlRole ()R&D ()\n\n\n\n## \n\n### \n\nJava Virtual Machine Stacks Java \n\n JVM \n\n\n\n- Frame\n\n- \n\n#### \n\n##### \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class Frames {\n    public static void main(String[] args) {\n        method1(10);\n    }\n\n    private static void method1(int x) {\n        int y = x + 1;\n        Object o = method2();\n        System.out.println(o);\n    }\n\n    private static Object method2() {\n        Object o = new Object();\n        return o;\n    }\n}\n\n```\n\n![](thread/cb65fed7-57dd-404b-b4f1-e365dbe83379.png)\n\n![](thread/210feb5c-150a-43c3-8b3d-440f53e343d1.png)\n\nmethod2\n![](thread/52ebada9-ad0c-45fc-9482-40b961c20bbf.png)\n\n![](thread/51e456b2-69ca-4039-8ec3-137a74a3e57d.png)\n\nmethod2 method2\n![](thread/7d8e2e3b-8f62-4e97-86d1-d8ab88b83ca1.png)\n\n![](thread/ca324ec8-b1a0-419a-a962-640dae424e10.png)\n\n\n\n![](thread/3ce55a24-aeb0-4055-9925-c69a63ec9053.png)\n\n##### \n\n``` java\npackage com.wry.concurrent.thread;\n\n/**\n * <p>\n *  \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class Frames2 {\n    public static void main(String[] args) {\n        new Thread(() -> {\n            //t1\n            method1(20);\n        }, \"t1\").start();\n        //main\n        method1(10);\n    }\n\n    private static void method1(int x) {\n        int y = x + 1;\n        Object o = method2();\n        System.out.println(o);\n    }\n\n    private static Object method2() {\n        Object o = new Object();\n        return o;\n    }\n}\n```\n\nt1 \n\n![](thread/815e324a-777f-4b34-b590-acbb4c624cb0.png)\n\n\n\n![](thread/d05f71ef-bbbb-4b19-a804-6444a74de835.png)\n\nmain\n\n![](thread/75442144-d101-4e7a-97ca-c833a2b827fe.png)\nt1\n![](thread/7bf73e18-7259-45da-93c5-a4183062572e.png)\n\n#### \n\n\n\n\n\n### Thread Context Switch\n\n cpu \n\n-  cpu \n\n- \n\n- \n\n-  sleepyieldwaitjoinparksynchronizedlock \n\n Context Switch ``Java `Program Counter Register` jvm \n\n- \n\n- Context Switch \n\n## \n\n| ****       | **static** | ****                                                 | ****                                                     |\n| :--------------- | :--------: | :----------------------------------------------------------- | :----------------------------------------------------------- |\n| start()          |            |  run               | start CPU startIllegalThreadStateExceptio |\n| run()            |            |                                      |  Thread  Runnable  Runnable  run  Thread  |\n| join()           |            |                                              |                                                              |\n| join(long n)     |            | ,n                               |                                                              |\n| getId()          |            |  id                                          | id                                                       |\n| getName()        |            |                                                    |                                                              |\n| setName(String)  |            |                                                    |                                                              |\n| getPriority()    |            |                                                |                                                              |\n| setPriority(int) |            |                                                | java1~10  CPU  |\n| getState()       |            |                                                  | Java  6  enum NEW, RUNNABLE, BLOCKED, WAITING,TIMED_WAITING, TERMINATED |\n| isInterrupted()  |            |                                                | ``                                           |\n| isAlive()        |            | (                                |                                                              |\n| interrupt()      |            |                                                      |  sleepwaitjoin  InterruptedException````park `` |\n| interrupted()    |   static   |                                        | ``                                             |\n| currentThread()  |   static   |                                        |                                                              |\n| sleep(long n)    |   static   | n cpu  |                                                              |\n| yield()          |   static   | CPU                        |                                          |\n\n\n\n## start\n\n### run\n\n``` java\n/**\n * <p>\n *  run \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class RunMethod {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            log.debug(Thread.currentThread().getName());\n            FileReaderUtil.read(Constants.FILE_PATH);\n        }, \"t1\");\n\n        t1.run();\n    }\n}\n\n```\n\nmain \n\n![](thread/4b22adcb-879c-493e-a6dc-7a50426a6db7.png)\n\n### start\n\n``` java\n/**\n * <p>\n *  run \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class RunMethod {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            log.debug(Thread.currentThread().getName());\n            FileReaderUtil.read(Constants.FILE_PATH);\n        }, \"t1\");\n//        //run\n//        t1.run();\n        //start\n        t1.start();\n    }\n}\n```\n\n![](thread/6d0f8427-4068-4a15-a933-cd3f74e28dbf.png)\n\n### \n``` java\n\n    /**\n     * If this thread was constructed using a separate\n     * <code>Runnable</code> run object, then that\n     * <code>Runnable</code> object's <code>run</code> method is called;\n     * otherwise, this method does nothing and returns.\n     * <p>\n     * Subclasses of <code>Thread</code> should override this method.\n     *\n     * @see     #start()\n     * @see     #stop()\n     * @see     #Thread(ThreadGroup, Runnable, String)\n     */\n    @Override\n    public void run() {\n        if (target != null) {\n            target.run();\n        }\n    }\n```\n``` java\n@FunctionalInterface\npublic interface Runnable {\n    /**\n     * When an object implementing interface <code>Runnable</code> is used\n     * to create a thread, starting the thread causes the object's\n     * <code>run</code> method to be called in that separately executing\n     * thread.\n     * <p>\n     * The general contract of the method <code>run</code> is that it may\n     * take any action whatsoever.\n     *\n     * @see     java.lang.Thread#run()\n     */\n    public abstract void run();\n}\n```\nrun() \n\n``` java\n   public synchronized void start() {\n        /**\n         * This method is not invoked for the main method thread or \"system\"\n         * group threads created/set up by the VM. Any new functionality added\n         * to this method in the future may have to also be added to the VM.\n         *\n         * A zero status value corresponds to state \"NEW\".\n         */\n        if (threadStatus != 0)\n            throw new IllegalThreadStateException();\n\n        /* Notify the group that this thread is about to be started\n         * so that it can be added to the group's list of threads\n         * and the group's unstarted count can be decremented. */\n        group.add(this);\n\n        boolean started = false;\n        try {\n            start0();\n            started = true;\n        } finally {\n            try {\n                if (!started) {\n                    group.threadStartFailed(this);\n                }\n            } catch (Throwable ignore) {\n                /* do nothing. If start0 threw a Throwable then\n                  it will be passed up the call stack */\n            }\n        }\n    }\n    \n     private native void start0();\n\n```\n`start()` `start0()``start0()``native`\n\n### \n\n-  run  run\n\n-  start  run \n\n### \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class ThreadStatus {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            System.out.println(\"running.....\");\n        }, \"t1\");\n\n        //\n        System.out.println(\":\"+t1.getState());\n        //start\n        t1.start();\n        //\n        System.out.println(\":\"+t1.getState());\n    }\n}\n```\n\n![](thread/3a071edf-6ded-487b-abbb-d016a9fe6864.png)\n\n### startjava.lang.IllegalThreadStateException\n\n``` java\n//start\nt1.start();\nt1.start();\n```\n\n![](thread/feed6992-8dff-450c-9010-e2f46caf6243.png)\n\n\n\n## **sleep** **** **yield**\n\n### sleep\n\n1.  sleep  *Running*  *Timed Waiting* \n\n``` java\n/**\n * <p>\n *   sleep\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class ThreadMethod {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            try {\n                Thread.sleep(2000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\");\n\n        t1.start();\n        log.debug(\"t1 {}\",t1.getState());\n\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        log.debug(\"t1 {}\",t1.getState());\n    }\n}\n```\n\n![image-20200822234416578](thread/image-20200822234416578.png)\n\n2.  interrupt  sleep  InterruptedException\n\n``` java\n/**\n * <p>\n *  interrupt \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class ThreadMethod2 {\n    public static void main(String[] args) {\n        Thread t1 = new Thread(() -> {\n            try {\n                log.debug(\"enter sleep...... \");\n                Thread.sleep(2000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n                log.debug(\"wake up...... \");\n            }\n        }, \"t1\");\n\n        t1.start();\n        try {\n            Thread.sleep(1000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        t1.interrupt();\n        log.debug(\"interrupt...... \");\n    }\n}\n```\n\n![](thread/81a4db1a-c8d1-47f7-a955-39db726f5173.png)\n\n3. \n\n4.  TimeUnit  sleep  Thread  sleep \n\n``` java\n/**\n * <p>\n *  TimeUnit\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\n@Slf4j\npublic class ThreadMethod3 {\n    public static void main(String[] args) throws InterruptedException {\n        log.debug(\"start ......\");\n        TimeUnit.SECONDS.sleep(1);\n        log.debug(\"end ......\");\n    }\n}\n```\n\n![](thread/f78c9ec4-6379-48de-b2e6-f529bb063540.png)\n\n\n\n### yield\n\n1.  yield  *Running*  *Runnable* \n\n2. \n\n##  \n\nhint\n\n cpu  cpu \n\n### yield\n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class ThreadPriority {\n    public static void main(String[] args) {\n        Runnable task1 = () -> {\n            int count = 0;\n            for (; ; ) {\n                System.out.println(\"---->1 \" + count++);\n            }\n        };\n        Runnable task2 = () -> {\n            int count = 0;\n            for (; ; ) {\n                // Thread.yield();\n                System.out.println(\"        ---->2 \" + count++);\n            }\n        };\n        Thread t1 = new Thread(task1, \"t1\");\n        Thread t2 = new Thread(task2, \"t2\");\n        t1.start();\n        t2.start();\n    }\n}\n```\n\nt1t2 \n\n![](thread/683dd209-d862-46f9-878f-b9e8f4c2db3b.png)\n\n### yield\n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class ThreadPriority {\n    public static void main(String[] args) {\n        Runnable task1 = () -> {\n            int count = 0;\n            for (; ; ) {\n                System.out.println(\"---->1 \" + count++);\n            }\n        };\n        Runnable task2 = () -> {\n            int count = 0;\n            for (; ; ) {\n                //yield,CPU\n                Thread.yield();\n                System.out.println(\"        ---->2 \" + count++);\n            }\n        };\n        Thread t1 = new Thread(task1, \"t1\");\n        Thread t2 = new Thread(task2, \"t2\");\n        t1.start();\n        t2.start();\n    }\n}\n\n```\n\nt1 t2 \n\n![](thread/d37e0c1b-1e69-4360-937a-edf5296f47ce.png)\n\n### \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/27\n */\npublic class ThreadPriority {\n    public static void main(String[] args) {\n        Runnable task1 = () -> {\n            int count = 0;\n            for (; ; ) {\n                System.out.println(\"---->1 \" + count++);\n            }\n        };\n        Runnable task2 = () -> {\n            int count = 0;\n            for (; ; ) {\n                System.out.println(\"        ---->2 \" + count++);\n            }\n        };\n        Thread t1 = new Thread(task1, \"t1\");\n        Thread t2 = new Thread(task2, \"t2\");\n        //t1\n        t1.setPriority(Thread.MIN_PRIORITY);\n        //t2\n        t2.setPriority(Thread.MAX_PRIORITY);\n        \n        t1.start();\n        t2.start();\n    }\n}\n```\n\nt2 t1 \n\n![](thread/2feee3db-6b39-4e1a-9098-1a5f966742f7.png)\n\n##  \n\n### CPU 100%\n\n#### sleep \n\ncpuwhile(rue)cpu,yieldsleepcpu\n\n``` java\nThread t1 = new Thread(() -> {\n            try {\n                Thread.sleep(500);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }   \n        },\"t1\");\n        t1.start();\n```\n\n\n\n- wait\n- I,\n- sleep\n\n##  join\n\n r \n\n### 1 join\n\nJoin\n\n``` java\n/**\n * <p>\n *  join\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class JoinMethod {\n    private static int r = 0;\n\n    private static void test1() {\n        log.debug(\"......\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"......\");\n            try {\n                TimeUnit.SECONDS.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.debug(\"......\");\n            r = 10;\n        },\"t1\");\n        t1.start();\n        log.debug(\":{}\", r);\n        log.debug(\"......\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n```t1`` r `r\n\n![](thread/5cce206b-f24c-4489-afda-57b5a3102172.png)\n\n### \n\n-  t1 t1  1 ` r=10`\n\n-  r  `r=0`\n\n### \n\n-  sleep \n\n  t1,\n\n-  join t1.start() \n\n  `join()`**\"\"** **join()**\n\n``` java\n/**\n * <p>\n *  join\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class JoinMethod {\n    private static int r = 0;\n\n    private static void test1() throws InterruptedException {\n        log.debug(\"......\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"......\");\n            try {\n                TimeUnit.SECONDS.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.debug(\"......\");\n            r = 10;\n        },\"t1\");\n        t1.start();\n        //t1\n        t1.join();\n        log.debug(\":{}\", r);\n        log.debug(\"......\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n![](thread/86d6badd-f76b-4152-8044-bef85f333017.png)\n\n### 2 \n\n\n\n- \n\n- \n\n#### \n\n cost \n\n``` java\n/**\n * <p>\n *  join \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class JoinMethod2 {\n    private static int r1 = 0;\n    private static int r2 = 0;\n\n    private static void test1() throws InterruptedException {\n        log.debug(\"......\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"......\");\n            try {\n                TimeUnit.SECONDS.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.debug(\"......\");\n            r1 = 10;\n        }, \"t1\");\n\n        Thread t2 = new Thread(() -> {\n            log.debug(\"......\");\n            try {\n                TimeUnit.SECONDS.sleep(2);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.debug(\"......\");\n            r2 = 20;\n        }, \"t2\");\n\n        //\n        t1.start();\n        t2.start();\n\n        //\n        long start = System.currentTimeMillis();\n        log.debug(\"join begin ......\");\n        t1.join();\n        log.debug(\"t1 join end ......\");\n        t2.join();\n        log.debug(\"t2 join end ......\");\n        //\n        long end = System.currentTimeMillis();\n        log.debug(\"t1 :{},t2 :{},{}\", r1, r2, end - start);\n        log.debug(\"......\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n\n\n-  join t1 , t2 , \n\n-  join1s , , t2  1s,  1s\n\n![](thread/9372a527-1cf5-4699-9271-f9724c815f24.png)\n\n join \n\n![](thread/b94de8b0-5933-49dc-b0ff-a29a03280074.png)\n\n### 3 \n\n``` java\n/**\n * <p>\n *  join \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class JoinMethod3 {\n    private static int r1 = 0;\n\n    private static void test1() throws InterruptedException {\n        log.debug(\"......\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"......\");\n            try {\n                //2000\n                TimeUnit.MILLISECONDS.sleep(2000);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.debug(\"......\");\n            r1 = 10;\n        }, \"t1\");\n\n        //\n        t1.start();\n\n        //\n        long start = System.currentTimeMillis();\n        log.debug(\"join begin ......\");\n        //1500\n        t1.join(1500);\n        log.debug(\"t1 join end ......\");\n        //\n        long end = System.currentTimeMillis();\n        log.debug(\"t1 :{},{}\", r1,  end - start);\n        log.debug(\"......\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n![](thread/44fc6f61-2e64-414e-be76-0486d270b52b.png)\n\njoin\n\n\n\n## interrupt\n\n###   \n\n sleep wait  join  \n\n sleep ,  sleep \n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.util.concurrent.TimeUnit;\n\n/**\n * <p>\n *   interrupt \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            try {\n                TimeUnit.SECONDS.sleep(2);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\");\n        t1.start();\n        log.debug(\"interrupt... \");\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n        log.debug(\" : {}\", t1.isInterrupted());\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\nfalse\n\n![](thread/d9550ede-fad3-4675-8791-3a1237fab0de.png)\n\n###   \n\n``` java\n/**\n * <p>\n *   interrupt \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod2 {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            while (true) {\n               \n            }\n        }, \"t1\");\n\n        t1.start();\n\n        log.debug(\"interrupt... \");\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n        log.debug(\" : {}\", t1.isInterrupted());\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n\n```\n\nt1\n![](thread/c2203c1e-3091-4832-8061-8ba8bc3b24d1.png)\n\n\n\n``` java\n/**\n * <p>\n *   interrupt \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod2 {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            while (true) {\n                boolean isInterrupt = Thread.currentThread().isInterrupted();\n                if (isInterrupt) {\n                    log.debug(\"\");\n                    break;\n                }\n            }\n        }, \"t1\");\n\n        t1.start();\n\n        log.debug(\"interrupt... \");\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n        log.debug(\" : {}\", t1.isInterrupted());\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n\n![](thread/70691192-ef7e-43b6-b365-d139f036e188.png)\n\n###  park:\n\n park , \n\n``` java\n/**\n * <p>\n *   interrupt park\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod3 {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            log.debug(\"park...\");\n            LockSupport.park();\n            log.debug(\"unpark...\");\n            log.debug(\"{}\", Thread.currentThread().isInterrupted());\n        }, \"t1\");\n        t1.start();\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n![](thread/f5e5190c-2ca0-4467-8618-c9084b18b26f.png)\n\npark park\n\n``` java\n/**\n * <p>\n *   interrupt park\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod3 {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            log.debug(\"park...\");\n            LockSupport.park();\n            log.debug(\"unpark...\");\n            log.debug(\"{}\", Thread.currentThread().isInterrupted());\n            //park\n            LockSupport.park();\n            log.debug(\"unpark...\");\n\n        }, \"t1\");\n        t1.start();\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n![](thread/a6cd39b0-e6e9-4b6f-88ea-3cfb0d899b83.png)\n\nThread Thread.interrupted() \n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.util.concurrent.TimeUnit;\nimport java.util.concurrent.locks.LockSupport;\n\n/**\n * <p>\n *   interrupt park\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class InterruptMethod3 {\n    private static void test1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            log.debug(\"park...\");\n            LockSupport.park();\n            log.debug(\"unpark...\");\n            log.debug(\"{}\", Thread.interrupted());\n            //park\n            LockSupport.park();\n            log.debug(\"unpark...\");\n        }, \"t1\");\n        t1.start();\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n\n        TimeUnit.SECONDS.sleep(1);\n        t1.interrupt();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n\n```\n\n![](thread/bc0f03b1-c84a-45af-879e-4bdc0f0ff35e.png)\n\n## \n\n### Two Phase Termination\n\nT1T2?\n\nT2\n\n#### \n\n- stop():\n  - stop \n-  System.exit(int)\n  - \n\n### \n\n2s\n\n![](thread/e1c2fc78-6f75-4049-8631-1e2bf400e92b.png)\n\n### \n\n``` java\n/**\n * <p>\n * interrupt\n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class TwoPhaseTermination {\n    private Thread monitor;\n\n    /**\n     * \n     */\n    private void start() {\n        monitor = new Thread(() -> {\n            while (true) {\n                Thread currentThread = Thread.currentThread();\n                if (currentThread.isInterrupted()){\n                    log.debug(\"\");\n                    break;\n                }\n                try {\n                    TimeUnit.SECONDS.sleep(1); //  \n                    log.debug(\"\"); //\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                    //,\n                    currentThread.interrupt();\n                }\n            }\n        });\n\n        monitor.start();\n    }\n\n    /**\n     * \n     */\n    private void stop() {\n        monitor.interrupt();\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        TwoPhaseTermination termination = new TwoPhaseTermination();\n        termination.start();\n\n        TimeUnit.SECONDS.sleep(3);\n        termination.stop();\n    }\n}\n```\n\n![](thread/d1df5ae9-03d4-4960-a460-86c4eb4f13d9.png)\n\n\n\n## \n\n\n\n|     |  |              |\n| --------- | ---- | -------------------- |\n| stop()    |      |          |\n| suspend() |      |  |\n| resume()  |      |          |\n\n## \n\nJava \n\n``` java\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class DaemonThread {\n    private static void test1() throws InterruptedException {\n        log.debug(\"...\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"...\");\n            while (true) {\n                if (Thread.currentThread().isInterrupted()) {\n                    break;\n                }\n            }\n            log.debug(\"...\");\n        }, \"t1\");\n        t1.start();\n        TimeUnit.SECONDS.sleep(1);\n        log.debug(\"...\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n\n```\n\n`main``t1``java `\n![](thread/0e59c147-a499-4226-bf3b-d6f0a4cabd5a.png)\n\n`setDaemon(boolean)`t1\n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class DaemonThread {\n    private static void test1() throws InterruptedException {\n        log.debug(\"...\");\n        Thread t1 = new Thread(() -> {\n            log.debug(\"...\");\n            while (true) {\n                if (Thread.currentThread().isInterrupted()) {\n                    break;\n                }\n            }\n            log.debug(\"...\");\n        }, \"t1\");\n        // \n        t1.setDaemon(true);\n        t1.start();\n        TimeUnit.SECONDS.sleep(1);\n        log.debug(\"...\");\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        test1();\n    }\n}\n```\n\n`main``t1`\n\n![](thread/ea4c56c3-75b1-48fa-a40e-dcb6dd63823f.png)\n\n>****\n>\n>- \n>\n>- Tomcat ` Acceptor ` `Poller ` Tomcat  shutdown \n\n## \n\n **** \n\n![](thread/d3f13fb8-e2e2-4692-8b27-2ca13a87ec1a.png)\n\n- \n\n-  CPU \n\n-  CPU \n\n  -  CPU \n\n- \n\n  -  API BIO  CPU\n\n  -  BIO \n\n  - \n\n- \n\n## \n\n **Java API** \n\n Thread.State \n\n``` java\n    public enum State {\n        /**\n         * Thread state for a thread which has not yet started.\n         */\n        NEW,\n\n        /**\n         * Thread state for a runnable thread.  A thread in the runnable\n         * state is executing in the Java virtual machine but it may\n         * be waiting for other resources from the operating system\n         * such as processor.\n         */\n        RUNNABLE,\n\n        /**\n         * Thread state for a thread blocked waiting for a monitor lock.\n         * A thread in the blocked state is waiting for a monitor lock\n         * to enter a synchronized block/method or\n         * reenter a synchronized block/method after calling\n         * {@link Object#wait() Object.wait}.\n         */\n        BLOCKED,\n\n        /**\n         * Thread state for a waiting thread.\n         * A thread is in the waiting state due to calling one of the\n         * following methods:\n         * <ul>\n         *   <li>{@link Object#wait() Object.wait} with no timeout</li>\n         *   <li>{@link #join() Thread.join} with no timeout</li>\n         *   <li>{@link LockSupport#park() LockSupport.park}</li>\n         * </ul>\n         *\n         * <p>A thread in the waiting state is waiting for another thread to\n         * perform a particular action.\n         *\n         * For example, a thread that has called <tt>Object.wait()</tt>\n         * on an object is waiting for another thread to call\n         * <tt>Object.notify()</tt> or <tt>Object.notifyAll()</tt> on\n         * that object. A thread that has called <tt>Thread.join()</tt>\n         * is waiting for a specified thread to terminate.\n         */\n        WAITING,\n\n        /**\n         * Thread state for a waiting thread with a specified waiting time.\n         * A thread is in the timed waiting state due to calling one of\n         * the following methods with a specified positive waiting time:\n         * <ul>\n         *   <li>{@link #sleep Thread.sleep}</li>\n         *   <li>{@link Object#wait(long) Object.wait} with timeout</li>\n         *   <li>{@link #join(long) Thread.join} with timeout</li>\n         *   <li>{@link LockSupport#parkNanos LockSupport.parkNanos}</li>\n         *   <li>{@link LockSupport#parkUntil LockSupport.parkUntil}</li>\n         * </ul>\n         */\n        TIMED_WAITING,\n\n        /**\n         * Thread state for a terminated thread.\n         * The thread has completed execution.\n         */\n        TERMINATED;\n    }\n```\n\n\n\n![](thread/0827c261-3195-4bdc-9b78-e0c664037749.png)\n\n- NEW  start() \n\n- RUNNABLE  start() **Java API**  RUNNABLE  **** \n  -  BIO  Java \n\n- BLOCKED  WAITING  TIMED_WAITING  **Java API** \n\n- TERMINATED \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/7/28\n */\n@Slf4j\npublic class ThreadState {\n    private static void test1() {\n        Thread t1 = new Thread(() -> {  //new\n            log.debug(\"runing......\");\n        }, \"t1\");\n\n        Thread t2 = new Thread(() -> {  //running\n           while (true){\n\n           }\n        },\"t2\");\n        t2.start();\n\n        Thread t3 = new Thread(() -> {  //terminted\n            log.debug(\"runing......\");\n        },\"t3\");\n        t3.start();\n\n        Thread t4 = new Thread(() -> {  //timed_waiting\n            synchronized (ThreadState.class) {\n                try {\n                    TimeUnit.SECONDS.sleep(100);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        },\"t4\");\n        t4.start();\n\n        Thread t5 = new Thread(() -> {  //waiting\n                try {\n                    t2.join();\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n        },\"t5\");\n        t5.start();\n\n        Thread t6 = new Thread(() -> {  //blocked\n            synchronized (ThreadState.class) {\n                try {\n                    TimeUnit.SECONDS.sleep(100);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        },\"t6\");\n        t6.start();\n\n        log.debug(\"t1  {}\",t1.getState());\n        log.debug(\"t2  {}\",t2.getState());\n        log.debug(\"t3  {}\",t3.getState());\n        log.debug(\"t4  {}\",t4.getState());\n        log.debug(\"t5  {}\",t5.getState());\n        log.debug(\"t6  {}\",t6.getState());\n\n        \n    }\n\n    public static void main(String[] args) {\n        test1();\n    }\n}\n\n```\n\n![](thread/d1f13ce8-f7cb-4cf1-b2aa-6e8d7204a459.png)\n\n## \n\n### \n\n\n\n- \n  - \n  -  4 \n-  sleep(n) \n\n\n\n>\n>\n>\n>\n>\n>\n> 1 \n>\n> 15\n>\n> 1\n>\n> 2\n>\n> 1\n>\n>\n>\n>\n>\n>\n>\n>- \n>\n>\n>\n>- \n>\n>\n>\n>- \n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>![image-20200806070304756](thread/image-20200806070304756.png)\n>\n>1620\n>\n>4\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>\n>![image-20200806070323056](thread/image-20200806070323056.png)\n>\n>\n>\n>\n>\n>\n\n### \n\n``` java\n/**\n * <p>\n * ,\n *\n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\n@Slf4j\npublic class MakingTea {\n    /**\n     * t2  t1  \n     */\n    private static void t1() {\n        Thread t1 = new Thread(() -> {\n            log.info(\"\");\n            try {\n                TimeUnit.SECONDS.sleep(1);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            log.info(\"\");\n            try {\n                TimeUnit.SECONDS.sleep(5);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\");\n        t1.start();\n\n        Thread t2 = new Thread(() -> {\n            try {\n                log.info(\"\");\n                TimeUnit.SECONDS.sleep(5);\n\n                //t1\n                t1.join();\n                log.info(\"\");\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t2\");\n        t2.start();\n    }\n\n    public static void main(String[] args) {\n        t1();\n    }\n}\n\n```\n\n![image-20200806072602725](thread/image-20200806072602725.png)\n\n## \n\n\n\n- \n\n-  api startrunsleepjoininterrupt \n\n- \n\n- \n\n  - \n\n  - \n\n  - join\n\n  - \n\n- \n\n  - \n\n  - Thread  \n\n- \n  - \n\n\n\n# \n\n## \n\n### \n\n- CPU\n\n  ![image-20200806080136510](thread/image-20200806080136510.png)\n\n- \n\n- 24sleep io wait\n\n  ![image-20200806080218070](thread/image-20200806080218070.png)\n\n- \n\n- \n\n-  [  ]\n\n- \n\n- \n\n  \n\n- \n\n  ![image-20200806080338819](thread/image-20200806080338819.png)\n\n- \n\n-  0  +1 \n\n-  [  ] [ 11...] \n\n-  [  ] 0  -1  -1 \n\n- [] 1 \n\n  ![image-20200806080425078](thread/image-20200806080425078.png)\n\n-  1  0\n\n### Java\n\n 0  5000  0 \n\n``` java\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\n@Slf4j\npublic class SharedVariables {\n    private static int counter = 0;\n    \n    /**\n     * \n     */\n    private static void t1() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                counter++;\n            }\n        }, \"t1\");\n        t1.start();\n\n        Thread t2 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                counter--;\n            }\n        }, \"t2\");\n        t2.start();\n\n        t1.join();\n        t2.join();\n\n        log.info(\"counter:{}\", counter);\n    }\n\n    public static void main(String[] args) {\n        t1();\n    }\n}\n```\n\n\n\n### \n\n Java \n\n i++ i  JVM \n\n```\ngetstatic i // i\niconst_1 // 1\niadd // \nputstatic i // i\n```\n\n i-- :\n\n```\ngetstatic i // i\niconst_1 // 1\nisub // \nputstatic i // i\n```\n\n Java \n\n![image-20200806081215362](thread/image-20200806081215362.png)\n\n 8 \n\n![image-20200806081309415](thread/image-20200806081309415.png)\n\n 8 \n\n\n\n![image-20200806081339039](thread/image-20200806081339039.png)\n\n\n\n![image-20200806081409317](thread/image-20200806081409317.png)\n\n### (Critical Section)\n\n- \n\n- ****\n\n  - ****\n\n  - ****\n\n- ********\n\n:\n\n``` java\nstatic int counter = 0;\nstatic void increment() \n// \n{ \n counter++; \n}\nstatic void decrement() \n// \n{ \n counter--; \n}\n```\n\n### (Race Condition)\n\n********\n\n##  synchronized\n\n### ***** ****\n\n\n\n- synchronizedLock\n\n- \n\nsynchronized\n\n\n\n\n\n>****\n>\n> java  synchronized \n>\n>\n>\n>\n\n### synchronized\n\n#### \n\n``` java\nsynchronized() // 1 2(blocked)\n{\n \n}\n```\n\n#### \n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\n@Slf4j\npublic class SharedVariables {\n    private static int counter = 0;\n    private static Object lock = new Object();\n\n    /**\n     * \n     * synchronized\n     */\n    private static void t2() throws InterruptedException {\n        Thread t1 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                synchronized (lock) {\n                    counter++;\n                }\n            }\n        }, \"t1\");\n        t1.start();\n\n        Thread t2 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                synchronized (lock) {\n                    counter--;\n                }\n            }\n        }, \"t2\");\n        t2.start();\n\n        t1.join();\n        t2.join();\n        log.info(\"counter:{}\", counter);\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        t2();\n    }\n}\n\n```\n\n \n\n``` java\n/**\n * <p>\n * ,\n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\n@Slf4j\npublic class Room {\n    private int counter = 0;\n\n    public void increment() {\n        synchronized (this) {\n            counter++;\n        }\n    }\n\n    public void decrement() {\n        synchronized (this) {\n            counter--;\n        }\n    }\n\n    public int getCounter() {\n        synchronized (this) {\n            return counter;\n        }\n    }\n\n    public static void main(String[] args) throws InterruptedException {\n        Room room = new Room();\n        Thread t1 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                room.increment();\n            }\n        }, \"t1\");\n        t1.start();\n\n        Thread t2 = new Thread(() -> {\n            for (int i = 0; i < 5000; i++) {\n                room.decrement();\n            }\n        }, \"t2\");\n        t2.start();\n\n        t1.join();\n        t2.join();\n\n        log.info(\"counter:{}\", room.getCounter());\n    }\n}\n```\n\n\n\n![image-20200806093605366](thread/image-20200806093605366.png)\n\n\n\n- `synchronized()` room t1t2 \n\n-  t1  `synchronized(room)`  t1 `count++` \n\n-  t2  `synchronized(room)` \n\n-  t1  cpu t1 t2  t1 \n\n-  t1  `synchronized{}`  obj  t2 t2  obj  `count--` \n\n\n\n:\n\n![image-20200806093649652](thread/image-20200806093649652.png)\n\n### \n\n`synchronized` ********\n\n:\n\n-  synchronized(obj)  for -- \n\n-  t1 synchronized(obj1)  t2 synchronized(obj2) -- \n\n-  t1 synchronized(obj)  t2 -- \n\n\n\n## synchronized\n\n`synchronized```\n\n``` java\nclass Test {\n    public synchronized void test() {\n\n    }\n}\n\n//\n\nclass Test {\n    public void test() {\n        synchronized (this) {\n\n        }\n    }\n}\n```\n\n`synchronized```\n\n``` java\n\nclass Test{\n    public synchronized static void test() {\n    }\n}\n\n//\n\nclass Test {\n    public static void test() {\n        synchronized (Test.class) {\n\n        }\n    }\n}\n```\n\n### synchronized\n\n synchronzied \n\n### \n\n synchronized \n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\n/**\n * <p>\n *  8\n * </p>\n * <p>\n * <strong> synchronized </strong>\n * <strong>  </strong><strong></strong>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\n@Slf4j\npublic class Thread8Locks {\n    public static void main(String[] args) {\n//        t1();\n//        t2();\n//        t3();\n//        t4();\n//        t5();\n//        t6();\n//        t7();\n//        t8();\n    }\n\n    /**\n     * \n     * t1, 1 2\n     * t2, 2 1\n     */\n    private static void t1() {\n        Number1 n = new Number1();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.a();\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.b();\n        }, \"t2\").start();\n    }\n\n    /**\n     * \n     * t1,1s 1 2\n     * t2, 2 1s 1\n     */\n    private static void t2() {\n        Number2 n = new Number2();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                n.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.b();\n        }, \"t2\").start();\n    }\n\n    /**\n     * \n     * c\n     * t3 3\n     * t1,t3,t2,1s 1 2  ; 3,1s,1,2\n     * t2,t3,t1, 2 1s 1; 2,3,1s,1\n     * t3,t1,t2,1s2 1; 3,1s,1,2\n     * t3,t2,t1 2 1s 1; 3,2,1s,1\n     */\n    private static void t3() {\n        Number3 n = new Number3();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                n.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.b();\n        }, \"t2\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.c();\n        }, \"t3\").start();\n    }\n\n\n    /**\n     * \n     * t1  t2 \n     * t1,t2,21s1; 2,1s,1\n     * t2,t1,21s1; 2,1s,1\n     */\n    private static void t4() {\n        Number4 n1 = new Number4();\n        Number4 n2 = new Number4();\n        new Thread(() -> {\n            try {\n                n1.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            n2.b();\n        }, \"t2\").start();\n    }\n\n\n    /**\n     * a\n     * b\n     * t1  t2 \n     * t1,t2,21s1; 2,1s,1\n     * t2,t1,21s1; 2,1s,1\n     */\n    private static void t5() {\n        Number5 n = new Number5();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                Number5.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.b();\n        }, \"t2\").start();\n    }\n\n\n    /**\n     * \n     * t1,t2,1s12; 1s,1,2\n     * t2,t1,21s1; 2,1s,1\n     */\n    private static void t6() {\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                Number6.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            Number6.b();\n        }, \"t2\").start();\n    }\n\n\n    /**\n     * a\n     * b\n     * t1  t2 \n     * t1,t2,21s1; 2,1s,1\n     * t2,t1,21s1; 2,1s,1\n     */\n    private static void t7() {\n        Number7 n1 = new Number7();\n        Number7 n2 = new Number7();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                n1.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n2.b();\n        }, \"t2\").start();\n    }\n\n\n    /**\n     * \n     * t1,t2,1s12; 1s,1,2\n     * t2,t1,21s1; 2,1s,1\n     */\n    private static void t8() {\n        Number8 n = new Number8();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            try {\n                n.a();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }, \"t1\").start();\n        new Thread(() -> {\n            log.debug(\"begin....\");\n            n.b();\n        }, \"t2\").start();\n    }\n\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number1\")\nclass Number1 {\n    public synchronized void a() {\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number2\")\nclass Number2 {\n    public synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number3\")\nclass Number3 {\n    public synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n\n    public void c() {\n        log.debug(\"3\");\n    }\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number4\")\nclass Number4 {\n    public synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n\n}\n\n/**\n * a\n * b\n */\n@Slf4j(topic = \"c.Number5\")\nclass Number5 {\n    public static synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number6\")\nclass Number6 {\n    public static synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public static synchronized void b() {\n        log.debug(\"2\");\n    }\n\n}\n\n/**\n * a\n * b\n */\n@Slf4j(topic = \"c.Number7\")\nclass Number7 {\n    public static synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public synchronized void b() {\n        log.debug(\"2\");\n    }\n}\n\n/**\n * \n */\n@Slf4j(topic = \"c.Number8\")\nclass Number8 {\n    public static synchronized void a() throws InterruptedException {\n        Thread.sleep(1000);\n        log.debug(\"1\");\n    }\n\n    public static synchronized void b() {\n        log.debug(\"2\");\n    }\n\n}\n\n```\n\n\n\n## \n\n#### \n\n- \n\n- \n\n  - \n\n  - \n\n#### \n\n- \n\n- \n\n  - \n\n  - \n\n``` java\npublic static void test1() {\n\tint i = 10;\n\ti++; \n}\n```\n\n test1()  i.\n\n```\npublic static void test1();\n descriptor: ()V\n flags: ACC_PUBLIC, ACC_STATIC\n Code:\n stack=1, locals=1, args_size=0\n 0: bipush 10\n 2: istore_0\n 3: iinc 0, 1\n 6: return\n LineNumberTable:\n line 10: 0\n line 11: 3\n line 12: 6\n LocalVariableTable:\n Start Length Slot Name Signature\n 3 4 0 i I\n```\n\n![image-20200806112353892](thread/image-20200806112353892.png)\n\n\n\n**,**\n\n``` java\n/**\n * <p>\n *\n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\npublic class ThreadSecurity {\n    static final int THREAD_NUMBER = 2;\n    static final int LOOP_NUMBER = 200;\n\n    public static void main(String[] args) {\n        ThreadUnsafe test = new ThreadUnsafe();\n        for (int i = 0; i < THREAD_NUMBER; i++) {\n            new Thread(() -> {\n                test.method1(LOOP_NUMBER);\n            }, \"Thread\" + i).start();\n        }\n    }\n}\nclass ThreadUnsafe {\n    ArrayList<String> list = new ArrayList<>();\n    public void method1(int loopNumber) {\n        for (int i = 0; i < loopNumber; i++) {\n            // { , \n            method2();\n            method3();\n            // } \n        }\n    }\n    private void method2() {\n        list.add(\"1\");\n    }\n    private void method3() {\n        list.remove(0);\n    }\n}\n```\n\n**2  add1 remove **\n\n![image-20200806113017975](thread/image-20200806113017975.png)\n\n\n\n-  method2  list \n\n- method3  method2 \n\n  ![image-20200806113212737](thread/image-20200806113212737.png)\n\n  ** list **\n\n``` java\npackage com.wry.concurrent.thread;\n\nimport java.util.ArrayList;\n\n/**\n * <p>\n *\n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/6\n */\npublic class ThreadSecurity {\n    static final int THREAD_NUMBER = 2;\n    static final int LOOP_NUMBER = 200;\n\n    public static void main(String[] args) {\n        Threadsafe test = new Threadsafe();\n        for (int i = 0; i < THREAD_NUMBER; i++) {\n            new Thread(() -> {\n                test.method1(LOOP_NUMBER);\n            }, \"Thread\" + i).start();\n        }\n    }\n}\nclass Threadsafe {\n\n    public void method1(int loopNumber) {\n        ArrayList<String> list = new ArrayList<>();\n        for (int i = 0; i < loopNumber; i++) {\n            // { , \n            method2(list);\n            method3(list);\n            // } \n        }\n    }\n    private void method2(ArrayList<String> list) {\n        list.add(\"1\");\n    }\n    private void method3(ArrayList<String> list) {\n        list.remove(0);\n    }\n}\n```\n\n\n\n\n\n- list \n\n-  method2  method1  method1 \n\n- method3  method2 \n\n![image-20200806113622053](thread/image-20200806113622053.png)\n\n method2  method3  public \n\n- 1 method2  method3\n\n  ``` java\n  /**\n   * <p>\n   *\n   * </p>\n   *\n   * @author wangruiyu\n   * @since 2020/8/6\n   */\n  public class ThreadSecurity2 {\n      static final int THREAD_NUMBER = 2;\n      static final int LOOP_NUMBER = 200;\n  \n      public static void main(String[] args) {\n  \n          Threadsafe2 test = new Threadsafe2();\n          for (int i = 0; i < THREAD_NUMBER; i++) {\n              new Thread(() -> {\n                  test.method1(LOOP_NUMBER);\n              }, \"Thread\" + i).start();\n          }\n      }\n  }\n  \n  class Threadsafe2 {\n  \n      public void method1(int loopNumber) {\n          ArrayList<String> list = new ArrayList<>();\n          for (int i = 0; i < loopNumber; i++) {\n              // { , \n              method2(list);\n              method3(list);\n              // } \n          }\n      }\n      public void method2(ArrayList<String> list) {\n          list.add(\"1\");\n      }\n      public void method3(ArrayList<String> list) {\n          list.remove(0);\n      }\n  }\n  ```\n\n  `method2``method3``method1`list \n\n- 2 1  ThreadSafe  method2  method3 \n\n  ``` java\n  \n  /**\n   * <p>\n   *\n   * </p>\n   *\n   * @author wangruiyu\n   * @since 2020/8/6\n   */\n  public class ThreadSecurity2 {\n      static final int THREAD_NUMBER = 2;\n      static final int LOOP_NUMBER = 200;\n  \n      public static void main(String[] args) {\n  \n          ThreadSafeSubClass test = new ThreadSafeSubClass();\n          for (int i = 0; i < THREAD_NUMBER; i++) {\n              new Thread(() -> {\n                  test.method1(LOOP_NUMBER);\n              }, \"Thread\" + i).start();\n          }\n      }\n  }\n  \n  class Threadsafe2 {\n  \n      public void method1(int loopNumber) {\n          ArrayList<String> list = new ArrayList<>();\n          for (int i = 0; i < loopNumber; i++) {\n              // { , \n              method2(list);\n              method3(list);\n              // } \n          }\n      }\n      public void method2(ArrayList<String> list) {\n          list.add(\"1\");\n      }\n      public void method3(ArrayList<String> list) {\n          list.remove(0);\n      }\n  }\n  \n  class ThreadSafeSubClass extends Threadsafe2{\n      @Override\n      public void method3(ArrayList<String> list) {\n          new Thread(() -> {\n              list.remove(0);\n          }).start();\n      }\n  }\n  ```\n\n- ![image-20200806115634318](thread/image-20200806115634318.png)\n\n\n\n** private  final **\n\n#### \n\n- String\n\n- Integer\n\n- StringBuffffer\n\n- Random\n\n- Vector\n\n- Hashtable\n\n- JAVA.util.concurrent \n\n\n\n``` java\nHashtable table = new Hashtable();\n\nnew Thread(()->{\n table.put(\"key\", \"value1\");\n}).start();\n\nnew Thread(()->{\n table.put(\"key\", \"value2\");\n}).start()\n```\n\n- \n\n- ****\n\n##### \n\n\n\n``` java\nHashtable table = new Hashtable();\n// 12\nif( table.get(\"key\") == null) {\n table.put(\"key\", value);\n}\n```\n\n![image-20200818213438504](thread/image-20200818213438504.png)\n\n##### \n\nStringInteger \n\nString  replacesubstring \n\n\n\n``` java\npublic class Immutable{\n    \n private int value = 0;\n    \n public Immutable(int value){\n \tthis.value = value;\n }\n public int getValue(){\n \treturn this.value;\n }\n}\n```\n\n\n\n``` java\npublic class Immutable{\n    \n private int value = 0;\n    \n public Immutable(int value){\n \tthis.value = value;\n }\n public int getValue(){\n \treturn this.value;\n }\n \n public Immutable add(int v){\n \treturn new Immutable(this.value + v);\n } \n}\n```\n\n#### \n\n##### \n\n\n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Random;\nimport java.util.concurrent.CopyOnWriteArrayList;\n\n/**\n * <p>\n *    -   \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/17\n */\n@Slf4j\npublic class ExerciseSell {\n    public static void main(String[] args) {\n        //\n        TicketWindows ticketWindows = new TicketWindows(2000);\n        //\n        List<Integer> list = new CopyOnWriteArrayList<>();\n        //\n        List<Thread> threadList = new ArrayList<>();\n        for (int i = 0; i < 4000; i++) {\n            Thread thread = new Thread(() -> {\n                //\n                int sell = ticketWindows.sell(randomAmount());\n                list.add(sell);\n            });\n            thread.start();\n            threadList.add(thread);\n        }\n\n        //\n        threadList.forEach(thread -> {\n            try {\n                thread.join();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        });\n        //\n        log.info(\"{}\", ticketWindows.getCount());\n        log.info(\"{}\", list.stream().mapToInt(Integer::intValue).sum());\n    }\n\n    //Random \n    static Random random = new Random();\n\n    //15\n    private static int randomAmount() {\n        return random.nextInt(5) + 1;\n    }\n}\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/17\n */\nclass TicketWindows {\n    private int count;\n\n    public TicketWindows(int count) {\n        this.count = count;\n    }\n\n    public int getCount() {\n        return count;\n    }\n\n    public int sell(int amount) {\n\n        if (count >= amount) {\n            synchronized (this) {\n                count -= amount;\n            }\n            return amount;\n        }\n        return 0;\n\n    }\n}\n\n```\n\n##### \n\n\n\n``` java\npackage com.wry.concurrent.thread;\n\nimport lombok.extern.slf4j.Slf4j;\n\nimport java.util.Random;\n\n/**\n * <p>\n *   -   \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/17\n */\n@Slf4j\npublic class ExceriseTransfer {\n    public static void main(String[] args) throws InterruptedException {\n        Account a = new Account(1000);\n        Account b = new Account(1000);\n        Thread threadA = new Thread(() -> {\n            for (int i = 0; i < 1000; i++) {\n                a.transfer(b, randomAmount());\n            }\n        });\n        Thread threadB = new Thread(() -> {\n            for (int i = 0; i < 1000; i++) {\n                b.transfer(a, randomAmount());\n            }\n        });\n        threadA.start();\n        threadB.start();\n        threadA.join();\n        threadB.join();\n        //\n        log.info(\"A {}\", a.getMoney());\n        log.info(\"B {}\", b.getMoney());\n    }\n\n\n    //Random \n    static Random random = new Random();\n\n    //1100\n    private static int randomAmount() {\n        return random.nextInt(100) + 1;\n    }\n}\n\n/**\n * <p>\n * \n * </p>\n *\n * @author wangruiyu\n * @since 2020/8/17\n */\nclass Account {\n    private int money;\n\n    public Account(int money) {\n        this.money = money;\n    }\n\n    public int getMoney() {\n        return money;\n    }\n\n    public void setMoney(int money) {\n        this.money = money;\n    }\n\n    /**\n     * \n     *\n     * @param account \n     * @param money   \n     */\n    public void transfer(Account account, int money) {\n        synchronized (Account.class) {\n            if (this.money >= money) {\n                account.setMoney(account.getMoney() + money);\n                this.setMoney(this.getMoney() - money);\n            }\n        }\n    }\n//    //synchronized  \n//    public synchronized  void transfer(Account account, int money) {\n//          if (this.money >= money) {\n//              account.setMoney(account.getMoney() + money);\n//              this.setMoney(this.getMoney() - money);\n//          }\n//    }\n}\n\n```\n\n## Monitor\n\n### Java\n\n 32 \n\n#### \n\n```ruby\n|--------------------------------------------------------------| \n| \t\t\t\t\tObject Header (64 bits)\t\t \t\t       |\n|------------------------------------|-------------------------| \n|\t\t Mark Word (32 bits) \t     | Klass Word (32 bits)    |\n|------------------------------------|-------------------------|\n```\n\n#### \n\n```ruby\n|---------------------------------------------------------------------------------|\n| \t\t\t\t\t\t\t\tObject Header (96 bits)\t\t\t \t\t\t\t  |\n|--------------------------------|-----------------------|------------------------|\n| \t\t\tMark Word(32bits) \t | \tKlass Word(32bits)   | array length(32bits)   |\n|--------------------------------|-----------------------|------------------------|\n```\n\n Mark Word \n\n```ruby\n|-------------------------------------------------------|--------------------|\n| \t\t\t\t\tMark Word (32 bits)\t\t\t\t\t| \t\tState\t\t |\n|-------------------------------------------------------|--------------------|\n| \t\t  hashcode:25 | age:4 | biased_lock:0 \t| 01\t| \t\tNormal\t\t |\n|-------------------------------------------------------|--------------------|\n| thread:23 | epoch:2 | age:4 | biased_lock:1 \t| 01\t| \t\tBiased\t\t |\n|-------------------------------------------------------|--------------------|\n| \t\tptr_to_lock_record:30 \t\t\t\t\t| 00 \t| Lightweight Locked |\n|-------------------------------------------------------|--------------------|\n| \t\tptr_to_heavyweight_monitor:30 \t\t\t| 10 \t| Heavyweight Locked |\n|-------------------------------------------------------|--------------------|\n| \t\t\t\t\t\t\t\t\t\t\t\t| 11\t|\t Marked for GC\t |\n|-------------------------------------------------------|--------------------|\n```\n\n\n\n64  Mark Word\n\n```ruby\n|--------------------------------------------------------------------|--------------------|\n| \t\t\t\t\t\t\tMark Word (64 bits) \t\t\t\t\t | \t\t  State  \t  |\n|--------------------------------------------------------------------|--------------------|\n|  unused:25 | hashcode:31 | unused:1 | age:4 | biased_lock:0 |  01  | \t\t  Normal\t  |\n|--------------------------------------------------------------------|--------------------|\n|  thread:54 | epoch:2     | unused:1 | age:4 | biased_lock:1 |  01  | \t\t  Biased\t  |\n|--------------------------------------------------------------------|--------------------|\n| \t\tptr_to_lock_record:62\t\t\t\t\t\t\t\t  |  00  | Lightweight Locked |\n|--------------------------------------------------------------------|--------------------|\n| \t\tptr_to_heavyweight_monitor:62 \t\t\t\t\t\t  |  10  | Heavyweight Locked |\n|--------------------------------------------------------------------|--------------------|\n| \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  |  11  | \tMarked for GC\t  |\n|--------------------------------------------------------------------|--------------------|\n```\n\n****\n\nhttps://stackoverflflow.com/questions/26357186/what-is-in-java-object-header\n\n## Monitor()\n\n### Monitor\n\nMonitor ********\n\n Java  Monitor  synchronized Mark Word  Monitor Monitor \n\n![image-20200819064936628](thread/image-20200819064936628.png)\n\n\n\n-  Monitor  Owner  null\n\n-  Thread-2  synchronized(obj)  Monitor  Owner  Thread-2Monitor Owner\n\n-  Thread-2  Thread-3Thread-4Thread-5  synchronized(obj)EntryList BLOCKED\n\n- Thread-2  EntryList \n\n-  WaitSet  Thread-0Thread-1  WAITING wait-notify \n\n>****\n>\n>synchronized  monitor \n>\n> synchronized \n\n##  synchronized\n\n****\n\n\n\n-  - JVM\n\n-  - \n\n-  - \n\n-  - \n\n-  -  - Monitor\n\n-  -  - \n\n-  -  - \n\n-  -  20 \n\n-  - \n\n\n\n\n\n\n\n\n\n\n\n 20 \n\n### synchronized\n\n``` java\nstatic final Object lock = new Object();\n\nstatic int counter = 0;\n\npublic static void main(String[] args) {\n synchronized (lock) {\n \tcounter++;\n }\n}\n```\n\n\n\n``` java\npublic static void main(java.lang.String[]);\n descriptor: ([Ljava/lang/String;)V\n flags: ACC_PUBLIC, ACC_STATIC\n Code:\n stack=2, locals=3, args_size=1\n 0: getstatic #2 // <- lock synchronized\n 3: dup\n 4: astore_1 // lock -> slot 1\n 5: monitorenter //  lock MarkWord  Monitor \n 6: getstatic #3 // <- i\n 9: iconst_1 //  1\n 10: iadd // +1\n 11: putstatic #3 // -> i\n 14: aload_1 // <- lock\n 15: monitorexit //  lock MarkWord ,  EntryList\n 16: goto 24\n 19: astore_2 // e -> slot 2 \n 20: aload_1 // <- lock\n 21: monitorexit //  lock MarkWord ,  EntryList\n 22: aload_2 // <- slot 2 (e)\n 23: athrow // throw e\n 24: return\n Exception table:\n from to target type\n 6 16 19 any\n 19 22 19 any\n LineNumberTable:\n line 8: 0\n line 9: 6\n line 10: 14\n line 11: 24\n LocalVariableTable:\n Start Length Slot Name Signature\n 0 25 0 args [Ljava/lang/String;\n StackMapTable: number_of_entries = 2\n frame_type = 255 /* full_frame */\n offset_delta = 19\n locals = [ class \"[Ljava/lang/String;\", class java/lang/Object ]\n stack = [ class java/lang/Throwable ]\n frame_type = 250 /* chop */\n offset_delta = 4              \n```\n\n\n\n>****\n>\n> synchronized \n\n### synchronized\n\n#### 1.\n\n\n\n `synchronized`\n\n\n\n``` java\nstatic final Object obj = new Object();\n\npublic static void method1() {\n synchronized( obj ) {\n //  A\n method2();\n }\n}\npublic static void method2() {\n synchronized( obj ) {\n //  B\n }\n}\n```\n\n- Lock RecordMark Word\n\n![image-20200819065515918](thread/image-20200819065515918.png)\n\n-  Object reference  cas  Object  Mark Word Mark Word \n\n  ![image-20200819065601188](thread/image-20200819065601188.png)\n\n -  cas   00 \n\n   ![image-20200819065708766](thread/image-20200819065708766.png)\n\n-  cas \n\n  -  Object \n  -  synchronized  Lock Record \n\n  ![image-20200819065835524](thread/image-20200819065835524.png)\n\n-  synchronized  null \n\n  ![image-20200819065931928](thread/image-20200819065931928.png)\n\n-  synchronized  null cas  Mark Word \n\n  - \n  - \n\n#### 2.\n\nCAS \n\n``` java\nstatic Object obj = new Object();\n\npublic static void method1() {\n synchronized( obj ) {\n // \n }\n}\n```\n\n-  Thread-1 Thread-0 \n\n  ![image-20200819071006301](thread/image-20200819071006301.png)\n\n-  Thread-1 \n\n  -  Object  `Monitor`  Object \n  -  `Monitor`  `EntryList` BLOCKED\n\n![image-20200819071139042](thread/image-20200819071139042.png)\n\n-  Thread-0  cas  Mark Word  Monitor  Monitor  Owner  null EntryList  BLOCKED \n\n#### 3.\n\n\n\n\n\n| **** **1** ******core 1** **** | **** **Mark**      | **** **2** ******core 2** **** |\n| ---------------------------------------- | ---------------------- | ---------------------------------------- |\n| -                                        | 10           | -                                        |\n|  monitor                 | 10 | -                                        |\n|                              | 10 | -                                        |\n|                                | 10 |                                          |\n|                                | 10 |  monitor                 |\n|                                | 10 |                                  |\n|                                  | 10 |                                  |\n|                              | 01             |                                  |\n| -                                        | 10 |                              |\n| -                                        | 10 |                                |\n| -                                        | 10 |                                |\n| ...                                      | ....                   | ....                                     |\n\n\n\n| **** **1** ******core 1** **** | **** **Mark**        | **** **2** ******core 2** **** |\n| ---------------------------------------- | ------------------------ | ---------------------------------------- |\n| -                                        | 10             | -                                        |\n|  monitor                 | 10   | -                                        |\n|                              | 10   | -                                        |\n|                                | 10   |                                          |\n|                                | 10   |  monitor                 |\n|                                | 10   |                                  |\n|                                | 10   |                                  |\n|                                | 10 |                                  |\n|                                | 10 |                                  |\n|                                | 10 |                                  |\n|                                | 10 |                                      |\n| ...                                      | ...                      | ...                                      |\n\n-  CPU  CPU  CPU \n\n-  Java 6 ****\n\n- Java 7 \n\n#### 4.\n\n CAS \n\nJava 6  CAS  ID  Mark Word  ID  CAS\n\n\n\n``` java\nstatic final Object obj = new Object();\n\npublic static void m1() {\n synchronized( obj ) {\n \t//  A\n \tm2();\n }\n}\npublic static void m2() {\n synchronized( obj ) {\n \t//  B\n \tm3();\n }\n}\npublic static void m3() {\n synchronized( obj ) {\n \t//  C\n }\n}\n```\n\n![image-20200819072452480](thread/image-20200819072452480.png)\n\n![image-20200819072504262](thread/image-20200819072504262.png)\n\n****\n\n\n\n```ruby\n|--------------------------------------------------------------------|--------------------|\n| \t\t\t\t\t\t\tMark Word (64 bits) \t\t\t\t\t | \t\t  State  \t  |\n|--------------------------------------------------------------------|--------------------|\n|  unused:25 | hashcode:31 | unused:1 | age:4 | biased_lock:0 |  01  | \t\t  Normal\t  |\n|--------------------------------------------------------------------|--------------------|\n|  thread:54 | epoch:2     | unused:1 | age:4 | biased_lock:1 |  01  | \t\t  Biased\t  |\n|--------------------------------------------------------------------|--------------------|\n| \t\tptr_to_lock_record:62\t\t\t\t\t\t\t\t  |  00  | Lightweight Locked |\n|--------------------------------------------------------------------|--------------------|\n| \t\tptr_to_heavyweight_monitor:62 \t\t\t\t\t\t  |  10  | Heavyweight Locked |\n|--------------------------------------------------------------------|--------------------|\n| \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  |  11  | \tMarked for GC\t  |\n|--------------------------------------------------------------------|--------------------|\n```\n\n\n\n- markword  0x05  3  101threadepochage  0\n\n-  VM \n\n   `-XX:BiasedLockingStartupDelay=0` \n\n- markword  0x01  3  001 hashcodeage  0 hashcode \n\n1 \n\n2 \n\n``` java\nclass Dog {\n    \n}\n```\n\n jol  jol \n\n``` java\n//  -XX:BiasedLockingStartupDelay=0 \npublic static void main(String[] args) throws IOException {\n \tDog d = new Dog();\n \tClassLayout classLayout = ClassLayout.parseInstance(d);\n \tnew Thread(() -> {\n \t\tlog.debug(\"synchronized \");\n \t\tSystem.out.println(classLayout.toPrintableSimple(true));\n \t\tsynchronized (d) {\n \t\t\tlog.debug(\"synchronized \");\n \t\t\tSystem.out.println(classLayout.toPrintableSimple(true));\n \t\t}\n \t\tlog.debug(\"synchronized \");\n \t\tSystem.out.println(classLayout.toPrintableSimple(true));\n \t}, \"t1\").start();\n}\n```\n\n\n\n```\n11:08:58.117 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000101 \n11:08:58.121 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00011111 11101011 11010000 00000101 \n11:08:58.121 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00011111 11101011 11010000 00000101\n```\n\n>****\n>\n> id \n\n3\n\n VM  `-XX:-UseBiasedLocking` \n\n\n\n```\n11:13:10.018 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n11:13:10.021 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00100000 00010100 11110011 10001000 \n11:13:10.021 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001\n```\n\n4)  hashCode\n\n hashCode \n\n####  **-** hashCode\n\n hashCode MarkWord  id hashCode \n\n-  hashCode\n\n-  Monitor  hashCode\n\n hashCode  `-XX:-UseBiasedLocking`\n\n\n\n```\n11:22:10.386 c.TestBiased [main] -  hashCode:1778535015 \n11:22:10.391 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 01101010 00000010 01001010 01100111 00000001 \n11:22:10.393 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 00000000 00100000 11000011 11110011 01101000 \n11:22:10.393 c.TestBiased [t1] - synchronized \n00000000 00000000 00000000 01101010 00000010 01001010 01100111 00000001\n```\n\n####  **-** \n\n\n\n``` java\nprivate static void test2() throws InterruptedException {\n \tDog d = new Dog();\n \tThread t1 = new Thread(() -> {\n\t\t synchronized (d) {\n \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t}\n \t\tsynchronized (TestBiased.class) {\n \t\t\tTestBiased.class.notify();\n \t\t}\n \t\t//  wait/notify  join \n \t\t// t1  jvm  t2  id \n         /*try {\n         System.in.read();\n         } catch (IOException e) {\n         e.printStackTrace();\n         }*/\n \t}, \"t1\");\n \tt1.start();\n    \n \tThread t2 = new Thread(() -> {\n \t\tsynchronized (TestBiased.class) {\n \t\t\ttry {\n \t\t\t\tTestBiased.class.wait();\n \t\t\t} catch (InterruptedException e) {\n \t\t\t\te.printStackTrace();\n \t\t\t}\n \t\t}\n \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\tsynchronized (d) {\n \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t}\n \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t}, \"t2\");\n \tt2.start();\n}\n```\n\n\n\n```\n[t1] - 00000000 00000000 00000000 00000000 00011111 01000001 00010000 00000101 \n\n[t2] - 00000000 00000000 00000000 00000000 00011111 01000001 00010000 00000101 \n\n[t2] - 00000000 00000000 00000000 00000000 00011111 10110101 11110000 01000000 \n\n[t2] - 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n```\n\n####  -  wait/notify \n\n``` java\npublic static void main(String[] args) throws InterruptedException {\n \tDog d = new Dog();\n \tThread t1 = new Thread(() -> {\n \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\tsynchronized (d) {\n \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t\ttry {\n \t\t\t\td.wait();\n \t\t\t} catch (InterruptedException e) {\n \t\t\t\te.printStackTrace();\n \t\t\t}\n \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t}\n \t}, \"t1\");\n \tt1.start();\n    \n \tnew Thread(() -> {\n \t\ttry {\n \t\t\tThread.sleep(6000);\n \t\t} catch (InterruptedException e) {\n \t\t\te.printStackTrace();\n \t\t}\n\t\tsynchronized (d) {\n \t\t\tlog.debug(\"notify\");\n \t\t\td.notify();\n \t\t}\n \t}, \"t2\").start();\n}\n```\n\n\n\n```\n[t1] - 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000101 \n[t1] - 00000000 00000000 00000000 00000000 00011111 10110011 11111000 00000101 \n[t2] - notify \n[t1] - 00000000 00000000 00000000 00000000 00011100 11010100 00001101 11001010\n```\n\n#### \n\n T1  T2 Thread ID\n\n 20 jvm \n\n``` java\nprivate static void test3() throws InterruptedException {\n \tVector<Dog> list = new Vector<>();\n \tThread t1 = new Thread(() -> {\n \t\tfor (int i = 0; i < 30; i++) {\n \t\t\tDog d = new Dog();\n \t\t\tlist.add(d);\n \t\t\tsynchronized (d) {\n \t\t\t\tlog.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t\t}\n \t\t}\n \t\tsynchronized (list) {\n \t\t\tlist.notify();\n \t\t} \n \t}, \"t1\");\n \tt1.start();\n \n \tThread t2 = new Thread(() -> {\n \t\tsynchronized (list) {\n \t\t\ttry {\n\t\t\t\tlist.wait();\n \t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n \t\t\t}\n \t\t}\n \t\tlog.debug(\"===============> \");\n \t\tfor (int i = 0; i < 30; i++) {\n \t\t\tDog d = list.get(i);\n \t\t\tlog.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t\tsynchronized (d) {\n \t\t\t\tlog.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t\t}\n \t\t\tlog.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n \t\t}\n \t}, \"t2\");\n \tt2.start();\n}\n```\n\n\n\n```\n[t1] - 0 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 1 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 2 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 3 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 4 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 5 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 6 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 7 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 8 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 9 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 10 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 11 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 12 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 13 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 14 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 15 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 16 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 17 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 18 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t1] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - ===============> \n[t2] - 0 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 0 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 1 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 1 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 1 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 2 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 2 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 2 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 3 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 3 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 3 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 4 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 4 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 4 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 5 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 5 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 5 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 6 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 6 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 6 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 7 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 7 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 7 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 8 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 8 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 8 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 9 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 9 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 9 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 10 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 10 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 10 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 11 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 11 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 11 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 12 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 12 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 12 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 13 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 13 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 13 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 14 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 14 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 14 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 15 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 15 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 15 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 16 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 16 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 16 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 17 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 17 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 17 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 18 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 18 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 \n[t2] - 18 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 \n[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 \n[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 \n[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101\n```\n\n#### \n\n 40 jvm \n\n``` java\n\n    static Thread t1, t2, t3;\n\n    private static void test4() throws InterruptedException {\n        Vector<Dog> list = new Vector<>();\n        int loopNumber = 39;\n        t1 = new Thread(() -> {\n            for (int i = 0; i < loopNumber; i++) {\n                Dog d = new Dog();\n                list.add(d);\n                synchronized (d) {\n                    log.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n                }\n            }\n            LockSupport.unpark(t2);\n        }, \"t1\");\n        t1.start();\n        t2 = new Thread(() -> {\n            LockSupport.park();\n            log.debug(\"===============> \");\n            for (int i = 0; i < loopNumber; i++) {\n                Dog d = list.get(i);\n                log.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n                synchronized (d) {\n                    log.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n                }\n                log.debug(i + \"\\t\" + ClassLayout.parseInstance(d).toPrintableSimple(true));\n            }\n            LockSupport.unpark(t3);\n        }, \"t2\");\n    }\n```\n\n>****\n>\n>https://github.com/farmerjohngit/myblog/issues/12\n>\n>https://www.cnblogs.com/LemonFive/p/11246086.html\n>\n>https://www.cnblogs.com/LemonFive/p/11248248.html\n>\n>\n\n#### 5.\n\n\n\n``` java\n@Fork(1)\n@BenchmarkMode(Mode.AverageTime)\n@Warmup(iterations=3)\n@Measurement(iterations=5)\n@OutputTimeUnit(TimeUnit.NANOSECONDS)\npublic class MyBenchmark {\n    static int x = 0;\n    @Benchmark\n    public void a() throws Exception {\n        x++;\n    }\n    @Benchmark\n    public void b() throws Exception {\n        Object o = new Object();\n        synchronized (o) {\n            x++;\n        }\n    }\n}\n```\n\n`java -jar benchmarks.jar`\n\n```\nBenchmark\t\t\tMode\t Samples \tScore\t Score error \tUnits \nc.i.MyBenchmark.a \tavgt \t\t5 \t\t1.542 \t\t0.056 \t\tns/op \nc.i.MyBenchmark.b \tavgt \t\t5 \t\t1.518 \t\t0.091 \t\tns/op\n```\n\n`java -XX:-EliminateLocks -jar benchmarks.jar`\n\n```\nBenchmark \t\t\tMode \tSamples \tScore \tScore error \tUnits \nc.i.MyBenchmark.a \tavgt \t\t5 \t\t1.507 \t\t0.108 \t\tns/op \nc.i.MyBenchmark.b \tavgt \t\t5 \t\t16.976 \t\t1.572 \t\tns/op\n```\n\n****\n\n\n","slug":"2023/thread","published":1,"updated":"2024-08-05T11:07:24.367Z","comments":1,"layout":"post","photos":[],"_id":"clzxjaivi001jvaib0numhc3m","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>CPU,IO</li>\n<li></li>\n<li>( )(360 )</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>-</p>\n</li>\n<li><p>CPU</p>\n</li>\n<li><p>Java windows</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li></li>\n<li></li>\n<li><ul>\n<li>IPC (Inter-process communication)</li>\n<li>,HTTP</li>\n</ul>\n</li>\n<li>--</li>\n<li>,-</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>cpu<code></code>- -cpu(windows15)cpu()<br><code></code>- -:<code></code><code></code>CPU concurrent</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">CPU</th>\n<th align=\"center\">1</th>\n<th align=\"center\">2</th>\n<th align=\"center\">3</th>\n<th align=\"center\">4</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">core</td>\n<td align=\"center\">1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">3</td>\n<td align=\"center\">4</td>\n</tr>\n</tbody></table>\n<img src=\"/post/2023/thread/453affe8-17db-40b3-940f-162e7597336e.png\" class=\"\">\n\n<p>CPUcore</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">CPU</th>\n<th align=\"center\">1</th>\n<th align=\"center\">2</th>\n<th align=\"center\">3</th>\n<th align=\"center\">4</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">core1</td>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n<td align=\"center\">3</td>\n<td align=\"center\">3</td>\n</tr>\n<tr>\n<td align=\"center\">core2</td>\n<td align=\"center\">2</td>\n<td align=\"center\">2</td>\n<td align=\"center\">4</td>\n<td align=\"center\">4</td>\n</tr>\n</tbody></table>\n<img src=\"/post/2023/thread/2ed065be-3fb7-4e67-b04e-b8e08980405d.png\" class=\"\">\n\n<p>Rob Pike:</p>\n<ul>\n<li>(concurrent) - -(dealing with) </li>\n<li>(parallel) - -(doing) </li>\n</ul>\n<p></p>\n<ul>\n<li>-,</li>\n<li>-(,)</li>\n<li>3</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br><br><strong>:</strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>()5<br>5,</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.util;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileNotFoundException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileReader;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/26</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FileReaderUtil</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">read</span><span class=\"params\">(String path)</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;FileReader start .....&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">FileReader</span> <span class=\"variable\">reader</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">java</span>.io.FileReader(path);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (FileNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;FileReader end .....&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.n2;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.wry.concurrent.constans.Constans;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.wry.concurrent.util.FileReaderUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileNotFoundException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileReader;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/26</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Sync</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//fileReader</span></span><br><span class=\"line\">        FileReaderUtil.read(Constans.FILE_PATH);</span><br><span class=\"line\"></span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;do other things .....&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.n2;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.wry.concurrent.constans.Constans;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.wry.concurrent.util.FileReaderUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/26</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Async</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            FileReaderUtil.read(Constans.FILE_PATH);</span><br><span class=\"line\">        &#125;).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;do other things .....&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li></li>\n<li>tomcat servlet,tomcat</li>\n<li>UIui</li>\n</ul>\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"()\"></a>()</h3><p>cpu,3,</p>\n<blockquote>\n<p>\t1\t\t10ms<br>\t2\t\t11ms<br>\t3\t\t9 ms<br>\t1 ms</p>\n</blockquote>\n<ul>\n<li>10 + 11 + 9 + 1&#x3D; 31ms</li>\n<li>cpu, 11,22,33,311ms12ms</li>\n</ul>\n<p><strong> : cpu</strong></p>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.n2.example;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Arrays;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutionException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.FutureTask;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/26</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyBenchmark</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">int</span>[] ARRAY = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[<span class=\"number\">4000_000_00</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        Arrays.fill(ARRAY, <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *  4</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">async</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">Long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"type\">int</span>[] array = ARRAY;</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; task1 = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;Integer&gt;(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000_000_00</span>; i++) &#123;</span><br><span class=\"line\">                sum += array[<span class=\"number\">0</span> + i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; task2 = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;Integer&gt;(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000_000_00</span>; i++) &#123;</span><br><span class=\"line\">                sum += array[<span class=\"number\">1000_000_00</span> + i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; task3 = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;Integer&gt;(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000_000_00</span>; i++) &#123;</span><br><span class=\"line\">                sum += array[<span class=\"number\">2000_000_00</span> + i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; task4 = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;Integer&gt;(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000_000_00</span>; i++) &#123;</span><br><span class=\"line\">                sum += array[<span class=\"number\">3000_000_00</span> + i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task1).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task2).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task3).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task4).start();</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> task1.get() + task2.get() + task3.get() + task4.get();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">Long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span> + i + <span class=\"string\">&quot;\\t&quot;</span> + (end - start));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sync</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">Long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"type\">int</span>[] array = ARRAY;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">4000_000_00</span>; i++) &#123;</span><br><span class=\"line\">            sum += array[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">Long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span> + sum + <span class=\"string\">&quot;\\t&quot;</span> + (end - start));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        sync();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        async();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/4f22eeff-a017-46f6-bf49-5359e570fe22.png\" class=\"\">\n\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>1cpu,cpu, cpu,<br>2cpu</p>\n<pre><code>-  ,,([] )\n-  \n</code></pre>\n<p>3 IOcpu,[IO]cpu,IO[IO][I0]</p>\n<h1 id=\"JAVA\"><a href=\"#JAVA\" class=\"headerlink\" title=\"JAVA\"></a>JAVA</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>javamain</p>\n<h3 id=\"1-Thread\"><a href=\"#1-Thread\" class=\"headerlink\" title=\"1.Thread\"></a>1.Thread</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  Thread</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Thread1</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;runing....&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        thread.setName(<span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        thread.start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;main....&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-Runnable-Thread\"><a href=\"#2-Runnable-Thread\" class=\"headerlink\" title=\"2.Runnable Thread\"></a>2.Runnable Thread</h3><p><code></code><code></code>  </p>\n<ul>\n<li>Thread </li>\n<li>Runnable </li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Thread2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">runnable</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;runing....&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//(12)</span></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(runnable,<span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        thread.start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;main....&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>JAVA 8 <code>lambda</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">Runnable lombdaRunnable= () -&gt; &#123;</span><br><span class=\"line\">    log.debug(<span class=\"string\">&quot;lombda runging......&quot;</span>); </span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">Thread lombdaThead=<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(lombdaRunnable,<span class=\"string\">&quot;lombdaThead&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">lombdaThead.start();</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">    log.debug(<span class=\"string\">&quot;lombda runging......&quot;</span>);</span><br><span class=\"line\">&#125;, <span class=\"string\">&quot;lambdaThread&quot;</span>).start();</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-FutureTask-Thread\"><a href=\"#3-FutureTask-Thread\" class=\"headerlink\" title=\"3.FutureTask Thread\"></a>3.FutureTask Thread</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Thread3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; task=<span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">Callable</span>&lt;Integer&gt;() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> Integer <span class=\"title function_\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;running.......&quot;</span>);</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//(12)</span></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task,<span class=\"string\">&quot;t3&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        thread.start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//tasktask</span></span><br><span class=\"line\">        <span class=\"type\">Integer</span> <span class=\"variable\">integer</span> <span class=\"operator\">=</span> task.get();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;task &#123;&#125;&quot;</span>,integer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h3 id=\"ThreadRunnable\"><a href=\"#ThreadRunnable\" class=\"headerlink\" title=\"ThreadRunnable\"></a>ThreadRunnable</h3><h4 id=\"Runnable\"><a href=\"#Runnable\" class=\"headerlink\" title=\"Runnable\"></a>Runnable</h4><p>Runnableinit</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Allocates a new &#123;<span class=\"doctag\">@code</span> Thread&#125; object. This constructor has the same</span></span><br><span class=\"line\"><span class=\"comment\"> * effect as &#123;<span class=\"doctag\">@linkplain</span> #Thread(ThreadGroup,Runnable,String) Thread&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * &#123;<span class=\"doctag\">@code</span> (null, target, name)&#125;.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span>  target</span></span><br><span class=\"line\"><span class=\"comment\"> *         the object whose &#123;<span class=\"doctag\">@code</span> run&#125; method is invoked when this thread</span></span><br><span class=\"line\"><span class=\"comment\"> *         is started. If &#123;<span class=\"doctag\">@code</span> null&#125;, this thread&#x27;s run method is invoked.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span>  name</span></span><br><span class=\"line\"><span class=\"comment\"> *         the name of the new thread</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">Thread</span><span class=\"params\">(Runnable target, String name)</span> &#123;</span><br><span class=\"line\">    init(<span class=\"literal\">null</span>, target, name, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>Init </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * Initializes a Thread with the current AccessControlContext.</span></span><br><span class=\"line\"><span class=\"comment\">    * <span class=\"doctag\">@see</span> #init(ThreadGroup,Runnable,String,long,AccessControlContext,boolean)</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">   <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">init</span><span class=\"params\">(ThreadGroup g, Runnable target, String name,</span></span><br><span class=\"line\"><span class=\"params\">                     <span class=\"type\">long</span> stackSize)</span> &#123;</span><br><span class=\"line\">       init(g, target, name, stackSize, <span class=\"literal\">null</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p>init <code>Runable</code> <code>target</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Initializes a Thread.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> g the Thread group</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> target the object whose run() method gets called</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> name the name of the new Thread</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> stackSize the desired stack size for the new thread, or</span></span><br><span class=\"line\"><span class=\"comment\"> *        zero to indicate that this parameter is to be ignored.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> acc the AccessControlContext to inherit, or</span></span><br><span class=\"line\"><span class=\"comment\"> *            AccessController.getContext() if null</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> inheritThreadLocals if &#123;<span class=\"doctag\">@code</span> true&#125;, inherit initial values for</span></span><br><span class=\"line\"><span class=\"comment\"> *            inheritable thread-locals from the constructing thread</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">init</span><span class=\"params\">(ThreadGroup g, Runnable target, String name,</span></span><br><span class=\"line\"><span class=\"params\">                  <span class=\"type\">long</span> stackSize, AccessControlContext acc,</span></span><br><span class=\"line\"><span class=\"params\">                  <span class=\"type\">boolean</span> inheritThreadLocals)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (name == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>(<span class=\"string\">&quot;name cannot be null&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.name = name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">Thread</span> <span class=\"variable\">parent</span> <span class=\"operator\">=</span> currentThread();</span><br><span class=\"line\">    <span class=\"type\">SecurityManager</span> <span class=\"variable\">security</span> <span class=\"operator\">=</span> System.getSecurityManager();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (g == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">/* Determine if it&#x27;s an applet or not */</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/* If there is a security manager, ask the security manager</span></span><br><span class=\"line\"><span class=\"comment\">           what to do. */</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (security != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            g = security.getThreadGroup();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/* If the security doesn&#x27;t have a strong opinion of the matter</span></span><br><span class=\"line\"><span class=\"comment\">           use the parent thread group. */</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (g == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            g = parent.getThreadGroup();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/* checkAccess regardless of whether or not threadgroup is</span></span><br><span class=\"line\"><span class=\"comment\">       explicitly passed in. */</span></span><br><span class=\"line\">    g.checkAccess();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * Do we have the required permissions?</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (security != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (isCCLOverridden(getClass())) &#123;</span><br><span class=\"line\">            security.checkPermission(SUBCLASS_IMPLEMENTATION_PERMISSION);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    g.addUnstarted();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.group = g;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.daemon = parent.isDaemon();</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.priority = parent.getPriority();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (security == <span class=\"literal\">null</span> || isCCLOverridden(parent.getClass()))</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.contextClassLoader = parent.getContextClassLoader();</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.contextClassLoader = parent.contextClassLoader;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.inheritedAccessControlContext =</span><br><span class=\"line\">            acc != <span class=\"literal\">null</span> ? acc : AccessController.getContext();</span><br><span class=\"line\">    <span class=\"comment\">//Runable </span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.target = target;</span><br><span class=\"line\">    setPriority(priority);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (inheritThreadLocals &amp;&amp; parent.inheritableThreadLocals != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.inheritableThreadLocals =</span><br><span class=\"line\">            ThreadLocal.createInheritedMap(parent.inheritableThreadLocals);</span><br><span class=\"line\">    <span class=\"comment\">/* Stash the specified stack size in case the VM cares */</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.stackSize = stackSize;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/* Set thread ID */</span></span><br><span class=\"line\">    tid = nextThreadID();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Thread ,Thread<code>run</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * If this thread was constructed using a separate</span></span><br><span class=\"line\"><span class=\"comment\">   * &lt;code&gt;Runnable&lt;/code&gt; run object, then that</span></span><br><span class=\"line\"><span class=\"comment\">   * &lt;code&gt;Runnable&lt;/code&gt; object&#x27;s &lt;code&gt;run&lt;/code&gt; method is called;</span></span><br><span class=\"line\"><span class=\"comment\">   * otherwise, this method does nothing and returns.</span></span><br><span class=\"line\"><span class=\"comment\">   * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\">   * Subclasses of &lt;code&gt;Thread&lt;/code&gt; should override this method.</span></span><br><span class=\"line\"><span class=\"comment\">   *</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@see</span>     #start()</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@see</span>     #stop()</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@see</span>     #Thread(ThreadGroup, Runnable, String)</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (target != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">          target.run();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>ThreadRunnable </li>\n<li>Runnable API </li>\n<li>Runnable Thread </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MultiThread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;&#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;running.....&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;running.....&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/e5b813b7-361c-42ec-9326-53b01a2872da.png\" class=\"\">\n\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"windows\"><a href=\"#windows\" class=\"headerlink\" title=\"windows\"></a>windows</h3><ul>\n<li>,</li>\n<li>tasklist</li>\n<li>taskkill</li>\n</ul>\n<h3 id=\"linux\"><a href=\"#linux\" class=\"headerlink\" title=\"linux\"></a>linux</h3><ul>\n<li>ps -fe</li>\n<li>ps -fT -p <PID>(PID) </li>\n<li>kill </li>\n<li>topH</li>\n<li>top -H -p <PID>(PID) :</li>\n</ul>\n<h3 id=\"java\"><a href=\"#java\" class=\"headerlink\" title=\"java\"></a>java</h3><ul>\n<li>jps JAVA </li>\n<li>jstack <PID> Java PID</li>\n<li>jconsole Java </li>\n</ul>\n<h3 id=\"jconsole\"><a href=\"#jconsole\" class=\"headerlink\" title=\"jconsole\"></a>jconsole</h3><p>java</p>\n<blockquote>\n<p>java -Djava. rmi. server . hostname&#x3D; ip -Dcom. sun. management . jmxremote -Dcom. sun. management . jmxremote. port&#x3D;i-Dcom . sun . management . jmxremote.ssl&#x3D;-Dcom. sun. management .jmxremote .authenticate&#x3D;    java</p>\n</blockquote>\n<p>&#x2F;etc&#x2F;hosts127.0.0.1 <br></p>\n<ul>\n<li>jmxremote.password </li>\n<li>jmxremote.passwordjmxremote.access600</li>\n<li>controlRole ()R&amp;D ()</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Java Virtual Machine Stacks Java </p>\n<p> JVM </p>\n<p></p>\n<ul>\n<li><p>Frame</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Frames</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        method1(<span class=\"number\">10</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">y</span> <span class=\"operator\">=</span> x + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">o</span> <span class=\"operator\">=</span> method2();</span><br><span class=\"line\">        System.out.println(o);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Object <span class=\"title function_\">method2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">o</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> o;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/cb65fed7-57dd-404b-b4f1-e365dbe83379.png\" class=\"\">\n\n<img src=\"/post/2023/thread/210feb5c-150a-43c3-8b3d-440f53e343d1.png\" class=\"\">\n\n<p>method2</p>\n<img src=\"/post/2023/thread/52ebada9-ad0c-45fc-9482-40b961c20bbf.png\" class=\"\">\n\n<img src=\"/post/2023/thread/51e456b2-69ca-4039-8ec3-137a74a3e57d.png\" class=\"\">\n\n<p>method2 method2</p>\n<img src=\"/post/2023/thread/7d8e2e3b-8f62-4e97-86d1-d8ab88b83ca1.png\" class=\"\">\n\n<img src=\"/post/2023/thread/ca324ec8-b1a0-419a-a962-640dae424e10.png\" class=\"\">\n\n<p></p>\n<img src=\"/post/2023/thread/3ce55a24-aeb0-4055-9925-c69a63ec9053.png\" class=\"\">\n\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Frames2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"comment\">//t1</span></span><br><span class=\"line\">            method1(<span class=\"number\">20</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"comment\">//main</span></span><br><span class=\"line\">        method1(<span class=\"number\">10</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">y</span> <span class=\"operator\">=</span> x + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">o</span> <span class=\"operator\">=</span> method2();</span><br><span class=\"line\">        System.out.println(o);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Object <span class=\"title function_\">method2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">o</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> o;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>t1 </p>\n<img src=\"/post/2023/thread/815e324a-777f-4b34-b590-acbb4c624cb0.png\" class=\"\">\n\n<p></p>\n<img src=\"/post/2023/thread/d05f71ef-bbbb-4b19-a804-6444a74de835.png\" class=\"\">\n\n<p>main</p>\n<img src=\"/post/2023/thread/75442144-d101-4e7a-97ca-c833a2b827fe.png\" class=\"\">\n<p>t1</p>\n<img src=\"/post/2023/thread/7bf73e18-7259-45da-93c5-a4183062572e.png\" class=\"\">\n\n<h4 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<h3 id=\"Thread-Context-Switch\"><a href=\"#Thread-Context-Switch\" class=\"headerlink\" title=\"Thread Context Switch\"></a>Thread Context Switch</h3><p> cpu </p>\n<ul>\n<li><p> cpu </p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p> sleepyieldwaitjoinparksynchronizedlock </p>\n</li>\n</ul>\n<p> Context Switch <code></code>Java <code>Program Counter Register</code> jvm </p>\n<ul>\n<li><p></p>\n</li>\n<li><p>Context Switch </p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><table>\n<thead>\n<tr>\n<th align=\"left\"><strong></strong></th>\n<th align=\"center\"><strong>static</strong></th>\n<th align=\"left\"><strong></strong></th>\n<th align=\"left\"><strong></strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">start()</td>\n<td align=\"center\"></td>\n<td align=\"left\"> run </td>\n<td align=\"left\">start CPU startIllegalThreadStateExceptio</td>\n</tr>\n<tr>\n<td align=\"left\">run()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"> Thread  Runnable  Runnable  run  Thread </td>\n</tr>\n<tr>\n<td align=\"left\">join()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">join(long n)</td>\n<td align=\"center\"></td>\n<td align=\"left\">,n</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">getId()</td>\n<td align=\"center\"></td>\n<td align=\"left\"> id</td>\n<td align=\"left\">id</td>\n</tr>\n<tr>\n<td align=\"left\">getName()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">setName(String)</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">getPriority()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">setPriority(int)</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\">java1~10  CPU </td>\n</tr>\n<tr>\n<td align=\"left\">getState()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\">Java  6  enum NEW, RUNNABLE, BLOCKED, WAITING,TIMED_WAITING, TERMINATED</td>\n</tr>\n<tr>\n<td align=\"left\">isInterrupted()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"><code></code></td>\n</tr>\n<tr>\n<td align=\"left\">isAlive()</td>\n<td align=\"center\"></td>\n<td align=\"left\">(</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">interrupt()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"> sleepwaitjoin  InterruptedException<code></code><code></code>park <code></code></td>\n</tr>\n<tr>\n<td align=\"left\">interrupted()</td>\n<td align=\"center\">static</td>\n<td align=\"left\"></td>\n<td align=\"left\"><code></code></td>\n</tr>\n<tr>\n<td align=\"left\">currentThread()</td>\n<td align=\"center\">static</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">sleep(long n)</td>\n<td align=\"center\">static</td>\n<td align=\"left\">n cpu </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">yield()</td>\n<td align=\"center\">static</td>\n<td align=\"left\">CPU</td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h2 id=\"start\"><a href=\"#start\" class=\"headerlink\" title=\"start\"></a>start</h2><h3 id=\"run\"><a href=\"#run\" class=\"headerlink\" title=\"run\"></a>run</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  run </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RunMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(Thread.currentThread().getName());</span><br><span class=\"line\">            FileReaderUtil.read(Constants.FILE_PATH);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.run();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>main </p>\n<img src=\"/post/2023/thread/4b22adcb-879c-493e-a6dc-7a50426a6db7.png\" class=\"\">\n\n<h3 id=\"start\"><a href=\"#start\" class=\"headerlink\" title=\"start\"></a>start</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  run </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RunMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(Thread.currentThread().getName());</span><br><span class=\"line\">            FileReaderUtil.read(Constants.FILE_PATH);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">//        //run</span></span><br><span class=\"line\"><span class=\"comment\">//        t1.run();</span></span><br><span class=\"line\">        <span class=\"comment\">//start</span></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/6d0f8427-4068-4a15-a933-cd3f74e28dbf.png\" class=\"\">\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * If this thread was constructed using a separate</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;code&gt;Runnable&lt;/code&gt; run object, then that</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;code&gt;Runnable&lt;/code&gt; object&#x27;s &lt;code&gt;run&lt;/code&gt; method is called;</span></span><br><span class=\"line\"><span class=\"comment\"> * otherwise, this method does nothing and returns.</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * Subclasses of &lt;code&gt;Thread&lt;/code&gt; should override this method.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span>     #start()</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span>     #stop()</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span>     #Thread(ThreadGroup, Runnable, String)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (target != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        target.run();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">Runnable</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * When an object implementing interface &lt;code&gt;Runnable&lt;/code&gt; is used</span></span><br><span class=\"line\"><span class=\"comment\">     * to create a thread, starting the thread causes the object&#x27;s</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;code&gt;run&lt;/code&gt; method to be called in that separately executing</span></span><br><span class=\"line\"><span class=\"comment\">     * thread.</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * The general contract of the method &lt;code&gt;run&lt;/code&gt; is that it may</span></span><br><span class=\"line\"><span class=\"comment\">     * take any action whatsoever.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@see</span>     java.lang.Thread#run()</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>run() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">     <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">      * This method is not invoked for the main method thread or &quot;system&quot;</span></span><br><span class=\"line\"><span class=\"comment\">      * group threads created/set up by the VM. Any new functionality added</span></span><br><span class=\"line\"><span class=\"comment\">      * to this method in the future may have to also be added to the VM.</span></span><br><span class=\"line\"><span class=\"comment\">      *</span></span><br><span class=\"line\"><span class=\"comment\">      * A zero status value corresponds to state &quot;NEW&quot;.</span></span><br><span class=\"line\"><span class=\"comment\">      */</span></span><br><span class=\"line\">     <span class=\"keyword\">if</span> (threadStatus != <span class=\"number\">0</span>)</span><br><span class=\"line\">         <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalThreadStateException</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"comment\">/* Notify the group that this thread is about to be started</span></span><br><span class=\"line\"><span class=\"comment\">      * so that it can be added to the group&#x27;s list of threads</span></span><br><span class=\"line\"><span class=\"comment\">      * and the group&#x27;s unstarted count can be decremented. */</span></span><br><span class=\"line\">     group.add(<span class=\"built_in\">this</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"type\">boolean</span> <span class=\"variable\">started</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">     <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">         start0();</span><br><span class=\"line\">         started = <span class=\"literal\">true</span>;</span><br><span class=\"line\">     &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">         <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">             <span class=\"keyword\">if</span> (!started) &#123;</span><br><span class=\"line\">                 group.threadStartFailed(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">         &#125; <span class=\"keyword\">catch</span> (Throwable ignore) &#123;</span><br><span class=\"line\">             <span class=\"comment\">/* do nothing. If start0 threw a Throwable then</span></span><br><span class=\"line\"><span class=\"comment\">               it will be passed up the call stack */</span></span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start0</span><span class=\"params\">()</span>;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>start()</code> <code>start0()</code><code>start0()</code><code>native</code></p>\n<h3 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p> run  run</p>\n</li>\n<li><p> start  run </p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadStatus</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;running.....&quot;</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;:&quot;</span>+t1.getState());</span><br><span class=\"line\">        <span class=\"comment\">//start</span></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;:&quot;</span>+t1.getState());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/3a071edf-6ded-487b-abbb-d016a9fe6864.png\" class=\"\">\n\n<h3 id=\"startjava-lang-IllegalThreadStateException\"><a href=\"#startjava-lang-IllegalThreadStateException\" class=\"headerlink\" title=\"startjava.lang.IllegalThreadStateException\"></a>startjava.lang.IllegalThreadStateException</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//start</span></span><br><span class=\"line\">t1.start();</span><br><span class=\"line\">t1.start();</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/feed6992-8dff-450c-9010-e2f46caf6243.png\" class=\"\">\n\n\n\n<h2 id=\"sleep--yield\"><a href=\"#sleep--yield\" class=\"headerlink\" title=\"sleep  yield\"></a><strong>sleep</strong> <strong></strong> <strong>yield</strong></h2><h3 id=\"sleep\"><a href=\"#sleep\" class=\"headerlink\" title=\"sleep\"></a>sleep</h3><ol>\n<li> sleep  <em>Running</em>  <em>Timed Waiting</em> </li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   sleep</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">2000</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 &#123;&#125;&quot;</span>,t1.getState());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 &#123;&#125;&quot;</span>,t1.getState());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/image-20200822234416578.png\" class=\"\" title=\"image-20200822234416578\">\n\n<ol start=\"2\">\n<li> interrupt  sleep  InterruptedException</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  interrupt </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadMethod2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;enter sleep...... &quot;</span>);</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">2000</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;wake up...... &quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;interrupt...... &quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/81a4db1a-c8d1-47f7-a955-39db726f5173.png\" class=\"\">\n\n<ol start=\"3\">\n<li><p></p>\n</li>\n<li><p> TimeUnit  sleep  Thread  sleep </p>\n</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  TimeUnit</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadMethod3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;start ......&quot;</span>);</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;end ......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/f78c9ec4-6379-48de-b2e6-f529bb063540.png\" class=\"\">\n\n\n\n<h3 id=\"yield\"><a href=\"#yield\" class=\"headerlink\" title=\"yield\"></a>yield</h3><ol>\n<li><p> yield  <em>Running</em>  <em>Runnable</em> </p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>hint</p>\n<p> cpu  cpu </p>\n<h3 id=\"yield\"><a href=\"#yield\" class=\"headerlink\" title=\"yield\"></a>yield</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPriority</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task1</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;----&gt;1 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task2</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Thread.yield();</span></span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;        ----&gt;2 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task1, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task2, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>t1t2 </p>\n<img src=\"/post/2023/thread/683dd209-d862-46f9-878f-b9e8f4c2db3b.png\" class=\"\">\n\n<h3 id=\"yield\"><a href=\"#yield\" class=\"headerlink\" title=\"yield\"></a>yield</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPriority</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task1</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;----&gt;1 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task2</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                <span class=\"comment\">//yield,CPU</span></span><br><span class=\"line\">                Thread.<span class=\"keyword\">yield</span>();</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;        ----&gt;2 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task1, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task2, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>t1 t2 </p>\n<img src=\"/post/2023/thread/d37e0c1b-1e69-4360-937a-edf5296f47ce.png\" class=\"\">\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPriority</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task1</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;----&gt;1 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task2</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;        ----&gt;2 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task1, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task2, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//t1</span></span><br><span class=\"line\">        t1.setPriority(Thread.MIN_PRIORITY);</span><br><span class=\"line\">        <span class=\"comment\">//t2</span></span><br><span class=\"line\">        t2.setPriority(Thread.MAX_PRIORITY);</span><br><span class=\"line\">        </span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>t2 t1 </p>\n<img src=\"/post/2023/thread/2feee3db-6b39-4e1a-9098-1a5f966742f7.png\" class=\"\">\n\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"CPU-100\"><a href=\"#CPU-100\" class=\"headerlink\" title=\"CPU 100%\"></a>CPU 100%</h3><h4 id=\"sleep-\"><a href=\"#sleep-\" class=\"headerlink\" title=\"sleep \"></a>sleep </h4><p>cpuwhile(rue)cpu,yieldsleepcpu</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">500</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;   </span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>wait</li>\n<li>I,</li>\n<li>sleep</li>\n</ul>\n<h2 id=\"join\"><a href=\"#join\" class=\"headerlink\" title=\"join\"></a>join</h2><p> r </p>\n<h3 id=\"1-join\"><a href=\"#1-join\" class=\"headerlink\" title=\"1 join\"></a>1 join</h3><p>Join</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  join</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JoinMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            r = <span class=\"number\">10</span>;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;:&#123;&#125;&quot;</span>, r);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code></code><code>t1</code><code>r</code>r</p>\n<img src=\"/post/2023/thread/5cce206b-f24c-4489-afda-57b5a3102172.png\" class=\"\">\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p> t1 t1  1 <code> r=10</code></p>\n</li>\n<li><p> r  <code>r=0</code></p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p> sleep </p>\n<p>t1,</p>\n</li>\n<li><p> join t1.start() </p>\n<p><code>join()</code>**** <strong>join()</strong></p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  join</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JoinMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            r = <span class=\"number\">10</span>;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        <span class=\"comment\">//t1</span></span><br><span class=\"line\">        t1.join();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;:&#123;&#125;&quot;</span>, r);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/86d6badd-f76b-4152-8044-bef85f333017.png\" class=\"\">\n\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2 \"></a>2 </h3><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> cost </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  join </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JoinMethod2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">r1</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">r2</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            r1 = <span class=\"number\">10</span>;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            r2 = <span class=\"number\">20</span>;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;join begin ......&quot;</span>);</span><br><span class=\"line\">        t1.join();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 join end ......&quot;</span>);</span><br><span class=\"line\">        t2.join();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t2 join end ......&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 :&#123;&#125;,t2 :&#123;&#125;,&#123;&#125;&quot;</span>, r1, r2, end - start);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ul>\n<li><p> join t1 , t2 , </p>\n</li>\n<li><p> join1s , , t2  1s,  1s</p>\n</li>\n</ul>\n<img src=\"/post/2023/thread/9372a527-1cf5-4699-9271-f9724c815f24.png\" class=\"\">\n\n<p> join </p>\n<img src=\"/post/2023/thread/b94de8b0-5933-49dc-b0ff-a29a03280074.png\" class=\"\">\n\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3 \"></a>3 </h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  join </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JoinMethod3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">r1</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">//2000</span></span><br><span class=\"line\">                TimeUnit.MILLISECONDS.sleep(<span class=\"number\">2000</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            r1 = <span class=\"number\">10</span>;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;join begin ......&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//1500</span></span><br><span class=\"line\">        t1.join(<span class=\"number\">1500</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 join end ......&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 :&#123;&#125;,&#123;&#125;&quot;</span>, r1,  end - start);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/44fc6f61-2e64-414e-be76-0486d270b52b.png\" class=\"\">\n\n<p>join</p>\n<h2 id=\"interrupt\"><a href=\"#interrupt\" class=\"headerlink\" title=\"interrupt\"></a>interrupt</h2><h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"  \"></a>  </h3><p> sleep wait  join  </p>\n<p> sleep ,  sleep </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;interrupt... &quot;</span>);</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot; : &#123;&#125;&quot;</span>, t1.isInterrupted());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>false</p>\n<img src=\"/post/2023/thread/d9550ede-fad3-4675-8791-3a1237fab0de.png\" class=\"\">\n\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"  \"></a>  </h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">               </span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;interrupt... &quot;</span>);</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot; : &#123;&#125;&quot;</span>, t1.isInterrupted());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>t1</p>\n<img src=\"/post/2023/thread/c2203c1e-3091-4832-8061-8ba8bc3b24d1.png\" class=\"\">\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"type\">boolean</span> <span class=\"variable\">isInterrupt</span> <span class=\"operator\">=</span> Thread.currentThread().isInterrupted();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (isInterrupt) &#123;</span><br><span class=\"line\">                    log.debug(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;interrupt... &quot;</span>);</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot; : &#123;&#125;&quot;</span>, t1.isInterrupted());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<img src=\"/post/2023/thread/70691192-ef7e-43b6-b365-d139f036e188.png\" class=\"\">\n\n<h3 id=\"park\"><a href=\"#park\" class=\"headerlink\" title=\"park:\"></a>park:</h3><p> park , </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt park</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;park...&quot;</span>);</span><br><span class=\"line\">            LockSupport.park();</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;unpark...&quot;</span>);</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;&#123;&#125;&quot;</span>, Thread.currentThread().isInterrupted());</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/f5e5190c-2ca0-4467-8618-c9084b18b26f.png\" class=\"\">\n\n<p>park park</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt park</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;park...&quot;</span>);</span><br><span class=\"line\">            LockSupport.park();</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;unpark...&quot;</span>);</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;&#123;&#125;&quot;</span>, Thread.currentThread().isInterrupted());</span><br><span class=\"line\">            <span class=\"comment\">//park</span></span><br><span class=\"line\">            LockSupport.park();</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;unpark...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/a6cd39b0-e6e9-4b6f-88ea-3cfb0d899b83.png\" class=\"\">\n\n<p>Thread Thread.interrupted() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.locks.LockSupport;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt park</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;park...&quot;</span>);</span><br><span class=\"line\">            LockSupport.park();</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;unpark...&quot;</span>);</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;&#123;&#125;&quot;</span>, Thread.interrupted());</span><br><span class=\"line\">            <span class=\"comment\">//park</span></span><br><span class=\"line\">            LockSupport.park();</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;unpark...&quot;</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\"></span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/bc0f03b1-c84a-45af-879e-4bdc0f0ff35e.png\" class=\"\">\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Two-Phase-Termination\"><a href=\"#Two-Phase-Termination\" class=\"headerlink\" title=\"Two Phase Termination\"></a>Two Phase Termination</h3><p>T1T2?</p>\n<p>T2</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>stop():<ul>\n<li>stop </li>\n</ul>\n</li>\n<li>System.exit(int)</li>\n<li></li>\n</ul>\n<h3 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h3><p>2s</p>\n<img src=\"/post/2023/thread/e1c2fc78-6f75-4049-8631-1e2bf400e92b.png\" class=\"\" title=\"\">\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * interrupt</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TwoPhaseTermination</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Thread monitor;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        monitor = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"type\">Thread</span> <span class=\"variable\">currentThread</span> <span class=\"operator\">=</span> Thread.currentThread();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (currentThread.isInterrupted())&#123;</span><br><span class=\"line\">                    log.debug(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>); <span class=\"comment\">//  </span></span><br><span class=\"line\">                    log.debug(<span class=\"string\">&quot;&quot;</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                    <span class=\"comment\">//,</span></span><br><span class=\"line\">                    currentThread.interrupt();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        monitor.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">stop</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        monitor.interrupt();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">TwoPhaseTermination</span> <span class=\"variable\">termination</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">TwoPhaseTermination</span>();</span><br><span class=\"line\">        termination.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">3</span>);</span><br><span class=\"line\">        termination.stop();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/d1df5ae9-03d4-4960-a460-86c4eb4f13d9.png\" class=\"\">\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>stop()</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>suspend()</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>resume()</td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Java </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DaemonThread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (Thread.currentThread().isInterrupted()) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><code>main</code><code>t1</code><code>java </code></p>\n<img src=\"/post/2023/thread/0e59c147-a499-4226-bf3b-d6f0a4cabd5a.png\" class=\"\">\n\n<p><code>setDaemon(boolean)</code>t1</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DaemonThread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (Thread.currentThread().isInterrupted()) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        t1.setDaemon(<span class=\"literal\">true</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>main</code><code>t1</code></p>\n<img src=\"/post/2023/thread/ea4c56c3-75b1-48fa-a40e-dcb6dd63823f.png\" class=\"\">\n\n<blockquote>\n<p><strong></strong></p>\n<ul>\n<li><p></p>\n</li>\n<li><p>Tomcat <code>Acceptor</code> <code>Poller </code> Tomcat  shutdown </p>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> <strong></strong> </p>\n<img src=\"/post/2023/thread/d3f13fb8-e2e2-4692-8b27-2ca13a87ec1a.png\" class=\"\">\n\n<ul>\n<li><p></p>\n</li>\n<li><p> CPU </p>\n</li>\n<li><p> CPU </p>\n<ul>\n<li> CPU </li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li><p> API BIO  CPU</p>\n</li>\n<li><p> BIO </p>\n</li>\n<li><p></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> <strong>Java API</strong> </p>\n<p> Thread.State </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> <span class=\"title class_\">State</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a thread which has not yet started.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    NEW,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a runnable thread.  A thread in the runnable</span></span><br><span class=\"line\"><span class=\"comment\">     * state is executing in the Java virtual machine but it may</span></span><br><span class=\"line\"><span class=\"comment\">     * be waiting for other resources from the operating system</span></span><br><span class=\"line\"><span class=\"comment\">     * such as processor.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    RUNNABLE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a thread blocked waiting for a monitor lock.</span></span><br><span class=\"line\"><span class=\"comment\">     * A thread in the blocked state is waiting for a monitor lock</span></span><br><span class=\"line\"><span class=\"comment\">     * to enter a synchronized block/method or</span></span><br><span class=\"line\"><span class=\"comment\">     * reenter a synchronized block/method after calling</span></span><br><span class=\"line\"><span class=\"comment\">     * &#123;<span class=\"doctag\">@link</span> Object#wait() Object.wait&#125;.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    BLOCKED,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a waiting thread.</span></span><br><span class=\"line\"><span class=\"comment\">     * A thread is in the waiting state due to calling one of the</span></span><br><span class=\"line\"><span class=\"comment\">     * following methods:</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Object#wait() Object.wait&#125; with no timeout&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> #join() Thread.join&#125; with no timeout&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> LockSupport#park() LockSupport.park&#125;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;/ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;A thread in the waiting state is waiting for another thread to</span></span><br><span class=\"line\"><span class=\"comment\">     * perform a particular action.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * For example, a thread that has called &lt;tt&gt;Object.wait()&lt;/tt&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * on an object is waiting for another thread to call</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;tt&gt;Object.notify()&lt;/tt&gt; or &lt;tt&gt;Object.notifyAll()&lt;/tt&gt; on</span></span><br><span class=\"line\"><span class=\"comment\">     * that object. A thread that has called &lt;tt&gt;Thread.join()&lt;/tt&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * is waiting for a specified thread to terminate.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    WAITING,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a waiting thread with a specified waiting time.</span></span><br><span class=\"line\"><span class=\"comment\">     * A thread is in the timed waiting state due to calling one of</span></span><br><span class=\"line\"><span class=\"comment\">     * the following methods with a specified positive waiting time:</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> #sleep Thread.sleep&#125;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Object#wait(long) Object.wait&#125; with timeout&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> #join(long) Thread.join&#125; with timeout&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> LockSupport#parkNanos LockSupport.parkNanos&#125;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> LockSupport#parkUntil LockSupport.parkUntil&#125;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;/ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    TIMED_WAITING,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a terminated thread.</span></span><br><span class=\"line\"><span class=\"comment\">     * The thread has completed execution.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    TERMINATED;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<img src=\"/post/2023/thread/0827c261-3195-4bdc-9b78-e0c664037749.png\" class=\"\">\n\n<ul>\n<li><p>NEW  start() </p>\n</li>\n<li><p>RUNNABLE  start() <strong>Java API</strong>  RUNNABLE  <strong></strong> </p>\n<ul>\n<li> BIO  Java </li>\n</ul>\n</li>\n<li><p>BLOCKED  WAITING  TIMED_WAITING  <strong>Java API</strong> </p>\n</li>\n<li><p>TERMINATED </p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadState</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//new</span></span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;runing......&quot;</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//running</span></span><br><span class=\"line\">           <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>)&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//terminted</span></span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;runing......&quot;</span>);</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t3&quot;</span>);</span><br><span class=\"line\">        t3.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t4</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//timed_waiting</span></span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (ThreadState.class) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    TimeUnit.SECONDS.sleep(<span class=\"number\">100</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t4&quot;</span>);</span><br><span class=\"line\">        t4.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t5</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//waiting</span></span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    t2.join();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t5&quot;</span>);</span><br><span class=\"line\">        t5.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t6</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//blocked</span></span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (ThreadState.class) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    TimeUnit.SECONDS.sleep(<span class=\"number\">100</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t6&quot;</span>);</span><br><span class=\"line\">        t6.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1  &#123;&#125;&quot;</span>,t1.getState());</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t2  &#123;&#125;&quot;</span>,t2.getState());</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t3  &#123;&#125;&quot;</span>,t3.getState());</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t4  &#123;&#125;&quot;</span>,t4.getState());</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t5  &#123;&#125;&quot;</span>,t5.getState());</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t6  &#123;&#125;&quot;</span>,t6.getState());</span><br><span class=\"line\"></span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/d1f13ce8-f7cb-4cf1-b2aa-6e8d7204a459.png\" class=\"\">\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li><ul>\n<li></li>\n<li> 4 </li>\n</ul>\n</li>\n<li> sleep(n) </li>\n</ul>\n<p></p>\n<blockquote>\n<p></p>\n<p></p>\n<p></p>\n<p> 1 </p>\n<p> 15</p>\n<p> 1</p>\n<p> 2</p>\n<p> 1</p>\n<p></p>\n<p></p>\n<p></p>\n<ul>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n</ul>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<img src=\"/post/2023/thread/image-20200806070304756.png\" class=\"\" title=\"image-20200806070304756\">\n\n<p>1620</p>\n<p>4</p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<img src=\"/post/2023/thread/image-20200806070323056.png\" class=\"\" title=\"image-20200806070323056\">\n\n<p></p>\n<p></p>\n<p></p>\n</blockquote>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * ,</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MakingTea</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * t2  t1  </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">5</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                log.info(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">//t1</span></span><br><span class=\"line\">                t1.join();</span><br><span class=\"line\">                log.info(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        t1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/image-20200806072602725.png\" class=\"\" title=\"image-20200806072602725\">\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p> api startrunsleepjoininterrupt </p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>join</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p>Thread  </p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>CPU</p>\n<img src=\"/post/2023/thread/image-20200806080136510.png\" class=\"\" title=\"image-20200806080136510\">\n</li>\n<li><p></p>\n</li>\n<li><p>24sleep io wait</p>\n<img src=\"/post/2023/thread/image-20200806080218070.png\" class=\"\" title=\"image-20200806080218070\">\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p> [  ]</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<p></p>\n</li>\n<li><p></p>\n<img src=\"/post/2023/thread/image-20200806080338819.png\" class=\"\" title=\"image-20200806080338819\">\n</li>\n<li><p></p>\n</li>\n<li><p> 0  +1 </p>\n</li>\n<li><p> [  ] [ 11] </p>\n</li>\n<li><p> [  ] 0  -1  -1 </p>\n</li>\n<li><p>[] 1 </p>\n<img src=\"/post/2023/thread/image-20200806080425078.png\" class=\"\" title=\"image-20200806080425078\">\n</li>\n<li><p> 1  0</p>\n</li>\n</ul>\n<h3 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h3><p> 0  5000  0 </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SharedVariables</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">counter</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                counter++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                counter--;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.join();</span><br><span class=\"line\">        t2.join();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;counter:&#123;&#125;&quot;</span>, counter);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        t1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> Java </p>\n<p> i++ i  JVM </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getstatic i // i</span><br><span class=\"line\">iconst_1 // 1</span><br><span class=\"line\">iadd // </span><br><span class=\"line\">putstatic i // i</span><br></pre></td></tr></table></figure>\n\n<p> i :</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getstatic i // i</span><br><span class=\"line\">iconst_1 // 1</span><br><span class=\"line\">isub // </span><br><span class=\"line\">putstatic i // i</span><br></pre></td></tr></table></figure>\n\n<p> Java </p>\n<img src=\"/post/2023/thread/image-20200806081215362.png\" class=\"\" title=\"image-20200806081215362\">\n\n<p> 8 </p>\n<img src=\"/post/2023/thread/image-20200806081309415.png\" class=\"\" title=\"image-20200806081309415\">\n\n<p> 8 </p>\n<p></p>\n<img src=\"/post/2023/thread/image-20200806081339039.png\" class=\"\" title=\"image-20200806081339039\">\n\n<p></p>\n<img src=\"/post/2023/thread/image-20200806081409317.png\" class=\"\" title=\"image-20200806081409317\">\n\n<h3 id=\"-Critical-Section\"><a href=\"#-Critical-Section\" class=\"headerlink\" title=\"(Critical Section)\"></a>(Critical Section)</h3><ul>\n<li><p></p>\n</li>\n<li><p><strong></strong></p>\n<ul>\n<li><p><strong></strong></p>\n</li>\n<li><p><strong></strong></p>\n</li>\n</ul>\n</li>\n<li><p><strong></strong><strong></strong></p>\n</li>\n</ul>\n<p>:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">counter</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">increment</span><span class=\"params\">()</span> </span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">&#123; </span><br><span class=\"line\"> counter++; </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">decrement</span><span class=\"params\">()</span> </span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">&#123; </span><br><span class=\"line\"> counter--; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-Race-Condition\"><a href=\"#-Race-Condition\" class=\"headerlink\" title=\"(Race Condition)\"></a>(Race Condition)</h3><p><strong></strong><strong></strong></p>\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"***** \"></a>***** <strong></strong></h3><p></p>\n<ul>\n<li><p>synchronizedLock</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<p>synchronized</p>\n<p></p>\n<p></p>\n<blockquote>\n<p><strong></strong></p>\n<p> java  synchronized </p>\n<p></p>\n<p></p>\n</blockquote>\n<h3 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">synchronized</span>() <span class=\"comment\">// 1 2(blocked)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SharedVariables</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">counter</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * synchronized</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t2</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (lock) &#123;</span><br><span class=\"line\">                    counter++;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (lock) &#123;</span><br><span class=\"line\">                    counter--;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.join();</span><br><span class=\"line\">        t2.join();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;counter:&#123;&#125;&quot;</span>, counter);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        t2();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p> </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * ,</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Room</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">counter</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">increment</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">            counter++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">decrement</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">            counter--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">getCounter</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> counter;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Room</span> <span class=\"variable\">room</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Room</span>();</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                room.increment();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                room.decrement();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.join();</span><br><span class=\"line\">        t2.join();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;counter:&#123;&#125;&quot;</span>, room.getCounter());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<img src=\"/post/2023/thread/image-20200806093605366.png\" class=\"\" title=\"image-20200806093605366\">\n\n<p></p>\n<ul>\n<li><p><code>synchronized()</code> room t1t2 </p>\n</li>\n<li><p> t1  <code>synchronized(room)</code>  t1 <code>count++</code> </p>\n</li>\n<li><p> t2  <code>synchronized(room)</code> </p>\n</li>\n<li><p> t1  cpu t1 t2  t1 </p>\n</li>\n<li><p> t1  <code>synchronized&#123;&#125;</code>  obj  t2 t2  obj  <code>count--</code> </p>\n</li>\n</ul>\n<p>:</p>\n<img src=\"/post/2023/thread/image-20200806093649652.png\" class=\"\" title=\"image-20200806093649652\">\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>synchronized</code> <strong></strong><strong></strong></p>\n<p>:</p>\n<ul>\n<li><p> synchronized(obj)  for  </p>\n</li>\n<li><p> t1 synchronized(obj1)  t2 synchronized(obj2)  </p>\n</li>\n<li><p> t1 synchronized(obj)  t2  </p>\n</li>\n</ul>\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><p><code>synchronized</code><code></code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>synchronized</code><code></code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Test</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (Test.class) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h3><p> synchronzied </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> synchronized </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  8</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;strong&gt; synchronized &lt;/strong&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;strong&gt;  &lt;/strong&gt;&lt;strong&gt;&lt;/strong&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Thread8Locks</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"><span class=\"comment\">//        t1();</span></span><br><span class=\"line\"><span class=\"comment\">//        t2();</span></span><br><span class=\"line\"><span class=\"comment\">//        t3();</span></span><br><span class=\"line\"><span class=\"comment\">//        t4();</span></span><br><span class=\"line\"><span class=\"comment\">//        t5();</span></span><br><span class=\"line\"><span class=\"comment\">//        t6();</span></span><br><span class=\"line\"><span class=\"comment\">//        t7();</span></span><br><span class=\"line\"><span class=\"comment\">//        t8();</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * t1, 1 2</span></span><br><span class=\"line\"><span class=\"comment\">     * t2, 2 1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number1</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number1</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.a();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,1s 1 2</span></span><br><span class=\"line\"><span class=\"comment\">     * t2, 2 1s 1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number2</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number2</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                n.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * c</span></span><br><span class=\"line\"><span class=\"comment\">     * t3 3</span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t3,t2,1s 1 2  ; 3,1s,1,2</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t3,t1, 2 1s 1; 2,3,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     * t3,t1,t2,1s2 1; 3,1s,1,2</span></span><br><span class=\"line\"><span class=\"comment\">     * t3,t2,t1 2 1s 1; 3,2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t3</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number3</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number3</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                n.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.c();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t3&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * t1  t2 </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t2,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t1,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t4</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number4</span> <span class=\"variable\">n1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number4</span>();</span><br><span class=\"line\">        <span class=\"type\">Number4</span> <span class=\"variable\">n2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number4</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                n1.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            n2.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * a</span></span><br><span class=\"line\"><span class=\"comment\">     * b</span></span><br><span class=\"line\"><span class=\"comment\">     * t1  t2 </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t2,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t1,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t5</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number5</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number5</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Number5.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t2,1s12; 1s,1,2</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t1,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t6</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Number6.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            Number6.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * a</span></span><br><span class=\"line\"><span class=\"comment\">     * b</span></span><br><span class=\"line\"><span class=\"comment\">     * t1  t2 </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t2,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t1,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t7</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number7</span> <span class=\"variable\">n1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number7</span>();</span><br><span class=\"line\">        <span class=\"type\">Number7</span> <span class=\"variable\">n2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number7</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                n1.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n2.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t2,1s12; 1s,1,2</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t1,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t8</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number8</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number8</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                n.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number1&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number1</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number2&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number3&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">c</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number4&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number4</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * a</span></span><br><span class=\"line\"><span class=\"comment\"> * b</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number5&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number5</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number6&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number6</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * a</span></span><br><span class=\"line\"><span class=\"comment\"> * b</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number7&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number7</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number8&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number8</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\">\ti++; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> test1()  i.</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public static void test1();</span><br><span class=\"line\"> descriptor: ()V</span><br><span class=\"line\"> flags: ACC_PUBLIC, ACC_STATIC</span><br><span class=\"line\"> Code:</span><br><span class=\"line\"> stack=1, locals=1, args_size=0</span><br><span class=\"line\"> 0: bipush 10</span><br><span class=\"line\"> 2: istore_0</span><br><span class=\"line\"> 3: iinc 0, 1</span><br><span class=\"line\"> 6: return</span><br><span class=\"line\"> LineNumberTable:</span><br><span class=\"line\"> line 10: 0</span><br><span class=\"line\"> line 11: 3</span><br><span class=\"line\"> line 12: 6</span><br><span class=\"line\"> LocalVariableTable:</span><br><span class=\"line\"> Start Length Slot Name Signature</span><br><span class=\"line\"> 3 4 0 i I</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/image-20200806112353892.png\" class=\"\" title=\"image-20200806112353892\">\n\n\n\n<p><strong>,</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadSecurity</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">THREAD_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">LOOP_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">200</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ThreadUnsafe</span> <span class=\"variable\">test</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadUnsafe</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; THREAD_NUMBER; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                test.method1(LOOP_NUMBER);</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;Thread&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadUnsafe</span> &#123;</span><br><span class=\"line\">    ArrayList&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> loopNumber)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// &#123; , </span></span><br><span class=\"line\">            method2();</span><br><span class=\"line\">            method3();</span><br><span class=\"line\">            <span class=\"comment\">// &#125; </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        list.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method3</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        list.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>2  add1 remove </strong></p>\n<img src=\"/post/2023/thread/image-20200806113017975.png\" class=\"\" title=\"image-20200806113017975\">\n\n<p></p>\n<ul>\n<li><p> method2  list </p>\n</li>\n<li><p>method3  method2 </p>\n<img src=\"/post/2023/thread/image-20200806113212737.png\" class=\"\" title=\"image-20200806113212737\">\n\n<p><strong> list </strong></p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadSecurity</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">THREAD_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">LOOP_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">200</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Threadsafe</span> <span class=\"variable\">test</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Threadsafe</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; THREAD_NUMBER; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                test.method1(LOOP_NUMBER);</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;Thread&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Threadsafe</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> loopNumber)</span> &#123;</span><br><span class=\"line\">        ArrayList&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// &#123; , </span></span><br><span class=\"line\">            method2(list);</span><br><span class=\"line\">            method3(list);</span><br><span class=\"line\">            <span class=\"comment\">// &#125; </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method3</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p></p>\n<ul>\n<li><p>list </p>\n</li>\n<li><p> method2  method1  method1 </p>\n</li>\n<li><p>method3  method2 </p>\n</li>\n</ul>\n<img src=\"/post/2023/thread/image-20200806113622053.png\" class=\"\" title=\"image-20200806113622053\">\n\n<p> method2  method3  public </p>\n<ul>\n<li><p>1 method2  method3</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadSecurity2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">THREAD_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">LOOP_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">200</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Threadsafe2</span> <span class=\"variable\">test</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Threadsafe2</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; THREAD_NUMBER; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                test.method1(LOOP_NUMBER);</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;Thread&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Threadsafe2</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> loopNumber)</span> &#123;</span><br><span class=\"line\">        ArrayList&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// &#123; , </span></span><br><span class=\"line\">            method2(list);</span><br><span class=\"line\">            method3(list);</span><br><span class=\"line\">            <span class=\"comment\">// &#125; </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method3</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>method2</code><code>method3</code><code>method1</code>list </p>\n</li>\n<li><p>2 1  ThreadSafe  method2  method3 </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadSecurity2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">THREAD_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">LOOP_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">200</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">ThreadSafeSubClass</span> <span class=\"variable\">test</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadSafeSubClass</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; THREAD_NUMBER; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                test.method1(LOOP_NUMBER);</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;Thread&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Threadsafe2</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> loopNumber)</span> &#123;</span><br><span class=\"line\">        ArrayList&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// &#123; , </span></span><br><span class=\"line\">            method2(list);</span><br><span class=\"line\">            method3(list);</span><br><span class=\"line\">            <span class=\"comment\">// &#125; </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method3</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadSafeSubClass</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Threadsafe2</span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method3</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            list.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><img src=\"/post/2023/thread/image-20200806115634318.png\" class=\"\" title=\"image-20200806115634318\"></li>\n</ul>\n<p><strong> private  final </strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p>String</p>\n</li>\n<li><p>Integer</p>\n</li>\n<li><p>StringBuffffer</p>\n</li>\n<li><p>Random</p>\n</li>\n<li><p>Vector</p>\n</li>\n<li><p>Hashtable</p>\n</li>\n<li><p>JAVA.util.concurrent </p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Hashtable</span> <span class=\"variable\">table</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Hashtable</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;&#123;</span><br><span class=\"line\"> table.put(<span class=\"string\">&quot;key&quot;</span>, <span class=\"string\">&quot;value1&quot;</span>);</span><br><span class=\"line\">&#125;).start();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;&#123;</span><br><span class=\"line\"> table.put(<span class=\"string\">&quot;key&quot;</span>, <span class=\"string\">&quot;value2&quot;</span>);</span><br><span class=\"line\">&#125;).start()</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p></p>\n</li>\n<li><p><strong></strong></p>\n</li>\n</ul>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Hashtable</span> <span class=\"variable\">table</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Hashtable</span>();</span><br><span class=\"line\"><span class=\"comment\">// 12</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>( table.get(<span class=\"string\">&quot;key&quot;</span>) == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\"> table.put(<span class=\"string\">&quot;key&quot;</span>, value);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/image-20200818213438504.png\" class=\"\" title=\"image-20200818213438504\">\n\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>StringInteger </p>\n<p>String  replacesubstring </p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Immutable</span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"title function_\">Immutable</span><span class=\"params\">(<span class=\"type\">int</span> value)</span>&#123;</span><br><span class=\"line\"> \t<span class=\"built_in\">this</span>.value = value;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">getValue</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.value;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Immutable</span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"title function_\">Immutable</span><span class=\"params\">(<span class=\"type\">int</span> value)</span>&#123;</span><br><span class=\"line\"> \t<span class=\"built_in\">this</span>.value = value;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">getValue</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.value;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"keyword\">public</span> Immutable <span class=\"title function_\">add</span><span class=\"params\">(<span class=\"type\">int</span> v)</span>&#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Immutable</span>(<span class=\"built_in\">this</span>.value + v);</span><br><span class=\"line\"> &#125; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.CopyOnWriteArrayList;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *    -   </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/17</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ExerciseSell</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">TicketWindows</span> <span class=\"variable\">ticketWindows</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">TicketWindows</span>(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        List&lt;Integer&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">CopyOnWriteArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        List&lt;Thread&gt; threadList = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">4000</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                <span class=\"type\">int</span> <span class=\"variable\">sell</span> <span class=\"operator\">=</span> ticketWindows.sell(randomAmount());</span><br><span class=\"line\">                list.add(sell);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            thread.start();</span><br><span class=\"line\">            threadList.add(thread);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        threadList.forEach(thread -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                thread.join();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;&#123;&#125;&quot;</span>, ticketWindows.getCount());</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;&#123;&#125;&quot;</span>, list.stream().mapToInt(Integer::intValue).sum());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Random </span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">Random</span> <span class=\"variable\">random</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//15</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">randomAmount</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> random.nextInt(<span class=\"number\">5</span>) + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/17</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">TicketWindows</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> count;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">TicketWindows</span><span class=\"params\">(<span class=\"type\">int</span> count)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.count = count;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">getCount</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> count;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">sell</span><span class=\"params\">(<span class=\"type\">int</span> amount)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (count &gt;= amount) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">                count -= amount;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> amount;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   -   </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/17</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ExceriseTransfer</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Account</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Account</span>(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        <span class=\"type\">Account</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Account</span>(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">threadA</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++) &#123;</span><br><span class=\"line\">                a.transfer(b, randomAmount());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">threadB</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++) &#123;</span><br><span class=\"line\">                b.transfer(a, randomAmount());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        threadA.start();</span><br><span class=\"line\">        threadB.start();</span><br><span class=\"line\">        threadA.join();</span><br><span class=\"line\">        threadB.join();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;A &#123;&#125;&quot;</span>, a.getMoney());</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;B &#123;&#125;&quot;</span>, b.getMoney());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Random </span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">Random</span> <span class=\"variable\">random</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//1100</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">randomAmount</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> random.nextInt(<span class=\"number\">100</span>) + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/17</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Account</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> money;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">Account</span><span class=\"params\">(<span class=\"type\">int</span> money)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.money = money;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">getMoney</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> money;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setMoney</span><span class=\"params\">(<span class=\"type\">int</span> money)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.money = money;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> account </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> money   </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">transfer</span><span class=\"params\">(Account account, <span class=\"type\">int</span> money)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (Account.class) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"built_in\">this</span>.money &gt;= money) &#123;</span><br><span class=\"line\">                account.setMoney(account.getMoney() + money);</span><br><span class=\"line\">                <span class=\"built_in\">this</span>.setMoney(<span class=\"built_in\">this</span>.getMoney() - money);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"><span class=\"comment\">//    //synchronized  </span></span><br><span class=\"line\"><span class=\"comment\">//    public synchronized  void transfer(Account account, int money) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//          if (this.money &gt;= money) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//              account.setMoney(account.getMoney() + money);</span></span><br><span class=\"line\"><span class=\"comment\">//              this.setMoney(this.getMoney() - money);</span></span><br><span class=\"line\"><span class=\"comment\">//          &#125;</span></span><br><span class=\"line\"><span class=\"comment\">//    &#125;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Monitor\"><a href=\"#Monitor\" class=\"headerlink\" title=\"Monitor\"></a>Monitor</h2><h3 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h3><p> 32 </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------</span>| </span><br><span class=\"line\">|<span class=\"params\"> \t\t\t\t\tObject Header (64 bits)\t\t \t\t       </span>|</span><br><span class=\"line\">|<span class=\"params\">------------------------------------</span>|-------------------------|<span class=\"params\"> </span></span><br><span class=\"line\"><span class=\"params\"></span>|\t\t <span class=\"title class_\">Mark</span> <span class=\"title class_\">Word</span> (<span class=\"number\">32</span> bits) \t     |<span class=\"params\"> Klass Word (32 bits)    </span>|</span><br><span class=\"line\">|<span class=\"params\">------------------------------------</span>|-------------------------|<span class=\"params\"></span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|<span class=\"params\">---------------------------------------------------------------------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\t\t\t\t\t\t\tObject Header (96 bits)\t\t\t \t\t\t\t  </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------</span>|-----------------------|<span class=\"params\">------------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\t\tMark Word(32bits) \t </span>| \t<span class=\"title class_\">Klass</span> <span class=\"title class_\">Word</span>(32bits)   |<span class=\"params\"> array length(32bits)   </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------</span>|-----------------------|<span class=\"params\">------------------------</span>|</span><br></pre></td></tr></table></figure>\n\n<p> Mark Word </p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|<span class=\"params\">-------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t\t\t\t<span class=\"title class_\">Mark</span> <span class=\"title class_\">Word</span> (<span class=\"number\">32</span> bits)\t\t\t\t\t|<span class=\"params\"> \t\tState\t\t </span>|</span><br><span class=\"line\">|<span class=\"params\">-------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t  <span class=\"symbol\">hashcode:</span><span class=\"number\">25</span> |<span class=\"params\"> age:4 </span>| <span class=\"symbol\">biased_lock:</span><span class=\"number\">0</span> \t|<span class=\"params\"> 01\t</span>| \t\t<span class=\"title class_\">Normal</span>\t\t |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|-------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> thread:23 </span>| <span class=\"symbol\">epoch:</span><span class=\"number\">2</span> |<span class=\"params\"> age:4 </span>| <span class=\"symbol\">biased_lock:</span><span class=\"number\">1</span> \t|<span class=\"params\"> 01\t</span>| \t\t<span class=\"title class_\">Biased</span>\t\t |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|-------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\tptr_to_lock_record:30 \t\t\t\t\t</span>| <span class=\"number\">00</span> \t|<span class=\"params\"> Lightweight Locked </span>|</span><br><span class=\"line\">|<span class=\"params\">-------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t<span class=\"symbol\">ptr_to_heavyweight_monitor:</span><span class=\"number\">30</span> \t\t\t|<span class=\"params\"> 10 \t</span>| <span class=\"title class_\">Heavyweight</span> <span class=\"title class_\">Locked</span> |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|-------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\t\t\t\t\t\t\t\t\t\t\t</span>| <span class=\"number\">11</span>\t|<span class=\"params\">\t Marked <span class=\"keyword\">for</span> GC\t </span>|</span><br><span class=\"line\">|<span class=\"params\">-------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br></pre></td></tr></table></figure>\n\n\n\n<p>64  Mark Word</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t\t\t\t\t\t<span class=\"title class_\">Mark</span> <span class=\"title class_\">Word</span> (<span class=\"number\">64</span> bits) \t\t\t\t\t |<span class=\"params\"> \t\t  State  \t  </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|  <span class=\"symbol\">unused:</span><span class=\"number\">25</span> |<span class=\"params\"> hashcode:31 </span>| <span class=\"symbol\">unused:</span><span class=\"number\">1</span> |<span class=\"params\"> age:4 </span>| <span class=\"symbol\">biased_lock:</span><span class=\"number\">0</span> |<span class=\"params\">  01  </span>| \t\t  <span class=\"title class_\">Normal</span>\t  |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\">  thread:54 </span>| <span class=\"symbol\">epoch:</span><span class=\"number\">2</span>     |<span class=\"params\"> unused:1 </span>| <span class=\"symbol\">age:</span><span class=\"number\">4</span> |<span class=\"params\"> biased_lock:1 </span>|  <span class=\"number\">01</span>  |<span class=\"params\"> \t\t  Biased\t  </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t<span class=\"symbol\">ptr_to_lock_record:</span><span class=\"number\">62</span>\t\t\t\t\t\t\t\t  |<span class=\"params\">  00  </span>| <span class=\"title class_\">Lightweight</span> <span class=\"title class_\">Locked</span> |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\tptr_to_heavyweight_monitor:62 \t\t\t\t\t\t  </span>|  <span class=\"number\">10</span>  |<span class=\"params\"> Heavyweight Locked </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  |<span class=\"params\">  11  </span>| \t<span class=\"title class_\">Marked</span> <span class=\"keyword\">for</span> <span class=\"variable constant_\">GC</span>\t  |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<p><a href=\"https://stackoverflflow.com/questions/26357186/what-is-in-java-object-header\">https://stackoverflflow.com/questions/26357186/what-is-in-java-object-header</a></p>\n<h2 id=\"Monitor-\"><a href=\"#Monitor-\" class=\"headerlink\" title=\"Monitor()\"></a>Monitor()</h2><h3 id=\"Monitor\"><a href=\"#Monitor\" class=\"headerlink\" title=\"Monitor\"></a>Monitor</h3><p>Monitor <strong></strong><strong></strong></p>\n<p> Java  Monitor  synchronized Mark Word  Monitor Monitor </p>\n<img src=\"/post/2023/thread/image-20200819064936628.png\" class=\"\" title=\"image-20200819064936628\">\n\n\n\n<ul>\n<li><p> Monitor  Owner  null</p>\n</li>\n<li><p> Thread-2  synchronized(obj)  Monitor  Owner  Thread-2Monitor Owner</p>\n</li>\n<li><p> Thread-2  Thread-3Thread-4Thread-5  synchronized(obj)EntryList BLOCKED</p>\n</li>\n<li><p>Thread-2  EntryList </p>\n</li>\n<li><p> WaitSet  Thread-0Thread-1  WAITING wait-notify </p>\n</li>\n</ul>\n<blockquote>\n<p><strong></strong></p>\n<p>synchronized  monitor </p>\n<p> synchronized </p>\n</blockquote>\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><p><strong></strong></p>\n<p></p>\n<ul>\n<li><p> - JVM</p>\n</li>\n<li><p> - </p>\n</li>\n<li><p> - </p>\n</li>\n<li><p> - </p>\n</li>\n<li><p> -  - Monitor</p>\n</li>\n<li><p> -  - </p>\n</li>\n<li><p> -  - </p>\n</li>\n<li><p> -  20 </p>\n</li>\n<li><p> - </p>\n</li>\n</ul>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p> 20 </p>\n<h3 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Object</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">counter</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span> (lock) &#123;</span><br><span class=\"line\"> \tcounter++;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(java.lang.String[])</span>;</span><br><span class=\"line\"> descriptor: ([Ljava/lang/String;)V</span><br><span class=\"line\"> flags: ACC_PUBLIC, ACC_STATIC</span><br><span class=\"line\"> Code:</span><br><span class=\"line\"> stack=<span class=\"number\">2</span>, locals=<span class=\"number\">3</span>, args_size=<span class=\"number\">1</span></span><br><span class=\"line\"> <span class=\"number\">0</span>: getstatic #<span class=\"number\">2</span> <span class=\"comment\">// &lt;- lock synchronized</span></span><br><span class=\"line\"> <span class=\"number\">3</span>: dup</span><br><span class=\"line\"> <span class=\"number\">4</span>: astore_1 <span class=\"comment\">// lock -&gt; slot 1</span></span><br><span class=\"line\"> <span class=\"number\">5</span>: monitorenter <span class=\"comment\">//  lock MarkWord  Monitor </span></span><br><span class=\"line\"> <span class=\"number\">6</span>: getstatic #<span class=\"number\">3</span> <span class=\"comment\">// &lt;- i</span></span><br><span class=\"line\"> <span class=\"number\">9</span>: iconst_1 <span class=\"comment\">//  1</span></span><br><span class=\"line\"> <span class=\"number\">10</span>: iadd <span class=\"comment\">// +1</span></span><br><span class=\"line\"> <span class=\"number\">11</span>: putstatic #<span class=\"number\">3</span> <span class=\"comment\">// -&gt; i</span></span><br><span class=\"line\"> <span class=\"number\">14</span>: aload_1 <span class=\"comment\">// &lt;- lock</span></span><br><span class=\"line\"> <span class=\"number\">15</span>: monitorexit <span class=\"comment\">//  lock MarkWord ,  EntryList</span></span><br><span class=\"line\"> <span class=\"number\">16</span>: goto <span class=\"number\">24</span></span><br><span class=\"line\"> <span class=\"number\">19</span>: astore_2 <span class=\"comment\">// e -&gt; slot 2 </span></span><br><span class=\"line\"> <span class=\"number\">20</span>: aload_1 <span class=\"comment\">// &lt;- lock</span></span><br><span class=\"line\"> <span class=\"number\">21</span>: monitorexit <span class=\"comment\">//  lock MarkWord ,  EntryList</span></span><br><span class=\"line\"> <span class=\"number\">22</span>: aload_2 <span class=\"comment\">// &lt;- slot 2 (e)</span></span><br><span class=\"line\"> <span class=\"number\">23</span>: athrow <span class=\"comment\">// throw e</span></span><br><span class=\"line\"> <span class=\"number\">24</span>: <span class=\"keyword\">return</span></span><br><span class=\"line\"> Exception table:</span><br><span class=\"line\"> from to target type</span><br><span class=\"line\"> <span class=\"number\">6</span> <span class=\"number\">16</span> <span class=\"number\">19</span> any</span><br><span class=\"line\"> <span class=\"number\">19</span> <span class=\"number\">22</span> <span class=\"number\">19</span> any</span><br><span class=\"line\"> LineNumberTable:</span><br><span class=\"line\"> line <span class=\"number\">8</span>: <span class=\"number\">0</span></span><br><span class=\"line\"> line <span class=\"number\">9</span>: <span class=\"number\">6</span></span><br><span class=\"line\"> line <span class=\"number\">10</span>: <span class=\"number\">14</span></span><br><span class=\"line\"> line <span class=\"number\">11</span>: <span class=\"number\">24</span></span><br><span class=\"line\"> LocalVariableTable:</span><br><span class=\"line\"> Start Length Slot Name Signature</span><br><span class=\"line\"> <span class=\"number\">0</span> <span class=\"number\">25</span> <span class=\"number\">0</span> args [Ljava/lang/String;</span><br><span class=\"line\"> StackMapTable: number_of_entries = <span class=\"number\">2</span></span><br><span class=\"line\"> frame_type = <span class=\"number\">255</span> <span class=\"comment\">/* full_frame */</span></span><br><span class=\"line\"> offset_delta = <span class=\"number\">19</span></span><br><span class=\"line\"> locals = [ class <span class=\"string\">&quot;[Ljava/lang/String;&quot;</span>, <span class=\"keyword\">class</span> <span class=\"title class_\">java</span>/lang/Object ]</span><br><span class=\"line\"> stack = [ <span class=\"keyword\">class</span> <span class=\"title class_\">java</span>/lang/Throwable ]</span><br><span class=\"line\"> frame_type = <span class=\"number\">250</span> <span class=\"comment\">/* chop */</span></span><br><span class=\"line\"> offset_delta = <span class=\"number\">4</span>              </span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p><strong></strong></p>\n<p> synchronized </p>\n</blockquote>\n<h3 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h4><p></p>\n<p> <code>synchronized</code></p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Object</span> <span class=\"variable\">obj</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> <span class=\"comment\">//  A</span></span><br><span class=\"line\"> method2();</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> <span class=\"comment\">//  B</span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Lock RecordMark Word</li>\n</ul>\n<img src=\"/post/2023/thread/image-20200819065515918.png\" class=\"\" title=\"image-20200819065515918\">\n\n<ul>\n<li><p> Object reference  cas  Object  Mark Word Mark Word </p>\n<img src=\"/post/2023/thread/image-20200819065601188.png\" class=\"\" title=\"image-20200819065601188\">\n</li>\n<li><p> cas   00 </p>\n<img src=\"/post/2023/thread/image-20200819065708766.png\" class=\"\" title=\"image-20200819065708766\">\n</li>\n<li><p> cas </p>\n<ul>\n<li> Object </li>\n<li> synchronized  Lock Record </li>\n</ul>\n<img src=\"/post/2023/thread/image-20200819065835524.png\" class=\"\" title=\"image-20200819065835524\">\n</li>\n<li><p> synchronized  null </p>\n<img src=\"/post/2023/thread/image-20200819065931928.png\" class=\"\" title=\"image-20200819065931928\">\n</li>\n<li><p> synchronized  null cas  Mark Word </p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><p>CAS </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">obj</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> <span class=\"comment\">// </span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p> Thread-1 Thread-0 </p>\n<img src=\"/post/2023/thread/image-20200819071006301.png\" class=\"\" title=\"image-20200819071006301\">\n</li>\n<li><p> Thread-1 </p>\n<ul>\n<li> Object  <code>Monitor</code>  Object </li>\n<li> <code>Monitor</code>  <code>EntryList</code> BLOCKED</li>\n</ul>\n</li>\n</ul>\n<img src=\"/post/2023/thread/image-20200819071139042.png\" class=\"\" title=\"image-20200819071139042\">\n\n<ul>\n<li> Thread-0  cas  Mark Word  Monitor  Monitor  Owner  null EntryList  BLOCKED </li>\n</ul>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><p></p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th><strong></strong> <strong>1</strong> <strong>****core 1</strong> <strong></strong></th>\n<th><strong></strong> <strong>Mark</strong></th>\n<th><strong></strong> <strong>2</strong> <strong>****core 2</strong> <strong></strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-</td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td> monitor</td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td> monitor</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>01</td>\n<td></td>\n</tr>\n<tr>\n<td>-</td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td>-</td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td>-</td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>.</td>\n<td>.</td>\n</tr>\n</tbody></table>\n<p></p>\n<table>\n<thead>\n<tr>\n<th><strong></strong> <strong>1</strong> <strong>****core 1</strong> <strong></strong></th>\n<th><strong></strong> <strong>Mark</strong></th>\n<th><strong></strong> <strong>2</strong> <strong>****core 2</strong> <strong></strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-</td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td> monitor</td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td> monitor</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<ul>\n<li><p> CPU  CPU  CPU </p>\n</li>\n<li><p> Java 6 <strong></strong></p>\n</li>\n<li><p>Java 7 </p>\n</li>\n</ul>\n<h4 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h4><p> CAS </p>\n<p>Java 6  CAS  ID  Mark Word  ID  CAS</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Object</span> <span class=\"variable\">obj</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> \t<span class=\"comment\">//  A</span></span><br><span class=\"line\"> \tm2();</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> \t<span class=\"comment\">//  B</span></span><br><span class=\"line\"> \tm3();</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m3</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> \t<span class=\"comment\">//  C</span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/image-20200819072452480.png\" class=\"\" title=\"image-20200819072452480\">\n\n<img src=\"/post/2023/thread/image-20200819072504262.png\" class=\"\" title=\"image-20200819072504262\">\n\n<p><strong></strong></p>\n<p></p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t\t\t\t\t\t<span class=\"title class_\">Mark</span> <span class=\"title class_\">Word</span> (<span class=\"number\">64</span> bits) \t\t\t\t\t |<span class=\"params\"> \t\t  State  \t  </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|  <span class=\"symbol\">unused:</span><span class=\"number\">25</span> |<span class=\"params\"> hashcode:31 </span>| <span class=\"symbol\">unused:</span><span class=\"number\">1</span> |<span class=\"params\"> age:4 </span>| <span class=\"symbol\">biased_lock:</span><span class=\"number\">0</span> |<span class=\"params\">  01  </span>| \t\t  <span class=\"title class_\">Normal</span>\t  |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\">  thread:54 </span>| <span class=\"symbol\">epoch:</span><span class=\"number\">2</span>     |<span class=\"params\"> unused:1 </span>| <span class=\"symbol\">age:</span><span class=\"number\">4</span> |<span class=\"params\"> biased_lock:1 </span>|  <span class=\"number\">01</span>  |<span class=\"params\"> \t\t  Biased\t  </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t<span class=\"symbol\">ptr_to_lock_record:</span><span class=\"number\">62</span>\t\t\t\t\t\t\t\t  |<span class=\"params\">  00  </span>| <span class=\"title class_\">Lightweight</span> <span class=\"title class_\">Locked</span> |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\tptr_to_heavyweight_monitor:62 \t\t\t\t\t\t  </span>|  <span class=\"number\">10</span>  |<span class=\"params\"> Heavyweight Locked </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  |<span class=\"params\">  11  </span>| \t<span class=\"title class_\">Marked</span> <span class=\"keyword\">for</span> <span class=\"variable constant_\">GC</span>\t  |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ul>\n<li><p>markword  0x05  3  101threadepochage  0</p>\n</li>\n<li><p> VM </p>\n<p> <code>-XX:BiasedLockingStartupDelay=0</code> </p>\n</li>\n<li><p>markword  0x01  3  001 hashcodeage  0 hashcode </p>\n</li>\n</ul>\n<p>1 </p>\n<p>2 </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Dog</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> jol  jol </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  -XX:BiasedLockingStartupDelay=0 </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\"> \t<span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Dog</span>();</span><br><span class=\"line\"> \t<span class=\"type\">ClassLayout</span> <span class=\"variable\">classLayout</span> <span class=\"operator\">=</span> ClassLayout.parseInstance(d);</span><br><span class=\"line\"> \t<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\tlog.debug(<span class=\"string\">&quot;synchronized &quot;</span>);</span><br><span class=\"line\"> \t\tSystem.out.println(classLayout.toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\tlog.debug(<span class=\"string\">&quot;synchronized &quot;</span>);</span><br><span class=\"line\"> \t\t\tSystem.out.println(classLayout.toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\tlog.debug(<span class=\"string\">&quot;synchronized &quot;</span>);</span><br><span class=\"line\"> \t\tSystem.out.println(classLayout.toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">11:08:58.117 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000101 </span><br><span class=\"line\">11:08:58.121 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00011111 11101011 11010000 00000101 </span><br><span class=\"line\">11:08:58.121 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00011111 11101011 11010000 00000101</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><strong></strong></p>\n<p> id </p>\n</blockquote>\n<p>3</p>\n<p> VM  <code>-XX:-UseBiasedLocking</code> </p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">11:13:10.018 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">11:13:10.021 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00100000 00010100 11110011 10001000 </span><br><span class=\"line\">11:13:10.021 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li> hashCode</li>\n</ol>\n<p> hashCode </p>\n<h4 id=\"-hashCode\"><a href=\"#-hashCode\" class=\"headerlink\" title=\" - hashCode\"></a> <strong>-</strong> hashCode</h4><p> hashCode MarkWord  id hashCode </p>\n<ul>\n<li><p> hashCode</p>\n</li>\n<li><p> Monitor  hashCode</p>\n</li>\n</ul>\n<p> hashCode  <code>-XX:-UseBiasedLocking</code></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">11:22:10.386 c.TestBiased [main] -  hashCode:1778535015 </span><br><span class=\"line\">11:22:10.391 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 01101010 00000010 01001010 01100111 00000001 </span><br><span class=\"line\">11:22:10.393 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00100000 11000011 11110011 01101000 </span><br><span class=\"line\">11:22:10.393 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 01101010 00000010 01001010 01100111 00000001</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" - \"></a> <strong>-</strong> </h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test2</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\"> \t<span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Dog</span>();</span><br><span class=\"line\"> \t<span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">\t\t <span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (TestBiased.class) &#123;</span><br><span class=\"line\"> \t\t\tTestBiased.class.notify();</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\t<span class=\"comment\">//  wait/notify  join </span></span><br><span class=\"line\"> \t\t<span class=\"comment\">// t1  jvm  t2  id </span></span><br><span class=\"line\">         <span class=\"comment\">/*try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">         System.in.read();</span></span><br><span class=\"line\"><span class=\"comment\">         &#125; catch (IOException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">         e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">         &#125;*/</span></span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"> \tt1.start();</span><br><span class=\"line\">    </span><br><span class=\"line\"> \t<span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (TestBiased.class) &#123;</span><br><span class=\"line\"> \t\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\"> \t\t\t\tTestBiased.class.wait();</span><br><span class=\"line\"> \t\t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\"> \t\t\t\te.printStackTrace();</span><br><span class=\"line\"> \t\t\t&#125;</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\"> \tt2.start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[t1] - 00000000 00000000 00000000 00000000 00011111 01000001 00010000 00000101 </span><br><span class=\"line\"></span><br><span class=\"line\">[t2] - 00000000 00000000 00000000 00000000 00011111 01000001 00010000 00000101 </span><br><span class=\"line\"></span><br><span class=\"line\">[t2] - 00000000 00000000 00000000 00000000 00011111 10110101 11110000 01000000 </span><br><span class=\"line\"></span><br><span class=\"line\">[t2] - 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br></pre></td></tr></table></figure>\n\n<h4 id=\"--wait-notify\"><a href=\"#--wait-notify\" class=\"headerlink\" title=\" -  wait&#x2F;notify\"></a> -  wait&#x2F;notify</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\"> \t<span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Dog</span>();</span><br><span class=\"line\"> \t<span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\"> \t\t\t\td.wait();</span><br><span class=\"line\"> \t\t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\"> \t\t\t\te.printStackTrace();</span><br><span class=\"line\"> \t\t\t&#125;</span><br><span class=\"line\"> \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"> \tt1.start();</span><br><span class=\"line\">    </span><br><span class=\"line\"> \t<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\"> \t\t\tThread.sleep(<span class=\"number\">6000</span>);</span><br><span class=\"line\"> \t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\"> \t\t\te.printStackTrace();</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\tlog.debug(<span class=\"string\">&quot;notify&quot;</span>);</span><br><span class=\"line\"> \t\t\td.notify();</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[t1] - 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000101 </span><br><span class=\"line\">[t1] - 00000000 00000000 00000000 00000000 00011111 10110011 11111000 00000101 </span><br><span class=\"line\">[t2] - notify </span><br><span class=\"line\">[t1] - 00000000 00000000 00000000 00000000 00011100 11010100 00001101 11001010</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> T1  T2 Thread ID</p>\n<p> 20 jvm </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test3</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\"> \tVector&lt;Dog&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">Vector</span>&lt;&gt;();</span><br><span class=\"line\"> \t<span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">30</span>; i++) &#123;</span><br><span class=\"line\"> \t\t\t<span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Dog</span>();</span><br><span class=\"line\"> \t\t\tlist.add(d);</span><br><span class=\"line\"> \t\t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\t\tlog.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t\t&#125;</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (list) &#123;</span><br><span class=\"line\"> \t\t\tlist.notify();</span><br><span class=\"line\"> \t\t&#125; </span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"> \tt1.start();</span><br><span class=\"line\"> </span><br><span class=\"line\"> \t<span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (list) &#123;</span><br><span class=\"line\"> \t\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t\t\tlist.wait();</span><br><span class=\"line\"> \t\t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">\t\t\t\te.printStackTrace();</span><br><span class=\"line\"> \t\t\t&#125;</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\tlog.debug(<span class=\"string\">&quot;===============&gt; &quot;</span>);</span><br><span class=\"line\"> \t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">30</span>; i++) &#123;</span><br><span class=\"line\"> \t\t\t<span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> list.get(i);</span><br><span class=\"line\"> \t\t\tlog.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\t\tlog.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t\t&#125;</span><br><span class=\"line\"> \t\t\tlog.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\"> \tt2.start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[t1] - 0 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 1 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 2 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 3 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 4 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 5 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 6 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 7 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 8 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 9 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 10 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 11 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 12 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 13 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 14 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 15 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 16 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 17 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 18 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - ===============&gt; </span><br><span class=\"line\">[t2] - 0 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 0 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 1 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 1 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 1 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 2 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 2 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 2 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 3 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 3 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 3 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 4 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 4 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 4 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 5 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 5 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 5 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 6 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 6 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 6 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 7 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 7 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 7 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 8 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 8 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 8 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 9 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 9 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 9 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 10 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 10 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 10 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 11 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 11 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 11 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 12 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 12 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 12 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 13 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 13 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 13 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 14 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 14 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 14 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 15 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 15 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 15 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 16 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 16 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 16 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 17 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 17 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 17 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 18 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 18 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 18 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> 40 jvm </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> Thread t1, t2, t3;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test4</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    Vector&lt;Dog&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">Vector</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">loopNumber</span> <span class=\"operator\">=</span> <span class=\"number\">39</span>;</span><br><span class=\"line\">    t1 = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Dog</span>();</span><br><span class=\"line\">            list.add(d);</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\">                log.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        LockSupport.unpark(t2);</span><br><span class=\"line\">    &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">    t1.start();</span><br><span class=\"line\">    t2 = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        LockSupport.park();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;===============&gt; &quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> list.get(i);</span><br><span class=\"line\">            log.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\">                log.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        LockSupport.unpark(t3);</span><br><span class=\"line\">    &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><strong></strong></p>\n<p><a href=\"https://github.com/farmerjohngit/myblog/issues/12\">https://github.com/farmerjohngit/myblog/issues/12</a></p>\n<p><a href=\"https://www.cnblogs.com/LemonFive/p/11246086.html\">https://www.cnblogs.com/LemonFive/p/11246086.html</a></p>\n<p><a href=\"https://www.cnblogs.com/LemonFive/p/11248248.html\">https://www.cnblogs.com/LemonFive/p/11248248.html</a></p>\n<p></p>\n</blockquote>\n<h4 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Fork(1)</span></span><br><span class=\"line\"><span class=\"meta\">@BenchmarkMode(Mode.AverageTime)</span></span><br><span class=\"line\"><span class=\"meta\">@Warmup(iterations=3)</span></span><br><span class=\"line\"><span class=\"meta\">@Measurement(iterations=5)</span></span><br><span class=\"line\"><span class=\"meta\">@OutputTimeUnit(TimeUnit.NANOSECONDS)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyBenchmark</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">x</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"meta\">@Benchmark</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        x++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Benchmark</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">o</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (o) &#123;</span><br><span class=\"line\">            x++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>java -jar benchmarks.jar</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Benchmark\t\t\tMode\t Samples \tScore\t Score error \tUnits </span><br><span class=\"line\">c.i.MyBenchmark.a \tavgt \t\t5 \t\t1.542 \t\t0.056 \t\tns/op </span><br><span class=\"line\">c.i.MyBenchmark.b \tavgt \t\t5 \t\t1.518 \t\t0.091 \t\tns/op</span><br></pre></td></tr></table></figure>\n\n<p><code>java -XX:-EliminateLocks -jar benchmarks.jar</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Benchmark \t\t\tMode \tSamples \tScore \tScore error \tUnits </span><br><span class=\"line\">c.i.MyBenchmark.a \tavgt \t\t5 \t\t1.507 \t\t0.108 \t\tns/op </span><br><span class=\"line\">c.i.MyBenchmark.b \tavgt \t\t5 \t\t16.976 \t\t1.572 \t\tns/op</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<p></p>\n","cover":false,"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>CPU,IO</li>\n<li></li>\n<li>( )(360 )</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>-</p>\n</li>\n<li><p>CPU</p>\n</li>\n<li><p>Java windows</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li></li>\n<li></li>\n<li><ul>\n<li>IPC (Inter-process communication)</li>\n<li>,HTTP</li>\n</ul>\n</li>\n<li>--</li>\n<li>,-</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>cpu<code></code>- -cpu(windows15)cpu()<br><code></code>- -:<code></code><code></code>CPU concurrent</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">CPU</th>\n<th align=\"center\">1</th>\n<th align=\"center\">2</th>\n<th align=\"center\">3</th>\n<th align=\"center\">4</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">core</td>\n<td align=\"center\">1</td>\n<td align=\"center\">2</td>\n<td align=\"center\">3</td>\n<td align=\"center\">4</td>\n</tr>\n</tbody></table>\n<img src=\"/post/2023/thread/453affe8-17db-40b3-940f-162e7597336e.png\" class=\"\">\n\n<p>CPUcore</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">CPU</th>\n<th align=\"center\">1</th>\n<th align=\"center\">2</th>\n<th align=\"center\">3</th>\n<th align=\"center\">4</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">core1</td>\n<td align=\"center\">1</td>\n<td align=\"center\">1</td>\n<td align=\"center\">3</td>\n<td align=\"center\">3</td>\n</tr>\n<tr>\n<td align=\"center\">core2</td>\n<td align=\"center\">2</td>\n<td align=\"center\">2</td>\n<td align=\"center\">4</td>\n<td align=\"center\">4</td>\n</tr>\n</tbody></table>\n<img src=\"/post/2023/thread/2ed065be-3fb7-4e67-b04e-b8e08980405d.png\" class=\"\">\n\n<p>Rob Pike:</p>\n<ul>\n<li>(concurrent) - -(dealing with) </li>\n<li>(parallel) - -(doing) </li>\n</ul>\n<p></p>\n<ul>\n<li>-,</li>\n<li>-(,)</li>\n<li>3</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br><br><strong>:</strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>()5<br>5,</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.util;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileNotFoundException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileReader;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/26</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FileReaderUtil</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">read</span><span class=\"params\">(String path)</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;FileReader start .....&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">FileReader</span> <span class=\"variable\">reader</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">java</span>.io.FileReader(path);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (FileNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;FileReader end .....&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.n2;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.wry.concurrent.constans.Constans;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.wry.concurrent.util.FileReaderUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileNotFoundException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileReader;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/26</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Sync</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//fileReader</span></span><br><span class=\"line\">        FileReaderUtil.read(Constans.FILE_PATH);</span><br><span class=\"line\"></span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;do other things .....&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.n2;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.wry.concurrent.constans.Constans;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.wry.concurrent.util.FileReaderUtil;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/26</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Async</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            FileReaderUtil.read(Constans.FILE_PATH);</span><br><span class=\"line\">        &#125;).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;do other things .....&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li></li>\n<li>tomcat servlet,tomcat</li>\n<li>UIui</li>\n</ul>\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"()\"></a>()</h3><p>cpu,3,</p>\n<blockquote>\n<p>\t1\t\t10ms<br>\t2\t\t11ms<br>\t3\t\t9 ms<br>\t1 ms</p>\n</blockquote>\n<ul>\n<li>10 + 11 + 9 + 1&#x3D; 31ms</li>\n<li>cpu, 11,22,33,311ms12ms</li>\n</ul>\n<p><strong> : cpu</strong></p>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.n2.example;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Arrays;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutionException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.FutureTask;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/26</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyBenchmark</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">int</span>[] ARRAY = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[<span class=\"number\">4000_000_00</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        Arrays.fill(ARRAY, <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *  4</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">async</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">Long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"type\">int</span>[] array = ARRAY;</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; task1 = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;Integer&gt;(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000_000_00</span>; i++) &#123;</span><br><span class=\"line\">                sum += array[<span class=\"number\">0</span> + i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; task2 = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;Integer&gt;(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000_000_00</span>; i++) &#123;</span><br><span class=\"line\">                sum += array[<span class=\"number\">1000_000_00</span> + i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; task3 = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;Integer&gt;(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000_000_00</span>; i++) &#123;</span><br><span class=\"line\">                sum += array[<span class=\"number\">2000_000_00</span> + i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; task4 = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;Integer&gt;(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000_000_00</span>; i++) &#123;</span><br><span class=\"line\">                sum += array[<span class=\"number\">3000_000_00</span> + i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task1).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task2).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task3).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task4).start();</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> task1.get() + task2.get() + task3.get() + task4.get();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">Long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span> + i + <span class=\"string\">&quot;\\t&quot;</span> + (end - start));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sync</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">Long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"type\">int</span>[] array = ARRAY;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">4000_000_00</span>; i++) &#123;</span><br><span class=\"line\">            sum += array[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">Long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;&quot;</span> + sum + <span class=\"string\">&quot;\\t&quot;</span> + (end - start));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        sync();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        async();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/4f22eeff-a017-46f6-bf49-5359e570fe22.png\" class=\"\">\n\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>1cpu,cpu, cpu,<br>2cpu</p>\n<pre><code>-  ,,([] )\n-  \n</code></pre>\n<p>3 IOcpu,[IO]cpu,IO[IO][I0]</p>\n<h1 id=\"JAVA\"><a href=\"#JAVA\" class=\"headerlink\" title=\"JAVA\"></a>JAVA</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>javamain</p>\n<h3 id=\"1-Thread\"><a href=\"#1-Thread\" class=\"headerlink\" title=\"1.Thread\"></a>1.Thread</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  Thread</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Thread1</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;runing....&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        thread.setName(<span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        thread.start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;main....&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-Runnable-Thread\"><a href=\"#2-Runnable-Thread\" class=\"headerlink\" title=\"2.Runnable Thread\"></a>2.Runnable Thread</h3><p><code></code><code></code>  </p>\n<ul>\n<li>Thread </li>\n<li>Runnable </li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Thread2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">runnable</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;runing....&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//(12)</span></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(runnable,<span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        thread.start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;main....&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>JAVA 8 <code>lambda</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">Runnable lombdaRunnable= () -&gt; &#123;</span><br><span class=\"line\">    log.debug(<span class=\"string\">&quot;lombda runging......&quot;</span>); </span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">Thread lombdaThead=<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(lombdaRunnable,<span class=\"string\">&quot;lombdaThead&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">lombdaThead.start();</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">    log.debug(<span class=\"string\">&quot;lombda runging......&quot;</span>);</span><br><span class=\"line\">&#125;, <span class=\"string\">&quot;lambdaThread&quot;</span>).start();</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-FutureTask-Thread\"><a href=\"#3-FutureTask-Thread\" class=\"headerlink\" title=\"3.FutureTask Thread\"></a>3.FutureTask Thread</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Thread3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class=\"line\">        FutureTask&lt;Integer&gt; task=<span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">Callable</span>&lt;Integer&gt;() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> Integer <span class=\"title function_\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;running.......&quot;</span>);</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//(12)</span></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task,<span class=\"string\">&quot;t3&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        thread.start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//tasktask</span></span><br><span class=\"line\">        <span class=\"type\">Integer</span> <span class=\"variable\">integer</span> <span class=\"operator\">=</span> task.get();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;task &#123;&#125;&quot;</span>,integer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h3 id=\"ThreadRunnable\"><a href=\"#ThreadRunnable\" class=\"headerlink\" title=\"ThreadRunnable\"></a>ThreadRunnable</h3><h4 id=\"Runnable\"><a href=\"#Runnable\" class=\"headerlink\" title=\"Runnable\"></a>Runnable</h4><p>Runnableinit</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Allocates a new &#123;<span class=\"doctag\">@code</span> Thread&#125; object. This constructor has the same</span></span><br><span class=\"line\"><span class=\"comment\"> * effect as &#123;<span class=\"doctag\">@linkplain</span> #Thread(ThreadGroup,Runnable,String) Thread&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * &#123;<span class=\"doctag\">@code</span> (null, target, name)&#125;.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span>  target</span></span><br><span class=\"line\"><span class=\"comment\"> *         the object whose &#123;<span class=\"doctag\">@code</span> run&#125; method is invoked when this thread</span></span><br><span class=\"line\"><span class=\"comment\"> *         is started. If &#123;<span class=\"doctag\">@code</span> null&#125;, this thread&#x27;s run method is invoked.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span>  name</span></span><br><span class=\"line\"><span class=\"comment\"> *         the name of the new thread</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"title function_\">Thread</span><span class=\"params\">(Runnable target, String name)</span> &#123;</span><br><span class=\"line\">    init(<span class=\"literal\">null</span>, target, name, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>Init </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * Initializes a Thread with the current AccessControlContext.</span></span><br><span class=\"line\"><span class=\"comment\">    * <span class=\"doctag\">@see</span> #init(ThreadGroup,Runnable,String,long,AccessControlContext,boolean)</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">   <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">init</span><span class=\"params\">(ThreadGroup g, Runnable target, String name,</span></span><br><span class=\"line\"><span class=\"params\">                     <span class=\"type\">long</span> stackSize)</span> &#123;</span><br><span class=\"line\">       init(g, target, name, stackSize, <span class=\"literal\">null</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p>init <code>Runable</code> <code>target</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Initializes a Thread.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> g the Thread group</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> target the object whose run() method gets called</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> name the name of the new Thread</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> stackSize the desired stack size for the new thread, or</span></span><br><span class=\"line\"><span class=\"comment\"> *        zero to indicate that this parameter is to be ignored.</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> acc the AccessControlContext to inherit, or</span></span><br><span class=\"line\"><span class=\"comment\"> *            AccessController.getContext() if null</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> inheritThreadLocals if &#123;<span class=\"doctag\">@code</span> true&#125;, inherit initial values for</span></span><br><span class=\"line\"><span class=\"comment\"> *            inheritable thread-locals from the constructing thread</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">init</span><span class=\"params\">(ThreadGroup g, Runnable target, String name,</span></span><br><span class=\"line\"><span class=\"params\">                  <span class=\"type\">long</span> stackSize, AccessControlContext acc,</span></span><br><span class=\"line\"><span class=\"params\">                  <span class=\"type\">boolean</span> inheritThreadLocals)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (name == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>(<span class=\"string\">&quot;name cannot be null&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.name = name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"type\">Thread</span> <span class=\"variable\">parent</span> <span class=\"operator\">=</span> currentThread();</span><br><span class=\"line\">    <span class=\"type\">SecurityManager</span> <span class=\"variable\">security</span> <span class=\"operator\">=</span> System.getSecurityManager();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (g == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">/* Determine if it&#x27;s an applet or not */</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/* If there is a security manager, ask the security manager</span></span><br><span class=\"line\"><span class=\"comment\">           what to do. */</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (security != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            g = security.getThreadGroup();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/* If the security doesn&#x27;t have a strong opinion of the matter</span></span><br><span class=\"line\"><span class=\"comment\">           use the parent thread group. */</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (g == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            g = parent.getThreadGroup();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/* checkAccess regardless of whether or not threadgroup is</span></span><br><span class=\"line\"><span class=\"comment\">       explicitly passed in. */</span></span><br><span class=\"line\">    g.checkAccess();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">     * Do we have the required permissions?</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (security != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (isCCLOverridden(getClass())) &#123;</span><br><span class=\"line\">            security.checkPermission(SUBCLASS_IMPLEMENTATION_PERMISSION);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    g.addUnstarted();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.group = g;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.daemon = parent.isDaemon();</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.priority = parent.getPriority();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (security == <span class=\"literal\">null</span> || isCCLOverridden(parent.getClass()))</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.contextClassLoader = parent.getContextClassLoader();</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.contextClassLoader = parent.contextClassLoader;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.inheritedAccessControlContext =</span><br><span class=\"line\">            acc != <span class=\"literal\">null</span> ? acc : AccessController.getContext();</span><br><span class=\"line\">    <span class=\"comment\">//Runable </span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.target = target;</span><br><span class=\"line\">    setPriority(priority);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (inheritThreadLocals &amp;&amp; parent.inheritableThreadLocals != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.inheritableThreadLocals =</span><br><span class=\"line\">            ThreadLocal.createInheritedMap(parent.inheritableThreadLocals);</span><br><span class=\"line\">    <span class=\"comment\">/* Stash the specified stack size in case the VM cares */</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.stackSize = stackSize;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/* Set thread ID */</span></span><br><span class=\"line\">    tid = nextThreadID();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Thread ,Thread<code>run</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * If this thread was constructed using a separate</span></span><br><span class=\"line\"><span class=\"comment\">   * &lt;code&gt;Runnable&lt;/code&gt; run object, then that</span></span><br><span class=\"line\"><span class=\"comment\">   * &lt;code&gt;Runnable&lt;/code&gt; object&#x27;s &lt;code&gt;run&lt;/code&gt; method is called;</span></span><br><span class=\"line\"><span class=\"comment\">   * otherwise, this method does nothing and returns.</span></span><br><span class=\"line\"><span class=\"comment\">   * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\">   * Subclasses of &lt;code&gt;Thread&lt;/code&gt; should override this method.</span></span><br><span class=\"line\"><span class=\"comment\">   *</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@see</span>     #start()</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@see</span>     #stop()</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@see</span>     #Thread(ThreadGroup, Runnable, String)</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"meta\">@Override</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (target != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">          target.run();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>ThreadRunnable </li>\n<li>Runnable API </li>\n<li>Runnable Thread </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MultiThread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;&#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;running.....&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;running.....&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/e5b813b7-361c-42ec-9326-53b01a2872da.png\" class=\"\">\n\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"windows\"><a href=\"#windows\" class=\"headerlink\" title=\"windows\"></a>windows</h3><ul>\n<li>,</li>\n<li>tasklist</li>\n<li>taskkill</li>\n</ul>\n<h3 id=\"linux\"><a href=\"#linux\" class=\"headerlink\" title=\"linux\"></a>linux</h3><ul>\n<li>ps -fe</li>\n<li>ps -fT -p <PID>(PID) </li>\n<li>kill </li>\n<li>topH</li>\n<li>top -H -p <PID>(PID) :</li>\n</ul>\n<h3 id=\"java\"><a href=\"#java\" class=\"headerlink\" title=\"java\"></a>java</h3><ul>\n<li>jps JAVA </li>\n<li>jstack <PID> Java PID</li>\n<li>jconsole Java </li>\n</ul>\n<h3 id=\"jconsole\"><a href=\"#jconsole\" class=\"headerlink\" title=\"jconsole\"></a>jconsole</h3><p>java</p>\n<blockquote>\n<p>java -Djava. rmi. server . hostname&#x3D; ip -Dcom. sun. management . jmxremote -Dcom. sun. management . jmxremote. port&#x3D;i-Dcom . sun . management . jmxremote.ssl&#x3D;-Dcom. sun. management .jmxremote .authenticate&#x3D;    java</p>\n</blockquote>\n<p>&#x2F;etc&#x2F;hosts127.0.0.1 <br></p>\n<ul>\n<li>jmxremote.password </li>\n<li>jmxremote.passwordjmxremote.access600</li>\n<li>controlRole ()R&amp;D ()</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Java Virtual Machine Stacks Java </p>\n<p> JVM </p>\n<p></p>\n<ul>\n<li><p>Frame</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Frames</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        method1(<span class=\"number\">10</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">y</span> <span class=\"operator\">=</span> x + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">o</span> <span class=\"operator\">=</span> method2();</span><br><span class=\"line\">        System.out.println(o);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Object <span class=\"title function_\">method2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">o</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> o;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/cb65fed7-57dd-404b-b4f1-e365dbe83379.png\" class=\"\">\n\n<img src=\"/post/2023/thread/210feb5c-150a-43c3-8b3d-440f53e343d1.png\" class=\"\">\n\n<p>method2</p>\n<img src=\"/post/2023/thread/52ebada9-ad0c-45fc-9482-40b961c20bbf.png\" class=\"\">\n\n<img src=\"/post/2023/thread/51e456b2-69ca-4039-8ec3-137a74a3e57d.png\" class=\"\">\n\n<p>method2 method2</p>\n<img src=\"/post/2023/thread/7d8e2e3b-8f62-4e97-86d1-d8ab88b83ca1.png\" class=\"\">\n\n<img src=\"/post/2023/thread/ca324ec8-b1a0-419a-a962-640dae424e10.png\" class=\"\">\n\n<p></p>\n<img src=\"/post/2023/thread/3ce55a24-aeb0-4055-9925-c69a63ec9053.png\" class=\"\">\n\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Frames2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"comment\">//t1</span></span><br><span class=\"line\">            method1(<span class=\"number\">20</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"comment\">//main</span></span><br><span class=\"line\">        method1(<span class=\"number\">10</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> x)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">y</span> <span class=\"operator\">=</span> x + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">o</span> <span class=\"operator\">=</span> method2();</span><br><span class=\"line\">        System.out.println(o);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Object <span class=\"title function_\">method2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">o</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> o;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>t1 </p>\n<img src=\"/post/2023/thread/815e324a-777f-4b34-b590-acbb4c624cb0.png\" class=\"\">\n\n<p></p>\n<img src=\"/post/2023/thread/d05f71ef-bbbb-4b19-a804-6444a74de835.png\" class=\"\">\n\n<p>main</p>\n<img src=\"/post/2023/thread/75442144-d101-4e7a-97ca-c833a2b827fe.png\" class=\"\">\n<p>t1</p>\n<img src=\"/post/2023/thread/7bf73e18-7259-45da-93c5-a4183062572e.png\" class=\"\">\n\n<h4 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<h3 id=\"Thread-Context-Switch\"><a href=\"#Thread-Context-Switch\" class=\"headerlink\" title=\"Thread Context Switch\"></a>Thread Context Switch</h3><p> cpu </p>\n<ul>\n<li><p> cpu </p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p> sleepyieldwaitjoinparksynchronizedlock </p>\n</li>\n</ul>\n<p> Context Switch <code></code>Java <code>Program Counter Register</code> jvm </p>\n<ul>\n<li><p></p>\n</li>\n<li><p>Context Switch </p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><table>\n<thead>\n<tr>\n<th align=\"left\"><strong></strong></th>\n<th align=\"center\"><strong>static</strong></th>\n<th align=\"left\"><strong></strong></th>\n<th align=\"left\"><strong></strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">start()</td>\n<td align=\"center\"></td>\n<td align=\"left\"> run </td>\n<td align=\"left\">start CPU startIllegalThreadStateExceptio</td>\n</tr>\n<tr>\n<td align=\"left\">run()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"> Thread  Runnable  Runnable  run  Thread </td>\n</tr>\n<tr>\n<td align=\"left\">join()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">join(long n)</td>\n<td align=\"center\"></td>\n<td align=\"left\">,n</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">getId()</td>\n<td align=\"center\"></td>\n<td align=\"left\"> id</td>\n<td align=\"left\">id</td>\n</tr>\n<tr>\n<td align=\"left\">getName()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">setName(String)</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">getPriority()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">setPriority(int)</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\">java1~10  CPU </td>\n</tr>\n<tr>\n<td align=\"left\">getState()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\">Java  6  enum NEW, RUNNABLE, BLOCKED, WAITING,TIMED_WAITING, TERMINATED</td>\n</tr>\n<tr>\n<td align=\"left\">isInterrupted()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"><code></code></td>\n</tr>\n<tr>\n<td align=\"left\">isAlive()</td>\n<td align=\"center\"></td>\n<td align=\"left\">(</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">interrupt()</td>\n<td align=\"center\"></td>\n<td align=\"left\"></td>\n<td align=\"left\"> sleepwaitjoin  InterruptedException<code></code><code></code>park <code></code></td>\n</tr>\n<tr>\n<td align=\"left\">interrupted()</td>\n<td align=\"center\">static</td>\n<td align=\"left\"></td>\n<td align=\"left\"><code></code></td>\n</tr>\n<tr>\n<td align=\"left\">currentThread()</td>\n<td align=\"center\">static</td>\n<td align=\"left\"></td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">sleep(long n)</td>\n<td align=\"center\">static</td>\n<td align=\"left\">n cpu </td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">yield()</td>\n<td align=\"center\">static</td>\n<td align=\"left\">CPU</td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h2 id=\"start\"><a href=\"#start\" class=\"headerlink\" title=\"start\"></a>start</h2><h3 id=\"run\"><a href=\"#run\" class=\"headerlink\" title=\"run\"></a>run</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  run </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RunMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(Thread.currentThread().getName());</span><br><span class=\"line\">            FileReaderUtil.read(Constants.FILE_PATH);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.run();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>main </p>\n<img src=\"/post/2023/thread/4b22adcb-879c-493e-a6dc-7a50426a6db7.png\" class=\"\">\n\n<h3 id=\"start\"><a href=\"#start\" class=\"headerlink\" title=\"start\"></a>start</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  run </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RunMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(Thread.currentThread().getName());</span><br><span class=\"line\">            FileReaderUtil.read(Constants.FILE_PATH);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">//        //run</span></span><br><span class=\"line\"><span class=\"comment\">//        t1.run();</span></span><br><span class=\"line\">        <span class=\"comment\">//start</span></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/6d0f8427-4068-4a15-a933-cd3f74e28dbf.png\" class=\"\">\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * If this thread was constructed using a separate</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;code&gt;Runnable&lt;/code&gt; run object, then that</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;code&gt;Runnable&lt;/code&gt; object&#x27;s &lt;code&gt;run&lt;/code&gt; method is called;</span></span><br><span class=\"line\"><span class=\"comment\"> * otherwise, this method does nothing and returns.</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * Subclasses of &lt;code&gt;Thread&lt;/code&gt; should override this method.</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span>     #start()</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span>     #stop()</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span>     #Thread(ThreadGroup, Runnable, String)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (target != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        target.run();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">Runnable</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * When an object implementing interface &lt;code&gt;Runnable&lt;/code&gt; is used</span></span><br><span class=\"line\"><span class=\"comment\">     * to create a thread, starting the thread causes the object&#x27;s</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;code&gt;run&lt;/code&gt; method to be called in that separately executing</span></span><br><span class=\"line\"><span class=\"comment\">     * thread.</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * The general contract of the method &lt;code&gt;run&lt;/code&gt; is that it may</span></span><br><span class=\"line\"><span class=\"comment\">     * take any action whatsoever.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@see</span>     java.lang.Thread#run()</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>run() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">     <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">      * This method is not invoked for the main method thread or &quot;system&quot;</span></span><br><span class=\"line\"><span class=\"comment\">      * group threads created/set up by the VM. Any new functionality added</span></span><br><span class=\"line\"><span class=\"comment\">      * to this method in the future may have to also be added to the VM.</span></span><br><span class=\"line\"><span class=\"comment\">      *</span></span><br><span class=\"line\"><span class=\"comment\">      * A zero status value corresponds to state &quot;NEW&quot;.</span></span><br><span class=\"line\"><span class=\"comment\">      */</span></span><br><span class=\"line\">     <span class=\"keyword\">if</span> (threadStatus != <span class=\"number\">0</span>)</span><br><span class=\"line\">         <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalThreadStateException</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"comment\">/* Notify the group that this thread is about to be started</span></span><br><span class=\"line\"><span class=\"comment\">      * so that it can be added to the group&#x27;s list of threads</span></span><br><span class=\"line\"><span class=\"comment\">      * and the group&#x27;s unstarted count can be decremented. */</span></span><br><span class=\"line\">     group.add(<span class=\"built_in\">this</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"type\">boolean</span> <span class=\"variable\">started</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">     <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">         start0();</span><br><span class=\"line\">         started = <span class=\"literal\">true</span>;</span><br><span class=\"line\">     &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">         <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">             <span class=\"keyword\">if</span> (!started) &#123;</span><br><span class=\"line\">                 group.threadStartFailed(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">         &#125; <span class=\"keyword\">catch</span> (Throwable ignore) &#123;</span><br><span class=\"line\">             <span class=\"comment\">/* do nothing. If start0 threw a Throwable then</span></span><br><span class=\"line\"><span class=\"comment\">               it will be passed up the call stack */</span></span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start0</span><span class=\"params\">()</span>;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><code>start()</code> <code>start0()</code><code>start0()</code><code>native</code></p>\n<h3 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p> run  run</p>\n</li>\n<li><p> start  run </p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadStatus</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;running.....&quot;</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;:&quot;</span>+t1.getState());</span><br><span class=\"line\">        <span class=\"comment\">//start</span></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;:&quot;</span>+t1.getState());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/3a071edf-6ded-487b-abbb-d016a9fe6864.png\" class=\"\">\n\n<h3 id=\"startjava-lang-IllegalThreadStateException\"><a href=\"#startjava-lang-IllegalThreadStateException\" class=\"headerlink\" title=\"startjava.lang.IllegalThreadStateException\"></a>startjava.lang.IllegalThreadStateException</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//start</span></span><br><span class=\"line\">t1.start();</span><br><span class=\"line\">t1.start();</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/feed6992-8dff-450c-9010-e2f46caf6243.png\" class=\"\">\n\n\n\n<h2 id=\"sleep--yield\"><a href=\"#sleep--yield\" class=\"headerlink\" title=\"sleep  yield\"></a><strong>sleep</strong> <strong></strong> <strong>yield</strong></h2><h3 id=\"sleep\"><a href=\"#sleep\" class=\"headerlink\" title=\"sleep\"></a>sleep</h3><ol>\n<li> sleep  <em>Running</em>  <em>Timed Waiting</em> </li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   sleep</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">2000</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 &#123;&#125;&quot;</span>,t1.getState());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 &#123;&#125;&quot;</span>,t1.getState());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/image-20200822234416578.png\" class=\"\" title=\"image-20200822234416578\">\n\n<ol start=\"2\">\n<li> interrupt  sleep  InterruptedException</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  interrupt </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadMethod2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;enter sleep...... &quot;</span>);</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">2000</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">                log.debug(<span class=\"string\">&quot;wake up...... &quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;interrupt...... &quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/81a4db1a-c8d1-47f7-a955-39db726f5173.png\" class=\"\">\n\n<ol start=\"3\">\n<li><p></p>\n</li>\n<li><p> TimeUnit  sleep  Thread  sleep </p>\n</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  TimeUnit</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadMethod3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;start ......&quot;</span>);</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;end ......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/f78c9ec4-6379-48de-b2e6-f529bb063540.png\" class=\"\">\n\n\n\n<h3 id=\"yield\"><a href=\"#yield\" class=\"headerlink\" title=\"yield\"></a>yield</h3><ol>\n<li><p> yield  <em>Running</em>  <em>Runnable</em> </p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>hint</p>\n<p> cpu  cpu </p>\n<h3 id=\"yield\"><a href=\"#yield\" class=\"headerlink\" title=\"yield\"></a>yield</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPriority</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task1</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;----&gt;1 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task2</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Thread.yield();</span></span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;        ----&gt;2 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task1, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task2, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>t1t2 </p>\n<img src=\"/post/2023/thread/683dd209-d862-46f9-878f-b9e8f4c2db3b.png\" class=\"\">\n\n<h3 id=\"yield\"><a href=\"#yield\" class=\"headerlink\" title=\"yield\"></a>yield</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPriority</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task1</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;----&gt;1 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task2</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                <span class=\"comment\">//yield,CPU</span></span><br><span class=\"line\">                Thread.<span class=\"keyword\">yield</span>();</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;        ----&gt;2 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task1, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task2, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>t1 t2 </p>\n<img src=\"/post/2023/thread/d37e0c1b-1e69-4360-937a-edf5296f47ce.png\" class=\"\">\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/27</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadPriority</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task1</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;----&gt;1 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Runnable</span> <span class=\"variable\">task2</span> <span class=\"operator\">=</span> () -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (; ; ) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;        ----&gt;2 &quot;</span> + count++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task1, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(task2, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//t1</span></span><br><span class=\"line\">        t1.setPriority(Thread.MIN_PRIORITY);</span><br><span class=\"line\">        <span class=\"comment\">//t2</span></span><br><span class=\"line\">        t2.setPriority(Thread.MAX_PRIORITY);</span><br><span class=\"line\">        </span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>t2 t1 </p>\n<img src=\"/post/2023/thread/2feee3db-6b39-4e1a-9098-1a5f966742f7.png\" class=\"\">\n\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"CPU-100\"><a href=\"#CPU-100\" class=\"headerlink\" title=\"CPU 100%\"></a>CPU 100%</h3><h4 id=\"sleep-\"><a href=\"#sleep-\" class=\"headerlink\" title=\"sleep \"></a>sleep </h4><p>cpuwhile(rue)cpu,yieldsleepcpu</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">500</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;   </span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>wait</li>\n<li>I,</li>\n<li>sleep</li>\n</ul>\n<h2 id=\"join\"><a href=\"#join\" class=\"headerlink\" title=\"join\"></a>join</h2><p> r </p>\n<h3 id=\"1-join\"><a href=\"#1-join\" class=\"headerlink\" title=\"1 join\"></a>1 join</h3><p>Join</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  join</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JoinMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            r = <span class=\"number\">10</span>;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;:&#123;&#125;&quot;</span>, r);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code></code><code>t1</code><code>r</code>r</p>\n<img src=\"/post/2023/thread/5cce206b-f24c-4489-afda-57b5a3102172.png\" class=\"\">\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p> t1 t1  1 <code> r=10</code></p>\n</li>\n<li><p> r  <code>r=0</code></p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p> sleep </p>\n<p>t1,</p>\n</li>\n<li><p> join t1.start() </p>\n<p><code>join()</code>**** <strong>join()</strong></p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  join</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JoinMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            r = <span class=\"number\">10</span>;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        <span class=\"comment\">//t1</span></span><br><span class=\"line\">        t1.join();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;:&#123;&#125;&quot;</span>, r);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/86d6badd-f76b-4152-8044-bef85f333017.png\" class=\"\">\n\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2 \"></a>2 </h3><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> cost </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  join </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JoinMethod2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">r1</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">r2</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            r1 = <span class=\"number\">10</span>;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            r2 = <span class=\"number\">20</span>;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;join begin ......&quot;</span>);</span><br><span class=\"line\">        t1.join();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 join end ......&quot;</span>);</span><br><span class=\"line\">        t2.join();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t2 join end ......&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 :&#123;&#125;,t2 :&#123;&#125;,&#123;&#125;&quot;</span>, r1, r2, end - start);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ul>\n<li><p> join t1 , t2 , </p>\n</li>\n<li><p> join1s , , t2  1s,  1s</p>\n</li>\n</ul>\n<img src=\"/post/2023/thread/9372a527-1cf5-4699-9271-f9724c815f24.png\" class=\"\">\n\n<p> join </p>\n<img src=\"/post/2023/thread/b94de8b0-5933-49dc-b0ff-a29a03280074.png\" class=\"\">\n\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3 \"></a>3 </h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  join </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JoinMethod3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">r1</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">//2000</span></span><br><span class=\"line\">                TimeUnit.MILLISECONDS.sleep(<span class=\"number\">2000</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">            r1 = <span class=\"number\">10</span>;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;join begin ......&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//1500</span></span><br><span class=\"line\">        t1.join(<span class=\"number\">1500</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 join end ......&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1 :&#123;&#125;,&#123;&#125;&quot;</span>, r1,  end - start);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/44fc6f61-2e64-414e-be76-0486d270b52b.png\" class=\"\">\n\n<p>join</p>\n<h2 id=\"interrupt\"><a href=\"#interrupt\" class=\"headerlink\" title=\"interrupt\"></a>interrupt</h2><h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"  \"></a>  </h3><p> sleep wait  join  </p>\n<p> sleep ,  sleep </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;interrupt... &quot;</span>);</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot; : &#123;&#125;&quot;</span>, t1.isInterrupted());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>false</p>\n<img src=\"/post/2023/thread/d9550ede-fad3-4675-8791-3a1237fab0de.png\" class=\"\">\n\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"  \"></a>  </h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">               </span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;interrupt... &quot;</span>);</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot; : &#123;&#125;&quot;</span>, t1.isInterrupted());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>t1</p>\n<img src=\"/post/2023/thread/c2203c1e-3091-4832-8061-8ba8bc3b24d1.png\" class=\"\">\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"type\">boolean</span> <span class=\"variable\">isInterrupt</span> <span class=\"operator\">=</span> Thread.currentThread().isInterrupted();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (isInterrupt) &#123;</span><br><span class=\"line\">                    log.debug(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;interrupt... &quot;</span>);</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot; : &#123;&#125;&quot;</span>, t1.isInterrupted());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<img src=\"/post/2023/thread/70691192-ef7e-43b6-b365-d139f036e188.png\" class=\"\">\n\n<h3 id=\"park\"><a href=\"#park\" class=\"headerlink\" title=\"park:\"></a>park:</h3><p> park , </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt park</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;park...&quot;</span>);</span><br><span class=\"line\">            LockSupport.park();</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;unpark...&quot;</span>);</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;&#123;&#125;&quot;</span>, Thread.currentThread().isInterrupted());</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/f5e5190c-2ca0-4467-8618-c9084b18b26f.png\" class=\"\">\n\n<p>park park</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt park</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;park...&quot;</span>);</span><br><span class=\"line\">            LockSupport.park();</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;unpark...&quot;</span>);</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;&#123;&#125;&quot;</span>, Thread.currentThread().isInterrupted());</span><br><span class=\"line\">            <span class=\"comment\">//park</span></span><br><span class=\"line\">            LockSupport.park();</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;unpark...&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/a6cd39b0-e6e9-4b6f-88ea-3cfb0d899b83.png\" class=\"\">\n\n<p>Thread Thread.interrupted() </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.locks.LockSupport;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   interrupt park</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterruptMethod3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;park...&quot;</span>);</span><br><span class=\"line\">            LockSupport.park();</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;unpark...&quot;</span>);</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;&#123;&#125;&quot;</span>, Thread.interrupted());</span><br><span class=\"line\">            <span class=\"comment\">//park</span></span><br><span class=\"line\">            LockSupport.park();</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;unpark...&quot;</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\"></span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        t1.interrupt();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/bc0f03b1-c84a-45af-879e-4bdc0f0ff35e.png\" class=\"\">\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"Two-Phase-Termination\"><a href=\"#Two-Phase-Termination\" class=\"headerlink\" title=\"Two Phase Termination\"></a>Two Phase Termination</h3><p>T1T2?</p>\n<p>T2</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>stop():<ul>\n<li>stop </li>\n</ul>\n</li>\n<li>System.exit(int)</li>\n<li></li>\n</ul>\n<h3 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h3><p>2s</p>\n<img src=\"/post/2023/thread/e1c2fc78-6f75-4049-8631-1e2bf400e92b.png\" class=\"\" title=\"\">\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * interrupt</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TwoPhaseTermination</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Thread monitor;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        monitor = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"type\">Thread</span> <span class=\"variable\">currentThread</span> <span class=\"operator\">=</span> Thread.currentThread();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (currentThread.isInterrupted())&#123;</span><br><span class=\"line\">                    log.debug(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>); <span class=\"comment\">//  </span></span><br><span class=\"line\">                    log.debug(<span class=\"string\">&quot;&quot;</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                    <span class=\"comment\">//,</span></span><br><span class=\"line\">                    currentThread.interrupt();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        monitor.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">stop</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        monitor.interrupt();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">TwoPhaseTermination</span> <span class=\"variable\">termination</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">TwoPhaseTermination</span>();</span><br><span class=\"line\">        termination.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">3</span>);</span><br><span class=\"line\">        termination.stop();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/d1df5ae9-03d4-4960-a460-86c4eb4f13d9.png\" class=\"\">\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>stop()</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>suspend()</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>resume()</td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>Java </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DaemonThread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (Thread.currentThread().isInterrupted()) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><code>main</code><code>t1</code><code>java </code></p>\n<img src=\"/post/2023/thread/0e59c147-a499-4226-bf3b-d6f0a4cabd5a.png\" class=\"\">\n\n<p><code>setDaemon(boolean)</code>t1</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DaemonThread</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (Thread.currentThread().isInterrupted()) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        t1.setDaemon(<span class=\"literal\">true</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>main</code><code>t1</code></p>\n<img src=\"/post/2023/thread/ea4c56c3-75b1-48fa-a40e-dcb6dd63823f.png\" class=\"\">\n\n<blockquote>\n<p><strong></strong></p>\n<ul>\n<li><p></p>\n</li>\n<li><p>Tomcat <code>Acceptor</code> <code>Poller </code> Tomcat  shutdown </p>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> <strong></strong> </p>\n<img src=\"/post/2023/thread/d3f13fb8-e2e2-4692-8b27-2ca13a87ec1a.png\" class=\"\">\n\n<ul>\n<li><p></p>\n</li>\n<li><p> CPU </p>\n</li>\n<li><p> CPU </p>\n<ul>\n<li> CPU </li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li><p> API BIO  CPU</p>\n</li>\n<li><p> BIO </p>\n</li>\n<li><p></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> <strong>Java API</strong> </p>\n<p> Thread.State </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> <span class=\"title class_\">State</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a thread which has not yet started.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    NEW,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a runnable thread.  A thread in the runnable</span></span><br><span class=\"line\"><span class=\"comment\">     * state is executing in the Java virtual machine but it may</span></span><br><span class=\"line\"><span class=\"comment\">     * be waiting for other resources from the operating system</span></span><br><span class=\"line\"><span class=\"comment\">     * such as processor.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    RUNNABLE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a thread blocked waiting for a monitor lock.</span></span><br><span class=\"line\"><span class=\"comment\">     * A thread in the blocked state is waiting for a monitor lock</span></span><br><span class=\"line\"><span class=\"comment\">     * to enter a synchronized block/method or</span></span><br><span class=\"line\"><span class=\"comment\">     * reenter a synchronized block/method after calling</span></span><br><span class=\"line\"><span class=\"comment\">     * &#123;<span class=\"doctag\">@link</span> Object#wait() Object.wait&#125;.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    BLOCKED,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a waiting thread.</span></span><br><span class=\"line\"><span class=\"comment\">     * A thread is in the waiting state due to calling one of the</span></span><br><span class=\"line\"><span class=\"comment\">     * following methods:</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Object#wait() Object.wait&#125; with no timeout&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> #join() Thread.join&#125; with no timeout&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> LockSupport#park() LockSupport.park&#125;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;/ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;p&gt;A thread in the waiting state is waiting for another thread to</span></span><br><span class=\"line\"><span class=\"comment\">     * perform a particular action.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * For example, a thread that has called &lt;tt&gt;Object.wait()&lt;/tt&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * on an object is waiting for another thread to call</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;tt&gt;Object.notify()&lt;/tt&gt; or &lt;tt&gt;Object.notifyAll()&lt;/tt&gt; on</span></span><br><span class=\"line\"><span class=\"comment\">     * that object. A thread that has called &lt;tt&gt;Thread.join()&lt;/tt&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * is waiting for a specified thread to terminate.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    WAITING,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a waiting thread with a specified waiting time.</span></span><br><span class=\"line\"><span class=\"comment\">     * A thread is in the timed waiting state due to calling one of</span></span><br><span class=\"line\"><span class=\"comment\">     * the following methods with a specified positive waiting time:</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> #sleep Thread.sleep&#125;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> Object#wait(long) Object.wait&#125; with timeout&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> #join(long) Thread.join&#125; with timeout&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> LockSupport#parkNanos LockSupport.parkNanos&#125;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     *   &lt;li&gt;&#123;<span class=\"doctag\">@link</span> LockSupport#parkUntil LockSupport.parkUntil&#125;&lt;/li&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     * &lt;/ul&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    TIMED_WAITING,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Thread state for a terminated thread.</span></span><br><span class=\"line\"><span class=\"comment\">     * The thread has completed execution.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    TERMINATED;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<img src=\"/post/2023/thread/0827c261-3195-4bdc-9b78-e0c664037749.png\" class=\"\">\n\n<ul>\n<li><p>NEW  start() </p>\n</li>\n<li><p>RUNNABLE  start() <strong>Java API</strong>  RUNNABLE  <strong></strong> </p>\n<ul>\n<li> BIO  Java </li>\n</ul>\n</li>\n<li><p>BLOCKED  WAITING  TIMED_WAITING  <strong>Java API</strong> </p>\n</li>\n<li><p>TERMINATED </p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/7/28</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadState</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//new</span></span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;runing......&quot;</span>);</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//running</span></span><br><span class=\"line\">           <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>)&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//terminted</span></span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;runing......&quot;</span>);</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t3&quot;</span>);</span><br><span class=\"line\">        t3.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t4</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//timed_waiting</span></span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (ThreadState.class) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    TimeUnit.SECONDS.sleep(<span class=\"number\">100</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t4&quot;</span>);</span><br><span class=\"line\">        t4.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t5</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//waiting</span></span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    t2.join();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t5&quot;</span>);</span><br><span class=\"line\">        t5.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t6</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;  <span class=\"comment\">//blocked</span></span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (ThreadState.class) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    TimeUnit.SECONDS.sleep(<span class=\"number\">100</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;,<span class=\"string\">&quot;t6&quot;</span>);</span><br><span class=\"line\">        t6.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t1  &#123;&#125;&quot;</span>,t1.getState());</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t2  &#123;&#125;&quot;</span>,t2.getState());</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t3  &#123;&#125;&quot;</span>,t3.getState());</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t4  &#123;&#125;&quot;</span>,t4.getState());</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t5  &#123;&#125;&quot;</span>,t5.getState());</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;t6  &#123;&#125;&quot;</span>,t6.getState());</span><br><span class=\"line\"></span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        test1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/d1f13ce8-f7cb-4cf1-b2aa-6e8d7204a459.png\" class=\"\">\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ul>\n<li><ul>\n<li></li>\n<li> 4 </li>\n</ul>\n</li>\n<li> sleep(n) </li>\n</ul>\n<p></p>\n<blockquote>\n<p></p>\n<p></p>\n<p></p>\n<p> 1 </p>\n<p> 15</p>\n<p> 1</p>\n<p> 2</p>\n<p> 1</p>\n<p></p>\n<p></p>\n<p></p>\n<ul>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n</ul>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<img src=\"/post/2023/thread/image-20200806070304756.png\" class=\"\" title=\"image-20200806070304756\">\n\n<p>1620</p>\n<p>4</p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<img src=\"/post/2023/thread/image-20200806070323056.png\" class=\"\" title=\"image-20200806070323056\">\n\n<p></p>\n<p></p>\n<p></p>\n</blockquote>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * ,</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MakingTea</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * t2  t1  </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">5</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                log.info(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">                TimeUnit.SECONDS.sleep(<span class=\"number\">5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">//t1</span></span><br><span class=\"line\">                t1.join();</span><br><span class=\"line\">                log.info(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        t1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/image-20200806072602725.png\" class=\"\" title=\"image-20200806072602725\">\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p> api startrunsleepjoininterrupt </p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>join</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p>Thread  </p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>CPU</p>\n<img src=\"/post/2023/thread/image-20200806080136510.png\" class=\"\" title=\"image-20200806080136510\">\n</li>\n<li><p></p>\n</li>\n<li><p>24sleep io wait</p>\n<img src=\"/post/2023/thread/image-20200806080218070.png\" class=\"\" title=\"image-20200806080218070\">\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p> [  ]</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<p></p>\n</li>\n<li><p></p>\n<img src=\"/post/2023/thread/image-20200806080338819.png\" class=\"\" title=\"image-20200806080338819\">\n</li>\n<li><p></p>\n</li>\n<li><p> 0  +1 </p>\n</li>\n<li><p> [  ] [ 11] </p>\n</li>\n<li><p> [  ] 0  -1  -1 </p>\n</li>\n<li><p>[] 1 </p>\n<img src=\"/post/2023/thread/image-20200806080425078.png\" class=\"\" title=\"image-20200806080425078\">\n</li>\n<li><p> 1  0</p>\n</li>\n</ul>\n<h3 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h3><p> 0  5000  0 </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SharedVariables</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">counter</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t1</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                counter++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                counter--;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.join();</span><br><span class=\"line\">        t2.join();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;counter:&#123;&#125;&quot;</span>, counter);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        t1();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> Java </p>\n<p> i++ i  JVM </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getstatic i // i</span><br><span class=\"line\">iconst_1 // 1</span><br><span class=\"line\">iadd // </span><br><span class=\"line\">putstatic i // i</span><br></pre></td></tr></table></figure>\n\n<p> i :</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getstatic i // i</span><br><span class=\"line\">iconst_1 // 1</span><br><span class=\"line\">isub // </span><br><span class=\"line\">putstatic i // i</span><br></pre></td></tr></table></figure>\n\n<p> Java </p>\n<img src=\"/post/2023/thread/image-20200806081215362.png\" class=\"\" title=\"image-20200806081215362\">\n\n<p> 8 </p>\n<img src=\"/post/2023/thread/image-20200806081309415.png\" class=\"\" title=\"image-20200806081309415\">\n\n<p> 8 </p>\n<p></p>\n<img src=\"/post/2023/thread/image-20200806081339039.png\" class=\"\" title=\"image-20200806081339039\">\n\n<p></p>\n<img src=\"/post/2023/thread/image-20200806081409317.png\" class=\"\" title=\"image-20200806081409317\">\n\n<h3 id=\"-Critical-Section\"><a href=\"#-Critical-Section\" class=\"headerlink\" title=\"(Critical Section)\"></a>(Critical Section)</h3><ul>\n<li><p></p>\n</li>\n<li><p><strong></strong></p>\n<ul>\n<li><p><strong></strong></p>\n</li>\n<li><p><strong></strong></p>\n</li>\n</ul>\n</li>\n<li><p><strong></strong><strong></strong></p>\n</li>\n</ul>\n<p>:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">counter</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">increment</span><span class=\"params\">()</span> </span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">&#123; </span><br><span class=\"line\"> counter++; </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">decrement</span><span class=\"params\">()</span> </span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">&#123; </span><br><span class=\"line\"> counter--; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-Race-Condition\"><a href=\"#-Race-Condition\" class=\"headerlink\" title=\"(Race Condition)\"></a>(Race Condition)</h3><p><strong></strong><strong></strong></p>\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"***** \"></a>***** <strong></strong></h3><p></p>\n<ul>\n<li><p>synchronizedLock</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<p>synchronized</p>\n<p></p>\n<p></p>\n<blockquote>\n<p><strong></strong></p>\n<p> java  synchronized </p>\n<p></p>\n<p></p>\n</blockquote>\n<h3 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">synchronized</span>() <span class=\"comment\">// 1 2(blocked)</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SharedVariables</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">counter</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * synchronized</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t2</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (lock) &#123;</span><br><span class=\"line\">                    counter++;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (lock) &#123;</span><br><span class=\"line\">                    counter--;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.join();</span><br><span class=\"line\">        t2.join();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;counter:&#123;&#125;&quot;</span>, counter);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        t2();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p> </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * ,</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Room</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">counter</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">increment</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">            counter++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">decrement</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">            counter--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">getCounter</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> counter;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Room</span> <span class=\"variable\">room</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Room</span>();</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                room.increment();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5000</span>; i++) &#123;</span><br><span class=\"line\">                room.decrement();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.join();</span><br><span class=\"line\">        t2.join();</span><br><span class=\"line\"></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;counter:&#123;&#125;&quot;</span>, room.getCounter());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<img src=\"/post/2023/thread/image-20200806093605366.png\" class=\"\" title=\"image-20200806093605366\">\n\n<p></p>\n<ul>\n<li><p><code>synchronized()</code> room t1t2 </p>\n</li>\n<li><p> t1  <code>synchronized(room)</code>  t1 <code>count++</code> </p>\n</li>\n<li><p> t2  <code>synchronized(room)</code> </p>\n</li>\n<li><p> t1  cpu t1 t2  t1 </p>\n</li>\n<li><p> t1  <code>synchronized&#123;&#125;</code>  obj  t2 t2  obj  <code>count--</code> </p>\n</li>\n</ul>\n<p>:</p>\n<img src=\"/post/2023/thread/image-20200806093649652.png\" class=\"\" title=\"image-20200806093649652\">\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>synchronized</code> <strong></strong><strong></strong></p>\n<p>:</p>\n<ul>\n<li><p> synchronized(obj)  for  </p>\n</li>\n<li><p> t1 synchronized(obj1)  t2 synchronized(obj2)  </p>\n</li>\n<li><p> t1 synchronized(obj)  t2  </p>\n</li>\n</ul>\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><p><code>synchronized</code><code></code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>synchronized</code><code></code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Test</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (Test.class) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h3><p> synchronzied </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> synchronized </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *  8</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;strong&gt; synchronized &lt;/strong&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;strong&gt;  &lt;/strong&gt;&lt;strong&gt;&lt;/strong&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Thread8Locks</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"><span class=\"comment\">//        t1();</span></span><br><span class=\"line\"><span class=\"comment\">//        t2();</span></span><br><span class=\"line\"><span class=\"comment\">//        t3();</span></span><br><span class=\"line\"><span class=\"comment\">//        t4();</span></span><br><span class=\"line\"><span class=\"comment\">//        t5();</span></span><br><span class=\"line\"><span class=\"comment\">//        t6();</span></span><br><span class=\"line\"><span class=\"comment\">//        t7();</span></span><br><span class=\"line\"><span class=\"comment\">//        t8();</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * t1, 1 2</span></span><br><span class=\"line\"><span class=\"comment\">     * t2, 2 1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number1</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number1</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.a();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,1s 1 2</span></span><br><span class=\"line\"><span class=\"comment\">     * t2, 2 1s 1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number2</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number2</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                n.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * c</span></span><br><span class=\"line\"><span class=\"comment\">     * t3 3</span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t3,t2,1s 1 2  ; 3,1s,1,2</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t3,t1, 2 1s 1; 2,3,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     * t3,t1,t2,1s2 1; 3,1s,1,2</span></span><br><span class=\"line\"><span class=\"comment\">     * t3,t2,t1 2 1s 1; 3,2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t3</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number3</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number3</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                n.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.c();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t3&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * t1  t2 </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t2,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t1,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t4</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number4</span> <span class=\"variable\">n1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number4</span>();</span><br><span class=\"line\">        <span class=\"type\">Number4</span> <span class=\"variable\">n2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number4</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                n1.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            n2.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * a</span></span><br><span class=\"line\"><span class=\"comment\">     * b</span></span><br><span class=\"line\"><span class=\"comment\">     * t1  t2 </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t2,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t1,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t5</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number5</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number5</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Number5.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t2,1s12; 1s,1,2</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t1,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t6</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Number6.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            Number6.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * a</span></span><br><span class=\"line\"><span class=\"comment\">     * b</span></span><br><span class=\"line\"><span class=\"comment\">     * t1  t2 </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t2,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t1,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t7</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number7</span> <span class=\"variable\">n1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number7</span>();</span><br><span class=\"line\">        <span class=\"type\">Number7</span> <span class=\"variable\">n2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number7</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                n1.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n2.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * t1,t2,1s12; 1s,1,2</span></span><br><span class=\"line\"><span class=\"comment\">     * t2,t1,21s1; 2,1s,1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">t8</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Number8</span> <span class=\"variable\">n</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Number8</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                n.a();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            log.debug(<span class=\"string\">&quot;begin....&quot;</span>);</span><br><span class=\"line\">            n.b();</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number1&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number1</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number2&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number3&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number3</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">c</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number4&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number4</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * a</span></span><br><span class=\"line\"><span class=\"comment\"> * b</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number5&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number5</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number6&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number6</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * a</span></span><br><span class=\"line\"><span class=\"comment\"> * b</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number7&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number7</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j(topic = &quot;c.Number8&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Number8</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;</span><br><span class=\"line\">\ti++; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> test1()  i.</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public static void test1();</span><br><span class=\"line\"> descriptor: ()V</span><br><span class=\"line\"> flags: ACC_PUBLIC, ACC_STATIC</span><br><span class=\"line\"> Code:</span><br><span class=\"line\"> stack=1, locals=1, args_size=0</span><br><span class=\"line\"> 0: bipush 10</span><br><span class=\"line\"> 2: istore_0</span><br><span class=\"line\"> 3: iinc 0, 1</span><br><span class=\"line\"> 6: return</span><br><span class=\"line\"> LineNumberTable:</span><br><span class=\"line\"> line 10: 0</span><br><span class=\"line\"> line 11: 3</span><br><span class=\"line\"> line 12: 6</span><br><span class=\"line\"> LocalVariableTable:</span><br><span class=\"line\"> Start Length Slot Name Signature</span><br><span class=\"line\"> 3 4 0 i I</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/image-20200806112353892.png\" class=\"\" title=\"image-20200806112353892\">\n\n\n\n<p><strong>,</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadSecurity</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">THREAD_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">LOOP_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">200</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ThreadUnsafe</span> <span class=\"variable\">test</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadUnsafe</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; THREAD_NUMBER; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                test.method1(LOOP_NUMBER);</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;Thread&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadUnsafe</span> &#123;</span><br><span class=\"line\">    ArrayList&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> loopNumber)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// &#123; , </span></span><br><span class=\"line\">            method2();</span><br><span class=\"line\">            method3();</span><br><span class=\"line\">            <span class=\"comment\">// &#125; </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        list.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method3</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        list.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>2  add1 remove </strong></p>\n<img src=\"/post/2023/thread/image-20200806113017975.png\" class=\"\" title=\"image-20200806113017975\">\n\n<p></p>\n<ul>\n<li><p> method2  list </p>\n</li>\n<li><p>method3  method2 </p>\n<img src=\"/post/2023/thread/image-20200806113212737.png\" class=\"\" title=\"image-20200806113212737\">\n\n<p><strong> list </strong></p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadSecurity</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">THREAD_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">LOOP_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">200</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Threadsafe</span> <span class=\"variable\">test</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Threadsafe</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; THREAD_NUMBER; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                test.method1(LOOP_NUMBER);</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;Thread&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Threadsafe</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> loopNumber)</span> &#123;</span><br><span class=\"line\">        ArrayList&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// &#123; , </span></span><br><span class=\"line\">            method2(list);</span><br><span class=\"line\">            method3(list);</span><br><span class=\"line\">            <span class=\"comment\">// &#125; </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method3</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p></p>\n<ul>\n<li><p>list </p>\n</li>\n<li><p> method2  method1  method1 </p>\n</li>\n<li><p>method3  method2 </p>\n</li>\n</ul>\n<img src=\"/post/2023/thread/image-20200806113622053.png\" class=\"\" title=\"image-20200806113622053\">\n\n<p> method2  method3  public </p>\n<ul>\n<li><p>1 method2  method3</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadSecurity2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">THREAD_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">LOOP_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">200</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">Threadsafe2</span> <span class=\"variable\">test</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Threadsafe2</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; THREAD_NUMBER; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                test.method1(LOOP_NUMBER);</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;Thread&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Threadsafe2</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> loopNumber)</span> &#123;</span><br><span class=\"line\">        ArrayList&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// &#123; , </span></span><br><span class=\"line\">            method2(list);</span><br><span class=\"line\">            method3(list);</span><br><span class=\"line\">            <span class=\"comment\">// &#125; </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method3</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>method2</code><code>method3</code><code>method1</code>list </p>\n</li>\n<li><p>2 1  ThreadSafe  method2  method3 </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/6</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThreadSecurity2</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">THREAD_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">LOOP_NUMBER</span> <span class=\"operator\">=</span> <span class=\"number\">200</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">ThreadSafeSubClass</span> <span class=\"variable\">test</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ThreadSafeSubClass</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; THREAD_NUMBER; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                test.method1(LOOP_NUMBER);</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;Thread&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Threadsafe2</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">(<span class=\"type\">int</span> loopNumber)</span> &#123;</span><br><span class=\"line\">        ArrayList&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// &#123; , </span></span><br><span class=\"line\">            method2(list);</span><br><span class=\"line\">            method3(list);</span><br><span class=\"line\">            <span class=\"comment\">// &#125; </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.add(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method3</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        list.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ThreadSafeSubClass</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Threadsafe2</span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method3</span><span class=\"params\">(ArrayList&lt;String&gt; list)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            list.remove(<span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><img src=\"/post/2023/thread/image-20200806115634318.png\" class=\"\" title=\"image-20200806115634318\"></li>\n</ul>\n<p><strong> private  final </strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p>String</p>\n</li>\n<li><p>Integer</p>\n</li>\n<li><p>StringBuffffer</p>\n</li>\n<li><p>Random</p>\n</li>\n<li><p>Vector</p>\n</li>\n<li><p>Hashtable</p>\n</li>\n<li><p>JAVA.util.concurrent </p>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Hashtable</span> <span class=\"variable\">table</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Hashtable</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;&#123;</span><br><span class=\"line\"> table.put(<span class=\"string\">&quot;key&quot;</span>, <span class=\"string\">&quot;value1&quot;</span>);</span><br><span class=\"line\">&#125;).start();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;&#123;</span><br><span class=\"line\"> table.put(<span class=\"string\">&quot;key&quot;</span>, <span class=\"string\">&quot;value2&quot;</span>);</span><br><span class=\"line\">&#125;).start()</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p></p>\n</li>\n<li><p><strong></strong></p>\n</li>\n</ul>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Hashtable</span> <span class=\"variable\">table</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Hashtable</span>();</span><br><span class=\"line\"><span class=\"comment\">// 12</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>( table.get(<span class=\"string\">&quot;key&quot;</span>) == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\"> table.put(<span class=\"string\">&quot;key&quot;</span>, value);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/image-20200818213438504.png\" class=\"\" title=\"image-20200818213438504\">\n\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>StringInteger </p>\n<p>String  replacesubstring </p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Immutable</span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"title function_\">Immutable</span><span class=\"params\">(<span class=\"type\">int</span> value)</span>&#123;</span><br><span class=\"line\"> \t<span class=\"built_in\">this</span>.value = value;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">getValue</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.value;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Immutable</span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\"> <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"title function_\">Immutable</span><span class=\"params\">(<span class=\"type\">int</span> value)</span>&#123;</span><br><span class=\"line\"> \t<span class=\"built_in\">this</span>.value = value;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">getValue</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.value;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"keyword\">public</span> Immutable <span class=\"title function_\">add</span><span class=\"params\">(<span class=\"type\">int</span> v)</span>&#123;</span><br><span class=\"line\"> \t<span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Immutable</span>(<span class=\"built_in\">this</span>.value + v);</span><br><span class=\"line\"> &#125; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.CopyOnWriteArrayList;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *    -   </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/17</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ExerciseSell</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"type\">TicketWindows</span> <span class=\"variable\">ticketWindows</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">TicketWindows</span>(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        List&lt;Integer&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">CopyOnWriteArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        List&lt;Thread&gt; threadList = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">4000</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">                <span class=\"comment\">//</span></span><br><span class=\"line\">                <span class=\"type\">int</span> <span class=\"variable\">sell</span> <span class=\"operator\">=</span> ticketWindows.sell(randomAmount());</span><br><span class=\"line\">                list.add(sell);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            thread.start();</span><br><span class=\"line\">            threadList.add(thread);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        threadList.forEach(thread -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                thread.join();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;&#123;&#125;&quot;</span>, ticketWindows.getCount());</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;&#123;&#125;&quot;</span>, list.stream().mapToInt(Integer::intValue).sum());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Random </span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">Random</span> <span class=\"variable\">random</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//15</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">randomAmount</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> random.nextInt(<span class=\"number\">5</span>) + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/17</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">TicketWindows</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> count;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">TicketWindows</span><span class=\"params\">(<span class=\"type\">int</span> count)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.count = count;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">getCount</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> count;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">sell</span><span class=\"params\">(<span class=\"type\">int</span> amount)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (count &gt;= amount) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">                count -= amount;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> amount;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.wry.concurrent.thread;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *   -   </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/17</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ExceriseTransfer</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">Account</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Account</span>(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        <span class=\"type\">Account</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Account</span>(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">threadA</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++) &#123;</span><br><span class=\"line\">                a.transfer(b, randomAmount());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"type\">Thread</span> <span class=\"variable\">threadB</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++) &#123;</span><br><span class=\"line\">                b.transfer(a, randomAmount());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        threadA.start();</span><br><span class=\"line\">        threadB.start();</span><br><span class=\"line\">        threadA.join();</span><br><span class=\"line\">        threadB.join();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;A &#123;&#125;&quot;</span>, a.getMoney());</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;B &#123;&#125;&quot;</span>, b.getMoney());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Random </span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">Random</span> <span class=\"variable\">random</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//1100</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">randomAmount</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> random.nextInt(<span class=\"number\">100</span>) + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> wangruiyu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020/8/17</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Account</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> money;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">Account</span><span class=\"params\">(<span class=\"type\">int</span> money)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.money = money;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">getMoney</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> money;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setMoney</span><span class=\"params\">(<span class=\"type\">int</span> money)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.money = money;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> account </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> money   </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">transfer</span><span class=\"params\">(Account account, <span class=\"type\">int</span> money)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (Account.class) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"built_in\">this</span>.money &gt;= money) &#123;</span><br><span class=\"line\">                account.setMoney(account.getMoney() + money);</span><br><span class=\"line\">                <span class=\"built_in\">this</span>.setMoney(<span class=\"built_in\">this</span>.getMoney() - money);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"><span class=\"comment\">//    //synchronized  </span></span><br><span class=\"line\"><span class=\"comment\">//    public synchronized  void transfer(Account account, int money) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//          if (this.money &gt;= money) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//              account.setMoney(account.getMoney() + money);</span></span><br><span class=\"line\"><span class=\"comment\">//              this.setMoney(this.getMoney() - money);</span></span><br><span class=\"line\"><span class=\"comment\">//          &#125;</span></span><br><span class=\"line\"><span class=\"comment\">//    &#125;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Monitor\"><a href=\"#Monitor\" class=\"headerlink\" title=\"Monitor\"></a>Monitor</h2><h3 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h3><p> 32 </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------</span>| </span><br><span class=\"line\">|<span class=\"params\"> \t\t\t\t\tObject Header (64 bits)\t\t \t\t       </span>|</span><br><span class=\"line\">|<span class=\"params\">------------------------------------</span>|-------------------------|<span class=\"params\"> </span></span><br><span class=\"line\"><span class=\"params\"></span>|\t\t <span class=\"title class_\">Mark</span> <span class=\"title class_\">Word</span> (<span class=\"number\">32</span> bits) \t     |<span class=\"params\"> Klass Word (32 bits)    </span>|</span><br><span class=\"line\">|<span class=\"params\">------------------------------------</span>|-------------------------|<span class=\"params\"></span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|<span class=\"params\">---------------------------------------------------------------------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\t\t\t\t\t\t\tObject Header (96 bits)\t\t\t \t\t\t\t  </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------</span>|-----------------------|<span class=\"params\">------------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\t\tMark Word(32bits) \t </span>| \t<span class=\"title class_\">Klass</span> <span class=\"title class_\">Word</span>(32bits)   |<span class=\"params\"> array length(32bits)   </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------</span>|-----------------------|<span class=\"params\">------------------------</span>|</span><br></pre></td></tr></table></figure>\n\n<p> Mark Word </p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|<span class=\"params\">-------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t\t\t\t<span class=\"title class_\">Mark</span> <span class=\"title class_\">Word</span> (<span class=\"number\">32</span> bits)\t\t\t\t\t|<span class=\"params\"> \t\tState\t\t </span>|</span><br><span class=\"line\">|<span class=\"params\">-------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t  <span class=\"symbol\">hashcode:</span><span class=\"number\">25</span> |<span class=\"params\"> age:4 </span>| <span class=\"symbol\">biased_lock:</span><span class=\"number\">0</span> \t|<span class=\"params\"> 01\t</span>| \t\t<span class=\"title class_\">Normal</span>\t\t |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|-------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> thread:23 </span>| <span class=\"symbol\">epoch:</span><span class=\"number\">2</span> |<span class=\"params\"> age:4 </span>| <span class=\"symbol\">biased_lock:</span><span class=\"number\">1</span> \t|<span class=\"params\"> 01\t</span>| \t\t<span class=\"title class_\">Biased</span>\t\t |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|-------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\tptr_to_lock_record:30 \t\t\t\t\t</span>| <span class=\"number\">00</span> \t|<span class=\"params\"> Lightweight Locked </span>|</span><br><span class=\"line\">|<span class=\"params\">-------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t<span class=\"symbol\">ptr_to_heavyweight_monitor:</span><span class=\"number\">30</span> \t\t\t|<span class=\"params\"> 10 \t</span>| <span class=\"title class_\">Heavyweight</span> <span class=\"title class_\">Locked</span> |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|-------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\t\t\t\t\t\t\t\t\t\t\t</span>| <span class=\"number\">11</span>\t|<span class=\"params\">\t Marked <span class=\"keyword\">for</span> GC\t </span>|</span><br><span class=\"line\">|<span class=\"params\">-------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br></pre></td></tr></table></figure>\n\n\n\n<p>64  Mark Word</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t\t\t\t\t\t<span class=\"title class_\">Mark</span> <span class=\"title class_\">Word</span> (<span class=\"number\">64</span> bits) \t\t\t\t\t |<span class=\"params\"> \t\t  State  \t  </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|  <span class=\"symbol\">unused:</span><span class=\"number\">25</span> |<span class=\"params\"> hashcode:31 </span>| <span class=\"symbol\">unused:</span><span class=\"number\">1</span> |<span class=\"params\"> age:4 </span>| <span class=\"symbol\">biased_lock:</span><span class=\"number\">0</span> |<span class=\"params\">  01  </span>| \t\t  <span class=\"title class_\">Normal</span>\t  |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\">  thread:54 </span>| <span class=\"symbol\">epoch:</span><span class=\"number\">2</span>     |<span class=\"params\"> unused:1 </span>| <span class=\"symbol\">age:</span><span class=\"number\">4</span> |<span class=\"params\"> biased_lock:1 </span>|  <span class=\"number\">01</span>  |<span class=\"params\"> \t\t  Biased\t  </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t<span class=\"symbol\">ptr_to_lock_record:</span><span class=\"number\">62</span>\t\t\t\t\t\t\t\t  |<span class=\"params\">  00  </span>| <span class=\"title class_\">Lightweight</span> <span class=\"title class_\">Locked</span> |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\tptr_to_heavyweight_monitor:62 \t\t\t\t\t\t  </span>|  <span class=\"number\">10</span>  |<span class=\"params\"> Heavyweight Locked </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  |<span class=\"params\">  11  </span>| \t<span class=\"title class_\">Marked</span> <span class=\"keyword\">for</span> <span class=\"variable constant_\">GC</span>\t  |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<p><a href=\"https://stackoverflflow.com/questions/26357186/what-is-in-java-object-header\">https://stackoverflflow.com/questions/26357186/what-is-in-java-object-header</a></p>\n<h2 id=\"Monitor-\"><a href=\"#Monitor-\" class=\"headerlink\" title=\"Monitor()\"></a>Monitor()</h2><h3 id=\"Monitor\"><a href=\"#Monitor\" class=\"headerlink\" title=\"Monitor\"></a>Monitor</h3><p>Monitor <strong></strong><strong></strong></p>\n<p> Java  Monitor  synchronized Mark Word  Monitor Monitor </p>\n<img src=\"/post/2023/thread/image-20200819064936628.png\" class=\"\" title=\"image-20200819064936628\">\n\n\n\n<ul>\n<li><p> Monitor  Owner  null</p>\n</li>\n<li><p> Thread-2  synchronized(obj)  Monitor  Owner  Thread-2Monitor Owner</p>\n</li>\n<li><p> Thread-2  Thread-3Thread-4Thread-5  synchronized(obj)EntryList BLOCKED</p>\n</li>\n<li><p>Thread-2  EntryList </p>\n</li>\n<li><p> WaitSet  Thread-0Thread-1  WAITING wait-notify </p>\n</li>\n</ul>\n<blockquote>\n<p><strong></strong></p>\n<p>synchronized  monitor </p>\n<p> synchronized </p>\n</blockquote>\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><p><strong></strong></p>\n<p></p>\n<ul>\n<li><p> - JVM</p>\n</li>\n<li><p> - </p>\n</li>\n<li><p> - </p>\n</li>\n<li><p> - </p>\n</li>\n<li><p> -  - Monitor</p>\n</li>\n<li><p> -  - </p>\n</li>\n<li><p> -  - </p>\n</li>\n<li><p> -  20 </p>\n</li>\n<li><p> - </p>\n</li>\n</ul>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p> 20 </p>\n<h3 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Object</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">counter</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span> (lock) &#123;</span><br><span class=\"line\"> \tcounter++;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(java.lang.String[])</span>;</span><br><span class=\"line\"> descriptor: ([Ljava/lang/String;)V</span><br><span class=\"line\"> flags: ACC_PUBLIC, ACC_STATIC</span><br><span class=\"line\"> Code:</span><br><span class=\"line\"> stack=<span class=\"number\">2</span>, locals=<span class=\"number\">3</span>, args_size=<span class=\"number\">1</span></span><br><span class=\"line\"> <span class=\"number\">0</span>: getstatic #<span class=\"number\">2</span> <span class=\"comment\">// &lt;- lock synchronized</span></span><br><span class=\"line\"> <span class=\"number\">3</span>: dup</span><br><span class=\"line\"> <span class=\"number\">4</span>: astore_1 <span class=\"comment\">// lock -&gt; slot 1</span></span><br><span class=\"line\"> <span class=\"number\">5</span>: monitorenter <span class=\"comment\">//  lock MarkWord  Monitor </span></span><br><span class=\"line\"> <span class=\"number\">6</span>: getstatic #<span class=\"number\">3</span> <span class=\"comment\">// &lt;- i</span></span><br><span class=\"line\"> <span class=\"number\">9</span>: iconst_1 <span class=\"comment\">//  1</span></span><br><span class=\"line\"> <span class=\"number\">10</span>: iadd <span class=\"comment\">// +1</span></span><br><span class=\"line\"> <span class=\"number\">11</span>: putstatic #<span class=\"number\">3</span> <span class=\"comment\">// -&gt; i</span></span><br><span class=\"line\"> <span class=\"number\">14</span>: aload_1 <span class=\"comment\">// &lt;- lock</span></span><br><span class=\"line\"> <span class=\"number\">15</span>: monitorexit <span class=\"comment\">//  lock MarkWord ,  EntryList</span></span><br><span class=\"line\"> <span class=\"number\">16</span>: goto <span class=\"number\">24</span></span><br><span class=\"line\"> <span class=\"number\">19</span>: astore_2 <span class=\"comment\">// e -&gt; slot 2 </span></span><br><span class=\"line\"> <span class=\"number\">20</span>: aload_1 <span class=\"comment\">// &lt;- lock</span></span><br><span class=\"line\"> <span class=\"number\">21</span>: monitorexit <span class=\"comment\">//  lock MarkWord ,  EntryList</span></span><br><span class=\"line\"> <span class=\"number\">22</span>: aload_2 <span class=\"comment\">// &lt;- slot 2 (e)</span></span><br><span class=\"line\"> <span class=\"number\">23</span>: athrow <span class=\"comment\">// throw e</span></span><br><span class=\"line\"> <span class=\"number\">24</span>: <span class=\"keyword\">return</span></span><br><span class=\"line\"> Exception table:</span><br><span class=\"line\"> from to target type</span><br><span class=\"line\"> <span class=\"number\">6</span> <span class=\"number\">16</span> <span class=\"number\">19</span> any</span><br><span class=\"line\"> <span class=\"number\">19</span> <span class=\"number\">22</span> <span class=\"number\">19</span> any</span><br><span class=\"line\"> LineNumberTable:</span><br><span class=\"line\"> line <span class=\"number\">8</span>: <span class=\"number\">0</span></span><br><span class=\"line\"> line <span class=\"number\">9</span>: <span class=\"number\">6</span></span><br><span class=\"line\"> line <span class=\"number\">10</span>: <span class=\"number\">14</span></span><br><span class=\"line\"> line <span class=\"number\">11</span>: <span class=\"number\">24</span></span><br><span class=\"line\"> LocalVariableTable:</span><br><span class=\"line\"> Start Length Slot Name Signature</span><br><span class=\"line\"> <span class=\"number\">0</span> <span class=\"number\">25</span> <span class=\"number\">0</span> args [Ljava/lang/String;</span><br><span class=\"line\"> StackMapTable: number_of_entries = <span class=\"number\">2</span></span><br><span class=\"line\"> frame_type = <span class=\"number\">255</span> <span class=\"comment\">/* full_frame */</span></span><br><span class=\"line\"> offset_delta = <span class=\"number\">19</span></span><br><span class=\"line\"> locals = [ class <span class=\"string\">&quot;[Ljava/lang/String;&quot;</span>, <span class=\"keyword\">class</span> <span class=\"title class_\">java</span>/lang/Object ]</span><br><span class=\"line\"> stack = [ <span class=\"keyword\">class</span> <span class=\"title class_\">java</span>/lang/Throwable ]</span><br><span class=\"line\"> frame_type = <span class=\"number\">250</span> <span class=\"comment\">/* chop */</span></span><br><span class=\"line\"> offset_delta = <span class=\"number\">4</span>              </span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p><strong></strong></p>\n<p> synchronized </p>\n</blockquote>\n<h3 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h4><p></p>\n<p> <code>synchronized</code></p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Object</span> <span class=\"variable\">obj</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> <span class=\"comment\">//  A</span></span><br><span class=\"line\"> method2();</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> <span class=\"comment\">//  B</span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Lock RecordMark Word</li>\n</ul>\n<img src=\"/post/2023/thread/image-20200819065515918.png\" class=\"\" title=\"image-20200819065515918\">\n\n<ul>\n<li><p> Object reference  cas  Object  Mark Word Mark Word </p>\n<img src=\"/post/2023/thread/image-20200819065601188.png\" class=\"\" title=\"image-20200819065601188\">\n</li>\n<li><p> cas   00 </p>\n<img src=\"/post/2023/thread/image-20200819065708766.png\" class=\"\" title=\"image-20200819065708766\">\n</li>\n<li><p> cas </p>\n<ul>\n<li> Object </li>\n<li> synchronized  Lock Record </li>\n</ul>\n<img src=\"/post/2023/thread/image-20200819065835524.png\" class=\"\" title=\"image-20200819065835524\">\n</li>\n<li><p> synchronized  null </p>\n<img src=\"/post/2023/thread/image-20200819065931928.png\" class=\"\" title=\"image-20200819065931928\">\n</li>\n<li><p> synchronized  null cas  Mark Word </p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><p>CAS </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"type\">Object</span> <span class=\"variable\">obj</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> <span class=\"comment\">// </span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p> Thread-1 Thread-0 </p>\n<img src=\"/post/2023/thread/image-20200819071006301.png\" class=\"\" title=\"image-20200819071006301\">\n</li>\n<li><p> Thread-1 </p>\n<ul>\n<li> Object  <code>Monitor</code>  Object </li>\n<li> <code>Monitor</code>  <code>EntryList</code> BLOCKED</li>\n</ul>\n</li>\n</ul>\n<img src=\"/post/2023/thread/image-20200819071139042.png\" class=\"\" title=\"image-20200819071139042\">\n\n<ul>\n<li> Thread-0  cas  Mark Word  Monitor  Monitor  Owner  null EntryList  BLOCKED </li>\n</ul>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><p></p>\n<p></p>\n<table>\n<thead>\n<tr>\n<th><strong></strong> <strong>1</strong> <strong>****core 1</strong> <strong></strong></th>\n<th><strong></strong> <strong>Mark</strong></th>\n<th><strong></strong> <strong>2</strong> <strong>****core 2</strong> <strong></strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-</td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td> monitor</td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td> monitor</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>01</td>\n<td></td>\n</tr>\n<tr>\n<td>-</td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td>-</td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td>-</td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>.</td>\n<td>.</td>\n</tr>\n</tbody></table>\n<p></p>\n<table>\n<thead>\n<tr>\n<th><strong></strong> <strong>1</strong> <strong>****core 1</strong> <strong></strong></th>\n<th><strong></strong> <strong>Mark</strong></th>\n<th><strong></strong> <strong>2</strong> <strong>****core 2</strong> <strong></strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-</td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td> monitor</td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td>-</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td> monitor</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<ul>\n<li><p> CPU  CPU  CPU </p>\n</li>\n<li><p> Java 6 <strong></strong></p>\n</li>\n<li><p>Java 7 </p>\n</li>\n</ul>\n<h4 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h4><p> CAS </p>\n<p>Java 6  CAS  ID  Mark Word  ID  CAS</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Object</span> <span class=\"variable\">obj</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> \t<span class=\"comment\">//  A</span></span><br><span class=\"line\"> \tm2();</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> \t<span class=\"comment\">//  B</span></span><br><span class=\"line\"> \tm3();</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m3</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">synchronized</span>( obj ) &#123;</span><br><span class=\"line\"> \t<span class=\"comment\">//  C</span></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<img src=\"/post/2023/thread/image-20200819072452480.png\" class=\"\" title=\"image-20200819072452480\">\n\n<img src=\"/post/2023/thread/image-20200819072504262.png\" class=\"\" title=\"image-20200819072504262\">\n\n<p><strong></strong></p>\n<p></p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t\t\t\t\t\t<span class=\"title class_\">Mark</span> <span class=\"title class_\">Word</span> (<span class=\"number\">64</span> bits) \t\t\t\t\t |<span class=\"params\"> \t\t  State  \t  </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|  <span class=\"symbol\">unused:</span><span class=\"number\">25</span> |<span class=\"params\"> hashcode:31 </span>| <span class=\"symbol\">unused:</span><span class=\"number\">1</span> |<span class=\"params\"> age:4 </span>| <span class=\"symbol\">biased_lock:</span><span class=\"number\">0</span> |<span class=\"params\">  01  </span>| \t\t  <span class=\"title class_\">Normal</span>\t  |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\">  thread:54 </span>| <span class=\"symbol\">epoch:</span><span class=\"number\">2</span>     |<span class=\"params\"> unused:1 </span>| <span class=\"symbol\">age:</span><span class=\"number\">4</span> |<span class=\"params\"> biased_lock:1 </span>|  <span class=\"number\">01</span>  |<span class=\"params\"> \t\t  Biased\t  </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t<span class=\"symbol\">ptr_to_lock_record:</span><span class=\"number\">62</span>\t\t\t\t\t\t\t\t  |<span class=\"params\">  00  </span>| <span class=\"title class_\">Lightweight</span> <span class=\"title class_\">Locked</span> |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br><span class=\"line\">|<span class=\"params\"> \t\tptr_to_heavyweight_monitor:62 \t\t\t\t\t\t  </span>|  <span class=\"number\">10</span>  |<span class=\"params\"> Heavyweight Locked </span>|</span><br><span class=\"line\">|<span class=\"params\">--------------------------------------------------------------------</span>|--------------------|<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>| \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  |<span class=\"params\">  11  </span>| \t<span class=\"title class_\">Marked</span> <span class=\"keyword\">for</span> <span class=\"variable constant_\">GC</span>\t  |<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\"></span>|--------------------------------------------------------------------|<span class=\"params\">--------------------</span>|</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ul>\n<li><p>markword  0x05  3  101threadepochage  0</p>\n</li>\n<li><p> VM </p>\n<p> <code>-XX:BiasedLockingStartupDelay=0</code> </p>\n</li>\n<li><p>markword  0x01  3  001 hashcodeage  0 hashcode </p>\n</li>\n</ul>\n<p>1 </p>\n<p>2 </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Dog</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> jol  jol </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  -XX:BiasedLockingStartupDelay=0 </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\"> \t<span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Dog</span>();</span><br><span class=\"line\"> \t<span class=\"type\">ClassLayout</span> <span class=\"variable\">classLayout</span> <span class=\"operator\">=</span> ClassLayout.parseInstance(d);</span><br><span class=\"line\"> \t<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\tlog.debug(<span class=\"string\">&quot;synchronized &quot;</span>);</span><br><span class=\"line\"> \t\tSystem.out.println(classLayout.toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\tlog.debug(<span class=\"string\">&quot;synchronized &quot;</span>);</span><br><span class=\"line\"> \t\t\tSystem.out.println(classLayout.toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\tlog.debug(<span class=\"string\">&quot;synchronized &quot;</span>);</span><br><span class=\"line\"> \t\tSystem.out.println(classLayout.toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">11:08:58.117 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000101 </span><br><span class=\"line\">11:08:58.121 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00011111 11101011 11010000 00000101 </span><br><span class=\"line\">11:08:58.121 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00011111 11101011 11010000 00000101</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><strong></strong></p>\n<p> id </p>\n</blockquote>\n<p>3</p>\n<p> VM  <code>-XX:-UseBiasedLocking</code> </p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">11:13:10.018 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">11:13:10.021 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00100000 00010100 11110011 10001000 </span><br><span class=\"line\">11:13:10.021 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li> hashCode</li>\n</ol>\n<p> hashCode </p>\n<h4 id=\"-hashCode\"><a href=\"#-hashCode\" class=\"headerlink\" title=\" - hashCode\"></a> <strong>-</strong> hashCode</h4><p> hashCode MarkWord  id hashCode </p>\n<ul>\n<li><p> hashCode</p>\n</li>\n<li><p> Monitor  hashCode</p>\n</li>\n</ul>\n<p> hashCode  <code>-XX:-UseBiasedLocking</code></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">11:22:10.386 c.TestBiased [main] -  hashCode:1778535015 </span><br><span class=\"line\">11:22:10.391 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 01101010 00000010 01001010 01100111 00000001 </span><br><span class=\"line\">11:22:10.393 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 00000000 00100000 11000011 11110011 01101000 </span><br><span class=\"line\">11:22:10.393 c.TestBiased [t1] - synchronized </span><br><span class=\"line\">00000000 00000000 00000000 01101010 00000010 01001010 01100111 00000001</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" - \"></a> <strong>-</strong> </h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test2</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\"> \t<span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Dog</span>();</span><br><span class=\"line\"> \t<span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">\t\t <span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (TestBiased.class) &#123;</span><br><span class=\"line\"> \t\t\tTestBiased.class.notify();</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\t<span class=\"comment\">//  wait/notify  join </span></span><br><span class=\"line\"> \t\t<span class=\"comment\">// t1  jvm  t2  id </span></span><br><span class=\"line\">         <span class=\"comment\">/*try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">         System.in.read();</span></span><br><span class=\"line\"><span class=\"comment\">         &#125; catch (IOException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">         e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">         &#125;*/</span></span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"> \tt1.start();</span><br><span class=\"line\">    </span><br><span class=\"line\"> \t<span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (TestBiased.class) &#123;</span><br><span class=\"line\"> \t\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\"> \t\t\t\tTestBiased.class.wait();</span><br><span class=\"line\"> \t\t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\"> \t\t\t\te.printStackTrace();</span><br><span class=\"line\"> \t\t\t&#125;</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\"> \tt2.start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[t1] - 00000000 00000000 00000000 00000000 00011111 01000001 00010000 00000101 </span><br><span class=\"line\"></span><br><span class=\"line\">[t2] - 00000000 00000000 00000000 00000000 00011111 01000001 00010000 00000101 </span><br><span class=\"line\"></span><br><span class=\"line\">[t2] - 00000000 00000000 00000000 00000000 00011111 10110101 11110000 01000000 </span><br><span class=\"line\"></span><br><span class=\"line\">[t2] - 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br></pre></td></tr></table></figure>\n\n<h4 id=\"--wait-notify\"><a href=\"#--wait-notify\" class=\"headerlink\" title=\" -  wait&#x2F;notify\"></a> -  wait&#x2F;notify</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\"> \t<span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Dog</span>();</span><br><span class=\"line\"> \t<span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\"> \t\t\t\td.wait();</span><br><span class=\"line\"> \t\t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\"> \t\t\t\te.printStackTrace();</span><br><span class=\"line\"> \t\t\t&#125;</span><br><span class=\"line\"> \t\t\tlog.debug(ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"> \tt1.start();</span><br><span class=\"line\">    </span><br><span class=\"line\"> \t<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\"> \t\t\tThread.sleep(<span class=\"number\">6000</span>);</span><br><span class=\"line\"> \t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\"> \t\t\te.printStackTrace();</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\tlog.debug(<span class=\"string\">&quot;notify&quot;</span>);</span><br><span class=\"line\"> \t\t\td.notify();</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t2&quot;</span>).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[t1] - 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000101 </span><br><span class=\"line\">[t1] - 00000000 00000000 00000000 00000000 00011111 10110011 11111000 00000101 </span><br><span class=\"line\">[t2] - notify </span><br><span class=\"line\">[t1] - 00000000 00000000 00000000 00000000 00011100 11010100 00001101 11001010</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> T1  T2 Thread ID</p>\n<p> 20 jvm </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test3</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\"> \tVector&lt;Dog&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">Vector</span>&lt;&gt;();</span><br><span class=\"line\"> \t<span class=\"type\">Thread</span> <span class=\"variable\">t1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">30</span>; i++) &#123;</span><br><span class=\"line\"> \t\t\t<span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Dog</span>();</span><br><span class=\"line\"> \t\t\tlist.add(d);</span><br><span class=\"line\"> \t\t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\t\tlog.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t\t&#125;</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (list) &#123;</span><br><span class=\"line\"> \t\t\tlist.notify();</span><br><span class=\"line\"> \t\t&#125; </span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\"> \tt1.start();</span><br><span class=\"line\"> </span><br><span class=\"line\"> \t<span class=\"type\">Thread</span> <span class=\"variable\">t2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\"> \t\t<span class=\"keyword\">synchronized</span> (list) &#123;</span><br><span class=\"line\"> \t\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t\t\tlist.wait();</span><br><span class=\"line\"> \t\t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">\t\t\t\te.printStackTrace();</span><br><span class=\"line\"> \t\t\t&#125;</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t\tlog.debug(<span class=\"string\">&quot;===============&gt; &quot;</span>);</span><br><span class=\"line\"> \t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">30</span>; i++) &#123;</span><br><span class=\"line\"> \t\t\t<span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> list.get(i);</span><br><span class=\"line\"> \t\t\tlog.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t\t<span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\"> \t\t\t\tlog.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t\t&#125;</span><br><span class=\"line\"> \t\t\tlog.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\"> \t\t&#125;</span><br><span class=\"line\"> \t&#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\"> \tt2.start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[t1] - 0 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 1 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 2 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 3 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 4 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 5 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 6 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 7 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 8 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 9 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 10 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 11 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 12 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 13 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 14 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 15 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 16 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 17 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 18 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t1] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - ===============&gt; </span><br><span class=\"line\">[t2] - 0 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 0 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 1 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 1 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 1 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 2 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 2 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 2 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 3 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 3 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 3 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 4 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 4 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 4 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 5 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 5 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 5 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 6 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 6 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 6 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 7 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 7 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 7 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 8 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 8 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 8 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 9 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 9 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 9 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 10 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 10 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 10 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 11 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 11 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 11 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 12 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 12 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 12 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 13 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 13 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 13 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 14 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 14 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 14 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 15 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 15 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 15 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 16 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 16 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 16 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 17 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 17 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 17 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 18 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 18 00000000 00000000 00000000 00000000 00100000 01011000 11110111 00000000 </span><br><span class=\"line\">[t2] - 18 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000001 </span><br><span class=\"line\">[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 19 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 20 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 21 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 22 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 23 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 24 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 25 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 26 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 27 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 28 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11100000 00000101 </span><br><span class=\"line\">[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101 </span><br><span class=\"line\">[t2] - 29 00000000 00000000 00000000 00000000 00011111 11110011 11110001 00000101</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> 40 jvm </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> Thread t1, t2, t3;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test4</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    Vector&lt;Dog&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">Vector</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">loopNumber</span> <span class=\"operator\">=</span> <span class=\"number\">39</span>;</span><br><span class=\"line\">    t1 = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Dog</span>();</span><br><span class=\"line\">            list.add(d);</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\">                log.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        LockSupport.unpark(t2);</span><br><span class=\"line\">    &#125;, <span class=\"string\">&quot;t1&quot;</span>);</span><br><span class=\"line\">    t1.start();</span><br><span class=\"line\">    t2 = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        LockSupport.park();</span><br><span class=\"line\">        log.debug(<span class=\"string\">&quot;===============&gt; &quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; loopNumber; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">Dog</span> <span class=\"variable\">d</span> <span class=\"operator\">=</span> list.get(i);</span><br><span class=\"line\">            log.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (d) &#123;</span><br><span class=\"line\">                log.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            log.debug(i + <span class=\"string\">&quot;\\t&quot;</span> + ClassLayout.parseInstance(d).toPrintableSimple(<span class=\"literal\">true</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        LockSupport.unpark(t3);</span><br><span class=\"line\">    &#125;, <span class=\"string\">&quot;t2&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><strong></strong></p>\n<p><a href=\"https://github.com/farmerjohngit/myblog/issues/12\">https://github.com/farmerjohngit/myblog/issues/12</a></p>\n<p><a href=\"https://www.cnblogs.com/LemonFive/p/11246086.html\">https://www.cnblogs.com/LemonFive/p/11246086.html</a></p>\n<p><a href=\"https://www.cnblogs.com/LemonFive/p/11248248.html\">https://www.cnblogs.com/LemonFive/p/11248248.html</a></p>\n<p></p>\n</blockquote>\n<h4 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h4><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Fork(1)</span></span><br><span class=\"line\"><span class=\"meta\">@BenchmarkMode(Mode.AverageTime)</span></span><br><span class=\"line\"><span class=\"meta\">@Warmup(iterations=3)</span></span><br><span class=\"line\"><span class=\"meta\">@Measurement(iterations=5)</span></span><br><span class=\"line\"><span class=\"meta\">@OutputTimeUnit(TimeUnit.NANOSECONDS)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyBenchmark</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">x</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"meta\">@Benchmark</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">a</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        x++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Benchmark</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">b</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">o</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (o) &#123;</span><br><span class=\"line\">            x++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>java -jar benchmarks.jar</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Benchmark\t\t\tMode\t Samples \tScore\t Score error \tUnits </span><br><span class=\"line\">c.i.MyBenchmark.a \tavgt \t\t5 \t\t1.542 \t\t0.056 \t\tns/op </span><br><span class=\"line\">c.i.MyBenchmark.b \tavgt \t\t5 \t\t1.518 \t\t0.091 \t\tns/op</span><br></pre></td></tr></table></figure>\n\n<p><code>java -XX:-EliminateLocks -jar benchmarks.jar</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Benchmark \t\t\tMode \tSamples \tScore \tScore error \tUnits </span><br><span class=\"line\">c.i.MyBenchmark.a \tavgt \t\t5 \t\t1.507 \t\t0.108 \t\tns/op </span><br><span class=\"line\">c.i.MyBenchmark.b \tavgt \t\t5 \t\t16.976 \t\t1.572 \t\tns/op</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<p></p>\n"}],"PostAsset":[{"_id":"source/_posts/2023/Hadoop/image-20200820213620752.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200820213620752.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200820224123902.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200820224123902.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822090658863.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822090658863.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822090905199.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822090905199.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822091216510.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822091216510.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822091335115.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822091335115.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822091809558.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822091809558.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822092048172.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822092048172.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822093255847.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822093255847.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822094801817.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822094801817.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822100056038.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822100056038.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822102024933.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822102024933.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822102108817.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822102108817.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822111645219.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822111645219.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822140728454.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822140728454.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822140954237.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822140954237.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822141013068.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822141013068.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200822141028970.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200822141028970.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200823180537869.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200823180537869.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200827081213048.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200827081213048.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200827081247672.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200827081247672.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200829223326519.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200829223326519.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/Hadoop/image-20200830083752748.png","post":"clzxjaiup0001vaib053qfkvr","slug":"image-20200830083752748.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/docker/img.png","post":"clzxjaiuz0009vaib59789ptl","slug":"img.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_10.png","post":"clzxjaiv2000evaib1jzn7wmb","slug":"img_10.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_11.png","post":"clzxjaiv2000evaib1jzn7wmb","slug":"img_11.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_12.png","post":"clzxjaiv2000evaib1jzn7wmb","slug":"img_12.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_5.png","post":"clzxjaiv2000evaib1jzn7wmb","slug":"img_5.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_6.png","post":"clzxjaiv2000evaib1jzn7wmb","slug":"img_6.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_7.png","post":"clzxjaiv2000evaib1jzn7wmb","slug":"img_7.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_8.png","post":"clzxjaiv2000evaib1jzn7wmb","slug":"img_8.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab-ci-springboot/img_9.png","post":"clzxjaiv2000evaib1jzn7wmb","slug":"img_9.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/https/https.png","post":"clzxjaiv3000fvaib6tmwdoli","slug":"https.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab/img_0.png","post":"clzxjaiv4000jvaibgufq8njy","slug":"img_0.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab/img_1.png","post":"clzxjaiv4000jvaibgufq8njy","slug":"img_1.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab/img_2.png","post":"clzxjaiv4000jvaibgufq8njy","slug":"img_2.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab/img_3.png","post":"clzxjaiv4000jvaibgufq8njy","slug":"img_3.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/gitlab/img_4.png","post":"clzxjaiv4000jvaibgufq8njy","slug":"img_4.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/0c1c2fd0-acb6-4197-801f-a9ff12f5ced4.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"0c1c2fd0-acb6-4197-801f-a9ff12f5ced4.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/3bfa032a-2a4e-4f01-b03d-90c4c39df0aa.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"3bfa032a-2a4e-4f01-b03d-90c4c39df0aa.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/3cd7e3a5-2b1d-4eb6-83c9-fedc27a2bfc1.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"3cd7e3a5-2b1d-4eb6-83c9-fedc27a2bfc1.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/3d67796c-0dc7-4f12-9af0-39b20fab7cbf.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"3d67796c-0dc7-4f12-9af0-39b20fab7cbf.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/3e60331e-2742-4047-8383-e107945f85c4.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"3e60331e-2742-4047-8383-e107945f85c4.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/4f6873cb-c0f9-4955-8600-bf37e24f4fbf.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"4f6873cb-c0f9-4955-8600-bf37e24f4fbf.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/5066a220-0f28-4b94-8934-f54c722697a9.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"5066a220-0f28-4b94-8934-f54c722697a9.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/5f12c1e3-2e47-4997-a887-b395b511490b.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"5f12c1e3-2e47-4997-a887-b395b511490b.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/5fb46273-081b-4271-b94c-e2ba6eea5f69.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"5fb46273-081b-4271-b94c-e2ba6eea5f69.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/626353d2-1f73-46e9-858d-732ed7bee94a.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"626353d2-1f73-46e9-858d-732ed7bee94a.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/6bcb9fd5-1105-4a75-b6c5-55dc08af5c50.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"6bcb9fd5-1105-4a75-b6c5-55dc08af5c50.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/745b992d-fcff-46df-8a33-150b65bf47ca.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"745b992d-fcff-46df-8a33-150b65bf47ca.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/787d871b-0d4c-403a-ae3f-cbc6ea587dc1.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"787d871b-0d4c-403a-ae3f-cbc6ea587dc1.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/8b2d9ee5-a0da-460c-9296-71cd9bae71cb.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"8b2d9ee5-a0da-460c-9296-71cd9bae71cb.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/90434413-5431-408e-878f-3b76d5118d64.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"90434413-5431-408e-878f-3b76d5118d64.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/9111c342-79fb-4def-aef6-d266daea6078.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"9111c342-79fb-4def-aef6-d266daea6078.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/95c89389-d9e7-42e1-9d80-4886d458a48b.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"95c89389-d9e7-42e1-9d80-4886d458a48b.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/a670f078-2260-4276-8db9-79112eb9e979.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"a670f078-2260-4276-8db9-79112eb9e979.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/bece6bf1-f9a8-475d-9911-6293e225d84e.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"bece6bf1-f9a8-475d-9911-6293e225d84e.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/bedb0d3f-90d8-4867-84c2-cea52a58412f.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"bedb0d3f-90d8-4867-84c2-cea52a58412f.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/befee5fe-233e-4ca1-8a63-1b8908311845.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"befee5fe-233e-4ca1-8a63-1b8908311845.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/d215e636-ea46-4b84-a861-4aff3dbdbf0e.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"d215e636-ea46-4b84-a861-4aff3dbdbf0e.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/d404438c-1def-4366-90a5-3f304dd1ddf2.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"d404438c-1def-4366-90a5-3f304dd1ddf2.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/d5649d47-ed1b-4797-8a8f-73634873cd9d.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"d5649d47-ed1b-4797-8a8f-73634873cd9d.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/d9b58c91-421c-4afe-b359-2cde68c12eca.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"d9b58c91-421c-4afe-b359-2cde68c12eca.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/db1f5266-c920-4379-a82d-f0dadbe1a1c3.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"db1f5266-c920-4379-a82d-f0dadbe1a1c3.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/ecac62a6-7c65-4df3-ba5e-19c0630fb78f.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"ecac62a6-7c65-4df3-ba5e-19c0630fb78f.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/jvm/f0d5cf63-e51f-4309-b8ff-448f90ca78fb.png","post":"clzxjaiv5000kvaib951o7vdr","slug":"f0d5cf63-e51f-4309-b8ff-448f90ca78fb.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/kotlin-springboot/kotlin.png","post":"clzxjaiv7000ovaibhi7c7wk3","slug":"kotlin.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/localdate-springboot/kotlin.jpg","post":"clzxjaiv9000qvaib7dpxeqgc","slug":"kotlin.jpg","modified":1,"renderable":0},{"_id":"source/_posts/2024/jsch/jsch/ssh.jpg","post":"clzxjaivg001gvaibgxk4hryj","slug":"ssh.jpg","modified":1,"renderable":0},{"_id":"source/_posts/2024/jsch/jsch/ssh.webp","post":"clzxjaivg001gvaibgxk4hryj","slug":"ssh.webp","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread-pool/e0733727-92bd-4438-a628-3b3989d8e838.png","post":"clzxjaivh001hvaibc20b68lj","slug":"e0733727-92bd-4438-a628-3b3989d8e838.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/0827c261-3195-4bdc-9b78-e0c664037749.png","post":"clzxjaivi001jvaib0numhc3m","slug":"0827c261-3195-4bdc-9b78-e0c664037749.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/0e59c147-a499-4226-bf3b-d6f0a4cabd5a.png","post":"clzxjaivi001jvaib0numhc3m","slug":"0e59c147-a499-4226-bf3b-d6f0a4cabd5a.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/210feb5c-150a-43c3-8b3d-440f53e343d1.png","post":"clzxjaivi001jvaib0numhc3m","slug":"210feb5c-150a-43c3-8b3d-440f53e343d1.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/2ed065be-3fb7-4e67-b04e-b8e08980405d.png","post":"clzxjaivi001jvaib0numhc3m","slug":"2ed065be-3fb7-4e67-b04e-b8e08980405d.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/2feee3db-6b39-4e1a-9098-1a5f966742f7.png","post":"clzxjaivi001jvaib0numhc3m","slug":"2feee3db-6b39-4e1a-9098-1a5f966742f7.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/3a071edf-6ded-487b-abbb-d016a9fe6864.png","post":"clzxjaivi001jvaib0numhc3m","slug":"3a071edf-6ded-487b-abbb-d016a9fe6864.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/3ce55a24-aeb0-4055-9925-c69a63ec9053.png","post":"clzxjaivi001jvaib0numhc3m","slug":"3ce55a24-aeb0-4055-9925-c69a63ec9053.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/44fc6f61-2e64-414e-be76-0486d270b52b.png","post":"clzxjaivi001jvaib0numhc3m","slug":"44fc6f61-2e64-414e-be76-0486d270b52b.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/453affe8-17db-40b3-940f-162e7597336e.png","post":"clzxjaivi001jvaib0numhc3m","slug":"453affe8-17db-40b3-940f-162e7597336e.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/4b22adcb-879c-493e-a6dc-7a50426a6db7.png","post":"clzxjaivi001jvaib0numhc3m","slug":"4b22adcb-879c-493e-a6dc-7a50426a6db7.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/4f22eeff-a017-46f6-bf49-5359e570fe22.png","post":"clzxjaivi001jvaib0numhc3m","slug":"4f22eeff-a017-46f6-bf49-5359e570fe22.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/51e456b2-69ca-4039-8ec3-137a74a3e57d.png","post":"clzxjaivi001jvaib0numhc3m","slug":"51e456b2-69ca-4039-8ec3-137a74a3e57d.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/52ebada9-ad0c-45fc-9482-40b961c20bbf.png","post":"clzxjaivi001jvaib0numhc3m","slug":"52ebada9-ad0c-45fc-9482-40b961c20bbf.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/5cce206b-f24c-4489-afda-57b5a3102172.png","post":"clzxjaivi001jvaib0numhc3m","slug":"5cce206b-f24c-4489-afda-57b5a3102172.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/683dd209-d862-46f9-878f-b9e8f4c2db3b.png","post":"clzxjaivi001jvaib0numhc3m","slug":"683dd209-d862-46f9-878f-b9e8f4c2db3b.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/6d0f8427-4068-4a15-a933-cd3f74e28dbf.png","post":"clzxjaivi001jvaib0numhc3m","slug":"6d0f8427-4068-4a15-a933-cd3f74e28dbf.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/70691192-ef7e-43b6-b365-d139f036e188.png","post":"clzxjaivi001jvaib0numhc3m","slug":"70691192-ef7e-43b6-b365-d139f036e188.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/75442144-d101-4e7a-97ca-c833a2b827fe.png","post":"clzxjaivi001jvaib0numhc3m","slug":"75442144-d101-4e7a-97ca-c833a2b827fe.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/7bf73e18-7259-45da-93c5-a4183062572e.png","post":"clzxjaivi001jvaib0numhc3m","slug":"7bf73e18-7259-45da-93c5-a4183062572e.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/7d8e2e3b-8f62-4e97-86d1-d8ab88b83ca1.png","post":"clzxjaivi001jvaib0numhc3m","slug":"7d8e2e3b-8f62-4e97-86d1-d8ab88b83ca1.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/815e324a-777f-4b34-b590-acbb4c624cb0.png","post":"clzxjaivi001jvaib0numhc3m","slug":"815e324a-777f-4b34-b590-acbb4c624cb0.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/81a4db1a-c8d1-47f7-a955-39db726f5173.png","post":"clzxjaivi001jvaib0numhc3m","slug":"81a4db1a-c8d1-47f7-a955-39db726f5173.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/86d6badd-f76b-4152-8044-bef85f333017.png","post":"clzxjaivi001jvaib0numhc3m","slug":"86d6badd-f76b-4152-8044-bef85f333017.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/9372a527-1cf5-4699-9271-f9724c815f24.png","post":"clzxjaivi001jvaib0numhc3m","slug":"9372a527-1cf5-4699-9271-f9724c815f24.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/a6cd39b0-e6e9-4b6f-88ea-3cfb0d899b83.png","post":"clzxjaivi001jvaib0numhc3m","slug":"a6cd39b0-e6e9-4b6f-88ea-3cfb0d899b83.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/b94de8b0-5933-49dc-b0ff-a29a03280074.png","post":"clzxjaivi001jvaib0numhc3m","slug":"b94de8b0-5933-49dc-b0ff-a29a03280074.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/bc0f03b1-c84a-45af-879e-4bdc0f0ff35e.png","post":"clzxjaivi001jvaib0numhc3m","slug":"bc0f03b1-c84a-45af-879e-4bdc0f0ff35e.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/c2203c1e-3091-4832-8061-8ba8bc3b24d1.png","post":"clzxjaivi001jvaib0numhc3m","slug":"c2203c1e-3091-4832-8061-8ba8bc3b24d1.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/ca324ec8-b1a0-419a-a962-640dae424e10.png","post":"clzxjaivi001jvaib0numhc3m","slug":"ca324ec8-b1a0-419a-a962-640dae424e10.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/cb65fed7-57dd-404b-b4f1-e365dbe83379.png","post":"clzxjaivi001jvaib0numhc3m","slug":"cb65fed7-57dd-404b-b4f1-e365dbe83379.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/d05f71ef-bbbb-4b19-a804-6444a74de835.png","post":"clzxjaivi001jvaib0numhc3m","slug":"d05f71ef-bbbb-4b19-a804-6444a74de835.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/d1df5ae9-03d4-4960-a460-86c4eb4f13d9.png","post":"clzxjaivi001jvaib0numhc3m","slug":"d1df5ae9-03d4-4960-a460-86c4eb4f13d9.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/d1f13ce8-f7cb-4cf1-b2aa-6e8d7204a459.png","post":"clzxjaivi001jvaib0numhc3m","slug":"d1f13ce8-f7cb-4cf1-b2aa-6e8d7204a459.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/d37e0c1b-1e69-4360-937a-edf5296f47ce.png","post":"clzxjaivi001jvaib0numhc3m","slug":"d37e0c1b-1e69-4360-937a-edf5296f47ce.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/d3f13fb8-e2e2-4692-8b27-2ca13a87ec1a.png","post":"clzxjaivi001jvaib0numhc3m","slug":"d3f13fb8-e2e2-4692-8b27-2ca13a87ec1a.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/d9550ede-fad3-4675-8791-3a1237fab0de.png","post":"clzxjaivi001jvaib0numhc3m","slug":"d9550ede-fad3-4675-8791-3a1237fab0de.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/e1c2fc78-6f75-4049-8631-1e2bf400e92b.png","post":"clzxjaivi001jvaib0numhc3m","slug":"e1c2fc78-6f75-4049-8631-1e2bf400e92b.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/e5b813b7-361c-42ec-9326-53b01a2872da.png","post":"clzxjaivi001jvaib0numhc3m","slug":"e5b813b7-361c-42ec-9326-53b01a2872da.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/ea4c56c3-75b1-48fa-a40e-dcb6dd63823f.png","post":"clzxjaivi001jvaib0numhc3m","slug":"ea4c56c3-75b1-48fa-a40e-dcb6dd63823f.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/f5e5190c-2ca0-4467-8618-c9084b18b26f.png","post":"clzxjaivi001jvaib0numhc3m","slug":"f5e5190c-2ca0-4467-8618-c9084b18b26f.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/f78c9ec4-6379-48de-b2e6-f529bb063540.png","post":"clzxjaivi001jvaib0numhc3m","slug":"f78c9ec4-6379-48de-b2e6-f529bb063540.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/feed6992-8dff-450c-9010-e2f46caf6243.png","post":"clzxjaivi001jvaib0numhc3m","slug":"feed6992-8dff-450c-9010-e2f46caf6243.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806070304756.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806070304756.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806070323056.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806070323056.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806072602725.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806072602725.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806080136510.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806080136510.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806080218070.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806080218070.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806080338819.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806080338819.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806080425078.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806080425078.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806081215362.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806081215362.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806081309415.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806081309415.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806081339039.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806081339039.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806081409317.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806081409317.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806093605366.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806093605366.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806093649652.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806093649652.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806112353892.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806112353892.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806113017975.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806113017975.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806113212737.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806113212737.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806113622053.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806113622053.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200806115634318.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200806115634318.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200818213438504.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200818213438504.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819064936628.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819064936628.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819065515918.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819065515918.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819065601188.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819065601188.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819065708766.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819065708766.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819065820151.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819065820151.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819065835524.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819065835524.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819065931928.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819065931928.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819071006301.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819071006301.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819071139042.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819071139042.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819072452480.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819072452480.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200819072504262.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200819072504262.png","modified":1,"renderable":0},{"_id":"source/_posts/2023/thread/image-20200822234416578.png","post":"clzxjaivi001jvaib0numhc3m","slug":"image-20200822234416578.png","modified":1,"renderable":0}],"PostCategory":[{"post_id":"clzxjaiup0001vaib053qfkvr","category_id":"clzxjaiuv0004vaiba5fx83ik","_id":"clzxjaiv3000gvaibchqz06ea"},{"post_id":"clzxjaiv4000jvaibgufq8njy","category_id":"clzxjaiv3000hvaiber0g1zfc","_id":"clzxjaiv9000rvaibgc4tbt3j"},{"post_id":"clzxjaiuz0009vaib59789ptl","category_id":"clzxjaiv3000hvaiber0g1zfc","_id":"clzxjaiva000vvaib6ej308z9"},{"post_id":"clzxjaiv5000kvaib951o7vdr","category_id":"clzxjaiv1000bvaibahp9hizc","_id":"clzxjaivb000wvaib4b7kcwx5"},{"post_id":"clzxjaiv0000avaib3j383d7m","category_id":"clzxjaiv3000hvaiber0g1zfc","_id":"clzxjaivb000zvaib1q3db00d"},{"post_id":"clzxjaiv2000evaib1jzn7wmb","category_id":"clzxjaiv3000hvaiber0g1zfc","_id":"clzxjaivc0012vaib8kk62gdw"},{"post_id":"clzxjaiut0003vaibhf84gyom","category_id":"clzxjaiv1000bvaibahp9hizc","_id":"clzxjaivc0017vaib5tzl474x"},{"post_id":"clzxjaiut0003vaibhf84gyom","category_id":"clzxjaivb000xvaib2xjh13b3","_id":"clzxjaivd001avaib8cpjbliy"},{"post_id":"clzxjaiv7000ovaibhi7c7wk3","category_id":"clzxjaivc0014vaib8e5adj6d","_id":"clzxjaivd001cvaib9o6d9zwg"},{"post_id":"clzxjaiv9000qvaib7dpxeqgc","category_id":"clzxjaivc0014vaib8e5adj6d","_id":"clzxjaive001evaib1k5r7kii"},{"post_id":"clzxjaivg001gvaibgxk4hryj","category_id":"clzxjaiv1000bvaibahp9hizc","_id":"clzxjaivi001kvaib1pca0fk2"},{"post_id":"clzxjaivh001hvaibc20b68lj","category_id":"clzxjaiv1000bvaibahp9hizc","_id":"clzxjaivi001lvaibd3ml85yq"},{"post_id":"clzxjaivi001jvaib0numhc3m","category_id":"clzxjaiv1000bvaibahp9hizc","_id":"clzxjaivj001nvaib636h397e"}],"PostTag":[{"post_id":"clzxjaiup0001vaib053qfkvr","tag_id":"clzxjaiux0005vaib2qref74z","_id":"clzxjaiv2000dvaib5owd3vk7"},{"post_id":"clzxjaiv4000jvaibgufq8njy","tag_id":"clzxjaiv4000ivaib6qdu4ebq","_id":"clzxjaiv6000nvaib3zaa43sg"},{"post_id":"clzxjaiut0003vaibhf84gyom","tag_id":"clzxjaiv1000cvaib2obug1ey","_id":"clzxjaiv9000pvaibh8i8d5o5"},{"post_id":"clzxjaiut0003vaibhf84gyom","tag_id":"clzxjaiv4000ivaib6qdu4ebq","_id":"clzxjaiva000uvaibc4xia9cp"},{"post_id":"clzxjaiuy0007vaibdvf40roq","tag_id":"clzxjaiv1000cvaib2obug1ey","_id":"clzxjaivb0010vaib1qfgfz2o"},{"post_id":"clzxjaiuy0007vaibdvf40roq","tag_id":"clzxjaiv4000ivaib6qdu4ebq","_id":"clzxjaivc0011vaib2kiafn6p"},{"post_id":"clzxjaiuz0009vaib59789ptl","tag_id":"clzxjaiv4000ivaib6qdu4ebq","_id":"clzxjaivc0015vaib0k5v4nkz"},{"post_id":"clzxjaiv0000avaib3j383d7m","tag_id":"clzxjaiv4000ivaib6qdu4ebq","_id":"clzxjaivd0019vaib3qhebzw1"},{"post_id":"clzxjaiv2000evaib1jzn7wmb","tag_id":"clzxjaiv4000ivaib6qdu4ebq","_id":"clzxjaivd001dvaib0w4t9mfp"},{"post_id":"clzxjaiv5000kvaib951o7vdr","tag_id":"clzxjaivd001bvaib2vqdgrs9","_id":"clzxjaive001fvaib8dnt1jd0"},{"post_id":"clzxjaivg001gvaibgxk4hryj","tag_id":"clzxjaivh001ivaib78do8b5b","_id":"clzxjaivj001pvaib0nwg5oz2"},{"post_id":"clzxjaivg001gvaibgxk4hryj","tag_id":"clzxjaivi001mvaib2v7cfcrw","_id":"clzxjaivj001qvaibbvjj0kya"},{"post_id":"clzxjaivh001hvaibc20b68lj","tag_id":"clzxjaivj001ovaibh5vng8m7","_id":"clzxjaivj001svaib3skp2ofl"},{"post_id":"clzxjaivi001jvaib0numhc3m","tag_id":"clzxjaivj001ovaibh5vng8m7","_id":"clzxjaivj001tvaib7ahr30yl"}],"Tag":[{"name":"Hadoop","_id":"clzxjaiux0005vaib2qref74z"},{"name":"springboot","_id":"clzxjaiv1000cvaib2obug1ey"},{"name":"docker","_id":"clzxjaiv4000ivaib6qdu4ebq"},{"name":"jvm","_id":"clzxjaivd001bvaib2vqdgrs9"},{"name":"ssh","_id":"clzxjaivh001ivaib78do8b5b"},{"name":"java","_id":"clzxjaivi001mvaib2v7cfcrw"},{"name":"thread","_id":"clzxjaivj001ovaibh5vng8m7"}]}}